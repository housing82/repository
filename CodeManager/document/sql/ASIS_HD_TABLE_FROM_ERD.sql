
CREATE TABLE HD_ACMAST_E
(
	JCODE                VARCHAR2(2 BYTE) CONSTRAINT SYS_C0025275 NOT NULL ,
	JACNTCODE            VARCHAR2(8 BYTE) NULL ,
	JACNTNAME            VARCHAR2(40 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_ACMAST_E
	ADD CONSTRAINT  SYS_C0025276 PRIMARY KEY (JCODE);



CREATE TABLE HD_ACMAST_E
(
	JCODE                VARCHAR2(2 BYTE) CONSTRAINT SYS_C0018941 NOT NULL ,
	JACNTCODE            VARCHAR2(8 BYTE) NULL ,
	JACNTNAME            VARCHAR2(40 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_ACMAST_E
	ADD CONSTRAINT  SYS_C0018942 PRIMARY KEY (JCODE);



CREATE TABLE HD_CODE_ACNT
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025277 NOT NULL ,
	JCODE                VARCHAR2(2 BYTE) CONSTRAINT SYS_C0025278 NOT NULL ,
	JACNTCODE            VARCHAR2(10 BYTE) NULL ,
	JACNTNAME            VARCHAR2(40 BYTE) NULL ,
	DETAILCODE           VARCHAR2(10 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



CREATE UNIQUE INDEX XPKHD_ACMAST_E ON HD_CODE_ACNT
(DEPT_CODE   ASC,JCODE   ASC);



ALTER TABLE HD_CODE_ACNT
	ADD CONSTRAINT  SYS_C0025279 PRIMARY KEY (DEPT_CODE,JCODE);



CREATE TABLE HD_CODE_ACNT
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0018943 NOT NULL ,
	JCODE                VARCHAR2(2 BYTE) CONSTRAINT SYS_C0018944 NOT NULL ,
	JACNTCODE            VARCHAR2(10 BYTE) NULL ,
	JACNTNAME            VARCHAR2(40 BYTE) NULL ,
	DETAILCODE           VARCHAR2(10 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



CREATE UNIQUE INDEX XPKHD_ACMAST_E ON HD_CODE_ACNT
(DEPT_CODE   ASC,JCODE   ASC);



CREATE TABLE HD_CODE_AGENCY
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025280 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025281 NOT NULL ,
	AGENCY_CODE          VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025282 NOT NULL ,
	AGENCY_NAME          VARCHAR2(50 BYTE) DEFAULT  '2'  CONSTRAINT SYS_C0025283 NOT NULL ,
	REMARK               VARCHAR2(50 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_CODE_AGENCY
	ADD CONSTRAINT  SYS_C0025284 PRIMARY KEY (DEPT_CODE,HOUSETAG,AGENCY_CODE);



CREATE TABLE HD_CODE_AGENCY
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0018945 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0018946 NOT NULL ,
	AGENCY_CODE          VARCHAR2(20 BYTE) CONSTRAINT SYS_C0018947 NOT NULL ,
	AGENCY_NAME          VARCHAR2(50 BYTE) DEFAULT  '2'  CONSTRAINT SYS_C0018948 NOT NULL ,
	REMARK               VARCHAR2(50 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_CODE_AGENCY
	ADD CONSTRAINT  SYS_C0018949 PRIMARY KEY (DEPT_CODE,HOUSETAG,AGENCY_CODE);



CREATE TABLE HD_CODE_AGREE
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025285 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025286 NOT NULL ,
	AGREESEQ             VARCHAR2(2 BYTE) CONSTRAINT SYS_C0025287 NOT NULL ,
	AGREENM              VARCHAR2(50 BYTE) NULL ,
	AGREEDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025288 NOT NULL ,
	MIDTYPE              VARCHAR2(2 BYTE) CONSTRAINT SYS_C0025289 NOT NULL ,
	DC_YN                VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025290 NOT NULL ,
	AC_YN                VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025291 NOT NULL ,
	DISTRIBUTE_RATE      NUMBER(4,1) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_CODE_AGREE
	ADD CONSTRAINT  SYS_C0025292 PRIMARY KEY (DEPT_CODE,HOUSETAG,AGREESEQ);



CREATE TABLE HD_CODE_AGREE
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0018950 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0018951 NOT NULL ,
	AGREESEQ             VARCHAR2(2 BYTE) CONSTRAINT SYS_C0018952 NOT NULL ,
	AGREENM              VARCHAR2(50 BYTE) NULL ,
	AGREEDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0018953 NOT NULL ,
	MIDTYPE              VARCHAR2(2 BYTE) CONSTRAINT SYS_C0018954 NOT NULL ,
	DC_YN                VARCHAR2(1 BYTE) CONSTRAINT SYS_C0018955 NOT NULL ,
	AC_YN                VARCHAR2(1 BYTE) CONSTRAINT SYS_C0018956 NOT NULL ,
	DISTRIBUTE_RATE      NUMBER(4,1) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_CODE_AGREE
	ADD CONSTRAINT  SYS_C0018957 PRIMARY KEY (DEPT_CODE,HOUSETAG,AGREESEQ);



CREATE TABLE HD_CODE_COMM_HIST
(
	HIST_DATE            DATE CONSTRAINT SYS_C0025293 NOT NULL ,
	GUBUN                VARCHAR2(2 BYTE) CONSTRAINT SYS_C0025294 NOT NULL ,
	CODE                 VARCHAR2(2 BYTE) CONSTRAINT SYS_C0025295 NOT NULL ,
	NM                   VARCHAR2(20 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	TRI_TAG              VARCHAR2(1 BYTE) NULL 
);



ALTER TABLE HD_CODE_COMM_HIST
	ADD CONSTRAINT  SYS_C0025296 PRIMARY KEY (HIST_DATE,GUBUN,CODE);



CREATE TABLE HD_CODE_COMM_HIST
(
	HIST_DATE            DATE CONSTRAINT SYS_C0018958 NOT NULL ,
	GUBUN                VARCHAR2(2 BYTE) CONSTRAINT SYS_C0018959 NOT NULL ,
	CODE                 VARCHAR2(2 BYTE) CONSTRAINT SYS_C0018960 NOT NULL ,
	NM                   VARCHAR2(20 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	TRI_TAG              VARCHAR2(1 BYTE) NULL 
);



ALTER TABLE HD_CODE_COMM_HIST
	ADD CONSTRAINT  SYS_C0018961 PRIMARY KEY (HIST_DATE,GUBUN,CODE);



CREATE TABLE HD_CODE_COMPAMT
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025297 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025298 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025299 NOT NULL ,
	COMP_DATE            VARCHAR2(8 BYTE) NULL ,
	COMP_AMT             NUMBER(15) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_CODE_COMPAMT
	ADD CONSTRAINT  SYS_C0025300 PRIMARY KEY (DEPT_CODE,HOUSETAG,SEQ);



CREATE TABLE HD_CODE_COMPAMT
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0018962 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0018963 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0018964 NOT NULL ,
	COMP_DATE            VARCHAR2(8 BYTE) NULL ,
	COMP_AMT             NUMBER(15) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_CODE_COMPAMT
	ADD CONSTRAINT  SYS_C0018965 PRIMARY KEY (DEPT_CODE,HOUSETAG,SEQ);



CREATE TABLE HD_CODE_CUSTOMER
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025301 NOT NULL ,
	CUST_NAME            VARCHAR2(50 BYTE) CONSTRAINT SYS_C0025302 NOT NULL ,
	CUSTCODE_TAG         VARCHAR2(3 BYTE) DEFAULT  '1'  NULL ,
	HANDPHONE            VARCHAR2(20 BYTE) NULL ,
	TEL                  VARCHAR2(20 BYTE) NULL ,
	COMP_TEL             VARCHAR2(20 BYTE) NULL ,
	ZIP                  VARCHAR2(6 BYTE) CONSTRAINT SYS_C0025303 NOT NULL ,
	ADDR1                VARCHAR2(300 BYTE) CONSTRAINT SYS_C0025304 NOT NULL ,
	ADDR2                VARCHAR2(300 BYTE) CONSTRAINT SYS_C0025305 NOT NULL ,
	OWNER                VARCHAR2(30 BYTE) NULL ,
	CONDITION            VARCHAR2(30 BYTE) NULL ,
	CATEGORY             VARCHAR2(12 BYTE) NULL ,
	EMAIL                VARCHAR2(50 BYTE) NULL ,
	RESIDENT_ZIP         VARCHAR2(6 BYTE) NULL ,
	RESIDENT_ADDR1       VARCHAR2(100 BYTE) NULL ,
	RESIDENT_ADDR2       VARCHAR2(100 BYTE) NULL ,
	USEYN                VARCHAR2(1 BYTE) NULL ,
	COMP_RECV_YN         VARCHAR2(1 BYTE) NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_CODE_CUSTOMER
	ADD CONSTRAINT  SYS_C0025306 PRIMARY KEY (CUST_CODE);



CREATE  INDEX XIE1HD_CODE_CUSTOMER ON HD_CODE_CUSTOMER
(CUST_NAME   ASC);



CREATE TABLE HD_CODE_CUSTOMER
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0018966 NOT NULL ,
	CUST_NAME            VARCHAR2(50 BYTE) CONSTRAINT SYS_C0018967 NOT NULL ,
	CUSTCODE_TAG         VARCHAR2(3 BYTE) DEFAULT  '1'  NULL ,
	HANDPHONE            VARCHAR2(20 BYTE) NULL ,
	TEL                  VARCHAR2(20 BYTE) NULL ,
	COMP_TEL             VARCHAR2(20 BYTE) NULL ,
	ZIP                  VARCHAR2(6 BYTE) CONSTRAINT SYS_C0018968 NOT NULL ,
	ADDR1                VARCHAR2(100 BYTE) CONSTRAINT SYS_C0018969 NOT NULL ,
	ADDR2                VARCHAR2(100 BYTE) CONSTRAINT SYS_C0018970 NOT NULL ,
	OWNER                VARCHAR2(30 BYTE) NULL ,
	CONDITION            VARCHAR2(30 BYTE) NULL ,
	CATEGORY             VARCHAR2(12 BYTE) NULL ,
	EMAIL                VARCHAR2(50 BYTE) NULL ,
	RESIDENT_ZIP         VARCHAR2(6 BYTE) NULL ,
	RESIDENT_ADDR1       VARCHAR2(100 BYTE) NULL ,
	RESIDENT_ADDR2       VARCHAR2(100 BYTE) NULL ,
	USEYN                VARCHAR2(1 BYTE) NULL ,
	COMP_RECV_YN         VARCHAR2(1 BYTE) NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_CODE_CUSTOMER
	ADD CONSTRAINT  SYS_C0018971 PRIMARY KEY (CUST_CODE);



CREATE  INDEX XIE1HD_CODE_CUSTOMER ON HD_CODE_CUSTOMER
(CUST_NAME   ASC);



CREATE TABLE HD_CODE_CUSTOMER_TXTUP
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025307 NOT NULL ,
	CUSTCODE_TAG         VARCHAR2(3 BYTE) DEFAULT  '1'  NULL ,
	CUST_NAME            VARCHAR2(50 BYTE) NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HANDPHONE            VARCHAR2(20 BYTE) NULL ,
	TEL                  VARCHAR2(20 BYTE) NULL ,
	ZIP                  VARCHAR2(6 BYTE) CONSTRAINT SYS_C0025308 NOT NULL ,
	ADDR                 VARCHAR2(300 BYTE) CONSTRAINT SYS_C0025309 NOT NULL ,
	EMAIL                VARCHAR2(50 BYTE) NULL ,
	PROCESS_TAG          VARCHAR2(1 BYTE) NULL ,
	ERR_MSG              VARCHAR2(100 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	ADDR2                VARCHAR2(300 BYTE) NULL ,
	ADDR_TAG             VARCHAR2(1 BYTE) NULL ,
	REPRESENT_NAME       VARCHAR2(50 BYTE) NULL 
);



ALTER TABLE HD_CODE_CUSTOMER_TXTUP
	ADD CONSTRAINT  SYS_C0025310 PRIMARY KEY (CUST_CODE);



CREATE TABLE HD_CODE_CUSTOMER_TXTUP
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0018972 NOT NULL ,
	CUSTCODE_TAG         VARCHAR2(3 BYTE) DEFAULT  '1'  NULL ,
	CUST_NAME            VARCHAR2(50 BYTE) NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HANDPHONE            VARCHAR2(20 BYTE) NULL ,
	TEL                  VARCHAR2(20 BYTE) NULL ,
	ZIP                  VARCHAR2(6 BYTE) CONSTRAINT SYS_C0018973 NOT NULL ,
	ADDR                 VARCHAR2(100 BYTE) CONSTRAINT SYS_C0018974 NOT NULL ,
	EMAIL                VARCHAR2(50 BYTE) NULL ,
	PROCESS_TAG          VARCHAR2(1 BYTE) NULL ,
	ERR_MSG              VARCHAR2(100 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_CODE_CUSTOMER_TXTUP
	ADD CONSTRAINT  SYS_C0018975 PRIMARY KEY (CUST_CODE);



CREATE TABLE HD_CODE_DEPOSIT
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025311 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025312 NOT NULL ,
	DEPOSIT_NO           VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025313 NOT NULL ,
	RECEIPTTAG           VARCHAR2(1 BYTE) DEFAULT  '2'  CONSTRAINT SYS_C0025314 NOT NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025315 NOT NULL ,
	BANK_NAME            VARCHAR2(30 BYTE) CONSTRAINT SYS_C0025316 NOT NULL ,
	LISTORDER            FLOAT(126) CONSTRAINT SYS_C0025317 NOT NULL ,
	OUTDEPOSITNO         VARCHAR2(20 BYTE) NULL ,
	REMARK               VARCHAR2(50 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	VIR_TAG              VARCHAR2(1 BYTE) NULL 
);



ALTER TABLE HD_CODE_DEPOSIT
	ADD CONSTRAINT  SYS_C0025318 PRIMARY KEY (DEPT_CODE,HOUSETAG,DEPOSIT_NO);



CREATE TABLE HD_CODE_DEPOSIT
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0018976 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0018977 NOT NULL ,
	DEPOSIT_NO           VARCHAR2(20 BYTE) CONSTRAINT SYS_C0018978 NOT NULL ,
	RECEIPTTAG           VARCHAR2(1 BYTE) DEFAULT  '2'  CONSTRAINT SYS_C0018979 NOT NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0018980 NOT NULL ,
	BANK_NAME            VARCHAR2(30 BYTE) CONSTRAINT SYS_C0018981 NOT NULL ,
	LISTORDER            FLOAT(126) CONSTRAINT SYS_C0018982 NOT NULL ,
	OUTDEPOSITNO         VARCHAR2(20 BYTE) NULL ,
	REMARK               VARCHAR2(50 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	VIR_TAG              VARCHAR2(1 BYTE) NULL 
);



ALTER TABLE HD_CODE_DEPOSIT
	ADD CONSTRAINT  SYS_C0018983 PRIMARY KEY (DEPT_CODE,HOUSETAG,DEPOSIT_NO);



CREATE TABLE HD_CODE_DEPT
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025319 NOT NULL ,
	DEPT_NAME            VARCHAR2(150 BYTE) CONSTRAINT SYS_C0025320 NOT NULL ,
	TEL                  VARCHAR2(12 BYTE) NULL ,
	ZIP                  VARCHAR2(6 BYTE) NULL ,
	ADDR1                VARCHAR2(100 BYTE) NULL ,
	ADDR2                VARCHAR2(100 BYTE) NULL ,
	LISTTAG              VARCHAR2(1 BYTE) NULL ,
	JOBTAG               VARCHAR2(1 BYTE) NULL ,
	COMPANY_CODE         VARCHAR2(6 BYTE) NULL ,
	AMIS_DEPTCODE        VARCHAR2(12 BYTE) NULL ,
	TAX_TAG              VARCHAR2(1 BYTE) NULL ,
	SIHANG_VENDOR        VARCHAR2(20 BYTE) NULL ,
	SIHANG_NAME          VARCHAR2(60 BYTE) NULL ,
	SIHANG_DEPYO         VARCHAR2(40 BYTE) NULL ,
	SIHANG_UPTE          VARCHAR2(40 BYTE) NULL ,
	SIHANG_UPJONG        VARCHAR2(40 BYTE) NULL ,
	SIHANG_ZIP           VARCHAR2(6 BYTE) NULL ,
	SIHANG_ADDR1         VARCHAR2(100 BYTE) NULL ,
	SIHANG_ADDR2         VARCHAR2(100 BYTE) NULL ,
	SIGONG_NAME          VARCHAR2(60 BYTE) NULL ,
	SIGONG_DEPYO         VARCHAR2(40 BYTE) NULL ,
	SIGONG_CHARGE        VARCHAR2(20 BYTE) NULL ,
	SIGONG_TEL           CHAR(18 BYTE) NULL ,
	MODEL_ZIP            VARCHAR2(6 BYTE) NULL ,
	MODEL_ADDR1          VARCHAR2(100 BYTE) NULL ,
	MODEL_ADDR2          VARCHAR2(100 BYTE) NULL ,
	MODEL_TEL            VARCHAR2(20 BYTE) NULL ,
	DEPT_TYPE_CODE       VARCHAR2(2 BYTE) NULL ,
	REMARK               VARCHAR2(50 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	SMS_NAME             VARCHAR2(20 BYTE) NULL ,
	SMS_TEL              VARCHAR2(20 BYTE) NULL ,
	OLD_DEPTCODE         VARCHAR2(20 BYTE) NULL ,
	ZIP_ORG              VARCHAR2(6 BYTE) NULL ,
	ADDR1_ORG            VARCHAR2(100 BYTE) NULL ,
	ADDR2_ORG            VARCHAR2(100 BYTE) NULL ,
	ADDR_TAG             VARCHAR2(1 BYTE) NULL ,
	SIHANG_ZIP_ORG       VARCHAR2(6 BYTE) NULL ,
	SIHANG_ADDR1_ORG     VARCHAR2(100 BYTE) NULL ,
	SIHANG_ADDR2_ORG     VARCHAR2(100 BYTE) NULL ,
	SIHANG_ADDR_TAG      VARCHAR2(1 BYTE) NULL ,
	MODEL_ZIP_ORG        VARCHAR2(6 BYTE) NULL ,
	MODEL_ADDR1_ORG      VARCHAR2(100 BYTE) NULL ,
	MODEL_ADDR2_ORG      VARCHAR2(100 BYTE) NULL ,
	MODEL_ADDR_TAG       VARCHAR2(1 BYTE) NULL 
);



ALTER TABLE HD_CODE_DEPT
	ADD CONSTRAINT  SYS_C0025321 PRIMARY KEY (DEPT_CODE);



CREATE TABLE HD_CODE_DEPT
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0018984 NOT NULL ,
	DEPT_NAME            VARCHAR2(150 BYTE) CONSTRAINT SYS_C0018985 NOT NULL ,
	TEL                  VARCHAR2(12 BYTE) NULL ,
	ZIP                  VARCHAR2(6 BYTE) NULL ,
	ADDR1                VARCHAR2(100 BYTE) NULL ,
	ADDR2                VARCHAR2(100 BYTE) NULL ,
	LISTTAG              VARCHAR2(1 BYTE) NULL ,
	JOBTAG               VARCHAR2(1 BYTE) NULL ,
	COMPANY_CODE         VARCHAR2(6 BYTE) NULL ,
	AMIS_DEPTCODE        VARCHAR2(12 BYTE) NULL ,
	TAX_TAG              VARCHAR2(1 BYTE) NULL ,
	SIHANG_VENDOR        VARCHAR2(20 BYTE) NULL ,
	SIHANG_NAME          VARCHAR2(60 BYTE) NULL ,
	SIHANG_DEPYO         VARCHAR2(40 BYTE) NULL ,
	SIHANG_UPTE          VARCHAR2(40 BYTE) NULL ,
	SIHANG_UPJONG        VARCHAR2(40 BYTE) NULL ,
	SIHANG_ZIP           VARCHAR2(6 BYTE) NULL ,
	SIHANG_ADDR1         VARCHAR2(100 BYTE) NULL ,
	SIHANG_ADDR2         VARCHAR2(100 BYTE) NULL ,
	SIGONG_NAME          VARCHAR2(60 BYTE) NULL ,
	SIGONG_DEPYO         VARCHAR2(40 BYTE) NULL ,
	SIGONG_CHARGE        VARCHAR2(20 BYTE) NULL ,
	SIGONG_TEL           CHAR(18 BYTE) NULL ,
	MODEL_ZIP            VARCHAR2(6 BYTE) NULL ,
	MODEL_ADDR1          VARCHAR2(100 BYTE) NULL ,
	MODEL_ADDR2          VARCHAR2(100 BYTE) NULL ,
	MODEL_TEL            VARCHAR2(20 BYTE) NULL ,
	DEPT_TYPE_CODE       VARCHAR2(2 BYTE) NULL ,
	REMARK               VARCHAR2(50 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	SMS_NAME             VARCHAR2(20 BYTE) NULL ,
	SMS_TEL              VARCHAR2(20 BYTE) NULL ,
	OLD_DEPTCODE         VARCHAR2(20 BYTE) NULL 
);



ALTER TABLE HD_CODE_DEPT
	ADD CONSTRAINT  SYS_C0018986 PRIMARY KEY (DEPT_CODE);



CREATE TABLE HD_CODE_DEPT_HIST
(
	HIST_DATE            DATE CONSTRAINT SYS_C0025325 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025326 NOT NULL ,
	DEPT_NAME            VARCHAR2(150 BYTE) CONSTRAINT SYS_C0025327 NOT NULL ,
	TEL                  VARCHAR2(12 BYTE) NULL ,
	ZIP                  VARCHAR2(6 BYTE) NULL ,
	ADDR1                VARCHAR2(100 BYTE) NULL ,
	ADDR2                VARCHAR2(100 BYTE) NULL ,
	LISTTAG              VARCHAR2(1 BYTE) NULL ,
	JOBTAG               VARCHAR2(1 BYTE) NULL ,
	COMPANY_CODE         VARCHAR2(6 BYTE) NULL ,
	AMIS_DEPTCODE        VARCHAR2(12 BYTE) NULL ,
	TAX_TAG              VARCHAR2(1 BYTE) NULL ,
	SIHANG_VENDOR        VARCHAR2(20 BYTE) NULL ,
	SIHANG_NAME          VARCHAR2(60 BYTE) NULL ,
	SIHANG_DEPYO         VARCHAR2(40 BYTE) NULL ,
	SIHANG_UPTE          VARCHAR2(40 BYTE) NULL ,
	SIHANG_UPJONG        VARCHAR2(40 BYTE) NULL ,
	SIHANG_ZIP           VARCHAR2(6 BYTE) NULL ,
	SIHANG_ADDR1         VARCHAR2(100 BYTE) NULL ,
	SIHANG_ADDR2         VARCHAR2(100 BYTE) NULL ,
	SIGONG_NAME          VARCHAR2(60 BYTE) NULL ,
	SIGONG_DEPYO         VARCHAR2(40 BYTE) NULL ,
	SIGONG_CHARGE        VARCHAR2(20 BYTE) NULL ,
	SIGONG_TEL           CHAR(18 BYTE) NULL ,
	MODEL_ZIP            VARCHAR2(6 BYTE) NULL ,
	MODEL_ADDR1          VARCHAR2(100 BYTE) NULL ,
	MODEL_ADDR2          VARCHAR2(100 BYTE) NULL ,
	MODEL_TEL            VARCHAR2(20 BYTE) NULL ,
	DEPT_TYPE_CODE       VARCHAR2(2 BYTE) NULL ,
	REMARK               VARCHAR2(50 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	SMS_NAME             VARCHAR2(20 BYTE) NULL ,
	SMS_TEL              VARCHAR2(20 BYTE) NULL ,
	OLD_DEPTCODE         VARCHAR2(20 BYTE) NULL ,
	TRI_TAG              VARCHAR2(1 BYTE) NULL ,
	MODTAG               VARCHAR2(1 BYTE) NULL ,
	ZIP_ORG              VARCHAR2(6 BYTE) NULL ,
	ADDR1_ORG            VARCHAR2(100 BYTE) NULL ,
	ADDR2_ORG            VARCHAR2(100 BYTE) NULL ,
	ADDR_TAG             VARCHAR2(1 BYTE) NULL ,
	SIHANG_ZIP_ORG       VARCHAR2(6 BYTE) NULL ,
	SIHANG_ADDR1_ORG     VARCHAR2(100 BYTE) NULL ,
	SIHANG_ADDR2_ORG     VARCHAR2(100 BYTE) NULL ,
	SIHANG_ADDR_TAG      VARCHAR2(1 BYTE) NULL ,
	MODEL_ZIP_ORG        VARCHAR2(6 BYTE) NULL ,
	MODEL_ADDR1_ORG      VARCHAR2(100 BYTE) NULL ,
	MODEL_ADDR2_ORG      VARCHAR2(100 BYTE) NULL ,
	MODEL_ADDR_TAG       VARCHAR2(1 BYTE) NULL 
);



ALTER TABLE HD_CODE_DEPT_HIST
	ADD CONSTRAINT  SYS_C0025328 PRIMARY KEY (HIST_DATE,DEPT_CODE);



CREATE TABLE HD_CODE_DEPT_HIST
(
	HIST_DATE            DATE CONSTRAINT SYS_C0018990 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0018991 NOT NULL ,
	DEPT_NAME            VARCHAR2(150 BYTE) CONSTRAINT SYS_C0018992 NOT NULL ,
	TEL                  VARCHAR2(12 BYTE) NULL ,
	ZIP                  VARCHAR2(6 BYTE) NULL ,
	ADDR1                VARCHAR2(100 BYTE) NULL ,
	ADDR2                VARCHAR2(100 BYTE) NULL ,
	LISTTAG              VARCHAR2(1 BYTE) NULL ,
	JOBTAG               VARCHAR2(1 BYTE) NULL ,
	COMPANY_CODE         VARCHAR2(6 BYTE) NULL ,
	AMIS_DEPTCODE        VARCHAR2(12 BYTE) NULL ,
	TAX_TAG              VARCHAR2(1 BYTE) NULL ,
	SIHANG_VENDOR        VARCHAR2(20 BYTE) NULL ,
	SIHANG_NAME          VARCHAR2(60 BYTE) NULL ,
	SIHANG_DEPYO         VARCHAR2(40 BYTE) NULL ,
	SIHANG_UPTE          VARCHAR2(40 BYTE) NULL ,
	SIHANG_UPJONG        VARCHAR2(40 BYTE) NULL ,
	SIHANG_ZIP           VARCHAR2(6 BYTE) NULL ,
	SIHANG_ADDR1         VARCHAR2(100 BYTE) NULL ,
	SIHANG_ADDR2         VARCHAR2(100 BYTE) NULL ,
	SIGONG_NAME          VARCHAR2(60 BYTE) NULL ,
	SIGONG_DEPYO         VARCHAR2(40 BYTE) NULL ,
	SIGONG_CHARGE        VARCHAR2(20 BYTE) NULL ,
	SIGONG_TEL           CHAR(18 BYTE) NULL ,
	MODEL_ZIP            VARCHAR2(6 BYTE) NULL ,
	MODEL_ADDR1          VARCHAR2(100 BYTE) NULL ,
	MODEL_ADDR2          VARCHAR2(100 BYTE) NULL ,
	MODEL_TEL            VARCHAR2(20 BYTE) NULL ,
	DEPT_TYPE_CODE       VARCHAR2(2 BYTE) NULL ,
	REMARK               VARCHAR2(50 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	SMS_NAME             VARCHAR2(20 BYTE) NULL ,
	SMS_TEL              VARCHAR2(20 BYTE) NULL ,
	OLD_DEPTCODE         VARCHAR2(20 BYTE) NULL ,
	TRI_TAG              VARCHAR2(1 BYTE) NULL 
);



ALTER TABLE HD_CODE_DEPT_HIST
	ADD CONSTRAINT  SYS_C0018993 PRIMARY KEY (HIST_DATE,DEPT_CODE);



CREATE TABLE HD_CODE_DEPTMEMO
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025322 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025323 NOT NULL ,
	TITLE                VARCHAR2(10 BYTE) NULL ,
	NM                   VARCHAR2(20 BYTE) NULL ,
	OFFICETEL            VARCHAR2(20 BYTE) NULL ,
	HANDPHONE            VARCHAR2(20 BYTE) NULL ,
	EMAIL                VARCHAR2(50 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_CODE_DEPTMEMO
	ADD CONSTRAINT  SYS_C0025324 PRIMARY KEY (DEPT_CODE,SEQ);



CREATE TABLE HD_CODE_DEPTMEMO
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0018987 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0018988 NOT NULL ,
	TITLE                VARCHAR2(10 BYTE) NULL ,
	NM                   VARCHAR2(20 BYTE) NULL ,
	OFFICETEL            VARCHAR2(20 BYTE) NULL ,
	HANDPHONE            VARCHAR2(20 BYTE) NULL ,
	EMAIL                VARCHAR2(50 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_CODE_DEPTMEMO
	ADD CONSTRAINT  SYS_C0018989 PRIMARY KEY (DEPT_CODE,SEQ);



CREATE TABLE HD_CODE_GIFT
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025329 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025330 NOT NULL ,
	GIFTCODE             VARCHAR2(4 BYTE) CONSTRAINT SYS_C0025331 NOT NULL ,
	GIFTNAME             VARCHAR2(40 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_CODE_GIFT
	ADD CONSTRAINT  SYS_C0025332 PRIMARY KEY (DEPT_CODE,HOUSETAG,GIFTCODE);



CREATE TABLE HD_CODE_GIFT
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0018994 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0018995 NOT NULL ,
	GIFTCODE             VARCHAR2(4 BYTE) CONSTRAINT SYS_C0018996 NOT NULL ,
	GIFTNAME             VARCHAR2(40 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_CODE_GIFT
	ADD CONSTRAINT  SYS_C0018997 PRIMARY KEY (DEPT_CODE,HOUSETAG,GIFTCODE);



CREATE TABLE HD_CODE_HOUSE
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025333 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025334 NOT NULL ,
	HOUSEDATE            VARCHAR2(8 BYTE) NULL ,
	COMPLETIONDATE       VARCHAR2(8 BYTE) NULL ,
	HOUSE_CNT            NUMBER(5) NULL ,
	MOVEINSTARTDATE      VARCHAR2(8 BYTE) NULL ,
	MOVEINENDDATE        VARCHAR2(8 BYTE) NULL ,
	PENALTYRATE          NUMBER(6,3) NULL ,
	HIC_TAG              VARCHAR2(2 BYTE) NULL ,
	TIRM_RATE            NUMBER(6,3) NULL ,
	SODUK_RATE           NUMBER(6,3) NULL ,
	JUMIN_RATE           NUMBER(6,3) NULL ,
	DAMDANG              VARCHAR2(20 BYTE) NULL ,
	DAMDANG_TEL          VARCHAR2(20 BYTE) NULL ,
	PRINT_CNT            NUMBER(3) NULL ,
	RESELL_TAG           VARCHAR2(1 BYTE) NULL ,
	VIRDEPOSIT_YN        VARCHAR2(1 BYTE) NULL ,
	VIRBANK_CODE         VARCHAR2(8 BYTE) NULL ,
	DEPT_ADDR_USE_YN     VARCHAR2(1 BYTE) NULL ,
	CONT_PBL_NAME        VARCHAR2(30 BYTE) NULL ,
	CONT_DW_NAME         VARCHAR2(30 BYTE) NULL ,
	REMARK               VARCHAR2(500 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	CONT_PBL_NAME2       VARCHAR2(30 BYTE) NULL ,
	CONT_DW_NAME2        VARCHAR2(30 BYTE) NULL ,
	CONT_PBL_NAME3       VARCHAR2(30 BYTE) NULL ,
	CONT_DW_NAME3        VARCHAR2(30 BYTE) NULL ,
	SLIPGROUP            VARCHAR2(1 BYTE) NULL ,
	APPLY_CHECK_YN       VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	ANNE1A_PBL           VARCHAR2(30 BYTE) NULL ,
	ANNE1A_DW            VARCHAR2(30 BYTE) NULL ,
	ANNE1B_PBL           VARCHAR2(30 BYTE) NULL ,
	ANNE1B_DW            VARCHAR2(30 BYTE) NULL ,
	ANNE2A_PBL           VARCHAR2(30 BYTE) NULL ,
	ANNE2A_DW            VARCHAR2(30 BYTE) NULL ,
	ANNE2B_PBL           VARCHAR2(30 BYTE) NULL ,
	ANNE2B_DW            VARCHAR2(30 BYTE) NULL ,
	ANNE3_PBL            VARCHAR2(30 BYTE) NULL ,
	ANNE3_DW             VARCHAR2(30 BYTE) NULL ,
	ANNE4_PBL            VARCHAR2(30 BYTE) NULL ,
	ANNE4_DW             VARCHAR2(30 BYTE) NULL ,
	DELAYDAY             NUMBER(5) NULL ,
	DELAYRATE            NUMBER(6,2) NULL ,
	AGREE_TAG            VARCHAR2(1 BYTE) NULL ,
	INDEMINITY_TAG       VARCHAR2(1 BYTE) NULL ,
	INDEMINITY_FRDT      VARCHAR2(8 BYTE) NULL ,
	INDEMINITY_TODT      VARCHAR2(8 BYTE) NULL ,
	SEALTYPE             VARCHAR2(1 BYTE) NULL ,
	JIRO_TAG             VARCHAR2(1 BYTE) NULL ,
	JIRO_SN              VARCHAR2(3 BYTE) NULL ,
	HD_DAYMONTH_TAG      VARCHAR2(1 BYTE) NULL ,
	RT_DAYMONTH_TAG      VARCHAR2(1 BYTE) NULL ,
	RT_FIXRATE_TAG       VARCHAR2(1 BYTE) NULL ,
	PREDIS_TAG           VARCHAR2(1 BYTE) NULL ,
	PROXY_TAG            VARCHAR2(1 BYTE) NULL ,
	TRUST_TAG            VARCHAR2(1 BYTE) NULL ,
	PRINT_YN             VARCHAR2(1 BYTE) NULL ,
	RT_FIXRATE_DAY       NUMBER(3) NULL ,
	RT_FIXRATE           FLOAT(126) NULL ,
	VIRDEPOSIT2_YN       VARCHAR2(1 BYTE) NULL ,
	VIRBANK2_CODE        VARCHAR2(8 BYTE) NULL ,
	RT_FIXRATE2          FLOAT(126) NULL ,
	RT_EXTRATE           FLOAT(126) DEFAULT  0  NULL ,
	RT_GURTYN            VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	RT_RENTYN            VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	ONCESALERATE         FLOAT(126) DEFAULT  0  NULL ,
	DELAY_BLOCK          VARCHAR2(1 BYTE) DEFAULT  '1'  NULL 
);



ALTER TABLE HD_CODE_HOUSE
	ADD CONSTRAINT  SYS_C0025335 PRIMARY KEY (DEPT_CODE,HOUSETAG);



CREATE TABLE HD_CODE_HOUSE
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0018998 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0018999 NOT NULL ,
	HOUSEDATE            VARCHAR2(8 BYTE) NULL ,
	COMPLETIONDATE       VARCHAR2(8 BYTE) NULL ,
	HOUSE_CNT            NUMBER(5) NULL ,
	MOVEINSTARTDATE      VARCHAR2(8 BYTE) NULL ,
	MOVEINENDDATE        VARCHAR2(8 BYTE) NULL ,
	PENALTYRATE          NUMBER(6,3) NULL ,
	HIC_TAG              VARCHAR2(2 BYTE) NULL ,
	TIRM_RATE            NUMBER(6,3) NULL ,
	SODUK_RATE           NUMBER(6,3) NULL ,
	JUMIN_RATE           NUMBER(6,3) NULL ,
	DAMDANG              VARCHAR2(20 BYTE) NULL ,
	DAMDANG_TEL          VARCHAR2(20 BYTE) NULL ,
	PRINT_CNT            NUMBER(3) NULL ,
	RESELL_TAG           VARCHAR2(1 BYTE) NULL ,
	VIRDEPOSIT_YN        VARCHAR2(1 BYTE) NULL ,
	VIRBANK_CODE         VARCHAR2(8 BYTE) NULL ,
	DEPT_ADDR_USE_YN     VARCHAR2(1 BYTE) NULL ,
	CONT_PBL_NAME        VARCHAR2(30 BYTE) NULL ,
	CONT_DW_NAME         VARCHAR2(30 BYTE) NULL ,
	REMARK               VARCHAR2(500 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	CONT_PBL_NAME2       VARCHAR2(30 BYTE) NULL ,
	CONT_DW_NAME2        VARCHAR2(30 BYTE) NULL ,
	CONT_PBL_NAME3       VARCHAR2(30 BYTE) NULL ,
	CONT_DW_NAME3        VARCHAR2(30 BYTE) NULL ,
	SLIPGROUP            VARCHAR2(1 BYTE) NULL ,
	APPLY_CHECK_YN       VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	ANNE1A_PBL           VARCHAR2(30 BYTE) NULL ,
	ANNE1A_DW            VARCHAR2(30 BYTE) NULL ,
	ANNE1B_PBL           VARCHAR2(30 BYTE) NULL ,
	ANNE1B_DW            VARCHAR2(30 BYTE) NULL ,
	ANNE2A_PBL           VARCHAR2(30 BYTE) NULL ,
	ANNE2A_DW            VARCHAR2(30 BYTE) NULL ,
	ANNE2B_PBL           VARCHAR2(30 BYTE) NULL ,
	ANNE2B_DW            VARCHAR2(30 BYTE) NULL ,
	ANNE3_PBL            VARCHAR2(30 BYTE) NULL ,
	ANNE3_DW             VARCHAR2(30 BYTE) NULL ,
	ANNE4_PBL            VARCHAR2(30 BYTE) NULL ,
	ANNE4_DW             VARCHAR2(30 BYTE) NULL ,
	DELAYDAY             NUMBER(5) NULL ,
	DELAYRATE            NUMBER(6,2) NULL ,
	AGREE_TAG            VARCHAR2(1 BYTE) NULL ,
	INDEMINITY_TAG       VARCHAR2(1 BYTE) NULL ,
	INDEMINITY_FRDT      VARCHAR2(8 BYTE) NULL ,
	INDEMINITY_TODT      VARCHAR2(8 BYTE) NULL ,
	SEALTYPE             VARCHAR2(1 BYTE) NULL ,
	JIRO_TAG             VARCHAR2(1 BYTE) NULL ,
	JIRO_SN              VARCHAR2(3 BYTE) NULL ,
	HD_DAYMONTH_TAG      VARCHAR2(1 BYTE) NULL ,
	RT_DAYMONTH_TAG      VARCHAR2(1 BYTE) NULL ,
	RT_FIXRATE_TAG       VARCHAR2(1 BYTE) NULL ,
	PREDIS_TAG           VARCHAR2(1 BYTE) NULL ,
	PROXY_TAG            VARCHAR2(1 BYTE) NULL ,
	TRUST_TAG            VARCHAR2(1 BYTE) NULL ,
	PRINT_YN             VARCHAR2(1 BYTE) NULL ,
	RT_FIXRATE_DAY       NUMBER(3) NULL ,
	RT_FIXRATE           FLOAT(126) NULL ,
	VIRDEPOSIT2_YN       VARCHAR2(1 BYTE) NULL ,
	VIRBANK2_CODE        VARCHAR2(8 BYTE) NULL ,
	RT_FIXRATE2          FLOAT(126) NULL ,
	RT_EXTRATE           FLOAT(126) DEFAULT  0  NULL ,
	RT_GURTYN            VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	RT_RENTYN            VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	ONCESALERATE         FLOAT(126) DEFAULT  0  NULL 
);



ALTER TABLE HD_CODE_HOUSE
	ADD CONSTRAINT  SYS_C0019000 PRIMARY KEY (DEPT_CODE,HOUSETAG);



CREATE TABLE HD_CODE_HOUSE_HIST
(
	HIST_DATE            DATE CONSTRAINT SYS_C0025336 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025337 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025338 NOT NULL ,
	HOUSEDATE            VARCHAR2(8 BYTE) NULL ,
	COMPLETIONDATE       VARCHAR2(8 BYTE) NULL ,
	HOUSE_CNT            NUMBER(5) NULL ,
	MOVEINSTARTDATE      VARCHAR2(8 BYTE) NULL ,
	MOVEINENDDATE        VARCHAR2(8 BYTE) NULL ,
	PENALTYRATE          NUMBER(6,3) NULL ,
	HIC_TAG              VARCHAR2(2 BYTE) NULL ,
	TIRM_RATE            NUMBER(6,3) NULL ,
	SODUK_RATE           NUMBER(6,3) NULL ,
	JUMIN_RATE           NUMBER(6,3) NULL ,
	DAMDANG              VARCHAR2(20 BYTE) NULL ,
	DAMDANG_TEL          VARCHAR2(20 BYTE) NULL ,
	PRINT_CNT            NUMBER(3) NULL ,
	RESELL_TAG           VARCHAR2(1 BYTE) NULL ,
	VIRDEPOSIT_YN        VARCHAR2(1 BYTE) NULL ,
	VIRBANK_CODE         VARCHAR2(8 BYTE) NULL ,
	DEPT_ADDR_USE_YN     VARCHAR2(1 BYTE) NULL ,
	CONT_PBL_NAME        VARCHAR2(30 BYTE) NULL ,
	CONT_DW_NAME         VARCHAR2(30 BYTE) NULL ,
	REMARK               VARCHAR2(500 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	CONT_PBL_NAME2       VARCHAR2(30 BYTE) NULL ,
	CONT_DW_NAME2        VARCHAR2(30 BYTE) NULL ,
	CONT_PBL_NAME3       VARCHAR2(30 BYTE) NULL ,
	CONT_DW_NAME3        VARCHAR2(30 BYTE) NULL ,
	SLIPGROUP            VARCHAR2(1 BYTE) NULL ,
	TRI_TAG              VARCHAR2(1 BYTE) NULL ,
	APPLY_CHECK_YN       VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	ANNE1A_PBL           VARCHAR2(30 BYTE) NULL ,
	ANNE1A_DW            VARCHAR2(30 BYTE) NULL ,
	ANNE1B_PBL           VARCHAR2(30 BYTE) NULL ,
	ANNE1B_DW            VARCHAR2(30 BYTE) NULL ,
	ANNE2A_PBL           VARCHAR2(30 BYTE) NULL ,
	ANNE2A_DW            VARCHAR2(30 BYTE) NULL ,
	ANNE2B_PBL           VARCHAR2(30 BYTE) NULL ,
	ANNE2B_DW            VARCHAR2(30 BYTE) NULL ,
	ANNE3_PBL            VARCHAR2(30 BYTE) NULL ,
	ANNE3_DW             VARCHAR2(30 BYTE) NULL ,
	ANNE4_PBL            VARCHAR2(30 BYTE) NULL ,
	ANNE4_DW             VARCHAR2(30 BYTE) NULL ,
	DELAYDAY             NUMBER(5) NULL ,
	DELAYRATE            NUMBER(6,2) NULL ,
	AGREE_TAG            VARCHAR2(1 BYTE) NULL ,
	INDEMINITY_TAG       VARCHAR2(1 BYTE) NULL ,
	INDEMINITY_FRDT      VARCHAR2(8 BYTE) NULL ,
	INDEMINITY_TODT      VARCHAR2(8 BYTE) NULL ,
	SEALTYPE             VARCHAR2(1 BYTE) NULL ,
	JIRO_TAG             VARCHAR2(1 BYTE) NULL ,
	JIRO_SN              VARCHAR2(3 BYTE) NULL ,
	HD_DAYMONTH_TAG      VARCHAR2(1 BYTE) NULL ,
	RT_DAYMONTH_TAG      VARCHAR2(1 BYTE) NULL ,
	RT_FIXRATE_TAG       VARCHAR2(1 BYTE) NULL ,
	PREDIS_TAG           VARCHAR2(1 BYTE) NULL ,
	PROXY_TAG            VARCHAR2(1 BYTE) NULL ,
	TRUST_TAG            VARCHAR2(1 BYTE) NULL ,
	PRINT_YN             VARCHAR2(1 BYTE) NULL ,
	RT_FIXRATE_DAY       NUMBER(3) NULL ,
	RT_FIXRATE           FLOAT(126) NULL ,
	VIRDEPOSIT2_YN       VARCHAR2(1 BYTE) NULL ,
	VIRBANK2_CODE        VARCHAR2(8 BYTE) NULL ,
	RT_FIXRATE2          FLOAT(126) NULL ,
	RT_EXTRATE           FLOAT(126) DEFAULT  0  NULL ,
	RT_GURTYN            VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	RT_RENTYN            VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	ONCESALERATE         FLOAT(126) DEFAULT  0  NULL ,
	DELAY_BLOCK          VARCHAR2(1 BYTE) NULL 
);



ALTER TABLE HD_CODE_HOUSE_HIST
	ADD CONSTRAINT  SYS_C0025339 PRIMARY KEY (HIST_DATE,DEPT_CODE,HOUSETAG);



CREATE TABLE HD_CODE_HOUSE_HIST
(
	HIST_DATE            DATE CONSTRAINT SYS_C0019001 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019002 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019003 NOT NULL ,
	HOUSEDATE            VARCHAR2(8 BYTE) NULL ,
	COMPLETIONDATE       VARCHAR2(8 BYTE) NULL ,
	HOUSE_CNT            NUMBER(5) NULL ,
	MOVEINSTARTDATE      VARCHAR2(8 BYTE) NULL ,
	MOVEINENDDATE        VARCHAR2(8 BYTE) NULL ,
	PENALTYRATE          NUMBER(6,3) NULL ,
	HIC_TAG              VARCHAR2(2 BYTE) NULL ,
	TIRM_RATE            NUMBER(6,3) NULL ,
	SODUK_RATE           NUMBER(6,3) NULL ,
	JUMIN_RATE           NUMBER(6,3) NULL ,
	DAMDANG              VARCHAR2(20 BYTE) NULL ,
	DAMDANG_TEL          VARCHAR2(20 BYTE) NULL ,
	PRINT_CNT            NUMBER(3) NULL ,
	RESELL_TAG           VARCHAR2(1 BYTE) NULL ,
	VIRDEPOSIT_YN        VARCHAR2(1 BYTE) NULL ,
	VIRBANK_CODE         VARCHAR2(8 BYTE) NULL ,
	DEPT_ADDR_USE_YN     VARCHAR2(1 BYTE) NULL ,
	CONT_PBL_NAME        VARCHAR2(30 BYTE) NULL ,
	CONT_DW_NAME         VARCHAR2(30 BYTE) NULL ,
	REMARK               VARCHAR2(500 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	CONT_PBL_NAME2       VARCHAR2(30 BYTE) NULL ,
	CONT_DW_NAME2        VARCHAR2(30 BYTE) NULL ,
	CONT_PBL_NAME3       VARCHAR2(30 BYTE) NULL ,
	CONT_DW_NAME3        VARCHAR2(30 BYTE) NULL ,
	SLIPGROUP            VARCHAR2(1 BYTE) NULL ,
	TRI_TAG              VARCHAR2(1 BYTE) NULL ,
	APPLY_CHECK_YN       VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	ANNE1A_PBL           VARCHAR2(30 BYTE) NULL ,
	ANNE1A_DW            VARCHAR2(30 BYTE) NULL ,
	ANNE1B_PBL           VARCHAR2(30 BYTE) NULL ,
	ANNE1B_DW            VARCHAR2(30 BYTE) NULL ,
	ANNE2A_PBL           VARCHAR2(30 BYTE) NULL ,
	ANNE2A_DW            VARCHAR2(30 BYTE) NULL ,
	ANNE2B_PBL           VARCHAR2(30 BYTE) NULL ,
	ANNE2B_DW            VARCHAR2(30 BYTE) NULL ,
	ANNE3_PBL            VARCHAR2(30 BYTE) NULL ,
	ANNE3_DW             VARCHAR2(30 BYTE) NULL ,
	ANNE4_PBL            VARCHAR2(30 BYTE) NULL ,
	ANNE4_DW             VARCHAR2(30 BYTE) NULL ,
	DELAYDAY             NUMBER(5) NULL ,
	DELAYRATE            NUMBER(6,2) NULL ,
	AGREE_TAG            VARCHAR2(1 BYTE) NULL ,
	INDEMINITY_TAG       VARCHAR2(1 BYTE) NULL ,
	INDEMINITY_FRDT      VARCHAR2(8 BYTE) NULL ,
	INDEMINITY_TODT      VARCHAR2(8 BYTE) NULL ,
	SEALTYPE             VARCHAR2(1 BYTE) NULL ,
	JIRO_TAG             VARCHAR2(1 BYTE) NULL ,
	JIRO_SN              VARCHAR2(3 BYTE) NULL ,
	HD_DAYMONTH_TAG      VARCHAR2(1 BYTE) NULL ,
	RT_DAYMONTH_TAG      VARCHAR2(1 BYTE) NULL ,
	RT_FIXRATE_TAG       VARCHAR2(1 BYTE) NULL ,
	PREDIS_TAG           VARCHAR2(1 BYTE) NULL ,
	PROXY_TAG            VARCHAR2(1 BYTE) NULL ,
	TRUST_TAG            VARCHAR2(1 BYTE) NULL ,
	PRINT_YN             VARCHAR2(1 BYTE) NULL ,
	RT_FIXRATE_DAY       NUMBER(3) NULL ,
	RT_FIXRATE           FLOAT(126) NULL ,
	VIRDEPOSIT2_YN       VARCHAR2(1 BYTE) NULL ,
	VIRBANK2_CODE        VARCHAR2(8 BYTE) NULL ,
	RT_FIXRATE2          FLOAT(126) NULL ,
	RT_EXTRATE           FLOAT(126) DEFAULT  0  NULL ,
	RT_GURTYN            VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	RT_RENTYN            VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	ONCESALERATE         FLOAT(126) DEFAULT  0  NULL 
);



ALTER TABLE HD_CODE_HOUSE_HIST
	ADD CONSTRAINT  SYS_C0019004 PRIMARY KEY (HIST_DATE,DEPT_CODE,HOUSETAG);



CREATE TABLE HD_CODE_OPTION
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C00143003 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C00143004 NOT NULL ,
	OPTSEQ               NUMBER(10) CONSTRAINT SYS_C00143005 NOT NULL ,
	SQUARE               NUMBER(8,4) NULL ,
	TYPE                 VARCHAR2(4 BYTE) NULL ,
	OPTION_NAME          VARCHAR2(100 BYTE) NULL ,
	OPTION_SUP           NUMBER(13) NULL ,
	OPTION_VAT           NUMBER(13) NULL ,
	REMARK               VARCHAR2(500 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	PRTSEQ               NUMBER(5) NULL 
);



ALTER TABLE HD_CODE_OPTION
	ADD CONSTRAINT  SYS_C00143006 PRIMARY KEY (DEPT_CODE,HOUSETAG,OPTSEQ);



CREATE TABLE HD_CODE_OPTION
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C00142983 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C00142984 NOT NULL ,
	OPTSEQ               NUMBER(10) CONSTRAINT SYS_C00142985 NOT NULL ,
	SQUARE               NUMBER(8,4) NULL ,
	OPTION_NAME          VARCHAR2(100 BYTE) NULL ,
	OPTION_SUP           NUMBER(13) NULL ,
	OPTION_VAT           NUMBER(13) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_CODE_OPTION
	ADD CONSTRAINT  SYS_C00142986 PRIMARY KEY (DEPT_CODE,HOUSETAG,OPTSEQ);



CREATE TABLE HD_CODE_SIHANG
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025340 NOT NULL ,
	SEQ                  NUMBER(3) CONSTRAINT SYS_C0025341 NOT NULL ,
	SIHANG_VENDOR        VARCHAR2(20 BYTE) NULL ,
	SIHANG_DEPYO         VARCHAR2(40 BYTE) NULL ,
	SIHANG_UPTE          VARCHAR2(40 BYTE) NULL ,
	SIHANG_UPJONG        VARCHAR2(40 BYTE) NULL ,
	SIHANG_ZIP           VARCHAR2(6 BYTE) NULL ,
	SIHANG_ADDR1         VARCHAR2(100 BYTE) NULL ,
	SIHANG_ADDR2         VARCHAR2(100 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	SIHANG_NAME          VARCHAR2(60 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	SIHANG_ZIP_ORG       VARCHAR2(6 BYTE) NULL ,
	SIHANG_ADDR1_ORG     VARCHAR2(100 BYTE) NULL ,
	SIHANG_ADDR2_ORG     VARCHAR2(100 BYTE) NULL ,
	SIHANG_ADDR_TAG      VARCHAR2(1 BYTE) NULL 
);



ALTER TABLE HD_CODE_SIHANG
	ADD CONSTRAINT  SYS_C0025342 PRIMARY KEY (DEPT_CODE,SEQ);



CREATE TABLE HD_CODE_SIHANG
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019005 NOT NULL ,
	SEQ                  NUMBER(3) CONSTRAINT SYS_C0019006 NOT NULL ,
	SIHANG_VENDOR        VARCHAR2(20 BYTE) NULL ,
	SIHANG_DEPYO         VARCHAR2(40 BYTE) NULL ,
	SIHANG_UPTE          VARCHAR2(40 BYTE) NULL ,
	SIHANG_UPJONG        VARCHAR2(40 BYTE) NULL ,
	SIHANG_ZIP           VARCHAR2(6 BYTE) NULL ,
	SIHANG_ADDR1         VARCHAR2(100 BYTE) NULL ,
	SIHANG_ADDR2         VARCHAR2(100 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	SIHANG_NAME          VARCHAR2(60 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_CODE_SIHANG
	ADD CONSTRAINT  SYS_C0019007 PRIMARY KEY (DEPT_CODE,SEQ);



CREATE TABLE HD_CODE_SIHANG_HIST
(
	HIST_DATE            TIMESTAMP(6) CONSTRAINT SYS_C0071752 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0071753 NOT NULL ,
	SEQ                  NUMBER(3) CONSTRAINT SYS_C0071754 NOT NULL ,
	SIHANG_VENDOR        VARCHAR2(20 BYTE) NULL ,
	SIHANG_DEPYO         VARCHAR2(40 BYTE) NULL ,
	SIHANG_UPTE          VARCHAR2(40 BYTE) NULL ,
	SIHANG_UPJONG        VARCHAR2(40 BYTE) NULL ,
	SIHANG_ZIP           VARCHAR2(6 BYTE) NULL ,
	SIHANG_ADDR1         VARCHAR2(100 BYTE) NULL ,
	SIHANG_ADDR2         VARCHAR2(100 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	SIHANG_NAME          VARCHAR2(60 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	SIHANG_ZIP_ORG       VARCHAR2(6 BYTE) NULL ,
	SIHANG_ADDR1_ORG     VARCHAR2(100 BYTE) NULL ,
	SIHANG_ADDR2_ORG     VARCHAR2(100 BYTE) NULL ,
	SIHANG_ADDR_TAG      VARCHAR2(1 BYTE) NULL ,
	TRI_TAG              VARCHAR2(1 BYTE) NULL 
);



CREATE TABLE HD_CODE_SPECIAL
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025343 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025344 NOT NULL ,
	SEQ                  NUMBER(3) CONSTRAINT SYS_C0025345 NOT NULL ,
	SPECIAL              VARCHAR2(100 BYTE) NULL 
);



ALTER TABLE HD_CODE_SPECIAL
	ADD CONSTRAINT  SYS_C0025346 PRIMARY KEY (DEPT_CODE,HOUSETAG,SEQ);



CREATE TABLE HD_CODE_SPECIAL
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019008 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019009 NOT NULL ,
	SEQ                  NUMBER(3) CONSTRAINT SYS_C0019010 NOT NULL ,
	SPECIAL              VARCHAR2(100 BYTE) NULL 
);



ALTER TABLE HD_CODE_SPECIAL
	ADD CONSTRAINT  SYS_C0019011 PRIMARY KEY (DEPT_CODE,HOUSETAG,SEQ);



CREATE TABLE HD_HOUS_APPLY
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025347 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025348 NOT NULL ,
	SN                   NUMBER(5) CONSTRAINT SYS_C0025349 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	APPLY_YN             VARCHAR2(1 BYTE) NULL ,
	APPLY_EMPNO          VARCHAR2(12 BYTE) NULL ,
	APPLY_DATE           VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_APPLY
	ADD CONSTRAINT  SYS_C0025350 PRIMARY KEY (CUST_CODE,SEQ,SN);



CREATE TABLE HD_HOUS_APPLY
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019012 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019013 NOT NULL ,
	SN                   NUMBER(5) CONSTRAINT SYS_C0019014 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	APPLY_YN             VARCHAR2(1 BYTE) NULL ,
	APPLY_EMPNO          VARCHAR2(12 BYTE) NULL ,
	APPLY_DATE           VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_APPLY
	ADD CONSTRAINT  SYS_C0019015 PRIMARY KEY (CUST_CODE,SEQ,SN);



CREATE TABLE HD_HOUS_BANKETC
(
	PAYMENTDATE          VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025351 NOT NULL ,
	PAYMENTSEQ           FLOAT(126) CONSTRAINT SYS_C0025352 NOT NULL ,
	BANK_KIND            VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025353 NOT NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) NULL ,
	SEQ                  NUMBER(5) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) NULL ,
	PAYMENTAMT           NUMBER NULL ,
	CANCELTAG            VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	INCOMETAG            VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	PROCESSTAG           VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	INDATA               VARCHAR2(100 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_BANKETC
	ADD CONSTRAINT  SYS_C0025354 PRIMARY KEY (PAYMENTDATE,PAYMENTSEQ,BANK_KIND);



CREATE TABLE HD_HOUS_BANKETC
(
	PAYMENTDATE          VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019016 NOT NULL ,
	PAYMENTSEQ           FLOAT(126) CONSTRAINT SYS_C0019017 NOT NULL ,
	BANK_KIND            VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019018 NOT NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) NULL ,
	SEQ                  NUMBER(5) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) NULL ,
	PAYMENTAMT           NUMBER NULL ,
	CANCELTAG            VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	INCOMETAG            VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	PROCESSTAG           VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	INDATA               VARCHAR2(100 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_BANKETC
	ADD CONSTRAINT  SYS_C0019019 PRIMARY KEY (PAYMENTDATE,PAYMENTSEQ,BANK_KIND);



CREATE TABLE HD_HOUS_COMPAMT
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025355 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025356 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) NULL ,
	ICHE_DATE            VARCHAR2(8 BYTE) NULL ,
	ICHE_AMT             NUMBER(15) NULL ,
	ICHE_YN              VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_COMPAMT
	ADD CONSTRAINT  SYS_C0025357 PRIMARY KEY (CUST_CODE,SEQ);



CREATE TABLE HD_HOUS_COMPAMT
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019020 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019021 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) NULL ,
	ICHE_DATE            VARCHAR2(8 BYTE) NULL ,
	ICHE_AMT             NUMBER(15) NULL ,
	ICHE_YN              VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_COMPAMT
	ADD CONSTRAINT  SYS_C0019022 PRIMARY KEY (CUST_CODE,SEQ);



CREATE TABLE HD_HOUS_CONSULT
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025358 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025359 NOT NULL ,
	CONS_DATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025360 NOT NULL ,
	CONS_EMP             VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025361 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025362 NOT NULL ,
	SEX                  VARCHAR2(1 BYTE) NULL ,
	CUSTNM               VARCHAR2(20 BYTE) NULL ,
	CONS_TIME            VARCHAR2(4 BYTE) NULL ,
	SQUARE               VARCHAR2(4 BYTE) NULL ,
	TEL                  VARCHAR2(20 BYTE) NULL ,
	MEMO                 VARCHAR2(4000 BYTE) NULL ,
	REMARK               VARCHAR2(4000 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_CONSULT
	ADD CONSTRAINT  SYS_C0025363 PRIMARY KEY (DEPT_CODE,HOUSETAG,CONS_DATE,CONS_EMP,SEQ);



CREATE TABLE HD_HOUS_CONSULT
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019023 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019024 NOT NULL ,
	CONS_DATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019025 NOT NULL ,
	CONS_EMP             VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019026 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019027 NOT NULL ,
	SEX                  VARCHAR2(1 BYTE) NULL ,
	CUSTNM               VARCHAR2(20 BYTE) NULL ,
	CONS_TIME            VARCHAR2(4 BYTE) NULL ,
	SQUARE               VARCHAR2(4 BYTE) NULL ,
	TEL                  VARCHAR2(20 BYTE) NULL ,
	MEMO                 VARCHAR2(4000 BYTE) NULL ,
	REMARK               VARCHAR2(4000 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_CONSULT
	ADD CONSTRAINT  SYS_C0019028 PRIMARY KEY (DEPT_CODE,HOUSETAG,CONS_DATE,CONS_EMP,SEQ);



CREATE TABLE HD_HOUS_DAY_INCOME
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025364 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025365 NOT NULL ,
	INDT                 VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025366 NOT NULL ,
	INSEQ                NUMBER(5) CONSTRAINT SYS_C0025367 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025368 NOT NULL ,
	CUST_NAME            VARCHAR2(50 BYTE) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) NULL ,
	INAMT                FLOAT(126) NULL ,
	INGUBUN              VARCHAR2(2 BYTE) NULL ,
	INTYPE               VARCHAR2(2 BYTE) NULL ,
	IHE_YN               VARCHAR2(1 BYTE) NULL ,
	CDNO                 VARCHAR2(30 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	MOD_RAMT             FLOAT(126) NULL ,
	MOD_DAMT             FLOAT(126) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	VDEPOSIT_NO          VARCHAR2(30 BYTE) NULL ,
	OUT_DT               VARCHAR2(8 BYTE) NULL ,
	OUT_TM               VARCHAR2(6 BYTE) NULL ,
	OUT_SEQ              FLOAT(126) NULL ,
	OUT_BANK             VARCHAR2(6 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	CD_BANK              VARCHAR2(8 BYTE) NULL ,
	CD_EDATE             VARCHAR2(6 BYTE) NULL ,
	CD_STYPE             VARCHAR2(2 BYTE) NULL 
);



ALTER TABLE HD_HOUS_DAY_INCOME
	ADD CONSTRAINT  SYS_C0025369 PRIMARY KEY (DEPT_CODE,HOUSETAG,INDT,INSEQ);



CREATE TABLE HD_HOUS_DAY_INCOME
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019029 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019030 NOT NULL ,
	INDT                 VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019031 NOT NULL ,
	INSEQ                NUMBER(5) CONSTRAINT SYS_C0019032 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019033 NOT NULL ,
	CUST_NAME            VARCHAR2(50 BYTE) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) NULL ,
	INAMT                FLOAT(126) NULL ,
	INGUBUN              VARCHAR2(2 BYTE) NULL ,
	INTYPE               VARCHAR2(2 BYTE) NULL ,
	IHE_YN               VARCHAR2(1 BYTE) NULL ,
	CDNO                 VARCHAR2(30 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	MOD_RAMT             FLOAT(126) NULL ,
	MOD_DAMT             FLOAT(126) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	VDEPOSIT_NO          VARCHAR2(30 BYTE) NULL ,
	OUT_DT               VARCHAR2(8 BYTE) NULL ,
	OUT_TM               VARCHAR2(6 BYTE) NULL ,
	OUT_SEQ              FLOAT(126) NULL ,
	OUT_BANK             VARCHAR2(6 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	CD_BANK              VARCHAR2(8 BYTE) NULL ,
	CD_EDATE             VARCHAR2(6 BYTE) NULL ,
	CD_STYPE             VARCHAR2(2 BYTE) NULL 
);



ALTER TABLE HD_HOUS_DAY_INCOME
	ADD CONSTRAINT  SYS_C0019034 PRIMARY KEY (DEPT_CODE,HOUSETAG,INDT,INSEQ);



CREATE TABLE HD_HOUS_DAY_INCOME_ADJUST
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025370 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025371 NOT NULL ,
	INDT                 VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025372 NOT NULL ,
	INSEQ                NUMBER(5) CONSTRAINT SYS_C0025373 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025374 NOT NULL ,
	CUST_NAME            VARCHAR2(50 BYTE) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) NULL ,
	INAMT                FLOAT(126) NULL ,
	INGUBUN              VARCHAR2(2 BYTE) NULL ,
	INTYPE               VARCHAR2(2 BYTE) NULL ,
	IHE_YN               VARCHAR2(1 BYTE) NULL ,
	CDNO                 VARCHAR2(30 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	MOD_RAMT             FLOAT(126) NULL ,
	MOD_DAMT             FLOAT(126) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	VDEPOSIT_NO          VARCHAR2(30 BYTE) NULL 
);



ALTER TABLE HD_HOUS_DAY_INCOME_ADJUST
	ADD CONSTRAINT  SYS_C0025375 PRIMARY KEY (DEPT_CODE,HOUSETAG,INDT,INSEQ);



CREATE TABLE HD_HOUS_DAY_INCOME_ADJUST
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019035 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019036 NOT NULL ,
	INDT                 VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019037 NOT NULL ,
	INSEQ                NUMBER(5) CONSTRAINT SYS_C0019038 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019039 NOT NULL ,
	CUST_NAME            VARCHAR2(50 BYTE) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) NULL ,
	INAMT                FLOAT(126) NULL ,
	INGUBUN              VARCHAR2(2 BYTE) NULL ,
	INTYPE               VARCHAR2(2 BYTE) NULL ,
	IHE_YN               VARCHAR2(1 BYTE) NULL ,
	CDNO                 VARCHAR2(30 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	MOD_RAMT             FLOAT(126) NULL ,
	MOD_DAMT             FLOAT(126) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	VDEPOSIT_NO          VARCHAR2(30 BYTE) NULL 
);



ALTER TABLE HD_HOUS_DAY_INCOME_ADJUST
	ADD CONSTRAINT  SYS_C0019040 PRIMARY KEY (DEPT_CODE,HOUSETAG,INDT,INSEQ);



CREATE TABLE HD_HOUS_DAY_INCOME_CONV
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025376 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025377 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025378 NOT NULL ,
	INDT                 VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025379 NOT NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	INAMT                FLOAT(126) NULL ,
	INGUN                VARCHAR2(2 BYTE) NULL ,
	CDNO                 VARCHAR2(30 BYTE) NULL ,
	CD_BANK              VARCHAR2(8 BYTE) NULL ,
	CD_EDATE             VARCHAR2(6 BYTE) NULL ,
	CD_STYPE             VARCHAR2(2 BYTE) NULL 
);



ALTER TABLE HD_HOUS_DAY_INCOME_CONV
	ADD CONSTRAINT  SYS_C0025380 PRIMARY KEY (DEPT_CODE,HOUSETAG,SEQ);



CREATE TABLE HD_HOUS_DAY_INCOME_CONV
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019041 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019042 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019043 NOT NULL ,
	INDT                 VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019044 NOT NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	INAMT                FLOAT(126) NULL ,
	INGUN                VARCHAR2(2 BYTE) NULL ,
	CDNO                 VARCHAR2(30 BYTE) NULL ,
	CD_BANK              VARCHAR2(8 BYTE) NULL ,
	CD_EDATE             VARCHAR2(6 BYTE) NULL ,
	CD_STYPE             VARCHAR2(2 BYTE) NULL 
);



ALTER TABLE HD_HOUS_DAY_INCOME_CONV
	ADD CONSTRAINT  SYS_C0019045 PRIMARY KEY (DEPT_CODE,HOUSETAG,SEQ);



CREATE TABLE HD_HOUS_DISK_TEMP
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025381 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025382 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025383 NOT NULL ,
	DATA1                VARCHAR2(1000 BYTE) NULL ,
	DATA2                VARCHAR2(1000 BYTE) NULL 
);



ALTER TABLE HD_HOUS_DISK_TEMP
	ADD CONSTRAINT  SYS_C0025384 PRIMARY KEY (DEPT_CODE,HOUSETAG,SEQ);



CREATE TABLE HD_HOUS_DISK_TEMP
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019046 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019047 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019048 NOT NULL ,
	DATA1                VARCHAR2(1000 BYTE) NULL ,
	DATA2                VARCHAR2(1000 BYTE) NULL 
);



ALTER TABLE HD_HOUS_DISK_TEMP
	ADD CONSTRAINT  SYS_C0019049 PRIMARY KEY (DEPT_CODE,HOUSETAG,SEQ);



CREATE TABLE HD_HOUS_ETCAMT
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0060937 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0060938 NOT NULL ,
	ETC_TAG              VARCHAR2(1 BYTE) CONSTRAINT SYS_C0060939 NOT NULL ,
	CNT                  NUMBER(5) CONSTRAINT SYS_C0060940 NOT NULL ,
	RECEIPTDATE          VARCHAR2(8 BYTE) CONSTRAINT SYS_C0060941 NOT NULL ,
	RECEIPTAMT           NUMBER(15) NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) NULL ,
	DEPOSIT_NO           VARCHAR2(20 BYTE) NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_ETCAMT
	ADD CONSTRAINT  SYS_C0060942 PRIMARY KEY (CUST_CODE,SEQ,ETC_TAG,CNT);



CREATE TABLE HD_HOUS_INCOME
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025385 NOT NULL ,
	SEQ                  FLOAT(126) CONSTRAINT SYS_C0025386 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0025387 NOT NULL ,
	TIMES                FLOAT(126) CONSTRAINT SYS_C0025388 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) CONSTRAINT SYS_C0025389 NOT NULL ,
	RECEIPTDATE          VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025390 NOT NULL ,
	RECEIPTAMT           FLOAT(126) CONSTRAINT SYS_C0025391 NOT NULL ,
	RECEIPTLANDAMT       NUMBER(13) CONSTRAINT SYS_C0025392 NOT NULL ,
	RECEIPTBUILDAMT      NUMBER(13) CONSTRAINT SYS_C0025393 NOT NULL ,
	RECEIPTVATAMT        NUMBER(13) CONSTRAINT SYS_C0025394 NOT NULL ,
	DELAYDAYS            FLOAT(126) CONSTRAINT SYS_C0025395 NOT NULL ,
	DELAYAMT             NUMBER(13) CONSTRAINT SYS_C0025396 NOT NULL ,
	DISCNTDAYS           FLOAT(126) CONSTRAINT SYS_C0025397 NOT NULL ,
	DISCNTAMT            NUMBER(13) CONSTRAINT SYS_C0025398 NOT NULL ,
	REALINCOMAMT         NUMBER(13) CONSTRAINT SYS_C0025399 NOT NULL ,
	REALLANDAMT          NUMBER(13) CONSTRAINT SYS_C0025400 NOT NULL ,
	REALBUILDAMT         NUMBER(13) CONSTRAINT SYS_C0025401 NOT NULL ,
	REALVATAMT           NUMBER(13) CONSTRAINT SYS_C0025402 NOT NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025403 NOT NULL ,
	BANK_NAME            VARCHAR2(30 BYTE) NULL ,
	PAYTAG               VARCHAR2(2 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025404 NOT NULL ,
	INCOMTYPE            VARCHAR2(2 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	REAL_PAY_TAG         VARCHAR2(1 BYTE) NULL ,
	SLIPDT               VARCHAR2(8 BYTE) NULL ,
	SLIPSEQ              NUMBER(5) NULL ,
	TAXDATE              VARCHAR2(8 BYTE) NULL ,
	TAXSEQ               NUMBER(5) NULL ,
	INSEQ                NUMBER(5) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	SLIPTYPE             VARCHAR2(1 BYTE) NULL ,
	VDEPOSIT_NO          VARCHAR2(30 BYTE) NULL ,
	DETAILMOD_YN         VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	OUT_DT               VARCHAR2(8 BYTE) NULL ,
	OUT_TM               VARCHAR2(6 BYTE) NULL ,
	OUT_SEQ              FLOAT(126) NULL ,
	OUT_BANK             VARCHAR2(6 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	RECEIPTMANAGEAMT     FLOAT(126) DEFAULT  0  NULL ,
	REALMANAGEAMT        FLOAT(126) DEFAULT  0  NULL ,
	CDNO                 VARCHAR2(30 BYTE) NULL ,
	CD_BANK              VARCHAR2(8 BYTE) NULL ,
	CD_EDATE             VARCHAR2(6 BYTE) NULL ,
	CD_STYPE             VARCHAR2(2 BYTE) NULL 
);



ALTER TABLE HD_HOUS_INCOME
	ADD CONSTRAINT  SYS_C0025405 PRIMARY KEY (CUST_CODE,SEQ,COUNTS,TIMES);



CREATE  INDEX XIE1HD_HOUS_INCOME ON HD_HOUS_INCOME
(DEPT_CODE   ASC,HOUSETAG   ASC,BUILDNO   ASC,HOUSENO   ASC,COUNTS   ASC,TIMES   ASC);



CREATE TABLE HD_HOUS_INCOME
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019050 NOT NULL ,
	SEQ                  FLOAT(126) CONSTRAINT SYS_C0019051 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019052 NOT NULL ,
	TIMES                FLOAT(126) CONSTRAINT SYS_C0019053 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) CONSTRAINT SYS_C0019054 NOT NULL ,
	RECEIPTDATE          VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019055 NOT NULL ,
	RECEIPTAMT           FLOAT(126) CONSTRAINT SYS_C0019056 NOT NULL ,
	RECEIPTLANDAMT       NUMBER(13) CONSTRAINT SYS_C0019057 NOT NULL ,
	RECEIPTBUILDAMT      NUMBER(13) CONSTRAINT SYS_C0019058 NOT NULL ,
	RECEIPTVATAMT        NUMBER(13) CONSTRAINT SYS_C0019059 NOT NULL ,
	DELAYDAYS            FLOAT(126) CONSTRAINT SYS_C0019060 NOT NULL ,
	DELAYAMT             NUMBER(13) CONSTRAINT SYS_C0019061 NOT NULL ,
	DISCNTDAYS           FLOAT(126) CONSTRAINT SYS_C0019062 NOT NULL ,
	DISCNTAMT            NUMBER(13) CONSTRAINT SYS_C0019063 NOT NULL ,
	REALINCOMAMT         NUMBER(13) CONSTRAINT SYS_C0019064 NOT NULL ,
	REALLANDAMT          NUMBER(13) CONSTRAINT SYS_C0019065 NOT NULL ,
	REALBUILDAMT         NUMBER(13) CONSTRAINT SYS_C0019066 NOT NULL ,
	REALVATAMT           NUMBER(13) CONSTRAINT SYS_C0019067 NOT NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019068 NOT NULL ,
	BANK_NAME            VARCHAR2(30 BYTE) NULL ,
	PAYTAG               VARCHAR2(2 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019069 NOT NULL ,
	INCOMTYPE            VARCHAR2(2 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	REAL_PAY_TAG         VARCHAR2(1 BYTE) NULL ,
	SLIPDT               VARCHAR2(8 BYTE) NULL ,
	SLIPSEQ              NUMBER(5) NULL ,
	TAXDATE              VARCHAR2(8 BYTE) NULL ,
	TAXSEQ               NUMBER(5) NULL ,
	INSEQ                NUMBER(5) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	SLIPTYPE             VARCHAR2(1 BYTE) NULL ,
	VDEPOSIT_NO          VARCHAR2(30 BYTE) NULL ,
	DETAILMOD_YN         VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	OUT_DT               VARCHAR2(8 BYTE) NULL ,
	OUT_TM               VARCHAR2(6 BYTE) NULL ,
	OUT_SEQ              FLOAT(126) NULL ,
	OUT_BANK             VARCHAR2(6 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	RECEIPTMANAGEAMT     FLOAT(126) DEFAULT  0  NULL ,
	REALMANAGEAMT        FLOAT(126) DEFAULT  0  NULL ,
	CDNO                 VARCHAR2(30 BYTE) NULL ,
	CD_BANK              VARCHAR2(8 BYTE) NULL ,
	CD_EDATE             VARCHAR2(6 BYTE) NULL ,
	CD_STYPE             VARCHAR2(2 BYTE) NULL 
);



ALTER TABLE HD_HOUS_INCOME
	ADD CONSTRAINT  SYS_C0019070 PRIMARY KEY (CUST_CODE,SEQ,COUNTS,TIMES);



CREATE  INDEX XIE1HD_HOUS_INCOME ON HD_HOUS_INCOME
(DEPT_CODE   ASC,HOUSETAG   ASC,BUILDNO   ASC,HOUSENO   ASC,COUNTS   ASC,TIMES   ASC);



CREATE TABLE HD_HOUS_INCOME_ADJUST
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025406 NOT NULL ,
	SEQ                  FLOAT(126) CONSTRAINT SYS_C0025407 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0025408 NOT NULL ,
	TIMES                FLOAT(126) CONSTRAINT SYS_C0025409 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) CONSTRAINT SYS_C0025410 NOT NULL ,
	RECEIPTDATE          VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025411 NOT NULL ,
	RECEIPTAMT           FLOAT(126) CONSTRAINT SYS_C0025412 NOT NULL ,
	RECEIPTLANDAMT       NUMBER(13) CONSTRAINT SYS_C0025413 NOT NULL ,
	RECEIPTBUILDAMT      NUMBER(13) CONSTRAINT SYS_C0025414 NOT NULL ,
	RECEIPTVATAMT        NUMBER(13) CONSTRAINT SYS_C0025415 NOT NULL ,
	DELAYDAYS            FLOAT(126) CONSTRAINT SYS_C0025416 NOT NULL ,
	DELAYAMT             NUMBER(13) CONSTRAINT SYS_C0025417 NOT NULL ,
	DISCNTDAYS           FLOAT(126) CONSTRAINT SYS_C0025418 NOT NULL ,
	DISCNTAMT            NUMBER(13) CONSTRAINT SYS_C0025419 NOT NULL ,
	REALINCOMAMT         NUMBER(13) CONSTRAINT SYS_C0025420 NOT NULL ,
	REALLANDAMT          NUMBER(13) CONSTRAINT SYS_C0025421 NOT NULL ,
	REALBUILDAMT         NUMBER(13) CONSTRAINT SYS_C0025422 NOT NULL ,
	REALVATAMT           NUMBER(13) CONSTRAINT SYS_C0025423 NOT NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025424 NOT NULL ,
	BANK_NAME            VARCHAR2(30 BYTE) NULL ,
	PAYTAG               VARCHAR2(2 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025425 NOT NULL ,
	INCOMTYPE            VARCHAR2(2 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	REAL_PAY_TAG         VARCHAR2(1 BYTE) NULL ,
	SLIPDT               VARCHAR2(8 BYTE) NULL ,
	SLIPSEQ              NUMBER(5) NULL ,
	TAXDATE              VARCHAR2(8 BYTE) NULL ,
	TAXSEQ               NUMBER(5) NULL ,
	INSEQ                NUMBER(5) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	SLIPTYPE             VARCHAR2(1 BYTE) NULL ,
	VDEPOSIT_NO          VARCHAR2(30 BYTE) NULL ,
	DETAILMOD_YN         VARCHAR2(1 BYTE) NULL ,
	OUT_DT               VARCHAR2(8 BYTE) NULL ,
	OUT_TM               VARCHAR2(6 BYTE) NULL ,
	OUT_SEQ              FLOAT(126) NULL ,
	OUT_BANK             VARCHAR2(6 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	RECEIPTMANAGEAMT     FLOAT(126) DEFAULT  0  NULL ,
	REALMANAGEAMT        FLOAT(126) DEFAULT  0  NULL ,
	CDNO                 VARCHAR2(30 BYTE) NULL ,
	CD_BANK              VARCHAR2(8 BYTE) NULL ,
	CD_EDATE             VARCHAR2(6 BYTE) NULL ,
	CD_STYPE             VARCHAR2(2 BYTE) NULL 
);



ALTER TABLE HD_HOUS_INCOME_ADJUST
	ADD CONSTRAINT  SYS_C0025426 PRIMARY KEY (CUST_CODE,SEQ,COUNTS,TIMES);



CREATE  INDEX XIE1HD_HOUS_INCOME_ADJUST ON HD_HOUS_INCOME_ADJUST
(DEPT_CODE   ASC,HOUSETAG   ASC,BUILDNO   ASC,HOUSENO   ASC,COUNTS   ASC,TIMES   ASC);



CREATE TABLE HD_HOUS_INCOME_ADJUST
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019071 NOT NULL ,
	SEQ                  FLOAT(126) CONSTRAINT SYS_C0019072 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019073 NOT NULL ,
	TIMES                FLOAT(126) CONSTRAINT SYS_C0019074 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) CONSTRAINT SYS_C0019075 NOT NULL ,
	RECEIPTDATE          VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019076 NOT NULL ,
	RECEIPTAMT           FLOAT(126) CONSTRAINT SYS_C0019077 NOT NULL ,
	RECEIPTLANDAMT       NUMBER(13) CONSTRAINT SYS_C0019078 NOT NULL ,
	RECEIPTBUILDAMT      NUMBER(13) CONSTRAINT SYS_C0019079 NOT NULL ,
	RECEIPTVATAMT        NUMBER(13) CONSTRAINT SYS_C0019080 NOT NULL ,
	DELAYDAYS            FLOAT(126) CONSTRAINT SYS_C0019081 NOT NULL ,
	DELAYAMT             NUMBER(13) CONSTRAINT SYS_C0019082 NOT NULL ,
	DISCNTDAYS           FLOAT(126) CONSTRAINT SYS_C0019083 NOT NULL ,
	DISCNTAMT            NUMBER(13) CONSTRAINT SYS_C0019084 NOT NULL ,
	REALINCOMAMT         NUMBER(13) CONSTRAINT SYS_C0019085 NOT NULL ,
	REALLANDAMT          NUMBER(13) CONSTRAINT SYS_C0019086 NOT NULL ,
	REALBUILDAMT         NUMBER(13) CONSTRAINT SYS_C0019087 NOT NULL ,
	REALVATAMT           NUMBER(13) CONSTRAINT SYS_C0019088 NOT NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019089 NOT NULL ,
	BANK_NAME            VARCHAR2(30 BYTE) NULL ,
	PAYTAG               VARCHAR2(2 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019090 NOT NULL ,
	INCOMTYPE            VARCHAR2(2 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	REAL_PAY_TAG         VARCHAR2(1 BYTE) NULL ,
	SLIPDT               VARCHAR2(8 BYTE) NULL ,
	SLIPSEQ              NUMBER(5) NULL ,
	TAXDATE              VARCHAR2(8 BYTE) NULL ,
	TAXSEQ               NUMBER(5) NULL ,
	INSEQ                NUMBER(5) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	SLIPTYPE             VARCHAR2(1 BYTE) NULL ,
	VDEPOSIT_NO          VARCHAR2(30 BYTE) NULL ,
	DETAILMOD_YN         VARCHAR2(1 BYTE) NULL ,
	OUT_DT               VARCHAR2(8 BYTE) NULL ,
	OUT_TM               VARCHAR2(6 BYTE) NULL ,
	OUT_SEQ              FLOAT(126) NULL ,
	OUT_BANK             VARCHAR2(6 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	RECEIPTMANAGEAMT     FLOAT(126) DEFAULT  0  NULL ,
	REALMANAGEAMT        FLOAT(126) DEFAULT  0  NULL ,
	CDNO                 VARCHAR2(30 BYTE) NULL ,
	CD_BANK              VARCHAR2(8 BYTE) NULL ,
	CD_EDATE             VARCHAR2(6 BYTE) NULL ,
	CD_STYPE             VARCHAR2(2 BYTE) NULL 
);



ALTER TABLE HD_HOUS_INCOME_ADJUST
	ADD CONSTRAINT  SYS_C0019091 PRIMARY KEY (CUST_CODE,SEQ,COUNTS,TIMES);



CREATE  INDEX XIE1HD_HOUS_INCOME_ADJUST ON HD_HOUS_INCOME_ADJUST
(DEPT_CODE   ASC,HOUSETAG   ASC,BUILDNO   ASC,HOUSENO   ASC,COUNTS   ASC,TIMES   ASC);



CREATE TABLE HD_HOUS_INCOME_LOG
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025427 NOT NULL ,
	SEQ                  FLOAT(126) CONSTRAINT SYS_C0025428 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0025429 NOT NULL ,
	TIMES                FLOAT(126) CONSTRAINT SYS_C0025430 NOT NULL ,
	WRITETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025431 NOT NULL ,
	WRITETIME            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025432 NOT NULL ,
	WRITESEQ             NUMBER(5) CONSTRAINT SYS_C0025433 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) CONSTRAINT SYS_C0025434 NOT NULL ,
	RECEIPTDATE          VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025435 NOT NULL ,
	RECEIPTAMT           FLOAT(126) CONSTRAINT SYS_C0025436 NOT NULL ,
	RECEIPTLANDAMT       NUMBER(13) CONSTRAINT SYS_C0025437 NOT NULL ,
	RECEIPTBUILDAMT      NUMBER(13) CONSTRAINT SYS_C0025438 NOT NULL ,
	RECEIPTVATAMT        NUMBER(13) CONSTRAINT SYS_C0025439 NOT NULL ,
	DELAYDAYS            FLOAT(126) CONSTRAINT SYS_C0025440 NOT NULL ,
	DELAYAMT             NUMBER(13) CONSTRAINT SYS_C0025441 NOT NULL ,
	DISCNTDAYS           FLOAT(126) CONSTRAINT SYS_C0025442 NOT NULL ,
	DISCNTAMT            NUMBER(13) CONSTRAINT SYS_C0025443 NOT NULL ,
	REALINCOMAMT         NUMBER(13) CONSTRAINT SYS_C0025444 NOT NULL ,
	REALLANDAMT          NUMBER(13) CONSTRAINT SYS_C0025445 NOT NULL ,
	REALBUILDAMT         NUMBER(13) CONSTRAINT SYS_C0025446 NOT NULL ,
	REALVATAMT           NUMBER(13) CONSTRAINT SYS_C0025447 NOT NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) NULL ,
	BANK_NAME            VARCHAR2(30 BYTE) NULL ,
	PAYTAG               VARCHAR2(2 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025448 NOT NULL ,
	INCOMTYPE            VARCHAR2(2 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	REAL_PAY_TAG         VARCHAR2(1 BYTE) NULL ,
	SLIPDT               VARCHAR2(8 BYTE) NULL ,
	SLIPSEQ              NUMBER(5) NULL ,
	TAXDATE              VARCHAR2(8 BYTE) NULL ,
	TAXSEQ               NUMBER(5) NULL ,
	INSEQ                NUMBER(5) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	SLIPTYPE             VARCHAR2(1 BYTE) NULL ,
	VDEPOSIT_NO          VARCHAR2(30 BYTE) NULL ,
	DETAILMOD_YN         VARCHAR2(1 BYTE) NULL ,
	OUT_DT               VARCHAR2(8 BYTE) NULL ,
	OUT_TM               VARCHAR2(6 BYTE) NULL ,
	OUT_SEQ              FLOAT(126) NULL ,
	OUT_BANK             VARCHAR2(6 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	RECEIPTMANAGEAMT     FLOAT(126) DEFAULT  0  NULL ,
	REALMANAGEAMT        FLOAT(126) DEFAULT  0  NULL ,
	CDNO                 VARCHAR2(30 BYTE) NULL ,
	CD_BANK              VARCHAR2(8 BYTE) NULL ,
	CD_EDATE             VARCHAR2(6 BYTE) NULL ,
	CD_STYPE             VARCHAR2(2 BYTE) NULL 
);



ALTER TABLE HD_HOUS_INCOME_LOG
	ADD CONSTRAINT  SYS_C0025449 PRIMARY KEY (CUST_CODE,SEQ,COUNTS,TIMES,WRITETAG,WRITETIME,WRITESEQ);



CREATE  INDEX XIE1HD_HOUS_INCOME_LOG ON HD_HOUS_INCOME_LOG
(DEPT_CODE   ASC,HOUSETAG   ASC,BUILDNO   ASC,HOUSENO   ASC,COUNTS   ASC,TIMES   ASC);



CREATE TABLE HD_HOUS_INCOME_LOG
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019092 NOT NULL ,
	SEQ                  FLOAT(126) CONSTRAINT SYS_C0019093 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019094 NOT NULL ,
	TIMES                FLOAT(126) CONSTRAINT SYS_C0019095 NOT NULL ,
	WRITETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019096 NOT NULL ,
	WRITETIME            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019097 NOT NULL ,
	WRITESEQ             NUMBER(5) CONSTRAINT SYS_C0019098 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) CONSTRAINT SYS_C0019099 NOT NULL ,
	RECEIPTDATE          VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019100 NOT NULL ,
	RECEIPTAMT           FLOAT(126) CONSTRAINT SYS_C0019101 NOT NULL ,
	RECEIPTLANDAMT       NUMBER(13) CONSTRAINT SYS_C0019102 NOT NULL ,
	RECEIPTBUILDAMT      NUMBER(13) CONSTRAINT SYS_C0019103 NOT NULL ,
	RECEIPTVATAMT        NUMBER(13) CONSTRAINT SYS_C0019104 NOT NULL ,
	DELAYDAYS            FLOAT(126) CONSTRAINT SYS_C0019105 NOT NULL ,
	DELAYAMT             NUMBER(13) CONSTRAINT SYS_C0019106 NOT NULL ,
	DISCNTDAYS           FLOAT(126) CONSTRAINT SYS_C0019107 NOT NULL ,
	DISCNTAMT            NUMBER(13) CONSTRAINT SYS_C0019108 NOT NULL ,
	REALINCOMAMT         NUMBER(13) CONSTRAINT SYS_C0019109 NOT NULL ,
	REALLANDAMT          NUMBER(13) CONSTRAINT SYS_C0019110 NOT NULL ,
	REALBUILDAMT         NUMBER(13) CONSTRAINT SYS_C0019111 NOT NULL ,
	REALVATAMT           NUMBER(13) CONSTRAINT SYS_C0019112 NOT NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) NULL ,
	BANK_NAME            VARCHAR2(30 BYTE) NULL ,
	PAYTAG               VARCHAR2(2 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019113 NOT NULL ,
	INCOMTYPE            VARCHAR2(2 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	REAL_PAY_TAG         VARCHAR2(1 BYTE) NULL ,
	SLIPDT               VARCHAR2(8 BYTE) NULL ,
	SLIPSEQ              NUMBER(5) NULL ,
	TAXDATE              VARCHAR2(8 BYTE) NULL ,
	TAXSEQ               NUMBER(5) NULL ,
	INSEQ                NUMBER(5) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	SLIPTYPE             VARCHAR2(1 BYTE) NULL ,
	VDEPOSIT_NO          VARCHAR2(30 BYTE) NULL ,
	DETAILMOD_YN         VARCHAR2(1 BYTE) NULL ,
	OUT_DT               VARCHAR2(8 BYTE) NULL ,
	OUT_TM               VARCHAR2(6 BYTE) NULL ,
	OUT_SEQ              FLOAT(126) NULL ,
	OUT_BANK             VARCHAR2(6 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	RECEIPTMANAGEAMT     FLOAT(126) DEFAULT  0  NULL ,
	REALMANAGEAMT        FLOAT(126) DEFAULT  0  NULL ,
	CDNO                 VARCHAR2(30 BYTE) NULL ,
	CD_BANK              VARCHAR2(8 BYTE) NULL ,
	CD_EDATE             VARCHAR2(6 BYTE) NULL ,
	CD_STYPE             VARCHAR2(2 BYTE) NULL 
);



ALTER TABLE HD_HOUS_INCOME_LOG
	ADD CONSTRAINT  SYS_C0019114 PRIMARY KEY (CUST_CODE,SEQ,COUNTS,TIMES,WRITETAG,WRITETIME,WRITESEQ);



CREATE  INDEX XIE1HD_HOUS_INCOME_LOG ON HD_HOUS_INCOME_LOG
(DEPT_CODE   ASC,HOUSETAG   ASC,BUILDNO   ASC,HOUSENO   ASC,COUNTS   ASC,TIMES   ASC);



CREATE TABLE HD_HOUS_INCOME_REIN
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025450 NOT NULL ,
	SEQ                  FLOAT(126) CONSTRAINT SYS_C0025451 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0025452 NOT NULL ,
	TIMES                FLOAT(126) CONSTRAINT SYS_C0025453 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) CONSTRAINT SYS_C0025454 NOT NULL ,
	RECEIPTDATE          VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025455 NOT NULL ,
	RECEIPTAMT           FLOAT(126) CONSTRAINT SYS_C0025456 NOT NULL ,
	RECEIPTLANDAMT       NUMBER(13) CONSTRAINT SYS_C0025457 NOT NULL ,
	RECEIPTBUILDAMT      NUMBER(13) CONSTRAINT SYS_C0025458 NOT NULL ,
	RECEIPTVATAMT        NUMBER(13) CONSTRAINT SYS_C0025459 NOT NULL ,
	DELAYDAYS            FLOAT(126) CONSTRAINT SYS_C0025460 NOT NULL ,
	DELAYAMT             NUMBER(13) CONSTRAINT SYS_C0025461 NOT NULL ,
	DISCNTDAYS           FLOAT(126) CONSTRAINT SYS_C0025462 NOT NULL ,
	DISCNTAMT            NUMBER(13) CONSTRAINT SYS_C0025463 NOT NULL ,
	REALINCOMAMT         NUMBER(13) CONSTRAINT SYS_C0025464 NOT NULL ,
	REALLANDAMT          NUMBER(13) CONSTRAINT SYS_C0025465 NOT NULL ,
	REALBUILDAMT         NUMBER(13) CONSTRAINT SYS_C0025466 NOT NULL ,
	REALVATAMT           NUMBER(13) CONSTRAINT SYS_C0025467 NOT NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025468 NOT NULL ,
	BANK_NAME            VARCHAR2(30 BYTE) NULL ,
	PAYTAG               VARCHAR2(2 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025469 NOT NULL ,
	INCOMTYPE            VARCHAR2(2 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	REAL_PAY_TAG         VARCHAR2(1 BYTE) NULL ,
	SLIPDT               VARCHAR2(8 BYTE) NULL ,
	SLIPSEQ              NUMBER(5) NULL ,
	TAXDATE              VARCHAR2(8 BYTE) NULL ,
	TAXSEQ               NUMBER(5) NULL ,
	INSEQ                NUMBER(5) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	SLIPTYPE             VARCHAR2(1 BYTE) NULL ,
	VDEPOSIT_NO          VARCHAR2(30 BYTE) NULL ,
	DETAILMOD_YN         VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	OUT_DT               VARCHAR2(8 BYTE) NULL ,
	OUT_TM               VARCHAR2(6 BYTE) NULL ,
	OUT_SEQ              FLOAT(126) NULL ,
	OUT_BANK             VARCHAR2(6 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	RECEIPTMANAGEAMT     FLOAT(126) DEFAULT  0  NULL ,
	REALMANAGEAMT        FLOAT(126) DEFAULT  0  NULL ,
	CDNO                 VARCHAR2(30 BYTE) NULL ,
	CD_BANK              VARCHAR2(8 BYTE) NULL ,
	CD_EDATE             VARCHAR2(6 BYTE) NULL ,
	CD_STYPE             VARCHAR2(2 BYTE) NULL 
);



ALTER TABLE HD_HOUS_INCOME_REIN
	ADD CONSTRAINT  SYS_C0025470 PRIMARY KEY (CUST_CODE,SEQ,COUNTS,TIMES);



CREATE  INDEX XIE1HD_HOUS_INCOME_REIN ON HD_HOUS_INCOME_REIN
(DEPT_CODE   ASC,HOUSETAG   ASC,BUILDNO   ASC,HOUSENO   ASC,COUNTS   ASC,TIMES   ASC);



CREATE TABLE HD_HOUS_INCOME_REIN
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019115 NOT NULL ,
	SEQ                  FLOAT(126) CONSTRAINT SYS_C0019116 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019117 NOT NULL ,
	TIMES                FLOAT(126) CONSTRAINT SYS_C0019118 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) CONSTRAINT SYS_C0019119 NOT NULL ,
	RECEIPTDATE          VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019120 NOT NULL ,
	RECEIPTAMT           FLOAT(126) CONSTRAINT SYS_C0019121 NOT NULL ,
	RECEIPTLANDAMT       NUMBER(13) CONSTRAINT SYS_C0019122 NOT NULL ,
	RECEIPTBUILDAMT      NUMBER(13) CONSTRAINT SYS_C0019123 NOT NULL ,
	RECEIPTVATAMT        NUMBER(13) CONSTRAINT SYS_C0019124 NOT NULL ,
	DELAYDAYS            FLOAT(126) CONSTRAINT SYS_C0019125 NOT NULL ,
	DELAYAMT             NUMBER(13) CONSTRAINT SYS_C0019126 NOT NULL ,
	DISCNTDAYS           FLOAT(126) CONSTRAINT SYS_C0019127 NOT NULL ,
	DISCNTAMT            NUMBER(13) CONSTRAINT SYS_C0019128 NOT NULL ,
	REALINCOMAMT         NUMBER(13) CONSTRAINT SYS_C0019129 NOT NULL ,
	REALLANDAMT          NUMBER(13) CONSTRAINT SYS_C0019130 NOT NULL ,
	REALBUILDAMT         NUMBER(13) CONSTRAINT SYS_C0019131 NOT NULL ,
	REALVATAMT           NUMBER(13) CONSTRAINT SYS_C0019132 NOT NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019133 NOT NULL ,
	BANK_NAME            VARCHAR2(30 BYTE) NULL ,
	PAYTAG               VARCHAR2(2 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019134 NOT NULL ,
	INCOMTYPE            VARCHAR2(2 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	REAL_PAY_TAG         VARCHAR2(1 BYTE) NULL ,
	SLIPDT               VARCHAR2(8 BYTE) NULL ,
	SLIPSEQ              NUMBER(5) NULL ,
	TAXDATE              VARCHAR2(8 BYTE) NULL ,
	TAXSEQ               NUMBER(5) NULL ,
	INSEQ                NUMBER(5) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	SLIPTYPE             VARCHAR2(1 BYTE) NULL ,
	VDEPOSIT_NO          VARCHAR2(30 BYTE) NULL ,
	DETAILMOD_YN         VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	OUT_DT               VARCHAR2(8 BYTE) NULL ,
	OUT_TM               VARCHAR2(6 BYTE) NULL ,
	OUT_SEQ              FLOAT(126) NULL ,
	OUT_BANK             VARCHAR2(6 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	RECEIPTMANAGEAMT     FLOAT(126) DEFAULT  0  NULL ,
	REALMANAGEAMT        FLOAT(126) DEFAULT  0  NULL ,
	CDNO                 VARCHAR2(30 BYTE) NULL ,
	CD_BANK              VARCHAR2(8 BYTE) NULL ,
	CD_EDATE             VARCHAR2(6 BYTE) NULL ,
	CD_STYPE             VARCHAR2(2 BYTE) NULL 
);



ALTER TABLE HD_HOUS_INCOME_REIN
	ADD CONSTRAINT  SYS_C0019135 PRIMARY KEY (CUST_CODE,SEQ,COUNTS,TIMES);



CREATE  INDEX XIE1HD_HOUS_INCOME_REIN ON HD_HOUS_INCOME_REIN
(DEPT_CODE   ASC,HOUSETAG   ASC,BUILDNO   ASC,HOUSENO   ASC,COUNTS   ASC,TIMES   ASC);



CREATE TABLE HD_HOUS_INCOME_TEMP
(
	SEQ_NUM              NUMBER(18) CONSTRAINT SYS_C0025471 NOT NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025472 NOT NULL ,
	SEQ                  FLOAT(126) CONSTRAINT SYS_C0025473 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0025474 NOT NULL ,
	TIMES                FLOAT(126) CONSTRAINT SYS_C0025475 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) NULL ,
	RECEIPTDATE          VARCHAR2(8 BYTE) NULL ,
	RECEIPTAMT           FLOAT(126) NULL ,
	RECEIPTLANDAMT       NUMBER(13) NULL ,
	RECEIPTBUILDAMT      NUMBER(13) NULL ,
	RECEIPTVATAMT        NUMBER(13) NULL ,
	DELAYDAYS            FLOAT(126) NULL ,
	DELAYAMT             NUMBER(13) NULL ,
	DISCNTDAYS           FLOAT(126) NULL ,
	DISCNTAMT            NUMBER(13) NULL ,
	REALINCOMAMT         NUMBER(13) NULL ,
	REALLANDAMT          NUMBER(13) NULL ,
	REALBUILDAMT         NUMBER(13) NULL ,
	REALVATAMT           NUMBER(13) NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) NULL ,
	BANK_NAME            VARCHAR2(30 BYTE) NULL ,
	PAYTAG               VARCHAR2(2 BYTE) DEFAULT  '1'  NULL ,
	INCOMTYPE            VARCHAR2(2 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	REAL_PAY_TAG         VARCHAR2(1 BYTE) NULL ,
	SLIPDT               VARCHAR2(8 BYTE) NULL ,
	SLIPSEQ              NUMBER(5) NULL ,
	TAXDATE              VARCHAR2(8 BYTE) NULL ,
	TAXSEQ               NUMBER(5) NULL ,
	INSEQ                NUMBER(5) NULL ,
	CALC_YN              VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	DETAILMOD_YN         VARCHAR2(1 BYTE) NULL ,
	OUT_DT               VARCHAR2(8 BYTE) NULL ,
	OUT_TM               VARCHAR2(6 BYTE) NULL ,
	OUT_SEQ              FLOAT(126) NULL ,
	OUT_BANK             VARCHAR2(6 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	RECEIPTMANAGEAMT     FLOAT(126) DEFAULT  0  NULL ,
	REALMANAGEAMT        FLOAT(126) DEFAULT  0  NULL ,
	CDNO                 VARCHAR2(30 BYTE) NULL 
);



ALTER TABLE HD_HOUS_INCOME_TEMP
	ADD CONSTRAINT  SYS_C0025476 PRIMARY KEY (SEQ_NUM,CUST_CODE,SEQ,COUNTS,TIMES);



CREATE  INDEX XIE1HD_HOUS_INCOME_TEMP ON HD_HOUS_INCOME_TEMP
(DEPT_CODE   ASC,HOUSETAG   ASC,BUILDNO   ASC,HOUSENO   ASC,COUNTS   ASC,TIMES   ASC);



CREATE TABLE HD_HOUS_INCOME_TEMP
(
	SEQ_NUM              NUMBER(18) CONSTRAINT SYS_C0019136 NOT NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019137 NOT NULL ,
	SEQ                  FLOAT(126) CONSTRAINT SYS_C0019138 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019139 NOT NULL ,
	TIMES                FLOAT(126) CONSTRAINT SYS_C0019140 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) NULL ,
	RECEIPTDATE          VARCHAR2(8 BYTE) NULL ,
	RECEIPTAMT           FLOAT(126) NULL ,
	RECEIPTLANDAMT       NUMBER(13) NULL ,
	RECEIPTBUILDAMT      NUMBER(13) NULL ,
	RECEIPTVATAMT        NUMBER(13) NULL ,
	DELAYDAYS            FLOAT(126) NULL ,
	DELAYAMT             NUMBER(13) NULL ,
	DISCNTDAYS           FLOAT(126) NULL ,
	DISCNTAMT            NUMBER(13) NULL ,
	REALINCOMAMT         NUMBER(13) NULL ,
	REALLANDAMT          NUMBER(13) NULL ,
	REALBUILDAMT         NUMBER(13) NULL ,
	REALVATAMT           NUMBER(13) NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) NULL ,
	BANK_NAME            VARCHAR2(30 BYTE) NULL ,
	PAYTAG               VARCHAR2(2 BYTE) DEFAULT  '1'  NULL ,
	INCOMTYPE            VARCHAR2(2 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	REAL_PAY_TAG         VARCHAR2(1 BYTE) NULL ,
	SLIPDT               VARCHAR2(8 BYTE) NULL ,
	SLIPSEQ              NUMBER(5) NULL ,
	TAXDATE              VARCHAR2(8 BYTE) NULL ,
	TAXSEQ               NUMBER(5) NULL ,
	INSEQ                NUMBER(5) NULL ,
	CALC_YN              VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	DETAILMOD_YN         VARCHAR2(1 BYTE) NULL ,
	OUT_DT               VARCHAR2(8 BYTE) NULL ,
	OUT_TM               VARCHAR2(6 BYTE) NULL ,
	OUT_SEQ              FLOAT(126) NULL ,
	OUT_BANK             VARCHAR2(6 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	RECEIPTMANAGEAMT     FLOAT(126) DEFAULT  0  NULL ,
	REALMANAGEAMT        FLOAT(126) DEFAULT  0  NULL ,
	CDNO                 VARCHAR2(30 BYTE) NULL 
);



ALTER TABLE HD_HOUS_INCOME_TEMP
	ADD CONSTRAINT  SYS_C0019141 PRIMARY KEY (SEQ_NUM,CUST_CODE,SEQ,COUNTS,TIMES);



CREATE  INDEX XIE1HD_HOUS_INCOME_TEMP ON HD_HOUS_INCOME_TEMP
(DEPT_CODE   ASC,HOUSETAG   ASC,BUILDNO   ASC,HOUSENO   ASC,COUNTS   ASC,TIMES   ASC);



CREATE TABLE HD_HOUS_INDEMINITY
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025477 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025478 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025479 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025480 NOT NULL ,
	RECEIPTAMT           NUMBER(15) NULL ,
	REALINCOMAMT         NUMBER(15) NULL ,
	INDEMINITY_TAG       VARCHAR2(1 BYTE) NULL ,
	DELAY_INDEMINITY     NUMBER(15) NULL ,
	ICHE_DATE            VARCHAR2(8 BYTE) NULL ,
	ICHE_YN              VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_INDEMINITY
	ADD CONSTRAINT  SYS_C0025481 PRIMARY KEY (CUST_CODE,SEQ);



CREATE TABLE HD_HOUS_INDEMINITY
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019142 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019143 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019144 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019145 NOT NULL ,
	RECEIPTAMT           NUMBER(15) NULL ,
	REALINCOMAMT         NUMBER(15) NULL ,
	INDEMINITY_TAG       VARCHAR2(1 BYTE) NULL ,
	DELAY_INDEMINITY     NUMBER(15) NULL ,
	ICHE_DATE            VARCHAR2(8 BYTE) NULL ,
	ICHE_YN              VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_INDEMINITY
	ADD CONSTRAINT  SYS_C0019146 PRIMARY KEY (CUST_CODE,SEQ);



CREATE TABLE HD_HOUS_INDEMINITY_CONV
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025482 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025483 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025484 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025485 NOT NULL ,
	ICHE_DATE            VARCHAR2(8 BYTE) NULL ,
	DELAY_INDEMINITY     NUMBER(15) NULL ,
	CONV_YN              VARCHAR2(1 BYTE) NULL 
);



ALTER TABLE HD_HOUS_INDEMINITY_CONV
	ADD CONSTRAINT  SYS_C0025486 PRIMARY KEY (DEPT_CODE,HOUSETAG,BUILDNO,HOUSENO);



CREATE TABLE HD_HOUS_INDEMINITY_CONV
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019147 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019148 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019149 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019150 NOT NULL ,
	ICHE_DATE            VARCHAR2(8 BYTE) NULL ,
	DELAY_INDEMINITY     NUMBER(15) NULL ,
	CONV_YN              VARCHAR2(1 BYTE) NULL 
);



ALTER TABLE HD_HOUS_INDEMINITY_CONV
	ADD CONSTRAINT  SYS_C0019151 PRIMARY KEY (DEPT_CODE,HOUSETAG,BUILDNO,HOUSENO);



CREATE TABLE HD_HOUS_JESE
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025487 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025488 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025489 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025490 NOT NULL ,
	DEPOSIT1             VARCHAR2(20 BYTE) NULL ,
	INDATE1              VARCHAR2(8 BYTE) NULL ,
	INAMT1               NUMBER(15) NULL ,
	DEPOSIT2             VARCHAR2(20 BYTE) NULL ,
	INDATE2              VARCHAR2(8 BYTE) NULL ,
	INAMT2               NUMBER(15) NULL ,
	DEPOSIT3             VARCHAR2(20 BYTE) NULL ,
	INDATE3              VARCHAR2(8 BYTE) NULL ,
	INAMT3               NUMBER(15) NULL ,
	JUNGSAN_BDATE        VARCHAR2(8 BYTE) NULL ,
	JUNGSAN_SDATE        VARCHAR2(8 BYTE) NULL ,
	SISUL_BDATE          VARCHAR2(8 BYTE) NULL ,
	SISUL_SDATE          VARCHAR2(8 BYTE) NULL ,
	DUNG_BDATE           VARCHAR2(8 BYTE) NULL ,
	DUNG_SDATE           VARCHAR2(8 BYTE) NULL ,
	BO_BDATE             VARCHAR2(8 BYTE) NULL ,
	BO_SDATE             VARCHAR2(8 BYTE) NULL ,
	BUBMU_BUILD          VARCHAR2(50 BYTE) NULL ,
	BUBMU_LAND           VARCHAR2(50 BYTE) NULL ,
	ETC_SDATE            VARCHAR2(8 BYTE) NULL ,
	ETC_ADATE            VARCHAR2(8 BYTE) NULL ,
	ETC_IDATE            VARCHAR2(8 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_JESE
	ADD CONSTRAINT  SYS_C0025491 PRIMARY KEY (CUST_CODE,SEQ);



CREATE TABLE HD_HOUS_JESE
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019152 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019153 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019154 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019155 NOT NULL ,
	DEPOSIT1             VARCHAR2(20 BYTE) NULL ,
	INDATE1              VARCHAR2(8 BYTE) NULL ,
	INAMT1               NUMBER(15) NULL ,
	DEPOSIT2             VARCHAR2(20 BYTE) NULL ,
	INDATE2              VARCHAR2(8 BYTE) NULL ,
	INAMT2               NUMBER(15) NULL ,
	DEPOSIT3             VARCHAR2(20 BYTE) NULL ,
	INDATE3              VARCHAR2(8 BYTE) NULL ,
	INAMT3               NUMBER(15) NULL ,
	JUNGSAN_BDATE        VARCHAR2(8 BYTE) NULL ,
	JUNGSAN_SDATE        VARCHAR2(8 BYTE) NULL ,
	SISUL_BDATE          VARCHAR2(8 BYTE) NULL ,
	SISUL_SDATE          VARCHAR2(8 BYTE) NULL ,
	DUNG_BDATE           VARCHAR2(8 BYTE) NULL ,
	DUNG_SDATE           VARCHAR2(8 BYTE) NULL ,
	BO_BDATE             VARCHAR2(8 BYTE) NULL ,
	BO_SDATE             VARCHAR2(8 BYTE) NULL ,
	BUBMU_BUILD          VARCHAR2(50 BYTE) NULL ,
	BUBMU_LAND           VARCHAR2(50 BYTE) NULL ,
	ETC_SDATE            VARCHAR2(8 BYTE) NULL ,
	ETC_ADATE            VARCHAR2(8 BYTE) NULL ,
	ETC_IDATE            VARCHAR2(8 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_JESE
	ADD CONSTRAINT  SYS_C0019156 PRIMARY KEY (CUST_CODE,SEQ);



CREATE TABLE HD_HOUS_LEND
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025492 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025493 NOT NULL ,
	CNT                  NUMBER(5) CONSTRAINT SYS_C0025494 NOT NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025495 NOT NULL ,
	AGREEDATE            VARCHAR2(8 BYTE) NULL ,
	AGREEAMT             NUMBER(15) NULL ,
	LEND_TAG             VARCHAR2(1 BYTE) NULL ,
	LENDDATE             VARCHAR2(8 BYTE) NULL ,
	PERPECTTAG           VARCHAR2(1 BYTE) NULL ,
	REAL_RECEIPTAMT      NUMBER(15) NULL ,
	STAMP_AMT            NUMBER(15) NULL ,
	GUARANTEE_AMT        NUMBER(15) NULL ,
	LEND_INTEREST        NUMBER(15) NULL ,
	RATE                 NUMBER(8,4) NULL ,
	REAL_DATE            VARCHAR2(8 BYTE) NULL ,
	EXCHANGE_PLANDATE    VARCHAR2(8 BYTE) NULL ,
	EXCHANGE_PLANAMT     NUMBER(15) NULL ,
	EXCHANGE_DATE        VARCHAR2(8 BYTE) NULL ,
	EXCHANGE_AMT         NUMBER(15) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_LEND
	ADD CONSTRAINT  SYS_C0025496 PRIMARY KEY (CUST_CODE,SEQ,CNT);



CREATE TABLE HD_HOUS_LEND
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019157 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019158 NOT NULL ,
	CNT                  NUMBER(5) CONSTRAINT SYS_C0019159 NOT NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019160 NOT NULL ,
	AGREEDATE            VARCHAR2(8 BYTE) NULL ,
	AGREEAMT             NUMBER(15) NULL ,
	LEND_TAG             VARCHAR2(1 BYTE) NULL ,
	LENDDATE             VARCHAR2(8 BYTE) NULL ,
	PERPECTTAG           VARCHAR2(1 BYTE) NULL ,
	REAL_RECEIPTAMT      NUMBER(15) NULL ,
	STAMP_AMT            NUMBER(15) NULL ,
	GUARANTEE_AMT        NUMBER(15) NULL ,
	LEND_INTEREST        NUMBER(15) NULL ,
	RATE                 NUMBER(8,4) NULL ,
	REAL_DATE            VARCHAR2(8 BYTE) NULL ,
	EXCHANGE_PLANDATE    VARCHAR2(8 BYTE) NULL ,
	EXCHANGE_PLANAMT     NUMBER(15) NULL ,
	EXCHANGE_DATE        VARCHAR2(8 BYTE) NULL ,
	EXCHANGE_AMT         NUMBER(15) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_LEND
	ADD CONSTRAINT  SYS_C0019161 PRIMARY KEY (CUST_CODE,SEQ,CNT);



CREATE TABLE HD_HOUS_LEND_TXTUP
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025497 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025498 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025499 NOT NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025500 NOT NULL ,
	AGREEDATE            VARCHAR2(8 BYTE) NULL ,
	AGREEAMT             NUMBER(15) NULL ,
	LEND_YN              VARCHAR2(1 BYTE) NULL ,
	ERR_MESSAGE          VARCHAR2(100 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_LEND_TXTUP
	ADD CONSTRAINT  SYS_C0025501 PRIMARY KEY (DEPT_CODE,HOUSETAG,SEQ);



CREATE TABLE HD_HOUS_LEND_TXTUP
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019162 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019163 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019164 NOT NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019165 NOT NULL ,
	AGREEDATE            VARCHAR2(8 BYTE) NULL ,
	AGREEAMT             NUMBER(15) NULL ,
	LEND_YN              VARCHAR2(1 BYTE) NULL ,
	ERR_MESSAGE          VARCHAR2(100 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_LEND_TXTUP
	ADD CONSTRAINT  SYS_C0019166 PRIMARY KEY (DEPT_CODE,HOUSETAG,SEQ);



CREATE TABLE HD_HOUS_MAGAM
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025502 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025503 NOT NULL ,
	MAGAMDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025504 NOT NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_MAGAM
	ADD CONSTRAINT  SYS_C0025505 PRIMARY KEY (DEPT_CODE,HOUSETAG);



CREATE TABLE HD_HOUS_MAGAM
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019167 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019168 NOT NULL ,
	MAGAMDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019169 NOT NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_MAGAM
	ADD CONSTRAINT  SYS_C0019170 PRIMARY KEY (DEPT_CODE,HOUSETAG);



CREATE TABLE HD_HOUS_OPTION
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C00142995 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C00142996 NOT NULL ,
	OPTSEQ               NUMBER(10) CONSTRAINT SYS_C00142997 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	OPTION_SUP           NUMBER(13) NULL ,
	OPTION_VAT           NUMBER(13) NULL ,
	CONT_DATE            VARCHAR2(8 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_OPTION
	ADD CONSTRAINT  SYS_C00142998 PRIMARY KEY (CUST_CODE,SEQ,OPTSEQ);



CREATE TABLE HD_HOUS_OPTION
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C00142987 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C00142988 NOT NULL ,
	OPTSEQ               NUMBER(10) CONSTRAINT SYS_C00142989 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	OPTION_SUP           NUMBER(13) NULL ,
	OPTION_VAT           NUMBER(13) NULL ,
	CONT_DATE            VARCHAR2(8 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_OPTION
	ADD CONSTRAINT  SYS_C00142990 PRIMARY KEY (CUST_CODE,SEQ,OPTSEQ);



CREATE TABLE HD_HOUS_RATE_DELAY
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025506 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025507 NOT NULL ,
	START_DAYS           NUMBER(5) CONSTRAINT SYS_C0025508 NOT NULL ,
	END_DAYS             NUMBER(5) CONSTRAINT SYS_C0025509 NOT NULL ,
	STARTDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025510 NOT NULL ,
	ENDDATE              VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025511 NOT NULL ,
	DELAYRATE            FLOAT(126) CONSTRAINT SYS_C0025512 NOT NULL ,
	DELAYCUT             VARCHAR2(2 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025513 NOT NULL ,
	DELAYUNIT            VARCHAR2(2 BYTE) DEFAULT  '2'  CONSTRAINT SYS_C0025514 NOT NULL ,
	START_TAG            VARCHAR2(1 BYTE) NULL ,
	END_TAG              VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_RATE_DELAY
	ADD CONSTRAINT  SYS_C0025515 PRIMARY KEY (CUST_CODE,SEQ,START_DAYS,END_DAYS,STARTDATE);



CREATE TABLE HD_HOUS_RATE_DELAY
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019171 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019172 NOT NULL ,
	START_DAYS           NUMBER(5) CONSTRAINT SYS_C0019173 NOT NULL ,
	END_DAYS             NUMBER(5) CONSTRAINT SYS_C0019174 NOT NULL ,
	STARTDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019175 NOT NULL ,
	ENDDATE              VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019176 NOT NULL ,
	DELAYRATE            FLOAT(126) CONSTRAINT SYS_C0019177 NOT NULL ,
	DELAYCUT             VARCHAR2(2 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019178 NOT NULL ,
	DELAYUNIT            VARCHAR2(2 BYTE) DEFAULT  '2'  CONSTRAINT SYS_C0019179 NOT NULL ,
	START_TAG            VARCHAR2(1 BYTE) NULL ,
	END_TAG              VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_RATE_DELAY
	ADD CONSTRAINT  SYS_C0019180 PRIMARY KEY (CUST_CODE,SEQ,START_DAYS,END_DAYS,STARTDATE);



CREATE TABLE HD_HOUS_RATE_DELAY_1207
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C00187801 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C00187802 NOT NULL ,
	START_DAYS           NUMBER(5) CONSTRAINT SYS_C00187803 NOT NULL ,
	END_DAYS             NUMBER(5) CONSTRAINT SYS_C00187804 NOT NULL ,
	STARTDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C00187805 NOT NULL ,
	ENDDATE              VARCHAR2(8 BYTE) CONSTRAINT SYS_C00187806 NOT NULL ,
	DELAYRATE            FLOAT(126) CONSTRAINT SYS_C00187807 NOT NULL ,
	DELAYCUT             VARCHAR2(2 BYTE) CONSTRAINT SYS_C00187808 NOT NULL ,
	DELAYUNIT            VARCHAR2(2 BYTE) CONSTRAINT SYS_C00187809 NOT NULL ,
	START_TAG            VARCHAR2(1 BYTE) NULL ,
	END_TAG              VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



CREATE TABLE HD_HOUS_RATE_DELAY_LOG
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025516 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025517 NOT NULL ,
	START_DAYS           NUMBER(5) CONSTRAINT SYS_C0025518 NOT NULL ,
	END_DAYS             NUMBER(5) CONSTRAINT SYS_C0025519 NOT NULL ,
	STARTDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025520 NOT NULL ,
	WRITETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025521 NOT NULL ,
	WRITETIME            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025522 NOT NULL ,
	WRITESEQ             NUMBER(5) CONSTRAINT SYS_C0025523 NOT NULL ,
	ENDDATE              VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025524 NOT NULL ,
	DELAYRATE            FLOAT(126) CONSTRAINT SYS_C0025525 NOT NULL ,
	DELAYCUT             VARCHAR2(2 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025526 NOT NULL ,
	DELAYUNIT            VARCHAR2(2 BYTE) DEFAULT  '2'  CONSTRAINT SYS_C0025527 NOT NULL ,
	START_TAG            VARCHAR2(1 BYTE) NULL ,
	END_TAG              VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_RATE_DELAY_LOG
	ADD CONSTRAINT  SYS_C0025528 PRIMARY KEY (CUST_CODE,SEQ,START_DAYS,END_DAYS,STARTDATE,WRITETAG,WRITETIME,WRITESEQ);



CREATE TABLE HD_HOUS_RATE_DELAY_LOG
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019181 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019182 NOT NULL ,
	START_DAYS           NUMBER(5) CONSTRAINT SYS_C0019183 NOT NULL ,
	END_DAYS             NUMBER(5) CONSTRAINT SYS_C0019184 NOT NULL ,
	STARTDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019185 NOT NULL ,
	WRITETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019186 NOT NULL ,
	WRITETIME            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019187 NOT NULL ,
	WRITESEQ             NUMBER(5) CONSTRAINT SYS_C0019188 NOT NULL ,
	ENDDATE              VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019189 NOT NULL ,
	DELAYRATE            FLOAT(126) CONSTRAINT SYS_C0019190 NOT NULL ,
	DELAYCUT             VARCHAR2(2 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019191 NOT NULL ,
	DELAYUNIT            VARCHAR2(2 BYTE) DEFAULT  '2'  CONSTRAINT SYS_C0019192 NOT NULL ,
	START_TAG            VARCHAR2(1 BYTE) NULL ,
	END_TAG              VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_RATE_DELAY_LOG
	ADD CONSTRAINT  SYS_C0019193 PRIMARY KEY (CUST_CODE,SEQ,START_DAYS,END_DAYS,STARTDATE,WRITETAG,WRITETIME,WRITESEQ);



CREATE TABLE HD_HOUS_RATE_DISCOUNT
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025529 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025530 NOT NULL ,
	STARTDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025531 NOT NULL ,
	ENDDATE              VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025532 NOT NULL ,
	DISCNTRATE           FLOAT(126) CONSTRAINT SYS_C0025533 NOT NULL ,
	DISCNTCUT            VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025534 NOT NULL ,
	DISCNTUNIT           VARCHAR2(1 BYTE) DEFAULT  '2'  CONSTRAINT SYS_C0025535 NOT NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_RATE_DISCOUNT
	ADD CONSTRAINT  SYS_C0025536 PRIMARY KEY (CUST_CODE,SEQ,STARTDATE);



CREATE TABLE HD_HOUS_RATE_DISCOUNT
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019194 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019195 NOT NULL ,
	STARTDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019196 NOT NULL ,
	ENDDATE              VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019197 NOT NULL ,
	DISCNTRATE           FLOAT(126) CONSTRAINT SYS_C0019198 NOT NULL ,
	DISCNTCUT            VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019199 NOT NULL ,
	DISCNTUNIT           VARCHAR2(1 BYTE) DEFAULT  '2'  CONSTRAINT SYS_C0019200 NOT NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_RATE_DISCOUNT
	ADD CONSTRAINT  SYS_C0019201 PRIMARY KEY (CUST_CODE,SEQ,STARTDATE);



CREATE TABLE HD_HOUS_RATE_DISCOUNT_LOG
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025537 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025538 NOT NULL ,
	STARTDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025539 NOT NULL ,
	WRITETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025540 NOT NULL ,
	WRITETIME            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025541 NOT NULL ,
	WRITESEQ             NUMBER(5) CONSTRAINT SYS_C0025542 NOT NULL ,
	ENDDATE              VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025543 NOT NULL ,
	DISCNTRATE           FLOAT(126) CONSTRAINT SYS_C0025544 NOT NULL ,
	DISCNTCUT            VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025545 NOT NULL ,
	DISCNTUNIT           VARCHAR2(1 BYTE) DEFAULT  '2'  CONSTRAINT SYS_C0025546 NOT NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_RATE_DISCOUNT_LOG
	ADD CONSTRAINT  SYS_C0025547 PRIMARY KEY (CUST_CODE,SEQ,STARTDATE,WRITETAG,WRITETIME,WRITESEQ);



CREATE TABLE HD_HOUS_RATE_DISCOUNT_LOG
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019202 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019203 NOT NULL ,
	STARTDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019204 NOT NULL ,
	WRITETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019205 NOT NULL ,
	WRITETIME            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019206 NOT NULL ,
	WRITESEQ             NUMBER(5) CONSTRAINT SYS_C0019207 NOT NULL ,
	ENDDATE              VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019208 NOT NULL ,
	DISCNTRATE           FLOAT(126) CONSTRAINT SYS_C0019209 NOT NULL ,
	DISCNTCUT            VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019210 NOT NULL ,
	DISCNTUNIT           VARCHAR2(1 BYTE) DEFAULT  '2'  CONSTRAINT SYS_C0019211 NOT NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_RATE_DISCOUNT_LOG
	ADD CONSTRAINT  SYS_C0019212 PRIMARY KEY (CUST_CODE,SEQ,STARTDATE,WRITETAG,WRITETIME,WRITESEQ);



CREATE TABLE HD_HOUS_REMARK
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025548 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025549 NOT NULL ,
	REMARKSEQ            NUMBER(5) CONSTRAINT SYS_C0025550 NOT NULL ,
	REAMRKDATE           VARCHAR2(8 BYTE) NULL ,
	REMARK               VARCHAR2(500 BYTE) NULL ,
	USERID               VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025551 NOT NULL ,
	CONFIRM_DATE         VARCHAR2(8 BYTE) NULL ,
	END_YN               VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_REMARK
	ADD CONSTRAINT  SYS_C0025552 PRIMARY KEY (CUST_CODE,SEQ,REMARKSEQ);



CREATE TABLE HD_HOUS_REMARK
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019213 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019214 NOT NULL ,
	REMARKSEQ            NUMBER(5) CONSTRAINT SYS_C0019215 NOT NULL ,
	REAMRKDATE           VARCHAR2(8 BYTE) NULL ,
	REMARK               VARCHAR2(500 BYTE) NULL ,
	USERID               VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019216 NOT NULL ,
	CONFIRM_DATE         VARCHAR2(8 BYTE) NULL ,
	END_YN               VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_REMARK
	ADD CONSTRAINT  SYS_C0019217 PRIMARY KEY (CUST_CODE,SEQ,REMARKSEQ);



CREATE TABLE HD_HOUS_RESERVE
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025553 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025554 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025555 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025556 NOT NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) NULL ,
	SQUARE               NUMBER(8,4) NULL ,
	TYPE                 VARCHAR2(4 BYTE) NULL ,
	CLASS                VARCHAR2(1 BYTE) NULL ,
	OPTIONS              VARCHAR2(2 BYTE) NULL ,
	RESERVEDATE          VARCHAR2(8 BYTE) NULL ,
	RESERVEAMT           NUMBER(13) NULL ,
	REMAINAMT            NUMBER(13) NULL ,
	CONTRACTDATE         VARCHAR2(8 BYTE) NULL ,
	CONTRACTTAG          VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	PRTSQUARE            NUMBER(8,4) NULL 
);



ALTER TABLE HD_HOUS_RESERVE
	ADD CONSTRAINT  SYS_C0025557 PRIMARY KEY (DEPT_CODE,HOUSETAG,BUILDNO,HOUSENO);



CREATE TABLE HD_HOUS_RESERVE
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019218 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019219 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019220 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019221 NOT NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) NULL ,
	SQUARE               NUMBER(8,4) NULL ,
	TYPE                 VARCHAR2(4 BYTE) NULL ,
	CLASS                VARCHAR2(1 BYTE) NULL ,
	OPTIONS              VARCHAR2(2 BYTE) NULL ,
	RESERVEDATE          VARCHAR2(8 BYTE) NULL ,
	RESERVEAMT           NUMBER(13) NULL ,
	REMAINAMT            NUMBER(13) NULL ,
	CONTRACTDATE         VARCHAR2(8 BYTE) NULL ,
	CONTRACTTAG          VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	PRTSQUARE            NUMBER(8,4) NULL 
);



ALTER TABLE HD_HOUS_RESERVE
	ADD CONSTRAINT  SYS_C0019222 PRIMARY KEY (DEPT_CODE,HOUSETAG,BUILDNO,HOUSENO);



CREATE TABLE HD_HOUS_SEALHISTORY
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025558 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025559 NOT NULL ,
	SN                   NUMBER(5) CONSTRAINT SYS_C0025560 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) NULL ,
	PRINT_DATE           VARCHAR2(14 BYTE) NULL ,
	SEALTYPE             VARCHAR2(1 BYTE) NULL ,
	PRINT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	PRINT_IP             VARCHAR2(15 BYTE) NULL 
);



ALTER TABLE HD_HOUS_SEALHISTORY
	ADD CONSTRAINT  SYS_C0025561 PRIMARY KEY (CUST_CODE,SEQ,SN);



CREATE TABLE HD_HOUS_SEALHISTORY
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019223 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019224 NOT NULL ,
	SN                   NUMBER(5) CONSTRAINT SYS_C0019225 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) NULL ,
	PRINT_DATE           VARCHAR2(14 BYTE) NULL ,
	SEALTYPE             VARCHAR2(1 BYTE) NULL ,
	PRINT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	PRINT_IP             VARCHAR2(15 BYTE) NULL 
);



ALTER TABLE HD_HOUS_SEALHISTORY
	ADD CONSTRAINT  SYS_C0019226 PRIMARY KEY (CUST_CODE,SEQ,SN);



CREATE TABLE HD_HOUS_SELL
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025562 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025563 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025564 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025565 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025566 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025567 NOT NULL ,
	DONGHO               VARCHAR2(20 BYTE) NULL ,
	CUST_NAME            VARCHAR2(50 BYTE) NULL ,
	SQUARE               NUMBER(8,4) NULL ,
	TYPE                 VARCHAR2(4 BYTE) NULL ,
	CLASS                VARCHAR2(1 BYTE) NULL ,
	OPTIONCODE           VARCHAR2(2 BYTE) DEFAULT  '00'  NULL ,
	CONTRACTTAG          VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025568 NOT NULL ,
	CONTRACTDATE         VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025569 NOT NULL ,
	CONTRACTNO           VARCHAR2(10 BYTE) NULL ,
	LOAN_TAG             VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	LEASETAG             VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	LASTCHANGEDATE       VARCHAR2(8 BYTE) NULL ,
	CHANGETAG            VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025570 NOT NULL ,
	CHANGEDATE           VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025571 NOT NULL ,
	CANCEL_REASON        VARCHAR2(50 BYTE) NULL ,
	CHILD_BUILDNO        VARCHAR2(10 BYTE) NULL ,
	CHILD_HOUSENO        VARCHAR2(10 BYTE) NULL ,
	RELA_CUSTCODE        VARCHAR2(13 BYTE) NULL ,
	RELA_SEQ             NUMBER(5) NULL ,
	VATTAG               VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025572 NOT NULL ,
	EXCLUSIVEAREA        NUMBER(12,4) CONSTRAINT SYS_C0025573 NOT NULL ,
	COMMONAREA           NUMBER(12,4) CONSTRAINT SYS_C0025574 NOT NULL ,
	ETCCOMMONAREA        NUMBER(12,4) CONSTRAINT SYS_C0025575 NOT NULL ,
	PARKINGAREA          NUMBER(12,4) CONSTRAINT SYS_C0025576 NOT NULL ,
	SERVICEAREA          NUMBER(12,4) CONSTRAINT SYS_C0025577 NOT NULL ,
	SITEAREA             NUMBER(12,4) CONSTRAINT SYS_C0025578 NOT NULL ,
	MOVEINSTARTDATE      VARCHAR2(8 BYTE) NULL ,
	MOVEINENDDATE        VARCHAR2(8 BYTE) NULL ,
	UNION_CNT            NUMBER(5) NULL ,
	REMARK               VARCHAR2(50 BYTE) NULL ,
	REFUNDMENTDATE       VARCHAR2(8 BYTE) NULL ,
	REFUNDMENTAMT        NUMBER(12) NULL ,
	PENALTYAMT           NUMBER(12) NULL ,
	LOAN_INTEREST        NUMBER(12) NULL ,
	SODUK_TAX            NUMBER(12) NULL ,
	JUMIN_TAX            NUMBER(12) NULL ,
	BANK_LOAN_ORGAMT     NUMBER(12) NULL ,
	BANK_LOAN_INTEREST   NUMBER(12) NULL ,
	LOANBANK             VARCHAR2(30 BYTE) NULL ,
	LOANDEPOSIT          VARCHAR2(30 BYTE) NULL ,
	LOANUSER             VARCHAR2(30 BYTE) NULL ,
	REFUND_DEPOSIT       VARCHAR2(30 BYTE) NULL ,
	REFUND_BANK          VARCHAR2(40 BYTE) NULL ,
	COMP_LOANAMT         NUMBER(12) NULL ,
	BILL_RETURNAMT       NUMBER(12) CONSTRAINT SYS_C0025579 NOT NULL ,
	DELAY_INDEMINITY     NUMBER(12) NULL ,
	DEPOSIT_COUNT        NUMBER(3) NULL ,
	CO_CUSTCODE          VARCHAR2(20 BYTE) NULL ,
	CO_SANGHO            VARCHAR2(30 BYTE) NULL ,
	CO_CONDITION         VARCHAR2(30 BYTE) NULL ,
	CO_CATEGORY          VARCHAR2(30 BYTE) NULL ,
	CATEGORY_NAME        VARCHAR2(40 BYTE) NULL ,
	SLIPDATE             VARCHAR2(8 BYTE) NULL ,
	SLIPSEQ              NUMBER(5) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	APPLY_YN             VARCHAR2(1 BYTE) NULL ,
	APPLY_EMPNO          VARCHAR2(12 BYTE) NULL ,
	APPLY_DATE           VARCHAR2(14 BYTE) NULL ,
	PRTSQUARE            NUMBER(8,4) NULL ,
	BANK_LOAN_INTEREST2  NUMBER(12) NULL ,
	ETC_AMT              NUMBER(12) NULL ,
	RENTHD_YN            VARCHAR2(1 BYTE) NULL ,
	RENTHD_SEQ           NUMBER(5) NULL ,
	BALCONY_TAG          VARCHAR2(1 BYTE) NULL ,
	BALCONYAREA          NUMBER(12,4) NULL ,
	DAYMONTH_TAG         VARCHAR2(1 BYTE) NULL ,
	FLOOR                VARCHAR2(4 BYTE) NULL ,
	CONT_CONDITION       VARCHAR2(2 BYTE) NULL ,
	LAND_RETURN          VARCHAR2(2 BYTE) NULL ,
	INT_CALC_DATE        VARCHAR2(8 BYTE) NULL ,
	PREDISAMT            NUMBER(15) NULL ,
	PROXYAMT             NUMBER(15) NULL ,
	INCONT_DATE          VARCHAR2(8 BYTE) NULL ,
	TRUSTAMT             NUMBER(15) NULL ,
	PREDIS_TAG           VARCHAR2(1 BYTE) NULL ,
	PROXY_TAG            VARCHAR2(1 BYTE) NULL ,
	TRUST_TAG            VARCHAR2(1 BYTE) NULL ,
	VIR_YN               VARCHAR2(1 BYTE) NULL ,
	VDEPOSIT             VARCHAR2(50 BYTE) NULL ,
	BALCONYAMT           NUMBER(15) DEFAULT  0  NULL ,
	CUST_CODE2           VARCHAR2(20 BYTE) NULL ,
	REP_LIMITDT          VARCHAR2(8 BYTE) NULL ,
	REP_YN               VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	REP_DATE             VARCHAR2(8 BYTE) NULL 
);



ALTER TABLE HD_HOUS_SELL
	ADD CONSTRAINT  SYS_C0025580 PRIMARY KEY (CUST_CODE,SEQ);



CREATE  INDEX XIE1HD_HOUS_SELL ON HD_HOUS_SELL
(CONTRACTDATE   ASC,LASTCHANGEDATE   ASC,CHANGEDATE   ASC,CHANGETAG   ASC);



CREATE  INDEX XIE2HD_HOUS_SELL ON HD_HOUS_SELL
(DEPT_CODE   ASC,HOUSETAG   ASC,BUILDNO   ASC,HOUSENO   ASC,DONGHO   ASC);



CREATE TABLE HD_HOUS_SELL
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019227 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019228 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019229 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019230 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019231 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019232 NOT NULL ,
	DONGHO               VARCHAR2(20 BYTE) NULL ,
	CUST_NAME            VARCHAR2(50 BYTE) NULL ,
	SQUARE               NUMBER(8,4) NULL ,
	TYPE                 VARCHAR2(4 BYTE) NULL ,
	CLASS                VARCHAR2(1 BYTE) NULL ,
	OPTIONCODE           VARCHAR2(2 BYTE) DEFAULT  '00'  NULL ,
	CONTRACTTAG          VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019233 NOT NULL ,
	CONTRACTDATE         VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019234 NOT NULL ,
	CONTRACTNO           VARCHAR2(10 BYTE) NULL ,
	LOAN_TAG             VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	LEASETAG             VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	LASTCHANGEDATE       VARCHAR2(8 BYTE) NULL ,
	CHANGETAG            VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019235 NOT NULL ,
	CHANGEDATE           VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019236 NOT NULL ,
	CANCEL_REASON        VARCHAR2(50 BYTE) NULL ,
	CHILD_BUILDNO        VARCHAR2(10 BYTE) NULL ,
	CHILD_HOUSENO        VARCHAR2(10 BYTE) NULL ,
	RELA_CUSTCODE        VARCHAR2(13 BYTE) NULL ,
	RELA_SEQ             NUMBER(5) NULL ,
	VATTAG               VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019237 NOT NULL ,
	EXCLUSIVEAREA        NUMBER(12,4) CONSTRAINT SYS_C0019238 NOT NULL ,
	COMMONAREA           NUMBER(12,4) CONSTRAINT SYS_C0019239 NOT NULL ,
	ETCCOMMONAREA        NUMBER(12,4) CONSTRAINT SYS_C0019240 NOT NULL ,
	PARKINGAREA          NUMBER(12,4) CONSTRAINT SYS_C0019241 NOT NULL ,
	SERVICEAREA          NUMBER(12,4) CONSTRAINT SYS_C0019242 NOT NULL ,
	SITEAREA             NUMBER(12,4) CONSTRAINT SYS_C0019243 NOT NULL ,
	MOVEINSTARTDATE      VARCHAR2(8 BYTE) NULL ,
	MOVEINENDDATE        VARCHAR2(8 BYTE) NULL ,
	UNION_CNT            NUMBER(5) NULL ,
	REMARK               VARCHAR2(50 BYTE) NULL ,
	REFUNDMENTDATE       VARCHAR2(8 BYTE) NULL ,
	REFUNDMENTAMT        NUMBER(12) NULL ,
	PENALTYAMT           NUMBER(12) NULL ,
	LOAN_INTEREST        NUMBER(12) NULL ,
	SODUK_TAX            NUMBER(12) NULL ,
	JUMIN_TAX            NUMBER(12) NULL ,
	BANK_LOAN_ORGAMT     NUMBER(12) NULL ,
	BANK_LOAN_INTEREST   NUMBER(12) NULL ,
	LOANBANK             VARCHAR2(30 BYTE) NULL ,
	LOANDEPOSIT          VARCHAR2(30 BYTE) NULL ,
	LOANUSER             VARCHAR2(30 BYTE) NULL ,
	REFUND_DEPOSIT       VARCHAR2(30 BYTE) NULL ,
	REFUND_BANK          VARCHAR2(40 BYTE) NULL ,
	COMP_LOANAMT         NUMBER(12) NULL ,
	BILL_RETURNAMT       NUMBER(12) CONSTRAINT SYS_C0019244 NOT NULL ,
	DELAY_INDEMINITY     NUMBER(12) NULL ,
	DEPOSIT_COUNT        NUMBER(3) NULL ,
	CO_CUSTCODE          VARCHAR2(20 BYTE) NULL ,
	CO_SANGHO            VARCHAR2(30 BYTE) NULL ,
	CO_CONDITION         VARCHAR2(30 BYTE) NULL ,
	CO_CATEGORY          VARCHAR2(30 BYTE) NULL ,
	CATEGORY_NAME        VARCHAR2(40 BYTE) NULL ,
	SLIPDATE             VARCHAR2(8 BYTE) NULL ,
	SLIPSEQ              NUMBER(5) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	APPLY_YN             VARCHAR2(1 BYTE) NULL ,
	APPLY_EMPNO          VARCHAR2(12 BYTE) NULL ,
	APPLY_DATE           VARCHAR2(14 BYTE) NULL ,
	PRTSQUARE            NUMBER(8,4) NULL ,
	BANK_LOAN_INTEREST2  NUMBER(12) NULL ,
	ETC_AMT              NUMBER(12) NULL ,
	RENTHD_YN            VARCHAR2(1 BYTE) NULL ,
	RENTHD_SEQ           NUMBER(5) NULL ,
	BALCONY_TAG          VARCHAR2(1 BYTE) NULL ,
	BALCONYAREA          NUMBER(12,4) NULL ,
	DAYMONTH_TAG         VARCHAR2(1 BYTE) NULL ,
	FLOOR                VARCHAR2(4 BYTE) NULL ,
	CONT_CONDITION       VARCHAR2(2 BYTE) NULL ,
	LAND_RETURN          VARCHAR2(2 BYTE) NULL ,
	INT_CALC_DATE        VARCHAR2(8 BYTE) NULL ,
	PREDISAMT            NUMBER(15) NULL ,
	PROXYAMT             NUMBER(15) NULL ,
	INCONT_DATE          VARCHAR2(8 BYTE) NULL ,
	TRUSTAMT             NUMBER(15) NULL ,
	PREDIS_TAG           VARCHAR2(1 BYTE) NULL ,
	PROXY_TAG            VARCHAR2(1 BYTE) NULL ,
	TRUST_TAG            VARCHAR2(1 BYTE) NULL ,
	VIR_YN               VARCHAR2(1 BYTE) NULL ,
	VDEPOSIT             VARCHAR2(50 BYTE) NULL 
);



ALTER TABLE HD_HOUS_SELL
	ADD CONSTRAINT  SYS_C0019245 PRIMARY KEY (CUST_CODE,SEQ);



CREATE  INDEX XIE1HD_HOUS_SELL ON HD_HOUS_SELL
(CONTRACTDATE   ASC,LASTCHANGEDATE   ASC,CHANGEDATE   ASC,CHANGETAG   ASC);



CREATE  INDEX XIE2HD_HOUS_SELL ON HD_HOUS_SELL
(DEPT_CODE   ASC,HOUSETAG   ASC,BUILDNO   ASC,HOUSENO   ASC,DONGHO   ASC);



CREATE TABLE HD_HOUS_SELL_CONV
(
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025635 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025636 NOT NULL ,
	BSEQ                 FLOAT(126) NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025637 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025638 NOT NULL ,
	CHANGETAG            VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025639 NOT NULL ,
	CONTRACTDATE         VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025640 NOT NULL ,
	LASTCHANGEDATE       VARCHAR2(8 BYTE) NULL ,
	CHANGEDATE           VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025641 NOT NULL 
);



CREATE UNIQUE INDEX HD_HOUS_SELL_CONV ON HD_HOUS_SELL_CONV
(CUST_CODE   ASC,SEQ   ASC);



CREATE TABLE HD_HOUS_SELL_CONV
(
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019300 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019301 NOT NULL ,
	BSEQ                 FLOAT(126) NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019302 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019303 NOT NULL ,
	CHANGETAG            VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019304 NOT NULL ,
	CONTRACTDATE         VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019305 NOT NULL ,
	LASTCHANGEDATE       VARCHAR2(8 BYTE) NULL ,
	CHANGEDATE           VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019306 NOT NULL 
);



CREATE UNIQUE INDEX HD_HOUS_SELL_CONV ON HD_HOUS_SELL_CONV
(CUST_CODE   ASC,SEQ   ASC);



CREATE TABLE HD_HOUS_SELL_LOG
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025642 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025643 NOT NULL ,
	WRITETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025644 NOT NULL ,
	WRITETIME            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025645 NOT NULL ,
	WRITESEQ             NUMBER(5) CONSTRAINT SYS_C0025646 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025647 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025648 NOT NULL ,
	DONGHO               VARCHAR2(20 BYTE) NULL ,
	CUST_NAME            VARCHAR2(50 BYTE) NULL ,
	SQUARE               NUMBER(8,4) NULL ,
	TYPE                 VARCHAR2(4 BYTE) NULL ,
	CLASS                VARCHAR2(1 BYTE) NULL ,
	OPTIONCODE           VARCHAR2(2 BYTE) DEFAULT  '00'  NULL ,
	CONTRACTTAG          VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025649 NOT NULL ,
	CONTRACTDATE         VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025650 NOT NULL ,
	CONTRACTNO           VARCHAR2(10 BYTE) NULL ,
	LOAN_TAG             VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	LEASETAG             VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	LASTCHANGEDATE       VARCHAR2(8 BYTE) NULL ,
	CHANGETAG            VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025651 NOT NULL ,
	CHANGEDATE           VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025652 NOT NULL ,
	CANCEL_REASON        VARCHAR2(50 BYTE) NULL ,
	CHILD_BUILDNO        VARCHAR2(10 BYTE) NULL ,
	CHILD_HOUSENO        VARCHAR2(10 BYTE) NULL ,
	RELA_CUSTCODE        VARCHAR2(13 BYTE) NULL ,
	RELA_SEQ             NUMBER(5) NULL ,
	VATTAG               VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025653 NOT NULL ,
	EXCLUSIVEAREA        NUMBER(12,4) CONSTRAINT SYS_C0025654 NOT NULL ,
	COMMONAREA           NUMBER(12,4) CONSTRAINT SYS_C0025655 NOT NULL ,
	ETCCOMMONAREA        NUMBER(12,4) CONSTRAINT SYS_C0025656 NOT NULL ,
	PARKINGAREA          NUMBER(12,4) CONSTRAINT SYS_C0025657 NOT NULL ,
	SERVICEAREA          NUMBER(12,4) CONSTRAINT SYS_C0025658 NOT NULL ,
	SITEAREA             NUMBER(12,4) CONSTRAINT SYS_C0025659 NOT NULL ,
	MOVEINSTARTDATE      VARCHAR2(8 BYTE) NULL ,
	MOVEINENDDATE        VARCHAR2(8 BYTE) NULL ,
	UNION_CNT            NUMBER(5) NULL ,
	REMARK               VARCHAR2(50 BYTE) NULL ,
	REFUNDMENTDATE       VARCHAR2(8 BYTE) NULL ,
	REFUNDMENTAMT        NUMBER(12) NULL ,
	PENALTYAMT           NUMBER(12) NULL ,
	LOAN_INTEREST        NUMBER(12) NULL ,
	SODUK_TAX            NUMBER(12) NULL ,
	JUMIN_TAX            NUMBER(12) NULL ,
	BANK_LOAN_ORGAMT     NUMBER(12) NULL ,
	BANK_LOAN_INTEREST   NUMBER(12) NULL ,
	LOANBANK             VARCHAR2(30 BYTE) NULL ,
	LOANDEPOSIT          VARCHAR2(30 BYTE) NULL ,
	LOANUSER             VARCHAR2(30 BYTE) NULL ,
	REFUND_DEPOSIT       VARCHAR2(30 BYTE) NULL ,
	REFUND_BANK          VARCHAR2(40 BYTE) NULL ,
	COMP_LOANAMT         NUMBER(12) NULL ,
	BILL_RETURNAMT       NUMBER(12) CONSTRAINT SYS_C0025660 NOT NULL ,
	DELAY_INDEMINITY     NUMBER(12) NULL ,
	DEPOSIT_COUNT        NUMBER(3) NULL ,
	CO_CUSTCODE          VARCHAR2(20 BYTE) NULL ,
	CO_SANGHO            VARCHAR2(30 BYTE) NULL ,
	CO_CONDITION         VARCHAR2(30 BYTE) NULL ,
	CO_CATEGORY          VARCHAR2(12 BYTE) NULL ,
	CATEGORY_NAME        VARCHAR2(40 BYTE) NULL ,
	SLIPDATE             VARCHAR2(8 BYTE) NULL ,
	SLIPSEQ              NUMBER(5) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	APPLY_YN             VARCHAR2(1 BYTE) NULL ,
	APPLY_EMPNO          VARCHAR2(12 BYTE) NULL ,
	APPLY_DATE           VARCHAR2(14 BYTE) NULL ,
	PRTSQUARE            NUMBER(8,4) NULL ,
	BANK_LOAN_INTEREST2  NUMBER(12) NULL ,
	ETC_AMT              NUMBER(12) NULL ,
	RENTHD_YN            VARCHAR2(1 BYTE) NULL ,
	RENTHD_SEQ           NUMBER(5) NULL ,
	BALCONY_TAG          VARCHAR2(1 BYTE) NULL ,
	BALCONYAREA          NUMBER(12,4) NULL ,
	DAYMONTH_TAG         VARCHAR2(1 BYTE) NULL ,
	FLOOR                VARCHAR2(4 BYTE) NULL ,
	CONT_CONDITION       VARCHAR2(2 BYTE) NULL ,
	LAND_RETURN          VARCHAR2(2 BYTE) NULL ,
	INT_CALC_DATE        VARCHAR2(8 BYTE) NULL ,
	PREDISAMT            NUMBER(15) NULL ,
	PROXYAMT             NUMBER(15) NULL ,
	INCONT_DATE          VARCHAR2(8 BYTE) NULL ,
	TRUSTAMT             NUMBER(15) NULL ,
	PREDIS_TAG           VARCHAR2(1 BYTE) NULL ,
	PROXY_TAG            VARCHAR2(1 BYTE) NULL ,
	TRUST_TAG            VARCHAR2(1 BYTE) NULL ,
	VIR_YN               VARCHAR2(1 BYTE) NULL ,
	VDEPOSIT             VARCHAR2(50 BYTE) NULL ,
	REP_LIMITDT          VARCHAR2(8 BYTE) NULL ,
	REP_YN               VARCHAR2(1 BYTE) NULL ,
	REP_DATE             VARCHAR2(8 BYTE) NULL 
);



ALTER TABLE HD_HOUS_SELL_LOG
	ADD CONSTRAINT  SYS_C0025661 PRIMARY KEY (CUST_CODE,SEQ,WRITETAG,WRITETIME,WRITESEQ);



CREATE  INDEX XIE1HD_HOUS_SELL_LOG ON HD_HOUS_SELL_LOG
(DEPT_CODE   ASC,HOUSETAG   ASC,BUILDNO   ASC,HOUSENO   ASC,CONTRACTDATE   ASC,LASTCHANGEDATE   ASC,CHANGEDATE   ASC,CHANGETAG   ASC);



CREATE TABLE HD_HOUS_SELL_LOG
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019307 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019308 NOT NULL ,
	WRITETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019309 NOT NULL ,
	WRITETIME            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019310 NOT NULL ,
	WRITESEQ             NUMBER(5) CONSTRAINT SYS_C0019311 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019312 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019313 NOT NULL ,
	DONGHO               VARCHAR2(20 BYTE) NULL ,
	CUST_NAME            VARCHAR2(50 BYTE) NULL ,
	SQUARE               NUMBER(8,4) NULL ,
	TYPE                 VARCHAR2(4 BYTE) NULL ,
	CLASS                VARCHAR2(1 BYTE) NULL ,
	OPTIONCODE           VARCHAR2(2 BYTE) DEFAULT  '00'  NULL ,
	CONTRACTTAG          VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019314 NOT NULL ,
	CONTRACTDATE         VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019315 NOT NULL ,
	CONTRACTNO           VARCHAR2(10 BYTE) NULL ,
	LOAN_TAG             VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	LEASETAG             VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	LASTCHANGEDATE       VARCHAR2(8 BYTE) NULL ,
	CHANGETAG            VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019316 NOT NULL ,
	CHANGEDATE           VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019317 NOT NULL ,
	CANCEL_REASON        VARCHAR2(50 BYTE) NULL ,
	CHILD_BUILDNO        VARCHAR2(10 BYTE) NULL ,
	CHILD_HOUSENO        VARCHAR2(10 BYTE) NULL ,
	RELA_CUSTCODE        VARCHAR2(13 BYTE) NULL ,
	RELA_SEQ             NUMBER(5) NULL ,
	VATTAG               VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019318 NOT NULL ,
	EXCLUSIVEAREA        NUMBER(12,4) CONSTRAINT SYS_C0019319 NOT NULL ,
	COMMONAREA           NUMBER(12,4) CONSTRAINT SYS_C0019320 NOT NULL ,
	ETCCOMMONAREA        NUMBER(12,4) CONSTRAINT SYS_C0019321 NOT NULL ,
	PARKINGAREA          NUMBER(12,4) CONSTRAINT SYS_C0019322 NOT NULL ,
	SERVICEAREA          NUMBER(12,4) CONSTRAINT SYS_C0019323 NOT NULL ,
	SITEAREA             NUMBER(12,4) CONSTRAINT SYS_C0019324 NOT NULL ,
	MOVEINSTARTDATE      VARCHAR2(8 BYTE) NULL ,
	MOVEINENDDATE        VARCHAR2(8 BYTE) NULL ,
	UNION_CNT            NUMBER(5) NULL ,
	REMARK               VARCHAR2(50 BYTE) NULL ,
	REFUNDMENTDATE       VARCHAR2(8 BYTE) NULL ,
	REFUNDMENTAMT        NUMBER(12) NULL ,
	PENALTYAMT           NUMBER(12) NULL ,
	LOAN_INTEREST        NUMBER(12) NULL ,
	SODUK_TAX            NUMBER(12) NULL ,
	JUMIN_TAX            NUMBER(12) NULL ,
	BANK_LOAN_ORGAMT     NUMBER(12) NULL ,
	BANK_LOAN_INTEREST   NUMBER(12) NULL ,
	LOANBANK             VARCHAR2(30 BYTE) NULL ,
	LOANDEPOSIT          VARCHAR2(30 BYTE) NULL ,
	LOANUSER             VARCHAR2(30 BYTE) NULL ,
	REFUND_DEPOSIT       VARCHAR2(30 BYTE) NULL ,
	REFUND_BANK          VARCHAR2(40 BYTE) NULL ,
	COMP_LOANAMT         NUMBER(12) NULL ,
	BILL_RETURNAMT       NUMBER(12) CONSTRAINT SYS_C0019325 NOT NULL ,
	DELAY_INDEMINITY     NUMBER(12) NULL ,
	DEPOSIT_COUNT        NUMBER(3) NULL ,
	CO_CUSTCODE          VARCHAR2(20 BYTE) NULL ,
	CO_SANGHO            VARCHAR2(30 BYTE) NULL ,
	CO_CONDITION         VARCHAR2(30 BYTE) NULL ,
	CO_CATEGORY          VARCHAR2(12 BYTE) NULL ,
	CATEGORY_NAME        VARCHAR2(40 BYTE) NULL ,
	SLIPDATE             VARCHAR2(8 BYTE) NULL ,
	SLIPSEQ              NUMBER(5) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	APPLY_YN             VARCHAR2(1 BYTE) NULL ,
	APPLY_EMPNO          VARCHAR2(12 BYTE) NULL ,
	APPLY_DATE           VARCHAR2(14 BYTE) NULL ,
	PRTSQUARE            NUMBER(8,4) NULL ,
	BANK_LOAN_INTEREST2  NUMBER(12) NULL ,
	ETC_AMT              NUMBER(12) NULL ,
	RENTHD_YN            VARCHAR2(1 BYTE) NULL ,
	RENTHD_SEQ           NUMBER(5) NULL ,
	BALCONY_TAG          VARCHAR2(1 BYTE) NULL ,
	BALCONYAREA          NUMBER(12,4) NULL ,
	DAYMONTH_TAG         VARCHAR2(1 BYTE) NULL ,
	FLOOR                VARCHAR2(4 BYTE) NULL ,
	CONT_CONDITION       VARCHAR2(2 BYTE) NULL ,
	LAND_RETURN          VARCHAR2(2 BYTE) NULL ,
	INT_CALC_DATE        VARCHAR2(8 BYTE) NULL ,
	PREDISAMT            NUMBER(15) NULL ,
	PROXYAMT             NUMBER(15) NULL ,
	INCONT_DATE          VARCHAR2(8 BYTE) NULL ,
	TRUSTAMT             NUMBER(15) NULL ,
	PREDIS_TAG           VARCHAR2(1 BYTE) NULL ,
	PROXY_TAG            VARCHAR2(1 BYTE) NULL ,
	TRUST_TAG            VARCHAR2(1 BYTE) NULL ,
	VIR_YN               VARCHAR2(1 BYTE) NULL ,
	VDEPOSIT             VARCHAR2(50 BYTE) NULL 
);



ALTER TABLE HD_HOUS_SELL_LOG
	ADD CONSTRAINT  SYS_C0019326 PRIMARY KEY (CUST_CODE,SEQ,WRITETAG,WRITETIME,WRITESEQ);



CREATE  INDEX XIE1HD_HOUS_SELL_LOG ON HD_HOUS_SELL_LOG
(DEPT_CODE   ASC,HOUSETAG   ASC,BUILDNO   ASC,HOUSENO   ASC,CONTRACTDATE   ASC,LASTCHANGEDATE   ASC,CHANGEDATE   ASC,CHANGETAG   ASC);



CREATE TABLE HD_HOUS_SELL_TXTUP
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025662 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025663 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025664 NOT NULL ,
	SN                   NUMBER(5) CONSTRAINT SYS_C0025665 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025666 NOT NULL ,
	CONTDATE             VARCHAR2(8 BYTE) NULL ,
	RECEIPTDATE          VARCHAR2(8 BYTE) NULL ,
	RECEIPTAMT           NUMBER(15) NULL ,
	CONT_YN              VARCHAR2(1 BYTE) NULL ,
	ERR_MESSAGE          VARCHAR2(100 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_SELL_TXTUP
	ADD CONSTRAINT  SYS_C0025667 PRIMARY KEY (DEPT_CODE,HOUSETAG,SEQ,SN);



CREATE TABLE HD_HOUS_SELL_TXTUP
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019327 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019328 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019329 NOT NULL ,
	SN                   NUMBER(5) CONSTRAINT SYS_C0019330 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019331 NOT NULL ,
	CONTDATE             VARCHAR2(8 BYTE) NULL ,
	RECEIPTDATE          VARCHAR2(8 BYTE) NULL ,
	RECEIPTAMT           NUMBER(15) NULL ,
	CONT_YN              VARCHAR2(1 BYTE) NULL ,
	ERR_MESSAGE          VARCHAR2(100 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_SELL_TXTUP
	ADD CONSTRAINT  SYS_C0019332 PRIMARY KEY (DEPT_CODE,HOUSETAG,SEQ,SN);



CREATE TABLE HD_HOUS_SELLDETAIL
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025581 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025582 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0025583 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025584 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025585 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025586 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025587 NOT NULL ,
	AGREEDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025588 NOT NULL ,
	LANDAMT              FLOAT(126) CONSTRAINT SYS_C0025589 NOT NULL ,
	BUILDAMT             FLOAT(126) CONSTRAINT SYS_C0025590 NOT NULL ,
	VATAMT               FLOAT(126) CONSTRAINT SYS_C0025591 NOT NULL ,
	BUNAMT               FLOAT(126) NULL ,
	DC_YN                VARCHAR2(1 BYTE) NULL ,
	AC_YN                VARCHAR2(1 BYTE) NULL ,
	PERPECTTAG           VARCHAR2(1 BYTE) DEFAULT  'N'  CONSTRAINT SYS_C0025592 NOT NULL ,
	RECEIPTAMT           FLOAT(126) CONSTRAINT SYS_C0025593 NOT NULL ,
	DISTRIBUTE_RATE      NUMBER(4,1) NULL ,
	SLIPDT               VARCHAR2(8 BYTE) NULL ,
	SLIPSEQ              NUMBER(5) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	MANAGEAMT            FLOAT(126) DEFAULT  0  NULL 
);



ALTER TABLE HD_HOUS_SELLDETAIL
	ADD CONSTRAINT  SYS_C0025594 PRIMARY KEY (CUST_CODE,SEQ,COUNTS);



CREATE  INDEX XIE1HD_HOUS_SELLDETAIL ON HD_HOUS_SELLDETAIL
(DEPT_CODE   ASC,HOUSETAG   ASC,BUILDNO   ASC,HOUSENO   ASC,COUNTS   ASC);



CREATE TABLE HD_HOUS_SELLDETAIL
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019246 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019247 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019248 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019249 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019250 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019251 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019252 NOT NULL ,
	AGREEDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019253 NOT NULL ,
	LANDAMT              FLOAT(126) CONSTRAINT SYS_C0019254 NOT NULL ,
	BUILDAMT             FLOAT(126) CONSTRAINT SYS_C0019255 NOT NULL ,
	VATAMT               FLOAT(126) CONSTRAINT SYS_C0019256 NOT NULL ,
	BUNAMT               FLOAT(126) NULL ,
	DC_YN                VARCHAR2(1 BYTE) NULL ,
	AC_YN                VARCHAR2(1 BYTE) NULL ,
	PERPECTTAG           VARCHAR2(1 BYTE) DEFAULT  'N'  CONSTRAINT SYS_C0019257 NOT NULL ,
	RECEIPTAMT           FLOAT(126) CONSTRAINT SYS_C0019258 NOT NULL ,
	DISTRIBUTE_RATE      NUMBER(4,1) NULL ,
	SLIPDT               VARCHAR2(8 BYTE) NULL ,
	SLIPSEQ              NUMBER(5) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	MANAGEAMT            FLOAT(126) DEFAULT  0  NULL 
);



ALTER TABLE HD_HOUS_SELLDETAIL
	ADD CONSTRAINT  SYS_C0019259 PRIMARY KEY (CUST_CODE,SEQ,COUNTS);



CREATE  INDEX XIE1HD_HOUS_SELLDETAIL ON HD_HOUS_SELLDETAIL
(DEPT_CODE   ASC,HOUSETAG   ASC,BUILDNO   ASC,HOUSENO   ASC,COUNTS   ASC);



CREATE TABLE HD_HOUS_SELLDETAIL_ADJUST
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025595 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025596 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0025597 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025598 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025599 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025600 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025601 NOT NULL ,
	AGREEDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025602 NOT NULL ,
	LANDAMT              FLOAT(126) CONSTRAINT SYS_C0025603 NOT NULL ,
	BUILDAMT             FLOAT(126) CONSTRAINT SYS_C0025604 NOT NULL ,
	VATAMT               FLOAT(126) CONSTRAINT SYS_C0025605 NOT NULL ,
	BUNAMT               FLOAT(126) NULL ,
	DC_YN                VARCHAR2(1 BYTE) NULL ,
	AC_YN                VARCHAR2(1 BYTE) NULL ,
	PERPECTTAG           VARCHAR2(1 BYTE) DEFAULT  'N'  CONSTRAINT SYS_C0025606 NOT NULL ,
	RECEIPTAMT           FLOAT(126) CONSTRAINT SYS_C0025607 NOT NULL ,
	DISTRIBUTE_RATE      NUMBER(4,1) NULL ,
	SLIPDT               VARCHAR2(8 BYTE) NULL ,
	SLIPSEQ              NUMBER(5) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	MANAGEAMT            FLOAT(126) DEFAULT  0  NULL 
);



ALTER TABLE HD_HOUS_SELLDETAIL_ADJUST
	ADD CONSTRAINT  SYS_C0025608 PRIMARY KEY (CUST_CODE,SEQ,COUNTS);



CREATE  INDEX XIE1HD_HOUS_SELLDETAIL_ADJUST ON HD_HOUS_SELLDETAIL_ADJUST
(DEPT_CODE   ASC,HOUSETAG   ASC,BUILDNO   ASC,HOUSENO   ASC,COUNTS   ASC);



CREATE TABLE HD_HOUS_SELLDETAIL_ADJUST
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019260 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019261 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019262 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019263 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019264 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019265 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019266 NOT NULL ,
	AGREEDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019267 NOT NULL ,
	LANDAMT              FLOAT(126) CONSTRAINT SYS_C0019268 NOT NULL ,
	BUILDAMT             FLOAT(126) CONSTRAINT SYS_C0019269 NOT NULL ,
	VATAMT               FLOAT(126) CONSTRAINT SYS_C0019270 NOT NULL ,
	BUNAMT               FLOAT(126) NULL ,
	DC_YN                VARCHAR2(1 BYTE) NULL ,
	AC_YN                VARCHAR2(1 BYTE) NULL ,
	PERPECTTAG           VARCHAR2(1 BYTE) DEFAULT  'N'  CONSTRAINT SYS_C0019271 NOT NULL ,
	RECEIPTAMT           FLOAT(126) CONSTRAINT SYS_C0019272 NOT NULL ,
	DISTRIBUTE_RATE      NUMBER(4,1) NULL ,
	SLIPDT               VARCHAR2(8 BYTE) NULL ,
	SLIPSEQ              NUMBER(5) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	MANAGEAMT            FLOAT(126) DEFAULT  0  NULL 
);



ALTER TABLE HD_HOUS_SELLDETAIL_ADJUST
	ADD CONSTRAINT  SYS_C0019273 PRIMARY KEY (CUST_CODE,SEQ,COUNTS);



CREATE  INDEX XIE1HD_HOUS_SELLDETAIL_ADJUST ON HD_HOUS_SELLDETAIL_ADJUST
(DEPT_CODE   ASC,HOUSETAG   ASC,BUILDNO   ASC,HOUSENO   ASC,COUNTS   ASC);



CREATE TABLE HD_HOUS_SELLDETAIL_LOG
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025609 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025610 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0025611 NOT NULL ,
	WRITETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025612 NOT NULL ,
	WRITETIME            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025613 NOT NULL ,
	WRITESEQ             NUMBER(5) CONSTRAINT SYS_C0025614 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025615 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025616 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025617 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025618 NOT NULL ,
	AGREEDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025619 NOT NULL ,
	LANDAMT              FLOAT(126) CONSTRAINT SYS_C0025620 NOT NULL ,
	BUILDAMT             FLOAT(126) CONSTRAINT SYS_C0025621 NOT NULL ,
	VATAMT               FLOAT(126) CONSTRAINT SYS_C0025622 NOT NULL ,
	BUNAMT               FLOAT(126) NULL ,
	DC_YN                VARCHAR2(1 BYTE) NULL ,
	AC_YN                VARCHAR2(1 BYTE) NULL ,
	PERPECTTAG           VARCHAR2(1 BYTE) DEFAULT  'N'  CONSTRAINT SYS_C0025623 NOT NULL ,
	RECEIPTAMT           FLOAT(126) CONSTRAINT SYS_C0025624 NOT NULL ,
	DISTRIBUTE_RATE      NUMBER(4,1) NULL ,
	SLIPDT               VARCHAR2(8 BYTE) NULL ,
	SLIPSEQ              NUMBER(5) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	MANAGEAMT            FLOAT(126) DEFAULT  0  NULL 
);



ALTER TABLE HD_HOUS_SELLDETAIL_LOG
	ADD CONSTRAINT  SYS_C0025625 PRIMARY KEY (CUST_CODE,SEQ,COUNTS,WRITETAG,WRITETIME,WRITESEQ);



CREATE  INDEX XIE1HD_HOUS_SELLDETAIL_LOG ON HD_HOUS_SELLDETAIL_LOG
(DEPT_CODE   ASC,HOUSETAG   ASC,BUILDNO   ASC,HOUSENO   ASC,COUNTS   ASC);



CREATE TABLE HD_HOUS_SELLDETAIL_LOG
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019274 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019275 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019276 NOT NULL ,
	WRITETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019277 NOT NULL ,
	WRITETIME            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019278 NOT NULL ,
	WRITESEQ             NUMBER(5) CONSTRAINT SYS_C0019279 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019280 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019281 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019282 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019283 NOT NULL ,
	AGREEDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019284 NOT NULL ,
	LANDAMT              FLOAT(126) CONSTRAINT SYS_C0019285 NOT NULL ,
	BUILDAMT             FLOAT(126) CONSTRAINT SYS_C0019286 NOT NULL ,
	VATAMT               FLOAT(126) CONSTRAINT SYS_C0019287 NOT NULL ,
	BUNAMT               FLOAT(126) NULL ,
	DC_YN                VARCHAR2(1 BYTE) NULL ,
	AC_YN                VARCHAR2(1 BYTE) NULL ,
	PERPECTTAG           VARCHAR2(1 BYTE) DEFAULT  'N'  CONSTRAINT SYS_C0019288 NOT NULL ,
	RECEIPTAMT           FLOAT(126) CONSTRAINT SYS_C0019289 NOT NULL ,
	DISTRIBUTE_RATE      NUMBER(4,1) NULL ,
	SLIPDT               VARCHAR2(8 BYTE) NULL ,
	SLIPSEQ              NUMBER(5) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	MANAGEAMT            FLOAT(126) DEFAULT  0  NULL 
);



ALTER TABLE HD_HOUS_SELLDETAIL_LOG
	ADD CONSTRAINT  SYS_C0019290 PRIMARY KEY (CUST_CODE,SEQ,COUNTS,WRITETAG,WRITETIME,WRITESEQ);



CREATE  INDEX XIE1HD_HOUS_SELLDETAIL_LOG ON HD_HOUS_SELLDETAIL_LOG
(DEPT_CODE   ASC,HOUSETAG   ASC,BUILDNO   ASC,HOUSENO   ASC,COUNTS   ASC);



CREATE TABLE HD_HOUS_SELLDETAIL_TEMP
(
	SEQ_NUM              NUMBER(18) CONSTRAINT SYS_C0025626 NOT NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025627 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025628 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0025629 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025630 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025631 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025632 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025633 NOT NULL ,
	AGREEDATE            VARCHAR2(8 BYTE) NULL ,
	LANDAMT              FLOAT(126) NULL ,
	BUILDAMT             FLOAT(126) NULL ,
	VATAMT               FLOAT(126) NULL ,
	BUNAMT               FLOAT(126) NULL ,
	DC_YN                VARCHAR2(1 BYTE) NULL ,
	AC_YN                VARCHAR2(1 BYTE) NULL ,
	PERPECTTAG           VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	RECEIPTAMT           FLOAT(126) NULL ,
	DISTRIBUTE_RATE      NUMBER(4,1) NULL ,
	SLIPDT               VARCHAR2(8 BYTE) NULL ,
	SLIPSEQ              NUMBER(5) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	MANAGEAMT            FLOAT(126) DEFAULT  0  NULL 
);



ALTER TABLE HD_HOUS_SELLDETAIL_TEMP
	ADD CONSTRAINT  SYS_C0025634 PRIMARY KEY (SEQ_NUM,CUST_CODE,SEQ,COUNTS);



CREATE  INDEX XIE1HD_HOUS_SELLDETAIL_TEMP ON HD_HOUS_SELLDETAIL_TEMP
(DEPT_CODE   ASC,HOUSETAG   ASC,BUILDNO   ASC,HOUSENO   ASC,COUNTS   ASC);



CREATE TABLE HD_HOUS_SELLDETAIL_TEMP
(
	SEQ_NUM              NUMBER(18) CONSTRAINT SYS_C0019291 NOT NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019292 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019293 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019294 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019295 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019296 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019297 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019298 NOT NULL ,
	AGREEDATE            VARCHAR2(8 BYTE) NULL ,
	LANDAMT              FLOAT(126) NULL ,
	BUILDAMT             FLOAT(126) NULL ,
	VATAMT               FLOAT(126) NULL ,
	BUNAMT               FLOAT(126) NULL ,
	DC_YN                VARCHAR2(1 BYTE) NULL ,
	AC_YN                VARCHAR2(1 BYTE) NULL ,
	PERPECTTAG           VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	RECEIPTAMT           FLOAT(126) NULL ,
	DISTRIBUTE_RATE      NUMBER(4,1) NULL ,
	SLIPDT               VARCHAR2(8 BYTE) NULL ,
	SLIPSEQ              NUMBER(5) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	MANAGEAMT            FLOAT(126) DEFAULT  0  NULL 
);



ALTER TABLE HD_HOUS_SELLDETAIL_TEMP
	ADD CONSTRAINT  SYS_C0019299 PRIMARY KEY (SEQ_NUM,CUST_CODE,SEQ,COUNTS);



CREATE  INDEX XIE1HD_HOUS_SELLDETAIL_TEMP ON HD_HOUS_SELLDETAIL_TEMP
(DEPT_CODE   ASC,HOUSETAG   ASC,BUILDNO   ASC,HOUSENO   ASC,COUNTS   ASC);



CREATE TABLE HD_HOUS_SLIP_MAGAM
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025668 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025669 NOT NULL ,
	MAGAMDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025670 NOT NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_SLIP_MAGAM
	ADD CONSTRAINT  SYS_C0025671 PRIMARY KEY (DEPT_CODE,HOUSETAG);



CREATE TABLE HD_HOUS_SLIP_MAGAM
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019333 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019334 NOT NULL ,
	MAGAMDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019335 NOT NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_SLIP_MAGAM
	ADD CONSTRAINT  SYS_C0019336 PRIMARY KEY (DEPT_CODE,HOUSETAG);



CREATE TABLE HD_HOUS_SUBSCRIBE
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025672 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025673 NOT NULL ,
	SEQ                  NUMBER(10) CONSTRAINT SYS_C0025674 NOT NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) NULL ,
	CUST_SEQ             NUMBER(10) NULL ,
	CUST_NAME            VARCHAR2(100 BYTE) NULL ,
	SUBSCRIBE_TAG        VARCHAR2(1 BYTE) NULL ,
	SUBSCRIBE_DATE       VARCHAR2(8 BYTE) NULL ,
	SUBSCRIBE_AMT        NUMBER(15) NULL ,
	WIN_DATE             VARCHAR2(8 BYTE) NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	RETURN_TAG           VARCHAR2(1 BYTE) NULL ,
	RETURN_DATE          VARCHAR2(8 BYTE) NULL ,
	RETURN_AMT           NUMBER(15) NULL ,
	VIR_YN               VARCHAR2(1 BYTE) NULL ,
	VDEPOSIT_NO          VARCHAR2(50 BYTE) NULL ,
	INCOM_YN             VARCHAR2(1 BYTE) NULL ,
	CONT_NO              VARCHAR2(10 BYTE) NULL ,
	REGIST_YN            VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	ERR_TEXT             VARCHAR2(200 BYTE) NULL ,
	ACT_YN               VARCHAR2(1 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL 
);



CREATE UNIQUE INDEX XPKHD_REFER_SQUAREDETAIL ON HD_HOUS_SUBSCRIBE
(DEPT_CODE   ASC,HOUSETAG   ASC,SEQ   ASC);



ALTER TABLE HD_HOUS_SUBSCRIBE
	ADD CONSTRAINT  SYS_C0025675 PRIMARY KEY (DEPT_CODE,HOUSETAG,SEQ);



CREATE TABLE HD_HOUS_SUBSCRIBE
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019337 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019338 NOT NULL ,
	SEQ                  NUMBER(10) CONSTRAINT SYS_C0019339 NOT NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) NULL ,
	CUST_SEQ             NUMBER(10) NULL ,
	CUST_NAME            VARCHAR2(100 BYTE) NULL ,
	SUBSCRIBE_TAG        VARCHAR2(1 BYTE) NULL ,
	SUBSCRIBE_DATE       VARCHAR2(8 BYTE) NULL ,
	SUBSCRIBE_AMT        NUMBER(15) NULL ,
	WIN_DATE             VARCHAR2(8 BYTE) NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	RETURN_TAG           VARCHAR2(1 BYTE) NULL ,
	RETURN_DATE          VARCHAR2(8 BYTE) NULL ,
	RETURN_AMT           NUMBER(15) NULL ,
	VIR_YN               VARCHAR2(1 BYTE) NULL ,
	VDEPOSIT_NO          VARCHAR2(50 BYTE) NULL ,
	INCOM_YN             VARCHAR2(1 BYTE) NULL ,
	CONT_NO              VARCHAR2(10 BYTE) NULL ,
	REGIST_YN            VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	ERR_TEXT             VARCHAR2(200 BYTE) NULL ,
	ACT_YN               VARCHAR2(1 BYTE) NULL 
);



CREATE UNIQUE INDEX XPKHD_REFER_SQUAREDETAIL ON HD_HOUS_SUBSCRIBE
(DEPT_CODE   ASC,HOUSETAG   ASC,SEQ   ASC);



CREATE TABLE HD_HOUS_SUBSCRIBE_TXTUP
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025676 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025677 NOT NULL ,
	SEQ                  NUMBER(10) CONSTRAINT SYS_C0025678 NOT NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) NULL ,
	CUST_NAME            VARCHAR2(100 BYTE) NULL ,
	SUBSCRIBE_DATE       VARCHAR2(8 BYTE) NULL ,
	SUBSCRIBE_AMT        NUMBER(15) NULL ,
	SUB_YN               VARCHAR2(1 BYTE) NULL ,
	ERR_MESSAGE          VARCHAR2(100 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_SUBSCRIBE_TXTUP
	ADD CONSTRAINT  SYS_C0025679 PRIMARY KEY (DEPT_CODE,HOUSETAG,SEQ);



CREATE TABLE HD_HOUS_SUBSCRIBE_TXTUP
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019340 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019341 NOT NULL ,
	SEQ                  NUMBER(10) CONSTRAINT SYS_C0019342 NOT NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) NULL ,
	CUST_NAME            VARCHAR2(100 BYTE) NULL ,
	SUBSCRIBE_DATE       VARCHAR2(8 BYTE) NULL ,
	SUBSCRIBE_AMT        NUMBER(15) NULL ,
	SUB_YN               VARCHAR2(1 BYTE) NULL ,
	ERR_MESSAGE          VARCHAR2(100 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_SUBSCRIBE_TXTUP
	ADD CONSTRAINT  SYS_C0019343 PRIMARY KEY (DEPT_CODE,HOUSETAG,SEQ);



CREATE TABLE HD_HOUS_SUPPLY
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025680 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025681 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025682 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025683 NOT NULL ,
	SQUARE               NUMBER(8,4) NULL ,
	TYPE                 VARCHAR2(4 BYTE) NULL ,
	CLASS                VARCHAR2(1 BYTE) NULL ,
	OPTIONCODE           VARCHAR2(2 BYTE) DEFAULT  '00'  NULL ,
	VATTAG               VARCHAR2(1 BYTE) NULL ,
	EXCLUSIVEAREA        NUMBER(12,4) NULL ,
	COMMONAREA           NUMBER(12,4) NULL ,
	ETCCOMMONAREA        NUMBER(12,4) NULL ,
	PARKINGAREA          NUMBER(12,4) NULL ,
	SERVICEAREA          NUMBER(12,4) NULL ,
	SITEAREA             NUMBER(12,4) NULL ,
	FLOOR                VARCHAR2(4 BYTE) NULL ,
	GUBUN                VARCHAR2(2 BYTE) NULL ,
	CATEGORY_NAME        VARCHAR2(40 BYTE) NULL ,
	CONTRACTYESNO        VARCHAR2(1 BYTE) DEFAULT  'N'  CONSTRAINT SYS_C0025684 NOT NULL ,
	VIRDEPOSIT           VARCHAR2(20 BYTE) NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) NULL ,
	BANK_NAME            VARCHAR2(30 BYTE) NULL ,
	USE_YN               VARCHAR2(1 BYTE) NULL ,
	RENT_TAG             VARCHAR2(2 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	PRTSQUARE            NUMBER(8,4) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	PREDISAMT            NUMBER(15) NULL ,
	VIRDEPOSIT2          VARCHAR2(20 BYTE) NULL 
);



ALTER TABLE HD_HOUS_SUPPLY
	ADD CONSTRAINT  SYS_C0025685 PRIMARY KEY (DEPT_CODE,HOUSETAG,BUILDNO,HOUSENO);



CREATE UNIQUE INDEX XAK1HD_HOUS_SUPPLY ON HD_HOUS_SUPPLY
(VIRDEPOSIT   ASC,BANK_CODE   ASC);



CREATE TABLE HD_HOUS_SUPPLY
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019344 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019345 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019346 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019347 NOT NULL ,
	SQUARE               NUMBER(8,4) NULL ,
	TYPE                 VARCHAR2(4 BYTE) NULL ,
	CLASS                VARCHAR2(1 BYTE) NULL ,
	OPTIONCODE           VARCHAR2(2 BYTE) DEFAULT  '00'  NULL ,
	VATTAG               VARCHAR2(1 BYTE) NULL ,
	EXCLUSIVEAREA        NUMBER(12,4) NULL ,
	COMMONAREA           NUMBER(12,4) NULL ,
	ETCCOMMONAREA        NUMBER(12,4) NULL ,
	PARKINGAREA          NUMBER(12,4) NULL ,
	SERVICEAREA          NUMBER(12,4) NULL ,
	SITEAREA             NUMBER(12,4) NULL ,
	FLOOR                VARCHAR2(4 BYTE) NULL ,
	GUBUN                VARCHAR2(2 BYTE) NULL ,
	CATEGORY_NAME        VARCHAR2(40 BYTE) NULL ,
	CONTRACTYESNO        VARCHAR2(1 BYTE) DEFAULT  'N'  CONSTRAINT SYS_C0019348 NOT NULL ,
	VIRDEPOSIT           VARCHAR2(20 BYTE) NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) NULL ,
	BANK_NAME            VARCHAR2(30 BYTE) NULL ,
	USE_YN               VARCHAR2(1 BYTE) NULL ,
	RENT_TAG             VARCHAR2(2 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	PRTSQUARE            NUMBER(8,4) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	PREDISAMT            NUMBER(15) NULL ,
	VIRDEPOSIT2          VARCHAR2(20 BYTE) NULL 
);



ALTER TABLE HD_HOUS_SUPPLY
	ADD CONSTRAINT  SYS_C0019349 PRIMARY KEY (DEPT_CODE,HOUSETAG,BUILDNO,HOUSENO);



CREATE UNIQUE INDEX XAK1HD_HOUS_SUPPLY ON HD_HOUS_SUPPLY
(VIRDEPOSIT   ASC,BANK_CODE   ASC);



CREATE TABLE HD_HOUS_SUPPLY_CHANGE
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025686 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025687 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025688 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025689 NOT NULL ,
	CHANGE_BUILDNO       VARCHAR2(10 BYTE) NULL ,
	CHANGE_HOUSENO       VARCHAR2(10 BYTE) NULL ,
	SQUARE               NUMBER(8,4) NULL ,
	TYPE                 VARCHAR2(4 BYTE) NULL ,
	CLASS                VARCHAR2(1 BYTE) NULL ,
	OPTIONCODE           VARCHAR2(2 BYTE) DEFAULT  '00'  NULL ,
	VATTAG               VARCHAR2(1 BYTE) NULL ,
	EXCLUSIVEAREA        NUMBER(12,4) NULL ,
	COMMONAREA           NUMBER(12,4) NULL ,
	ETCCOMMONAREA        NUMBER(12,4) NULL ,
	PARKINGAREA          NUMBER(12,4) NULL ,
	SERVICEAREA          NUMBER(12,4) NULL ,
	SITEAREA             NUMBER(12,4) NULL ,
	FLOOR                VARCHAR2(4 BYTE) NULL ,
	GUBUN                VARCHAR2(2 BYTE) NULL ,
	CATEGORY_NAME        VARCHAR2(40 BYTE) NULL ,
	CONTRACTYESNO        VARCHAR2(1 BYTE) DEFAULT  'N'  CONSTRAINT SYS_C0025690 NOT NULL ,
	VIRDEPOSIT           VARCHAR2(20 BYTE) NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) NULL ,
	BANK_NAME            VARCHAR2(30 BYTE) NULL ,
	USE_YN               VARCHAR2(1 BYTE) NULL ,
	RENT_TAG             VARCHAR2(2 BYTE) NULL ,
	PRTSQUARE            NUMBER(8,4) NULL ,
	PREDISAMT            NUMBER(15) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	VIRDEPOSIT2          VARCHAR2(20 BYTE) NULL 
);



ALTER TABLE HD_HOUS_SUPPLY_CHANGE
	ADD CONSTRAINT  SYS_C0025691 PRIMARY KEY (DEPT_CODE,HOUSETAG,BUILDNO,HOUSENO);



CREATE UNIQUE INDEX XAK1HD_HOUS_SUPPLY_CHANGE ON HD_HOUS_SUPPLY_CHANGE
(VIRDEPOSIT   ASC,BANK_CODE   ASC);



CREATE TABLE HD_HOUS_SUPPLY_CHANGE
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019350 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019351 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019352 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019353 NOT NULL ,
	CHANGE_BUILDNO       VARCHAR2(10 BYTE) NULL ,
	CHANGE_HOUSENO       VARCHAR2(10 BYTE) NULL ,
	SQUARE               NUMBER(8,4) NULL ,
	TYPE                 VARCHAR2(4 BYTE) NULL ,
	CLASS                VARCHAR2(1 BYTE) NULL ,
	OPTIONCODE           VARCHAR2(2 BYTE) DEFAULT  '00'  NULL ,
	VATTAG               VARCHAR2(1 BYTE) NULL ,
	EXCLUSIVEAREA        NUMBER(12,4) NULL ,
	COMMONAREA           NUMBER(12,4) NULL ,
	ETCCOMMONAREA        NUMBER(12,4) NULL ,
	PARKINGAREA          NUMBER(12,4) NULL ,
	SERVICEAREA          NUMBER(12,4) NULL ,
	SITEAREA             NUMBER(12,4) NULL ,
	FLOOR                VARCHAR2(4 BYTE) NULL ,
	GUBUN                VARCHAR2(2 BYTE) NULL ,
	CATEGORY_NAME        VARCHAR2(40 BYTE) NULL ,
	CONTRACTYESNO        VARCHAR2(1 BYTE) DEFAULT  'N'  CONSTRAINT SYS_C0019354 NOT NULL ,
	VIRDEPOSIT           VARCHAR2(20 BYTE) NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) NULL ,
	BANK_NAME            VARCHAR2(30 BYTE) NULL ,
	USE_YN               VARCHAR2(1 BYTE) NULL ,
	RENT_TAG             VARCHAR2(2 BYTE) NULL ,
	PRTSQUARE            NUMBER(8,4) NULL ,
	PREDISAMT            NUMBER(15) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	VIRDEPOSIT2          VARCHAR2(20 BYTE) NULL 
);



ALTER TABLE HD_HOUS_SUPPLY_CHANGE
	ADD CONSTRAINT  SYS_C0019355 PRIMARY KEY (DEPT_CODE,HOUSETAG,BUILDNO,HOUSENO);



CREATE UNIQUE INDEX XAK1HD_HOUS_SUPPLY_CHANGE ON HD_HOUS_SUPPLY_CHANGE
(VIRDEPOSIT   ASC,BANK_CODE   ASC);



CREATE TABLE HD_HOUS_SUPPLY_CONV
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025692 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025693 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025694 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025695 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025696 NOT NULL ,
	SQUARE               NUMBER(8,4) NULL ,
	TYPE                 VARCHAR2(4 BYTE) NULL ,
	CLASS                VARCHAR2(1 BYTE) NULL ,
	OPTIONCODE           VARCHAR2(2 BYTE) DEFAULT  '00'  NULL ,
	CONTRACTYESNO        VARCHAR2(1 BYTE) DEFAULT  'N'  CONSTRAINT SYS_C0025697 NOT NULL 
);



ALTER TABLE HD_HOUS_SUPPLY_CONV
	ADD CONSTRAINT  SYS_C0025698 PRIMARY KEY (DEPT_CODE,HOUSETAG,SEQ);



CREATE TABLE HD_HOUS_SUPPLY_CONV
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019356 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019357 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019358 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019359 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019360 NOT NULL ,
	SQUARE               NUMBER(8,4) NULL ,
	TYPE                 VARCHAR2(4 BYTE) NULL ,
	CLASS                VARCHAR2(1 BYTE) NULL ,
	OPTIONCODE           VARCHAR2(2 BYTE) DEFAULT  '00'  NULL ,
	CONTRACTYESNO        VARCHAR2(1 BYTE) DEFAULT  'N'  CONSTRAINT SYS_C0019361 NOT NULL 
);



ALTER TABLE HD_HOUS_SUPPLY_CONV
	ADD CONSTRAINT  SYS_C0019362 PRIMARY KEY (DEPT_CODE,HOUSETAG,SEQ);



CREATE TABLE HD_HOUS_SUPPLY_HIST
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025699 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025700 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025701 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025702 NOT NULL ,
	HIST_DATE            DATE CONSTRAINT SYS_C0025703 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025704 NOT NULL ,
	SQUARE               NUMBER(8,4) NULL ,
	TYPE                 VARCHAR2(4 BYTE) NULL ,
	CLASS                VARCHAR2(1 BYTE) NULL ,
	OPTIONCODE           VARCHAR2(2 BYTE) DEFAULT  '00'  NULL ,
	VATTAG               VARCHAR2(1 BYTE) NULL ,
	EXCLUSIVEAREA        NUMBER(12,4) NULL ,
	COMMONAREA           NUMBER(12,4) NULL ,
	ETCCOMMONAREA        NUMBER(12,4) NULL ,
	PARKINGAREA          NUMBER(12,4) NULL ,
	SERVICEAREA          NUMBER(12,4) NULL ,
	SITEAREA             NUMBER(12,4) NULL ,
	FLOOR                VARCHAR2(4 BYTE) NULL ,
	GUBUN                VARCHAR2(2 BYTE) NULL ,
	CATEGORY_NAME        VARCHAR2(40 BYTE) NULL ,
	CONTRACTYESNO        VARCHAR2(1 BYTE) DEFAULT  'N'  CONSTRAINT SYS_C0025705 NOT NULL ,
	VIRDEPOSIT           VARCHAR2(20 BYTE) NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) NULL ,
	BANK_NAME            VARCHAR2(30 BYTE) NULL ,
	USE_YN               VARCHAR2(1 BYTE) NULL ,
	RENT_TAG             VARCHAR2(2 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	PRTSQUARE            NUMBER(8,4) NULL ,
	TRI_TAG              VARCHAR2(1 BYTE) NULL ,
	PREDISAMT            NUMBER(15) NULL ,
	VIRDEPOSIT2          VARCHAR2(20 BYTE) NULL 
);



ALTER TABLE HD_HOUS_SUPPLY_HIST
	ADD CONSTRAINT  SYS_C0025706 PRIMARY KEY (DEPT_CODE,HOUSETAG,BUILDNO,HOUSENO,HIST_DATE,SEQ);



CREATE TABLE HD_HOUS_SUPPLY_HIST
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019363 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019364 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019365 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019366 NOT NULL ,
	HIST_DATE            DATE CONSTRAINT SYS_C0019367 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019368 NOT NULL ,
	SQUARE               NUMBER(8,4) NULL ,
	TYPE                 VARCHAR2(4 BYTE) NULL ,
	CLASS                VARCHAR2(1 BYTE) NULL ,
	OPTIONCODE           VARCHAR2(2 BYTE) DEFAULT  '00'  NULL ,
	VATTAG               VARCHAR2(1 BYTE) NULL ,
	EXCLUSIVEAREA        NUMBER(12,4) NULL ,
	COMMONAREA           NUMBER(12,4) NULL ,
	ETCCOMMONAREA        NUMBER(12,4) NULL ,
	PARKINGAREA          NUMBER(12,4) NULL ,
	SERVICEAREA          NUMBER(12,4) NULL ,
	SITEAREA             NUMBER(12,4) NULL ,
	FLOOR                VARCHAR2(4 BYTE) NULL ,
	GUBUN                VARCHAR2(2 BYTE) NULL ,
	CATEGORY_NAME        VARCHAR2(40 BYTE) NULL ,
	CONTRACTYESNO        VARCHAR2(1 BYTE) DEFAULT  'N'  CONSTRAINT SYS_C0019369 NOT NULL ,
	VIRDEPOSIT           VARCHAR2(20 BYTE) NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) NULL ,
	BANK_NAME            VARCHAR2(30 BYTE) NULL ,
	USE_YN               VARCHAR2(1 BYTE) NULL ,
	RENT_TAG             VARCHAR2(2 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	PRTSQUARE            NUMBER(8,4) NULL ,
	TRI_TAG              VARCHAR2(1 BYTE) NULL ,
	PREDISAMT            NUMBER(15) NULL ,
	VIRDEPOSIT2          VARCHAR2(20 BYTE) NULL 
);



ALTER TABLE HD_HOUS_SUPPLY_HIST
	ADD CONSTRAINT  SYS_C0019370 PRIMARY KEY (DEPT_CODE,HOUSETAG,BUILDNO,HOUSENO,HIST_DATE,SEQ);



CREATE TABLE HD_HOUS_UNION
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025707 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025708 NOT NULL ,
	UNION_CUSTCODE       VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025709 NOT NULL ,
	UNION_CUSTNM         VARCHAR2(50 BYTE) NULL ,
	REG_DATE             VARCHAR2(8 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_UNION
	ADD CONSTRAINT  SYS_C0025710 PRIMARY KEY (CUST_CODE,SEQ,UNION_CUSTCODE);



CREATE TABLE HD_HOUS_UNION
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019371 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019372 NOT NULL ,
	UNION_CUSTCODE       VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019373 NOT NULL ,
	UNION_CUSTNM         VARCHAR2(50 BYTE) NULL ,
	REG_DATE             VARCHAR2(8 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_UNION
	ADD CONSTRAINT  SYS_C0019374 PRIMARY KEY (CUST_CODE,SEQ,UNION_CUSTCODE);



CREATE TABLE HD_HOUS_VIRTURE
(
	TROCCORG_CD          VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025711 NOT NULL ,
	TR_IL                VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025712 NOT NULL ,
	CPORG_CD             VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025713 NOT NULL ,
	DEPTR_SEQ            VARCHAR2(7 BYTE) CONSTRAINT SYS_C0025714 NOT NULL ,
	VA_NO                VARCHAR2(16 BYTE) NULL ,
	DEP_AMT              NUMBER(13) NULL ,
	DEPT_ST              CHAR(1 BYTE) NULL ,
	PROCESSTAG           VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) NULL ,
	SEQ                  FLOAT(126) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_VIRTURE
	ADD CONSTRAINT  SYS_C0025715 PRIMARY KEY (TROCCORG_CD,TR_IL,CPORG_CD,DEPTR_SEQ);



CREATE TABLE HD_HOUS_VIRTURE
(
	TROCCORG_CD          VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019375 NOT NULL ,
	TR_IL                VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019376 NOT NULL ,
	CPORG_CD             VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019377 NOT NULL ,
	DEPTR_SEQ            VARCHAR2(7 BYTE) CONSTRAINT SYS_C0019378 NOT NULL ,
	VA_NO                VARCHAR2(16 BYTE) NULL ,
	DEP_AMT              NUMBER(13) NULL ,
	DEPT_ST              CHAR(1 BYTE) NULL ,
	PROCESSTAG           VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) NULL ,
	SEQ                  FLOAT(126) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_HOUS_VIRTURE
	ADD CONSTRAINT  SYS_C0019379 PRIMARY KEY (TROCCORG_CD,TR_IL,CPORG_CD,DEPTR_SEQ);



CREATE TABLE HD_LEASE_BONDSEIZURE
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025716 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025717 NOT NULL ,
	RENT_YN              VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025718 NOT NULL ,
	BONDSEQ              NUMBER(5) CONSTRAINT SYS_C0025719 NOT NULL ,
	SEIZURE_NO           VARCHAR2(50 BYTE) NULL ,
	SEIZOR               VARCHAR2(50 BYTE) NULL ,
	SEIZUREAMT           NUMBER(15) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	SEIZURE_NAME         VARCHAR2(100 BYTE) NULL ,
	COURT                VARCHAR2(50 BYTE) NULL ,
	DEBT                 VARCHAR2(50 BYTE) NULL ,
	DEBT3                VARCHAR2(50 BYTE) NULL ,
	REQUEST_BOND         VARCHAR2(50 BYTE) NULL ,
	REQUEST_CONTENT      VARCHAR2(100 BYTE) NULL ,
	DECISION_DATE        VARCHAR2(8 BYTE) NULL ,
	RECEIPT_DATE         VARCHAR2(8 BYTE) NULL ,
	CANCEL_YN            VARCHAR2(1 BYTE) NULL ,
	CANCEL_DATE          VARCHAR2(8 BYTE) NULL ,
	SEIZURE_CODE         VARCHAR2(20 BYTE) NULL ,
	DEBT_CODE            VARCHAR2(20 BYTE) NULL ,
	DEBT3_CODE           VARCHAR2(20 BYTE) NULL ,
	DEBT_RELATION        VARCHAR2(20 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_LEASE_BONDSEIZURE
	ADD CONSTRAINT  SYS_C0025720 PRIMARY KEY (CUST_CODE,SEQ,RENT_YN,BONDSEQ);



CREATE TABLE HD_LEASE_BONDSEIZURE
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019380 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019381 NOT NULL ,
	RENT_YN              VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019382 NOT NULL ,
	BONDSEQ              NUMBER(5) CONSTRAINT SYS_C0019383 NOT NULL ,
	SEIZURE_NO           VARCHAR2(50 BYTE) NULL ,
	SEIZOR               VARCHAR2(50 BYTE) NULL ,
	SEIZUREAMT           NUMBER(15) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	SEIZURE_NAME         VARCHAR2(100 BYTE) NULL ,
	COURT                VARCHAR2(50 BYTE) NULL ,
	DEBT                 VARCHAR2(50 BYTE) NULL ,
	DEBT3                VARCHAR2(50 BYTE) NULL ,
	REQUEST_BOND         VARCHAR2(50 BYTE) NULL ,
	REQUEST_CONTENT      VARCHAR2(100 BYTE) NULL ,
	DECISION_DATE        VARCHAR2(8 BYTE) NULL ,
	RECEIPT_DATE         VARCHAR2(8 BYTE) NULL ,
	CANCEL_YN            VARCHAR2(1 BYTE) NULL ,
	CANCEL_DATE          VARCHAR2(8 BYTE) NULL ,
	SEIZURE_CODE         VARCHAR2(20 BYTE) NULL ,
	DEBT_CODE            VARCHAR2(20 BYTE) NULL ,
	DEBT3_CODE           VARCHAR2(20 BYTE) NULL ,
	DEBT_RELATION        VARCHAR2(20 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_LEASE_BONDSEIZURE
	ADD CONSTRAINT  SYS_C0019384 PRIMARY KEY (CUST_CODE,SEQ,RENT_YN,BONDSEQ);



CREATE TABLE HD_REFER_GIFT
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025721 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025722 NOT NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025723 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025724 NOT NULL ,
	GIFTCODE             VARCHAR2(4 BYTE) CONSTRAINT SYS_C0025725 NOT NULL ,
	GIFTGIVEDATE         VARCHAR2(8 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_REFER_GIFT
	ADD CONSTRAINT  SYS_C0025726 PRIMARY KEY (DEPT_CODE,HOUSETAG,CUST_CODE,SEQ,GIFTCODE);



CREATE TABLE HD_REFER_GIFT
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019385 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019386 NOT NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019387 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019388 NOT NULL ,
	GIFTCODE             VARCHAR2(4 BYTE) CONSTRAINT SYS_C0019389 NOT NULL ,
	GIFTGIVEDATE         VARCHAR2(8 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_REFER_GIFT
	ADD CONSTRAINT  SYS_C0019390 PRIMARY KEY (DEPT_CODE,HOUSETAG,CUST_CODE,SEQ,GIFTCODE);



CREATE TABLE HD_REFER_HOLIDAY
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025727 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025728 NOT NULL ,
	RATE_TAG             VARCHAR2(2 BYTE) CONSTRAINT SYS_C0025729 NOT NULL ,
	AD_TAG               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0025730 NOT NULL ,
	HOLIDAY              VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025731 NOT NULL ,
	GONG_DAYS            NUMBER(5) NULL ,
	PTAG                 VARCHAR2(2 BYTE) NULL ,
	REMARK               VARCHAR2(50 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_REFER_HOLIDAY
	ADD CONSTRAINT  SYS_C0025732 PRIMARY KEY (DEPT_CODE,HOUSETAG,RATE_TAG,AD_TAG,HOLIDAY);



CREATE TABLE HD_REFER_HOLIDAY
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019391 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019392 NOT NULL ,
	RATE_TAG             VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019393 NOT NULL ,
	AD_TAG               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019394 NOT NULL ,
	HOLIDAY              VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019395 NOT NULL ,
	GONG_DAYS            NUMBER(5) NULL ,
	PTAG                 VARCHAR2(2 BYTE) NULL ,
	REMARK               VARCHAR2(50 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_REFER_HOLIDAY
	ADD CONSTRAINT  SYS_C0019396 PRIMARY KEY (DEPT_CODE,HOUSETAG,RATE_TAG,AD_TAG,HOLIDAY);



CREATE TABLE HD_REFER_INCOMEBILL
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025733 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025734 NOT NULL ,
	BILL_TAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025735 NOT NULL ,
	DEPOSIT_NO           VARCHAR2(20 BYTE) NULL ,
	DEPOSITOR            VARCHAR2(50 BYTE) NULL ,
	PAY_WAY              VARCHAR2(100 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_REFER_INCOMEBILL
	ADD CONSTRAINT  SYS_C0025736 PRIMARY KEY (DEPT_CODE,HOUSETAG,BILL_TAG);



CREATE TABLE HD_REFER_INCOMEBILL
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019397 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019398 NOT NULL ,
	BILL_TAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019399 NOT NULL ,
	DEPOSIT_NO           VARCHAR2(20 BYTE) NULL ,
	DEPOSITOR            VARCHAR2(20 BYTE) NULL ,
	PAY_WAY              VARCHAR2(100 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_REFER_INCOMEBILL
	ADD CONSTRAINT  SYS_C0019400 PRIMARY KEY (DEPT_CODE,HOUSETAG,BILL_TAG);



CREATE TABLE HD_REFER_INCOMEDATE
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025737 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025738 NOT NULL ,
	DEPOSIT_NO           VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025739 NOT NULL ,
	STARTDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025740 NOT NULL ,
	Q8050TAG             VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_REFER_INCOMEDATE
	ADD CONSTRAINT  SYS_C0025741 PRIMARY KEY (DEPT_CODE,HOUSETAG,DEPOSIT_NO);



CREATE TABLE HD_REFER_INCOMEDATE
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019401 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019402 NOT NULL ,
	DEPOSIT_NO           VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019403 NOT NULL ,
	STARTDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019404 NOT NULL ,
	Q8050TAG             VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_REFER_INCOMEDATE
	ADD CONSTRAINT  SYS_C0019405 PRIMARY KEY (DEPT_CODE,HOUSETAG,DEPOSIT_NO);



CREATE TABLE HD_REFER_INCOMEREMARK
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025742 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025743 NOT NULL ,
	BILL_TAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025744 NOT NULL ,
	SEQ                  NUMBER(3) CONSTRAINT SYS_C0025745 NOT NULL ,
	REMARK               VARCHAR2(100 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_REFER_INCOMEREMARK
	ADD CONSTRAINT  SYS_C0025746 PRIMARY KEY (DEPT_CODE,HOUSETAG,BILL_TAG,SEQ);



CREATE TABLE HD_REFER_INCOMEREMARK
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019406 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019407 NOT NULL ,
	BILL_TAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019408 NOT NULL ,
	SEQ                  NUMBER(3) CONSTRAINT SYS_C0019409 NOT NULL ,
	REMARK               VARCHAR2(100 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_REFER_INCOMEREMARK
	ADD CONSTRAINT  SYS_C0019410 PRIMARY KEY (DEPT_CODE,HOUSETAG,BILL_TAG,SEQ);



CREATE TABLE HD_REFER_KEY
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025747 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025748 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025749 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025750 NOT NULL ,
	RENT_YN              VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025751 NOT NULL ,
	KEY_DATE             VARCHAR2(8 BYTE) NULL ,
	KEY_CNT              NUMBER(5) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_REFER_KEY
	ADD CONSTRAINT  SYS_C0025752 PRIMARY KEY (DEPT_CODE,HOUSETAG,BUILDNO,HOUSENO,RENT_YN);



CREATE TABLE HD_REFER_KEY
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019411 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019412 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019413 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019414 NOT NULL ,
	RENT_YN              VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019415 NOT NULL ,
	KEY_DATE             VARCHAR2(8 BYTE) NULL ,
	KEY_CNT              NUMBER(5) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_REFER_KEY
	ADD CONSTRAINT  SYS_C0019416 PRIMARY KEY (DEPT_CODE,HOUSETAG,BUILDNO,HOUSENO,RENT_YN);



CREATE TABLE HD_REFER_MOVEIN
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025753 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025754 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025755 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025756 NOT NULL ,
	RENT_YN              VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025757 NOT NULL ,
	MOVEIN_TAG           VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025758 NOT NULL ,
	MOVEIN_DATE          VARCHAR2(8 BYTE) NULL ,
	PUBLISH_DATE         VARCHAR2(8 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_REFER_MOVEIN
	ADD CONSTRAINT  SYS_C0025759 PRIMARY KEY (DEPT_CODE,HOUSETAG,BUILDNO,HOUSENO,RENT_YN);



CREATE TABLE HD_REFER_MOVEIN
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019417 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019418 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019419 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019420 NOT NULL ,
	RENT_YN              VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019421 NOT NULL ,
	MOVEIN_TAG           VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019422 NOT NULL ,
	MOVEIN_DATE          VARCHAR2(8 BYTE) NULL ,
	PUBLISH_DATE         VARCHAR2(8 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_REFER_MOVEIN
	ADD CONSTRAINT  SYS_C0019423 PRIMARY KEY (DEPT_CODE,HOUSETAG,BUILDNO,HOUSENO,RENT_YN);



CREATE TABLE HD_REFER_RATE_DELAY
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025760 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025761 NOT NULL ,
	RATETAG              VARCHAR2(2 BYTE) CONSTRAINT SYS_C0025762 NOT NULL ,
	START_DAYS           NUMBER(5) CONSTRAINT SYS_C0025763 NOT NULL ,
	END_DAYS             NUMBER(5) CONSTRAINT SYS_C0025764 NOT NULL ,
	STARTDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025765 NOT NULL ,
	ENDDATE              VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025766 NOT NULL ,
	DELAYRATE            FLOAT(126) CONSTRAINT SYS_C0025767 NOT NULL ,
	DELAYCUT             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025768 NOT NULL ,
	DELAYUNIT            VARCHAR2(1 BYTE) DEFAULT  '2'  CONSTRAINT SYS_C0025769 NOT NULL ,
	START_TAG            VARCHAR2(1 BYTE) NULL ,
	END_TAG              VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_REFER_RATE_DELAY
	ADD CONSTRAINT  SYS_C0025770 PRIMARY KEY (DEPT_CODE,HOUSETAG,RATETAG,START_DAYS,END_DAYS,STARTDATE);



CREATE TABLE HD_REFER_RATE_DELAY
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019424 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019425 NOT NULL ,
	RATETAG              VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019426 NOT NULL ,
	START_DAYS           NUMBER(5) CONSTRAINT SYS_C0019427 NOT NULL ,
	END_DAYS             NUMBER(5) CONSTRAINT SYS_C0019428 NOT NULL ,
	STARTDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019429 NOT NULL ,
	ENDDATE              VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019430 NOT NULL ,
	DELAYRATE            FLOAT(126) CONSTRAINT SYS_C0019431 NOT NULL ,
	DELAYCUT             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019432 NOT NULL ,
	DELAYUNIT            VARCHAR2(1 BYTE) DEFAULT  '2'  CONSTRAINT SYS_C0019433 NOT NULL ,
	START_TAG            VARCHAR2(1 BYTE) NULL ,
	END_TAG              VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_REFER_RATE_DELAY
	ADD CONSTRAINT  SYS_C0019434 PRIMARY KEY (DEPT_CODE,HOUSETAG,RATETAG,START_DAYS,END_DAYS,STARTDATE);



CREATE TABLE HD_REFER_RATE_DISCOUNT
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025771 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025772 NOT NULL ,
	RATE_TAG             VARCHAR2(2 BYTE) CONSTRAINT SYS_C0025773 NOT NULL ,
	STARTDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025774 NOT NULL ,
	ENDDATE              VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025775 NOT NULL ,
	DISCNTRATE           FLOAT(126) CONSTRAINT SYS_C0025776 NOT NULL ,
	DISCNTCUT            VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025777 NOT NULL ,
	DISCNTUNIT           VARCHAR2(1 BYTE) DEFAULT  '2'  CONSTRAINT SYS_C0025778 NOT NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_REFER_RATE_DISCOUNT
	ADD CONSTRAINT  SYS_C0025779 PRIMARY KEY (DEPT_CODE,HOUSETAG,RATE_TAG,STARTDATE);



CREATE TABLE HD_REFER_RATE_DISCOUNT
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019435 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019436 NOT NULL ,
	RATE_TAG             VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019437 NOT NULL ,
	STARTDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019438 NOT NULL ,
	ENDDATE              VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019439 NOT NULL ,
	DISCNTRATE           FLOAT(126) CONSTRAINT SYS_C0019440 NOT NULL ,
	DISCNTCUT            VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019441 NOT NULL ,
	DISCNTUNIT           VARCHAR2(1 BYTE) DEFAULT  '2'  CONSTRAINT SYS_C0019442 NOT NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_REFER_RATE_DISCOUNT
	ADD CONSTRAINT  SYS_C0019443 PRIMARY KEY (DEPT_CODE,HOUSETAG,RATE_TAG,STARTDATE);



CREATE TABLE HD_REFER_SELLCREATE
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025780 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025781 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025782 NOT NULL ,
	SQUARE               NUMBER(8,4) CONSTRAINT SYS_C0025783 NOT NULL ,
	TYPE                 VARCHAR2(4 BYTE) CONSTRAINT SYS_C0025784 NOT NULL ,
	CLASS                VARCHAR2(1 BYTE) NULL ,
	OPTIONS              VARCHAR2(2 BYTE) NULL ,
	START_BUILDNO        VARCHAR2(10 BYTE) NULL ,
	START_HOUSENO        VARCHAR2(10 BYTE) NULL ,
	END_HOUSENO          VARCHAR2(10 BYTE) NULL ,
	SEDESU               NUMBER(5) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_REFER_SELLCREATE
	ADD CONSTRAINT  SYS_C0025785 PRIMARY KEY (DEPT_CODE,HOUSETAG,SEQ);



CREATE TABLE HD_REFER_SELLCREATE
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019444 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019445 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019446 NOT NULL ,
	SQUARE               NUMBER(8,4) CONSTRAINT SYS_C0019447 NOT NULL ,
	TYPE                 VARCHAR2(4 BYTE) CONSTRAINT SYS_C0019448 NOT NULL ,
	CLASS                VARCHAR2(1 BYTE) NULL ,
	OPTIONS              VARCHAR2(2 BYTE) NULL ,
	START_BUILDNO        VARCHAR2(10 BYTE) NULL ,
	START_HOUSENO        VARCHAR2(10 BYTE) NULL ,
	END_HOUSENO          VARCHAR2(10 BYTE) NULL ,
	SEDESU               NUMBER(5) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_REFER_SELLCREATE
	ADD CONSTRAINT  SYS_C0019449 PRIMARY KEY (DEPT_CODE,HOUSETAG,SEQ);



CREATE TABLE HD_REFER_SELLDETAIL
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025786 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025787 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025788 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025789 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0025790 NOT NULL ,
	AGREEDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025791 NOT NULL ,
	AGREEAMT             FLOAT(126) NULL ,
	LANDAMT              FLOAT(126) CONSTRAINT SYS_C0025792 NOT NULL ,
	BUILDAMT             FLOAT(126) CONSTRAINT SYS_C0025793 NOT NULL ,
	VATAMT               FLOAT(126) CONSTRAINT SYS_C0025794 NOT NULL ,
	DC_YN                VARCHAR2(1 BYTE) NULL ,
	AC_YN                VARCHAR2(1 BYTE) NULL ,
	DISTRIBUTE_RATE      NUMBER(4,1) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	MANAGEAMT            FLOAT(126) DEFAULT  0  NULL 
);



ALTER TABLE HD_REFER_SELLDETAIL
	ADD CONSTRAINT  SYS_C0025795 PRIMARY KEY (DEPT_CODE,HOUSETAG,BUILDNO,HOUSENO,COUNTS);



CREATE TABLE HD_REFER_SELLDETAIL
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019450 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019451 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019452 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019453 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019454 NOT NULL ,
	AGREEDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019455 NOT NULL ,
	AGREEAMT             FLOAT(126) NULL ,
	LANDAMT              FLOAT(126) CONSTRAINT SYS_C0019456 NOT NULL ,
	BUILDAMT             FLOAT(126) CONSTRAINT SYS_C0019457 NOT NULL ,
	VATAMT               FLOAT(126) CONSTRAINT SYS_C0019458 NOT NULL ,
	DC_YN                VARCHAR2(1 BYTE) NULL ,
	AC_YN                VARCHAR2(1 BYTE) NULL ,
	DISTRIBUTE_RATE      NUMBER(4,1) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	MANAGEAMT            FLOAT(126) DEFAULT  0  NULL 
);



ALTER TABLE HD_REFER_SELLDETAIL
	ADD CONSTRAINT  SYS_C0019459 PRIMARY KEY (DEPT_CODE,HOUSETAG,BUILDNO,HOUSENO,COUNTS);



CREATE TABLE HD_REFER_SELLDETAIL_CHANGE
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025796 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025797 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025798 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025799 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0025800 NOT NULL ,
	AGREEDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025801 NOT NULL ,
	AGREEAMT             FLOAT(126) NULL ,
	LANDAMT              FLOAT(126) CONSTRAINT SYS_C0025802 NOT NULL ,
	BUILDAMT             FLOAT(126) CONSTRAINT SYS_C0025803 NOT NULL ,
	VATAMT               FLOAT(126) CONSTRAINT SYS_C0025804 NOT NULL ,
	DC_YN                VARCHAR2(1 BYTE) NULL ,
	AC_YN                VARCHAR2(1 BYTE) NULL ,
	DISTRIBUTE_RATE      NUMBER(4,1) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	MANAGEAMT            FLOAT(126) DEFAULT  0  NULL 
);



ALTER TABLE HD_REFER_SELLDETAIL_CHANGE
	ADD CONSTRAINT  SYS_C0025805 PRIMARY KEY (DEPT_CODE,HOUSETAG,BUILDNO,HOUSENO,COUNTS);



CREATE TABLE HD_REFER_SELLDETAIL_CHANGE
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019460 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019461 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019462 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019463 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019464 NOT NULL ,
	AGREEDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019465 NOT NULL ,
	AGREEAMT             FLOAT(126) NULL ,
	LANDAMT              FLOAT(126) CONSTRAINT SYS_C0019466 NOT NULL ,
	BUILDAMT             FLOAT(126) CONSTRAINT SYS_C0019467 NOT NULL ,
	VATAMT               FLOAT(126) CONSTRAINT SYS_C0019468 NOT NULL ,
	DC_YN                VARCHAR2(1 BYTE) NULL ,
	AC_YN                VARCHAR2(1 BYTE) NULL ,
	DISTRIBUTE_RATE      NUMBER(4,1) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	MANAGEAMT            FLOAT(126) DEFAULT  0  NULL 
);



ALTER TABLE HD_REFER_SELLDETAIL_CHANGE
	ADD CONSTRAINT  SYS_C0019469 PRIMARY KEY (DEPT_CODE,HOUSETAG,BUILDNO,HOUSENO,COUNTS);



CREATE TABLE HD_REFER_SELLDETAIL_HIST
(
	HIST_DATE            DATE CONSTRAINT SYS_C0025806 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025807 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025808 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025809 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025810 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0025811 NOT NULL ,
	AGREEDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025812 NOT NULL ,
	AGREEAMT             FLOAT(126) NULL ,
	LANDAMT              FLOAT(126) CONSTRAINT SYS_C0025813 NOT NULL ,
	BUILDAMT             FLOAT(126) CONSTRAINT SYS_C0025814 NOT NULL ,
	VATAMT               FLOAT(126) CONSTRAINT SYS_C0025815 NOT NULL ,
	DC_YN                VARCHAR2(1 BYTE) NULL ,
	AC_YN                VARCHAR2(1 BYTE) NULL ,
	DISTRIBUTE_RATE      NUMBER(4,1) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	TRI_TAG              VARCHAR2(1 BYTE) NULL ,
	MANAGEAMT            FLOAT(126) DEFAULT  0  NULL 
);



ALTER TABLE HD_REFER_SELLDETAIL_HIST
	ADD CONSTRAINT  SYS_C0025816 PRIMARY KEY (HIST_DATE,DEPT_CODE,HOUSETAG,BUILDNO,HOUSENO,COUNTS);



CREATE TABLE HD_REFER_SELLDETAIL_HIST
(
	HIST_DATE            DATE CONSTRAINT SYS_C0019470 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019471 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019472 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019473 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019474 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019475 NOT NULL ,
	AGREEDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019476 NOT NULL ,
	AGREEAMT             FLOAT(126) NULL ,
	LANDAMT              FLOAT(126) CONSTRAINT SYS_C0019477 NOT NULL ,
	BUILDAMT             FLOAT(126) CONSTRAINT SYS_C0019478 NOT NULL ,
	VATAMT               FLOAT(126) CONSTRAINT SYS_C0019479 NOT NULL ,
	DC_YN                VARCHAR2(1 BYTE) NULL ,
	AC_YN                VARCHAR2(1 BYTE) NULL ,
	DISTRIBUTE_RATE      NUMBER(4,1) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	TRI_TAG              VARCHAR2(1 BYTE) NULL ,
	MANAGEAMT            FLOAT(126) DEFAULT  0  NULL 
);



ALTER TABLE HD_REFER_SELLDETAIL_HIST
	ADD CONSTRAINT  SYS_C0019480 PRIMARY KEY (HIST_DATE,DEPT_CODE,HOUSETAG,BUILDNO,HOUSENO,COUNTS);



CREATE TABLE HD_REFER_SQUARE
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025817 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025818 NOT NULL ,
	SEQ                  NUMBER(3) CONSTRAINT SYS_C0025819 NOT NULL ,
	SQUARE               NUMBER(8,4) CONSTRAINT SYS_C0025820 NOT NULL ,
	TYPE                 VARCHAR2(4 BYTE) CONSTRAINT SYS_C0025821 NOT NULL ,
	CLASS                VARCHAR2(1 BYTE) NULL ,
	OPTIONCODE           VARCHAR2(2 BYTE) DEFAULT  '00'  NULL ,
	VATTAG               VARCHAR2(1 BYTE) NULL ,
	EXCLUSIVEAREA        NUMBER(12,4) NULL ,
	COMMONAREA           NUMBER(12,4) NULL ,
	ETCCOMMONAREA        NUMBER(12,4) NULL ,
	PARKINGAREA          NUMBER(12,4) NULL ,
	SERVICEAREA          NUMBER(12,4) NULL ,
	SITEAREA             NUMBER(12,4) NULL ,
	LANDAMT              FLOAT(126) NULL ,
	BUILDAMT             FLOAT(126) NULL ,
	VATAMT               FLOAT(126) NULL ,
	TOT_BAMT             FLOAT(126) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	PRTSQUARE            NUMBER(8,4) NULL ,
	MANAGEAMT            FLOAT(126) DEFAULT  0  NULL 
);



ALTER TABLE HD_REFER_SQUARE
	ADD CONSTRAINT  SYS_C0025822 PRIMARY KEY (DEPT_CODE,HOUSETAG,SEQ);



CREATE UNIQUE INDEX XAK1HD_REFER_SQUARE ON HD_REFER_SQUARE
(DEPT_CODE   ASC,HOUSETAG   ASC,SQUARE   ASC,TYPE   ASC,CLASS   ASC,OPTIONCODE   ASC);



CREATE TABLE HD_REFER_SQUARE
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019481 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019482 NOT NULL ,
	SEQ                  NUMBER(3) CONSTRAINT SYS_C0019483 NOT NULL ,
	SQUARE               NUMBER(8,4) CONSTRAINT SYS_C0019484 NOT NULL ,
	TYPE                 VARCHAR2(4 BYTE) CONSTRAINT SYS_C0019485 NOT NULL ,
	CLASS                VARCHAR2(1 BYTE) NULL ,
	OPTIONCODE           VARCHAR2(2 BYTE) DEFAULT  '00'  NULL ,
	VATTAG               VARCHAR2(1 BYTE) NULL ,
	EXCLUSIVEAREA        NUMBER(12,4) NULL ,
	COMMONAREA           NUMBER(12,4) NULL ,
	ETCCOMMONAREA        NUMBER(12,4) NULL ,
	PARKINGAREA          NUMBER(12,4) NULL ,
	SERVICEAREA          NUMBER(12,4) NULL ,
	SITEAREA             NUMBER(12,4) NULL ,
	LANDAMT              FLOAT(126) NULL ,
	BUILDAMT             FLOAT(126) NULL ,
	VATAMT               FLOAT(126) NULL ,
	TOT_BAMT             FLOAT(126) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	PRTSQUARE            NUMBER(8,4) NULL ,
	MANAGEAMT            FLOAT(126) DEFAULT  0  NULL 
);



ALTER TABLE HD_REFER_SQUARE
	ADD CONSTRAINT  SYS_C0019486 PRIMARY KEY (DEPT_CODE,HOUSETAG,SEQ);



CREATE UNIQUE INDEX XAK1HD_REFER_SQUARE ON HD_REFER_SQUARE
(DEPT_CODE   ASC,HOUSETAG   ASC,SQUARE   ASC,TYPE   ASC,CLASS   ASC,OPTIONCODE   ASC);



CREATE TABLE HD_REFER_SQUARE_CNT
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025850 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025851 NOT NULL ,
	CNT                  NUMBER(5) CONSTRAINT SYS_C0025852 NOT NULL ,
	SEQ                  NUMBER(3) CONSTRAINT SYS_C0025853 NOT NULL ,
	CNT_DATE             VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025854 NOT NULL ,
	SQUARE               NUMBER(8,4) CONSTRAINT SYS_C0025855 NOT NULL ,
	TYPE                 VARCHAR2(4 BYTE) CONSTRAINT SYS_C0025856 NOT NULL ,
	CLASS                VARCHAR2(1 BYTE) NULL ,
	OPTIONCODE           VARCHAR2(2 BYTE) DEFAULT  '00'  NULL ,
	VATTAG               VARCHAR2(1 BYTE) NULL ,
	EXCLUSIVEAREA        NUMBER(8,4) NULL ,
	COMMONAREA           NUMBER(8,4) NULL ,
	ETCCOMMONAREA        NUMBER(8,4) NULL ,
	PARKINGAREA          NUMBER(8,4) NULL ,
	SERVICEAREA          NUMBER(8,4) NULL ,
	SITEAREA             NUMBER(8,4) NULL ,
	LANDAMT              FLOAT(126) NULL ,
	BUILDAMT             FLOAT(126) NULL ,
	VATAMT               FLOAT(126) NULL ,
	TOT_BAMT             FLOAT(126) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	PRTSQUARE            NUMBER(8,4) NULL ,
	MANAGEAMT            FLOAT(126) DEFAULT  0  NULL 
);



ALTER TABLE HD_REFER_SQUARE_CNT
	ADD CONSTRAINT  SYS_C0025857 PRIMARY KEY (DEPT_CODE,HOUSETAG,CNT,SEQ);



CREATE UNIQUE INDEX XAK1HD_REFER_SQUARE_CNT ON HD_REFER_SQUARE_CNT
(DEPT_CODE   ASC,HOUSETAG   ASC,CNT   ASC,SQUARE   ASC,TYPE   ASC,CLASS   ASC,OPTIONCODE   ASC);



CREATE TABLE HD_REFER_SQUARE_CNT
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019514 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019515 NOT NULL ,
	CNT                  NUMBER(5) CONSTRAINT SYS_C0019516 NOT NULL ,
	SEQ                  NUMBER(3) CONSTRAINT SYS_C0019517 NOT NULL ,
	CNT_DATE             VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019518 NOT NULL ,
	SQUARE               NUMBER(8,4) CONSTRAINT SYS_C0019519 NOT NULL ,
	TYPE                 VARCHAR2(4 BYTE) CONSTRAINT SYS_C0019520 NOT NULL ,
	CLASS                VARCHAR2(1 BYTE) NULL ,
	OPTIONCODE           VARCHAR2(2 BYTE) DEFAULT  '00'  NULL ,
	VATTAG               VARCHAR2(1 BYTE) NULL ,
	EXCLUSIVEAREA        NUMBER(8,4) NULL ,
	COMMONAREA           NUMBER(8,4) NULL ,
	ETCCOMMONAREA        NUMBER(8,4) NULL ,
	PARKINGAREA          NUMBER(8,4) NULL ,
	SERVICEAREA          NUMBER(8,4) NULL ,
	SITEAREA             NUMBER(8,4) NULL ,
	LANDAMT              FLOAT(126) NULL ,
	BUILDAMT             FLOAT(126) NULL ,
	VATAMT               FLOAT(126) NULL ,
	TOT_BAMT             FLOAT(126) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	PRTSQUARE            NUMBER(8,4) NULL ,
	MANAGEAMT            FLOAT(126) DEFAULT  0  NULL 
);



ALTER TABLE HD_REFER_SQUARE_CNT
	ADD CONSTRAINT  SYS_C0019521 PRIMARY KEY (DEPT_CODE,HOUSETAG,CNT,SEQ);



CREATE UNIQUE INDEX XAK1HD_REFER_SQUARE_CNT ON HD_REFER_SQUARE_CNT
(DEPT_CODE   ASC,HOUSETAG   ASC,CNT   ASC,SQUARE   ASC,TYPE   ASC,CLASS   ASC,OPTIONCODE   ASC);



CREATE TABLE HD_REFER_SQUARE_CONV
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025858 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025859 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025860 NOT NULL ,
	SQUARE               NUMBER(8,4) CONSTRAINT SYS_C0025861 NOT NULL ,
	TYPE                 VARCHAR2(4 BYTE) CONSTRAINT SYS_C0025862 NOT NULL ,
	CLASS                VARCHAR2(1 BYTE) NULL ,
	OPTIONCODE           VARCHAR2(2 BYTE) DEFAULT  '00'  NULL ,
	VATTAG               VARCHAR2(1 BYTE) NULL ,
	EXCLUSIVEAREA        NUMBER(12,4) NULL ,
	COMMONAREA           NUMBER(12,4) NULL ,
	ETCCOMMONAREA        NUMBER(12,4) NULL ,
	PARKINGAREA          NUMBER(12,4) NULL ,
	SERVICEAREA          NUMBER(12,4) NULL ,
	SITEAREA             NUMBER(12,4) NULL 
);



ALTER TABLE HD_REFER_SQUARE_CONV
	ADD CONSTRAINT  SYS_C0025863 PRIMARY KEY (DEPT_CODE,HOUSETAG,SEQ);



CREATE TABLE HD_REFER_SQUARE_CONV
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019522 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019523 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019524 NOT NULL ,
	SQUARE               NUMBER(8,4) CONSTRAINT SYS_C0019525 NOT NULL ,
	TYPE                 VARCHAR2(4 BYTE) CONSTRAINT SYS_C0019526 NOT NULL ,
	CLASS                VARCHAR2(1 BYTE) NULL ,
	OPTIONCODE           VARCHAR2(2 BYTE) DEFAULT  '00'  NULL ,
	VATTAG               VARCHAR2(1 BYTE) NULL ,
	EXCLUSIVEAREA        NUMBER(12,4) NULL ,
	COMMONAREA           NUMBER(12,4) NULL ,
	ETCCOMMONAREA        NUMBER(12,4) NULL ,
	PARKINGAREA          NUMBER(12,4) NULL ,
	SERVICEAREA          NUMBER(12,4) NULL ,
	SITEAREA             NUMBER(12,4) NULL 
);



ALTER TABLE HD_REFER_SQUARE_CONV
	ADD CONSTRAINT  SYS_C0019527 PRIMARY KEY (DEPT_CODE,HOUSETAG,SEQ);



CREATE TABLE HD_REFER_SQUAREDETAIL
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025823 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025824 NOT NULL ,
	SEQ                  NUMBER(3) CONSTRAINT SYS_C0025825 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0025826 NOT NULL ,
	AGREEDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025827 NOT NULL ,
	LANDAMT              FLOAT(126) CONSTRAINT SYS_C0025828 NOT NULL ,
	BUILDAMT             FLOAT(126) CONSTRAINT SYS_C0025829 NOT NULL ,
	VATAMT               FLOAT(126) CONSTRAINT SYS_C0025830 NOT NULL ,
	BAMT                 FLOAT(126) NULL ,
	DC_YN                VARCHAR2(1 BYTE) NULL ,
	AC_YN                VARCHAR2(1 BYTE) NULL ,
	DISTRIBUTE_RATE      NUMBER(4,1) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	MANAGEAMT            FLOAT(126) DEFAULT  0  NULL 
);



ALTER TABLE HD_REFER_SQUAREDETAIL
	ADD CONSTRAINT  SYS_C0025831 PRIMARY KEY (DEPT_CODE,HOUSETAG,SEQ,COUNTS);



CREATE TABLE HD_REFER_SQUAREDETAIL
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019487 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019488 NOT NULL ,
	SEQ                  NUMBER(3) CONSTRAINT SYS_C0019489 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019490 NOT NULL ,
	AGREEDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019491 NOT NULL ,
	LANDAMT              FLOAT(126) CONSTRAINT SYS_C0019492 NOT NULL ,
	BUILDAMT             FLOAT(126) CONSTRAINT SYS_C0019493 NOT NULL ,
	VATAMT               FLOAT(126) CONSTRAINT SYS_C0019494 NOT NULL ,
	BAMT                 FLOAT(126) NULL ,
	DC_YN                VARCHAR2(1 BYTE) NULL ,
	AC_YN                VARCHAR2(1 BYTE) NULL ,
	DISTRIBUTE_RATE      NUMBER(4,1) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	MANAGEAMT            FLOAT(126) DEFAULT  0  NULL 
);



ALTER TABLE HD_REFER_SQUAREDETAIL
	ADD CONSTRAINT  SYS_C0019495 PRIMARY KEY (DEPT_CODE,HOUSETAG,SEQ,COUNTS);



CREATE TABLE HD_REFER_SQUAREDETAIL_CNT
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025832 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025833 NOT NULL ,
	CNT                  NUMBER(5) CONSTRAINT SYS_C0025834 NOT NULL ,
	SEQ                  NUMBER(3) CONSTRAINT SYS_C0025835 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0025836 NOT NULL ,
	AGREEDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025837 NOT NULL ,
	LANDAMT              FLOAT(126) CONSTRAINT SYS_C0025838 NOT NULL ,
	BUILDAMT             FLOAT(126) CONSTRAINT SYS_C0025839 NOT NULL ,
	VATAMT               FLOAT(126) CONSTRAINT SYS_C0025840 NOT NULL ,
	BAMT                 FLOAT(126) NULL ,
	DC_YN                VARCHAR2(1 BYTE) NULL ,
	AC_YN                VARCHAR2(1 BYTE) NULL ,
	DISTRIBUTE_RATE      NUMBER(4,1) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	MANAGEAMT            FLOAT(126) DEFAULT  0  NULL 
);



ALTER TABLE HD_REFER_SQUAREDETAIL_CNT
	ADD CONSTRAINT  SYS_C0025841 PRIMARY KEY (DEPT_CODE,HOUSETAG,CNT,SEQ,COUNTS);



CREATE TABLE HD_REFER_SQUAREDETAIL_CNT
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019496 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019497 NOT NULL ,
	CNT                  NUMBER(5) CONSTRAINT SYS_C0019498 NOT NULL ,
	SEQ                  NUMBER(3) CONSTRAINT SYS_C0019499 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019500 NOT NULL ,
	AGREEDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019501 NOT NULL ,
	LANDAMT              FLOAT(126) CONSTRAINT SYS_C0019502 NOT NULL ,
	BUILDAMT             FLOAT(126) CONSTRAINT SYS_C0019503 NOT NULL ,
	VATAMT               FLOAT(126) CONSTRAINT SYS_C0019504 NOT NULL ,
	BAMT                 FLOAT(126) NULL ,
	DC_YN                VARCHAR2(1 BYTE) NULL ,
	AC_YN                VARCHAR2(1 BYTE) NULL ,
	DISTRIBUTE_RATE      NUMBER(4,1) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	MANAGEAMT            FLOAT(126) DEFAULT  0  NULL 
);



ALTER TABLE HD_REFER_SQUAREDETAIL_CNT
	ADD CONSTRAINT  SYS_C0019505 PRIMARY KEY (DEPT_CODE,HOUSETAG,CNT,SEQ,COUNTS);



CREATE TABLE HD_REFER_SQUAREDETAIL_CONV
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025842 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025843 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025844 NOT NULL ,
	SQUARE               NUMBER(8,4) NULL ,
	TYPE                 VARCHAR2(4 BYTE) NULL ,
	CLASS                VARCHAR2(1 BYTE) NULL ,
	OPTIONCODE           VARCHAR2(2 BYTE) NULL ,
	COUNTS               VARCHAR2(2 BYTE) NULL ,
	AGREEDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025845 NOT NULL ,
	BAMT                 FLOAT(126) NULL ,
	LANDAMT              FLOAT(126) CONSTRAINT SYS_C0025846 NOT NULL ,
	BUILDAMT             FLOAT(126) CONSTRAINT SYS_C0025847 NOT NULL ,
	VATAMT               FLOAT(126) CONSTRAINT SYS_C0025848 NOT NULL ,
	MANAGEAMT            FLOAT(126) DEFAULT  0  NULL 
);



ALTER TABLE HD_REFER_SQUAREDETAIL_CONV
	ADD CONSTRAINT  SYS_C0025849 PRIMARY KEY (DEPT_CODE,HOUSETAG,SEQ);



CREATE TABLE HD_REFER_SQUAREDETAIL_CONV
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019506 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019507 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019508 NOT NULL ,
	SQUARE               NUMBER(8,4) NULL ,
	TYPE                 VARCHAR2(4 BYTE) NULL ,
	CLASS                VARCHAR2(1 BYTE) NULL ,
	OPTIONCODE           VARCHAR2(2 BYTE) NULL ,
	COUNTS               VARCHAR2(2 BYTE) NULL ,
	AGREEDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019509 NOT NULL ,
	BAMT                 FLOAT(126) NULL ,
	LANDAMT              FLOAT(126) CONSTRAINT SYS_C0019510 NOT NULL ,
	BUILDAMT             FLOAT(126) CONSTRAINT SYS_C0019511 NOT NULL ,
	VATAMT               FLOAT(126) CONSTRAINT SYS_C0019512 NOT NULL ,
	MANAGEAMT            FLOAT(126) DEFAULT  0  NULL 
);



ALTER TABLE HD_REFER_SQUAREDETAIL_CONV
	ADD CONSTRAINT  SYS_C0019513 PRIMARY KEY (DEPT_CODE,HOUSETAG,SEQ);



CREATE TABLE HD_RENT_CANCEL
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025864 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025865 NOT NULL ,
	PROCESS_TAG          VARCHAR2(1 BYTE) NULL ,
	WANT_DATE            VARCHAR2(8 BYTE) NULL ,
	TAKE_DATE            VARCHAR2(8 BYTE) NULL ,
	CANCEL_DATE          VARCHAR2(8 BYTE) NULL ,
	CANCEL_TAG           VARCHAR2(2 BYTE) NULL ,
	CANCEL_TEXT          VARCHAR2(200 BYTE) NULL ,
	PENALTY_TAG          VARCHAR2(2 BYTE) NULL ,
	PENALTY_TEXT         VARCHAR2(200 BYTE) NULL ,
	YRATE                FLOAT(126) NULL ,
	PENALTY_AMT          NUMBER(15) NULL ,
	RETURN_DEPOSIT       VARCHAR2(30 BYTE) NULL ,
	RETURN_BANK          VARCHAR2(40 BYTE) NULL ,
	RETURN_DEPOSITOR     VARCHAR2(100 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



CREATE UNIQUE INDEX XPKHD_RENT_CANCEL ON HD_RENT_CANCEL
(CUST_CODE   ASC,SEQ   ASC);



ALTER TABLE HD_RENT_CANCEL
	ADD CONSTRAINT  SYS_C0025866 PRIMARY KEY (CUST_CODE,SEQ);



CREATE TABLE HD_RENT_CANCEL
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019528 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019529 NOT NULL ,
	PROCESS_TAG          VARCHAR2(1 BYTE) NULL ,
	WANT_DATE            VARCHAR2(8 BYTE) NULL ,
	TAKE_DATE            VARCHAR2(8 BYTE) NULL ,
	CANCEL_DATE          VARCHAR2(8 BYTE) NULL ,
	CANCEL_TAG           VARCHAR2(2 BYTE) NULL ,
	CANCEL_TEXT          VARCHAR2(200 BYTE) NULL ,
	PENALTY_TAG          VARCHAR2(2 BYTE) NULL ,
	PENALTY_TEXT         VARCHAR2(200 BYTE) NULL ,
	YRATE                FLOAT(126) NULL ,
	PENALTY_AMT          NUMBER(15) NULL ,
	RETURN_DEPOSIT       VARCHAR2(30 BYTE) NULL ,
	RETURN_BANK          VARCHAR2(40 BYTE) NULL ,
	RETURN_DEPOSITOR     VARCHAR2(100 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



CREATE UNIQUE INDEX XPKHD_RENT_CANCEL ON HD_RENT_CANCEL
(CUST_CODE   ASC,SEQ   ASC);



CREATE TABLE HD_RENT_DETAIL_RENT
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025867 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025868 NOT NULL ,
	RENT_CHG_SEQ         NUMBER(3) CONSTRAINT SYS_C0025869 NOT NULL ,
	APPLY_YYMM           VARCHAR2(8 BYTE) NULL ,
	RENT_SUPPLY          NUMBER(12) NULL ,
	RENT_VAT             NUMBER(12) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	RENT_INS             NUMBER(12) NULL 
);



ALTER TABLE HD_RENT_DETAIL_RENT
	ADD CONSTRAINT  SYS_C0025870 PRIMARY KEY (CUST_CODE,SEQ,RENT_CHG_SEQ);



CREATE TABLE HD_RENT_DETAIL_RENT
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019530 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019531 NOT NULL ,
	RENT_CHG_SEQ         NUMBER(3) CONSTRAINT SYS_C0019532 NOT NULL ,
	APPLY_YYMM           VARCHAR2(8 BYTE) NULL ,
	RENT_SUPPLY          NUMBER(12) NULL ,
	RENT_VAT             NUMBER(12) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	RENT_INS             NUMBER(12) NULL 
);



ALTER TABLE HD_RENT_DETAIL_RENT
	ADD CONSTRAINT  SYS_C0019533 PRIMARY KEY (CUST_CODE,SEQ,RENT_CHG_SEQ);



CREATE TABLE HD_RENT_DETAIL_TERM
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025871 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025872 NOT NULL ,
	TERM_CHG_SEQ         NUMBER(3) CONSTRAINT SYS_C0025873 NOT NULL ,
	APPLY_DATE           VARCHAR2(8 BYTE) NULL ,
	RENT_SDATE           VARCHAR2(8 BYTE) NULL ,
	RENT_EDATE           VARCHAR2(8 BYTE) NULL ,
	VAT_YN               VARCHAR2(1 BYTE) NULL ,
	GUARANTEE_AMT        NUMBER(12) NULL ,
	RENT_SUPPLY          NUMBER(12) NULL ,
	RENT_VAT             NUMBER(12) NULL ,
	AGREE_DD             VARCHAR2(2 BYTE) NULL ,
	AGREE_MM_TAG         VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	RENT_INS             NUMBER(12) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	CHANGECONTDT         VARCHAR2(8 BYTE) NULL 
);



ALTER TABLE HD_RENT_DETAIL_TERM
	ADD CONSTRAINT  SYS_C0025874 PRIMARY KEY (CUST_CODE,SEQ,TERM_CHG_SEQ);



CREATE TABLE HD_RENT_DETAIL_TERM
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019534 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019535 NOT NULL ,
	TERM_CHG_SEQ         NUMBER(3) CONSTRAINT SYS_C0019536 NOT NULL ,
	APPLY_DATE           VARCHAR2(8 BYTE) NULL ,
	RENT_SDATE           VARCHAR2(8 BYTE) NULL ,
	RENT_EDATE           VARCHAR2(8 BYTE) NULL ,
	VAT_YN               VARCHAR2(1 BYTE) NULL ,
	GUARANTEE_AMT        NUMBER(12) NULL ,
	RENT_SUPPLY          NUMBER(12) NULL ,
	RENT_VAT             NUMBER(12) NULL ,
	AGREE_DD             VARCHAR2(2 BYTE) NULL ,
	AGREE_MM_TAG         VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	RENT_INS             NUMBER(12) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	CHANGECONTDT         VARCHAR2(8 BYTE) NULL 
);



ALTER TABLE HD_RENT_DETAIL_TERM
	ADD CONSTRAINT  SYS_C0019537 PRIMARY KEY (CUST_CODE,SEQ,TERM_CHG_SEQ);



CREATE TABLE HD_RENT_DONGHO
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025875 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025876 NOT NULL ,
	CONT_SEQ             NUMBER(3) CONSTRAINT SYS_C0025877 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025878 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025879 NOT NULL ,
	REPRESENT_YN         VARCHAR2(1 BYTE) NULL ,
	REMARK               VARCHAR2(100 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_RENT_DONGHO
	ADD CONSTRAINT  SYS_C0025880 PRIMARY KEY (CUST_CODE,SEQ,CONT_SEQ);



CREATE  INDEX XIE1HD_RENT_DONGHO ON HD_RENT_DONGHO
(DEPT_CODE   ASC,HOUSETAG   ASC,BUILDNO   ASC,HOUSENO   ASC);



CREATE TABLE HD_RENT_DONGHO
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019538 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019539 NOT NULL ,
	CONT_SEQ             NUMBER(3) CONSTRAINT SYS_C0019540 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019541 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019542 NOT NULL ,
	REPRESENT_YN         VARCHAR2(1 BYTE) NULL ,
	REMARK               VARCHAR2(100 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_RENT_DONGHO
	ADD CONSTRAINT  SYS_C0019543 PRIMARY KEY (CUST_CODE,SEQ,CONT_SEQ);



CREATE  INDEX XIE1HD_RENT_DONGHO ON HD_RENT_DONGHO
(DEPT_CODE   ASC,HOUSETAG   ASC,BUILDNO   ASC,HOUSENO   ASC);



CREATE TABLE HD_RENT_ETC
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025881 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025882 NOT NULL ,
	ETC_SEQ              NUMBER(3) CONSTRAINT SYS_C0025883 NOT NULL ,
	UNIQUE_DIV           VARCHAR2(2 BYTE) NULL ,
	EFFECT_NO            VARCHAR2(20 BYTE) NULL ,
	DELIVERY_DATE        VARCHAR2(8 BYTE) NULL ,
	CREDITOR             VARCHAR2(10 BYTE) NULL ,
	BOND_AMT             NUMBER(13) NULL ,
	CANCEL_YN            VARCHAR2(1 BYTE) NULL ,
	CANCEL_DATE          VARCHAR2(8 BYTE) NULL ,
	CANCEL_DESC          VARCHAR2(120 BYTE) NULL ,
	REMARK               VARCHAR2(120 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_RENT_ETC
	ADD CONSTRAINT  SYS_C0025884 PRIMARY KEY (CUST_CODE,SEQ,ETC_SEQ);



CREATE TABLE HD_RENT_ETC
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019544 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019545 NOT NULL ,
	ETC_SEQ              NUMBER(3) CONSTRAINT SYS_C0019546 NOT NULL ,
	UNIQUE_DIV           VARCHAR2(2 BYTE) NULL ,
	EFFECT_NO            VARCHAR2(20 BYTE) NULL ,
	DELIVERY_DATE        VARCHAR2(8 BYTE) NULL ,
	CREDITOR             VARCHAR2(10 BYTE) NULL ,
	BOND_AMT             NUMBER(13) NULL ,
	CANCEL_YN            VARCHAR2(1 BYTE) NULL ,
	CANCEL_DATE          VARCHAR2(8 BYTE) NULL ,
	CANCEL_DESC          VARCHAR2(120 BYTE) NULL ,
	REMARK               VARCHAR2(120 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_RENT_ETC
	ADD CONSTRAINT  SYS_C0019547 PRIMARY KEY (CUST_CODE,SEQ,ETC_SEQ);



CREATE TABLE HD_RENT_FIXRATE
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025885 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025886 NOT NULL ,
	WORKMM               NUMBER(3) CONSTRAINT SYS_C0025887 NOT NULL ,
	RATE1                FLOAT(126) NULL ,
	RATE2                FLOAT(126) NULL ,
	START_TAG            VARCHAR2(1 BYTE) NULL ,
	END_TAG              VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_RENT_FIXRATE
	ADD CONSTRAINT  SYS_C0025888 PRIMARY KEY (DEPT_CODE,HOUSETAG,WORKMM);



CREATE TABLE HD_RENT_FIXRATE
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019548 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019549 NOT NULL ,
	WORKMM               NUMBER(3) CONSTRAINT SYS_C0019550 NOT NULL ,
	RATE1                FLOAT(126) NULL ,
	RATE2                FLOAT(126) NULL ,
	START_TAG            VARCHAR2(1 BYTE) NULL ,
	END_TAG              VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_RENT_FIXRATE
	ADD CONSTRAINT  SYS_C0019551 PRIMARY KEY (DEPT_CODE,HOUSETAG,WORKMM);



CREATE TABLE HD_RENT_GIRO
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025889 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025890 NOT NULL ,
	GIRO_TAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025891 NOT NULL ,
	BILL_YM              VARCHAR2(6 BYTE) CONSTRAINT SYS_C0025892 NOT NULL ,
	END_DATE             VARCHAR2(8 BYTE) NULL ,
	MAKE_DATE            VARCHAR2(8 BYTE) NULL ,
	J_AMT                NUMBER(15) NULL ,
	J_DAMT               NUMBER(15) NULL ,
	D_AMT                NUMBER(15) NULL ,
	D_SAMT               NUMBER(15) NULL ,
	D_VAMT               NUMBER(15) NULL ,
	D_IAMT               NUMBER(15) NULL ,
	AMT                  NUMBER(15) NULL ,
	GIRO_NO              VARCHAR2(10 BYTE) NULL ,
	CUST_NO              VARCHAR2(20 BYTE) NULL ,
	AMT_NO               VARCHAR2(15 BYTE) NULL ,
	DEPOSIT_NO           VARCHAR2(100 BYTE) NULL ,
	DEPOSIT_TAG          VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	JYM1                 VARCHAR2(6 BYTE) NULL ,
	JYMAMT1              NUMBER(15) NULL ,
	JYM2                 VARCHAR2(6 BYTE) NULL ,
	JYMAMT2              NUMBER(15) NULL ,
	JYM3                 VARCHAR2(6 BYTE) NULL ,
	JYMAMT3              NUMBER(15) NULL ,
	PRINT_YN             VARCHAR2(1 BYTE) NULL 
);



ALTER TABLE HD_RENT_GIRO
	ADD CONSTRAINT  SYS_C0025893 PRIMARY KEY (CUST_CODE,SEQ,GIRO_TAG,BILL_YM);



CREATE TABLE HD_RENT_GIRO
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019552 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019553 NOT NULL ,
	GIRO_TAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019554 NOT NULL ,
	BILL_YM              VARCHAR2(6 BYTE) CONSTRAINT SYS_C0019555 NOT NULL ,
	END_DATE             VARCHAR2(8 BYTE) NULL ,
	MAKE_DATE            VARCHAR2(8 BYTE) NULL ,
	J_AMT                NUMBER(15) NULL ,
	J_DAMT               NUMBER(15) NULL ,
	D_AMT                NUMBER(15) NULL ,
	D_SAMT               NUMBER(15) NULL ,
	D_VAMT               NUMBER(15) NULL ,
	D_IAMT               NUMBER(15) NULL ,
	AMT                  NUMBER(15) NULL ,
	GIRO_NO              VARCHAR2(10 BYTE) NULL ,
	CUST_NO              VARCHAR2(20 BYTE) NULL ,
	AMT_NO               VARCHAR2(15 BYTE) NULL ,
	DEPOSIT_NO           VARCHAR2(100 BYTE) NULL ,
	DEPOSIT_TAG          VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	JYM1                 VARCHAR2(6 BYTE) NULL ,
	JYMAMT1              NUMBER(15) NULL ,
	JYM2                 VARCHAR2(6 BYTE) NULL ,
	JYMAMT2              NUMBER(15) NULL ,
	JYM3                 VARCHAR2(6 BYTE) NULL ,
	JYMAMT3              NUMBER(15) NULL ,
	PRINT_YN             VARCHAR2(1 BYTE) NULL 
);



ALTER TABLE HD_RENT_GIRO
	ADD CONSTRAINT  SYS_C0019556 PRIMARY KEY (CUST_CODE,SEQ,GIRO_TAG,BILL_YM);



CREATE TABLE HD_RENT_GURT_AGREE
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025894 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025895 NOT NULL ,
	TERM_CHG_SEQ         NUMBER(3) CONSTRAINT SYS_C0025896 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0025897 NOT NULL ,
	AGREE_DATE           VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025898 NOT NULL ,
	AGREE_AMT            NUMBER(13) NULL ,
	DISCNT_YN            VARCHAR2(1 BYTE) NULL ,
	DELAY_YN             VARCHAR2(1 BYTE) NULL ,
	PERPECT_TAG          VARCHAR2(1 BYTE) DEFAULT  'N'  CONSTRAINT SYS_C0025899 NOT NULL ,
	RECEIPT_AMT          NUMBER(12) CONSTRAINT SYS_C0025900 NOT NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	SLIP_DATE            VARCHAR2(8 BYTE) NULL ,
	SLIP_SEQ             NUMBER(5) NULL 
);



ALTER TABLE HD_RENT_GURT_AGREE
	ADD CONSTRAINT  SYS_C0025901 PRIMARY KEY (CUST_CODE,SEQ,TERM_CHG_SEQ,COUNTS);



CREATE TABLE HD_RENT_GURT_AGREE
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019557 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019558 NOT NULL ,
	TERM_CHG_SEQ         NUMBER(3) CONSTRAINT SYS_C0019559 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019560 NOT NULL ,
	AGREE_DATE           VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019561 NOT NULL ,
	AGREE_AMT            NUMBER(13) NULL ,
	DISCNT_YN            VARCHAR2(1 BYTE) NULL ,
	DELAY_YN             VARCHAR2(1 BYTE) NULL ,
	PERPECT_TAG          VARCHAR2(1 BYTE) DEFAULT  'N'  CONSTRAINT SYS_C0019562 NOT NULL ,
	RECEIPT_AMT          NUMBER(12) CONSTRAINT SYS_C0019563 NOT NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	SLIP_DATE            VARCHAR2(8 BYTE) NULL ,
	SLIP_SEQ             NUMBER(5) NULL 
);



ALTER TABLE HD_RENT_GURT_AGREE
	ADD CONSTRAINT  SYS_C0019564 PRIMARY KEY (CUST_CODE,SEQ,TERM_CHG_SEQ,COUNTS);



CREATE TABLE HD_RENT_GURT_AGREE_ADJ
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025902 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025903 NOT NULL ,
	TERM_CHG_SEQ         NUMBER(3) CONSTRAINT SYS_C0025904 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0025905 NOT NULL ,
	AGREE_DATE           VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025906 NOT NULL ,
	AGREE_AMT            NUMBER(13) NULL ,
	DISCNT_YN            VARCHAR2(1 BYTE) NULL ,
	DELAY_YN             VARCHAR2(1 BYTE) NULL ,
	PERPECT_TAG          VARCHAR2(1 BYTE) DEFAULT  'N'  CONSTRAINT SYS_C0025907 NOT NULL ,
	RECEIPT_AMT          NUMBER(12) CONSTRAINT SYS_C0025908 NOT NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	SLIP_DATE            VARCHAR2(8 BYTE) NULL ,
	SLIP_SEQ             NUMBER(5) NULL 
);



CREATE UNIQUE INDEX XPKHD_RENT_GURT_AGREE_ADJ ON HD_RENT_GURT_AGREE_ADJ
(CUST_CODE   ASC,SEQ   ASC,TERM_CHG_SEQ   ASC,COUNTS   ASC);



ALTER TABLE HD_RENT_GURT_AGREE_ADJ
	ADD CONSTRAINT  SYS_C0025909 PRIMARY KEY (CUST_CODE,SEQ,TERM_CHG_SEQ,COUNTS);



CREATE TABLE HD_RENT_GURT_AGREE_ADJ
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019565 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019566 NOT NULL ,
	TERM_CHG_SEQ         NUMBER(3) CONSTRAINT SYS_C0019567 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019568 NOT NULL ,
	AGREE_DATE           VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019569 NOT NULL ,
	AGREE_AMT            NUMBER(13) NULL ,
	DISCNT_YN            VARCHAR2(1 BYTE) NULL ,
	DELAY_YN             VARCHAR2(1 BYTE) NULL ,
	PERPECT_TAG          VARCHAR2(1 BYTE) DEFAULT  'N'  CONSTRAINT SYS_C0019570 NOT NULL ,
	RECEIPT_AMT          NUMBER(12) CONSTRAINT SYS_C0019571 NOT NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	SLIP_DATE            VARCHAR2(8 BYTE) NULL ,
	SLIP_SEQ             NUMBER(5) NULL 
);



CREATE UNIQUE INDEX XPKHD_RENT_GURT_AGREE_ADJ ON HD_RENT_GURT_AGREE_ADJ
(CUST_CODE   ASC,SEQ   ASC,TERM_CHG_SEQ   ASC,COUNTS   ASC);



ALTER TABLE HD_RENT_GURT_AGREE_ADJ
	ADD CONSTRAINT  SYS_C0019572 PRIMARY KEY (CUST_CODE,SEQ,TERM_CHG_SEQ,COUNTS);



CREATE TABLE HD_RENT_GURT_AGREE_TEMP
(
	SEQ_NUM              NUMBER(18) CONSTRAINT SYS_C0025910 NOT NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025911 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025912 NOT NULL ,
	TERM_CHG_SEQ         NUMBER(3) CONSTRAINT SYS_C0025913 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0025914 NOT NULL ,
	AGREE_DATE           VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025915 NOT NULL ,
	AGREE_AMT            NUMBER(13) NULL ,
	DISCNT_YN            VARCHAR2(1 BYTE) NULL ,
	DELAY_YN             VARCHAR2(1 BYTE) NULL ,
	PERPECT_TAG          VARCHAR2(1 BYTE) DEFAULT  'N'  CONSTRAINT SYS_C0025916 NOT NULL ,
	RECEIPT_AMT          NUMBER(12) CONSTRAINT SYS_C0025917 NOT NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	SLIP_DATE            VARCHAR2(8 BYTE) NULL ,
	SLIP_SEQ             NUMBER(5) NULL 
);



ALTER TABLE HD_RENT_GURT_AGREE_TEMP
	ADD CONSTRAINT  SYS_C0025918 PRIMARY KEY (SEQ_NUM,CUST_CODE,SEQ,TERM_CHG_SEQ,COUNTS);



CREATE TABLE HD_RENT_GURT_AGREE_TEMP
(
	SEQ_NUM              NUMBER(18) CONSTRAINT SYS_C0019573 NOT NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019574 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019575 NOT NULL ,
	TERM_CHG_SEQ         NUMBER(3) CONSTRAINT SYS_C0019576 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019577 NOT NULL ,
	AGREE_DATE           VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019578 NOT NULL ,
	AGREE_AMT            NUMBER(13) NULL ,
	DISCNT_YN            VARCHAR2(1 BYTE) NULL ,
	DELAY_YN             VARCHAR2(1 BYTE) NULL ,
	PERPECT_TAG          VARCHAR2(1 BYTE) DEFAULT  'N'  CONSTRAINT SYS_C0019579 NOT NULL ,
	RECEIPT_AMT          NUMBER(12) CONSTRAINT SYS_C0019580 NOT NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	SLIP_DATE            VARCHAR2(8 BYTE) NULL ,
	SLIP_SEQ             NUMBER(5) NULL 
);



ALTER TABLE HD_RENT_GURT_AGREE_TEMP
	ADD CONSTRAINT  SYS_C0019581 PRIMARY KEY (SEQ_NUM,CUST_CODE,SEQ,TERM_CHG_SEQ,COUNTS);



CREATE TABLE HD_RENT_GURT_INCOME
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025919 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025920 NOT NULL ,
	TERM_CHG_SEQ         NUMBER(3) CONSTRAINT SYS_C0025921 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0025922 NOT NULL ,
	TIMES                FLOAT(126) CONSTRAINT SYS_C0025923 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) NULL ,
	IN_DATE              VARCHAR2(8 BYTE) NULL ,
	IN_SEQ               NUMBER(5) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) NULL ,
	RECEIPT_DATE         VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025924 NOT NULL ,
	RECEIPT_AMT          NUMBER(13) CONSTRAINT SYS_C0025925 NOT NULL ,
	DELAY_DAYS           NUMBER(6) CONSTRAINT SYS_C0025926 NOT NULL ,
	DELAY_AMT            NUMBER(12) CONSTRAINT SYS_C0025927 NOT NULL ,
	DISCNT_DAYS          NUMBER(6) CONSTRAINT SYS_C0025928 NOT NULL ,
	DISCNT_AMT           NUMBER(12) CONSTRAINT SYS_C0025929 NOT NULL ,
	REALINCOM_AMT        NUMBER(13) CONSTRAINT SYS_C0025930 NOT NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025931 NOT NULL ,
	BANK_NAME            VARCHAR2(30 BYTE) NULL ,
	PAY_TAG              VARCHAR2(2 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025932 NOT NULL ,
	INCOM_TYPE           VARCHAR2(2 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	REAL_PAY_TAG         VARCHAR2(1 BYTE) NULL ,
	SLIP_DATE            VARCHAR2(8 BYTE) NULL ,
	SLIP_SEQ             NUMBER(5) NULL ,
	TAX_DATE             VARCHAR2(8 BYTE) NULL ,
	TAX_SEQ              NUMBER(5) NULL ,
	SLIP_TYPE            VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	VDEPOSIT_NO          VARCHAR2(30 BYTE) NULL ,
	OUT_DT               VARCHAR2(8 BYTE) NULL ,
	OUT_TM               VARCHAR2(6 BYTE) NULL ,
	OUT_SEQ              FLOAT(126) NULL ,
	OUT_BANK             VARCHAR2(6 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL 
);



ALTER TABLE HD_RENT_GURT_INCOME
	ADD CONSTRAINT  SYS_C0025933 PRIMARY KEY (CUST_CODE,SEQ,TERM_CHG_SEQ,COUNTS,TIMES);



CREATE TABLE HD_RENT_GURT_INCOME
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019582 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019583 NOT NULL ,
	TERM_CHG_SEQ         NUMBER(3) CONSTRAINT SYS_C0019584 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019585 NOT NULL ,
	TIMES                FLOAT(126) CONSTRAINT SYS_C0019586 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) NULL ,
	IN_DATE              VARCHAR2(8 BYTE) NULL ,
	IN_SEQ               NUMBER(5) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) NULL ,
	RECEIPT_DATE         VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019587 NOT NULL ,
	RECEIPT_AMT          NUMBER(13) CONSTRAINT SYS_C0019588 NOT NULL ,
	DELAY_DAYS           NUMBER(3) CONSTRAINT SYS_C0019589 NOT NULL ,
	DELAY_AMT            NUMBER(12) CONSTRAINT SYS_C0019590 NOT NULL ,
	DISCNT_DAYS          NUMBER(3) CONSTRAINT SYS_C0019591 NOT NULL ,
	DISCNT_AMT           NUMBER(12) CONSTRAINT SYS_C0019592 NOT NULL ,
	REALINCOM_AMT        NUMBER(13) CONSTRAINT SYS_C0019593 NOT NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019594 NOT NULL ,
	BANK_NAME            VARCHAR2(30 BYTE) NULL ,
	PAY_TAG              VARCHAR2(2 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019595 NOT NULL ,
	INCOM_TYPE           VARCHAR2(2 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	REAL_PAY_TAG         VARCHAR2(1 BYTE) NULL ,
	SLIP_DATE            VARCHAR2(8 BYTE) NULL ,
	SLIP_SEQ             NUMBER(5) NULL ,
	TAX_DATE             VARCHAR2(8 BYTE) NULL ,
	TAX_SEQ              NUMBER(5) NULL ,
	SLIP_TYPE            VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	VDEPOSIT_NO          VARCHAR2(30 BYTE) NULL ,
	OUT_DT               VARCHAR2(8 BYTE) NULL ,
	OUT_TM               VARCHAR2(6 BYTE) NULL ,
	OUT_SEQ              FLOAT(126) NULL ,
	OUT_BANK             VARCHAR2(6 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL 
);



ALTER TABLE HD_RENT_GURT_INCOME
	ADD CONSTRAINT  SYS_C0019596 PRIMARY KEY (CUST_CODE,SEQ,TERM_CHG_SEQ,COUNTS,TIMES);



CREATE TABLE HD_RENT_GURT_INCOME_ADJ
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025934 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025935 NOT NULL ,
	TERM_CHG_SEQ         NUMBER(3) CONSTRAINT SYS_C0025936 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0025937 NOT NULL ,
	TIMES                FLOAT(126) CONSTRAINT SYS_C0025938 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) NULL ,
	IN_DATE              VARCHAR2(8 BYTE) NULL ,
	IN_SEQ               NUMBER(5) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) NULL ,
	RECEIPT_DATE         VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025939 NOT NULL ,
	RECEIPT_AMT          NUMBER(13) CONSTRAINT SYS_C0025940 NOT NULL ,
	DELAY_DAYS           NUMBER(3) CONSTRAINT SYS_C0025941 NOT NULL ,
	DELAY_AMT            NUMBER(12) CONSTRAINT SYS_C0025942 NOT NULL ,
	DISCNT_DAYS          NUMBER(3) CONSTRAINT SYS_C0025943 NOT NULL ,
	DISCNT_AMT           NUMBER(12) CONSTRAINT SYS_C0025944 NOT NULL ,
	REALINCOM_AMT        NUMBER(13) CONSTRAINT SYS_C0025945 NOT NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025946 NOT NULL ,
	BANK_NAME            VARCHAR2(30 BYTE) NULL ,
	PAY_TAG              VARCHAR2(2 BYTE) NULL ,
	INCOM_TYPE           VARCHAR2(2 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	REAL_PAY_TAG         VARCHAR2(1 BYTE) NULL ,
	SLIP_DATE            VARCHAR2(8 BYTE) NULL ,
	SLIP_SEQ             NUMBER(5) NULL ,
	TAX_DATE             VARCHAR2(8 BYTE) NULL ,
	TAX_SEQ              NUMBER(5) NULL ,
	SLIP_TYPE            VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	VDEPOSIT_NO          VARCHAR2(30 BYTE) NULL ,
	OUT_DT               VARCHAR2(8 BYTE) NULL ,
	OUT_TM               VARCHAR2(6 BYTE) NULL ,
	OUT_SEQ              FLOAT(126) NULL ,
	OUT_BANK             VARCHAR2(6 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL 
);



CREATE UNIQUE INDEX XPKHD_RENT_GURT_INCOME_ADJ ON HD_RENT_GURT_INCOME_ADJ
(CUST_CODE   ASC,SEQ   ASC,TERM_CHG_SEQ   ASC,COUNTS   ASC,TIMES   ASC);



ALTER TABLE HD_RENT_GURT_INCOME_ADJ
	ADD CONSTRAINT  SYS_C0025947 PRIMARY KEY (CUST_CODE,SEQ,TERM_CHG_SEQ,COUNTS,TIMES);



CREATE TABLE HD_RENT_GURT_INCOME_ADJ
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019597 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019598 NOT NULL ,
	TERM_CHG_SEQ         NUMBER(3) CONSTRAINT SYS_C0019599 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019600 NOT NULL ,
	TIMES                FLOAT(126) CONSTRAINT SYS_C0019601 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) NULL ,
	IN_DATE              VARCHAR2(8 BYTE) NULL ,
	IN_SEQ               NUMBER(5) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) NULL ,
	RECEIPT_DATE         VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019602 NOT NULL ,
	RECEIPT_AMT          NUMBER(13) CONSTRAINT SYS_C0019603 NOT NULL ,
	DELAY_DAYS           NUMBER(3) CONSTRAINT SYS_C0019604 NOT NULL ,
	DELAY_AMT            NUMBER(12) CONSTRAINT SYS_C0019605 NOT NULL ,
	DISCNT_DAYS          NUMBER(3) CONSTRAINT SYS_C0019606 NOT NULL ,
	DISCNT_AMT           NUMBER(12) CONSTRAINT SYS_C0019607 NOT NULL ,
	REALINCOM_AMT        NUMBER(13) CONSTRAINT SYS_C0019608 NOT NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019609 NOT NULL ,
	BANK_NAME            VARCHAR2(30 BYTE) NULL ,
	PAY_TAG              VARCHAR2(2 BYTE) NULL ,
	INCOM_TYPE           VARCHAR2(2 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	REAL_PAY_TAG         VARCHAR2(1 BYTE) NULL ,
	SLIP_DATE            VARCHAR2(8 BYTE) NULL ,
	SLIP_SEQ             NUMBER(5) NULL ,
	TAX_DATE             VARCHAR2(8 BYTE) NULL ,
	TAX_SEQ              NUMBER(5) NULL ,
	SLIP_TYPE            VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	VDEPOSIT_NO          VARCHAR2(30 BYTE) NULL ,
	OUT_DT               VARCHAR2(8 BYTE) NULL ,
	OUT_TM               VARCHAR2(6 BYTE) NULL ,
	OUT_SEQ              FLOAT(126) NULL ,
	OUT_BANK             VARCHAR2(6 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL 
);



CREATE UNIQUE INDEX XPKHD_RENT_GURT_INCOME_ADJ ON HD_RENT_GURT_INCOME_ADJ
(CUST_CODE   ASC,SEQ   ASC,TERM_CHG_SEQ   ASC,COUNTS   ASC,TIMES   ASC);



ALTER TABLE HD_RENT_GURT_INCOME_ADJ
	ADD CONSTRAINT  SYS_C0019610 PRIMARY KEY (CUST_CODE,SEQ,TERM_CHG_SEQ,COUNTS,TIMES);



CREATE TABLE HD_RENT_GURT_INCOME_DAILY
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025948 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025949 NOT NULL ,
	IN_DATE              VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025950 NOT NULL ,
	IN_SEQ               NUMBER(5) CONSTRAINT SYS_C0025951 NOT NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) NULL ,
	SEQ                  NUMBER(5) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) NULL ,
	IN_AMT               NUMBER(12) NULL ,
	IN_GUBUN             VARCHAR2(2 BYTE) NULL ,
	IN_TYPE              VARCHAR2(2 BYTE) NULL ,
	TRANS_YN             VARCHAR2(1 BYTE) NULL ,
	CARD_NO              VARCHAR2(20 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	MOD_DELAY_AMT        NUMBER(12) NULL ,
	MOD_DISC_AMT         NUMBER(12) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	VDEPOSIT_NO          VARCHAR2(30 BYTE) NULL ,
	OUT_DT               VARCHAR2(8 BYTE) NULL ,
	OUT_TM               VARCHAR2(6 BYTE) NULL ,
	OUT_SEQ              FLOAT(126) NULL ,
	OUT_BANK             VARCHAR2(6 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL 
);



ALTER TABLE HD_RENT_GURT_INCOME_DAILY
	ADD CONSTRAINT  SYS_C0025952 PRIMARY KEY (DEPT_CODE,HOUSETAG,IN_DATE,IN_SEQ);



CREATE TABLE HD_RENT_GURT_INCOME_DAILY
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019611 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019612 NOT NULL ,
	IN_DATE              VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019613 NOT NULL ,
	IN_SEQ               NUMBER(5) CONSTRAINT SYS_C0019614 NOT NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) NULL ,
	SEQ                  NUMBER(5) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) NULL ,
	IN_AMT               NUMBER(12) NULL ,
	IN_GUBUN             VARCHAR2(2 BYTE) NULL ,
	IN_TYPE              VARCHAR2(2 BYTE) NULL ,
	TRANS_YN             VARCHAR2(1 BYTE) NULL ,
	CARD_NO              VARCHAR2(20 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	MOD_DELAY_AMT        NUMBER(12) NULL ,
	MOD_DISC_AMT         NUMBER(12) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	VDEPOSIT_NO          VARCHAR2(30 BYTE) NULL ,
	OUT_DT               VARCHAR2(8 BYTE) NULL ,
	OUT_TM               VARCHAR2(6 BYTE) NULL ,
	OUT_SEQ              FLOAT(126) NULL ,
	OUT_BANK             VARCHAR2(6 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL 
);



ALTER TABLE HD_RENT_GURT_INCOME_DAILY
	ADD CONSTRAINT  SYS_C0019615 PRIMARY KEY (DEPT_CODE,HOUSETAG,IN_DATE,IN_SEQ);



CREATE TABLE HD_RENT_GURT_INCOME_DAILY_ADJ
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025953 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025954 NOT NULL ,
	IN_DATE              VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025955 NOT NULL ,
	IN_SEQ               NUMBER(5) CONSTRAINT SYS_C0025956 NOT NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) NULL ,
	SEQ                  NUMBER(5) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) NULL ,
	IN_AMT               NUMBER(12) NULL ,
	IN_GUBUN             VARCHAR2(2 BYTE) NULL ,
	IN_TYPE              VARCHAR2(2 BYTE) NULL ,
	TRANS_YN             VARCHAR2(1 BYTE) NULL ,
	CARD_NO              VARCHAR2(20 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	MOD_DELAY_AMT        NUMBER(12) NULL ,
	MOD_DISC_AMT         NUMBER(12) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	VDEPOSIT_NO          VARCHAR2(30 BYTE) NULL ,
	OUT_DT               VARCHAR2(8 BYTE) NULL ,
	OUT_TM               VARCHAR2(6 BYTE) NULL ,
	OUT_SEQ              FLOAT(126) NULL ,
	OUT_BANK             VARCHAR2(6 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL 
);



ALTER TABLE HD_RENT_GURT_INCOME_DAILY_ADJ
	ADD CONSTRAINT  SYS_C0025957 PRIMARY KEY (DEPT_CODE,HOUSETAG,IN_DATE,IN_SEQ);



CREATE TABLE HD_RENT_GURT_INCOME_DAILY_ADJ
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019616 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019617 NOT NULL ,
	IN_DATE              VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019618 NOT NULL ,
	IN_SEQ               NUMBER(5) CONSTRAINT SYS_C0019619 NOT NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) NULL ,
	SEQ                  NUMBER(5) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) NULL ,
	IN_AMT               NUMBER(12) NULL ,
	IN_GUBUN             VARCHAR2(2 BYTE) NULL ,
	IN_TYPE              VARCHAR2(2 BYTE) NULL ,
	TRANS_YN             VARCHAR2(1 BYTE) NULL ,
	CARD_NO              VARCHAR2(20 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	MOD_DELAY_AMT        NUMBER(12) NULL ,
	MOD_DISC_AMT         NUMBER(12) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	VDEPOSIT_NO          VARCHAR2(30 BYTE) NULL ,
	OUT_DT               VARCHAR2(8 BYTE) NULL ,
	OUT_TM               VARCHAR2(6 BYTE) NULL ,
	OUT_SEQ              FLOAT(126) NULL ,
	OUT_BANK             VARCHAR2(6 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL 
);



ALTER TABLE HD_RENT_GURT_INCOME_DAILY_ADJ
	ADD CONSTRAINT  SYS_C0019620 PRIMARY KEY (DEPT_CODE,HOUSETAG,IN_DATE,IN_SEQ);



CREATE TABLE HD_RENT_GURT_INCOME_TEMP
(
	SEQ_NUM              NUMBER(18) CONSTRAINT SYS_C0025958 NOT NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025959 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025960 NOT NULL ,
	TERM_CHG_SEQ         NUMBER(3) CONSTRAINT SYS_C0025961 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0025962 NOT NULL ,
	TIMES                FLOAT(126) CONSTRAINT SYS_C0025963 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) NULL ,
	IN_DATE              VARCHAR2(8 BYTE) NULL ,
	IN_SEQ               NUMBER(5) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) NULL ,
	RECEIPT_DATE         VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025964 NOT NULL ,
	RECEIPT_AMT          NUMBER(13) CONSTRAINT SYS_C0025965 NOT NULL ,
	DELAY_DAYS           NUMBER(3) CONSTRAINT SYS_C0025966 NOT NULL ,
	DELAY_AMT            NUMBER(12) CONSTRAINT SYS_C0025967 NOT NULL ,
	DISCNT_DAYS          NUMBER(3) CONSTRAINT SYS_C0025968 NOT NULL ,
	DISCNT_AMT           NUMBER(12) CONSTRAINT SYS_C0025969 NOT NULL ,
	REALINCOM_AMT        NUMBER(13) CONSTRAINT SYS_C0025970 NOT NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025971 NOT NULL ,
	BANK_NAME            VARCHAR2(30 BYTE) NULL ,
	PAY_TAG              VARCHAR2(2 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025972 NOT NULL ,
	INCOM_TYPE           VARCHAR2(2 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	REAL_PAY_TAG         VARCHAR2(1 BYTE) NULL ,
	SLIP_DATE            VARCHAR2(8 BYTE) NULL ,
	SLIP_SEQ             NUMBER(5) NULL ,
	TAX_DATE             VARCHAR2(8 BYTE) NULL ,
	TAX_SEQ              NUMBER(5) NULL ,
	SLIP_TYPE            VARCHAR2(1 BYTE) NULL ,
	CALC_YN              VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	VDEPOSIT_NO          VARCHAR2(30 BYTE) NULL ,
	OUT_DT               VARCHAR2(8 BYTE) NULL ,
	OUT_TM               VARCHAR2(6 BYTE) NULL ,
	OUT_SEQ              FLOAT(126) NULL ,
	OUT_BANK             VARCHAR2(6 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL 
);



ALTER TABLE HD_RENT_GURT_INCOME_TEMP
	ADD CONSTRAINT  SYS_C0025973 PRIMARY KEY (SEQ_NUM,CUST_CODE,SEQ,TERM_CHG_SEQ,COUNTS,TIMES);



CREATE TABLE HD_RENT_GURT_INCOME_TEMP
(
	SEQ_NUM              NUMBER(18) CONSTRAINT SYS_C0019621 NOT NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019622 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019623 NOT NULL ,
	TERM_CHG_SEQ         NUMBER(3) CONSTRAINT SYS_C0019624 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019625 NOT NULL ,
	TIMES                FLOAT(126) CONSTRAINT SYS_C0019626 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) NULL ,
	IN_DATE              VARCHAR2(8 BYTE) NULL ,
	IN_SEQ               NUMBER(5) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) NULL ,
	RECEIPT_DATE         VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019627 NOT NULL ,
	RECEIPT_AMT          NUMBER(13) CONSTRAINT SYS_C0019628 NOT NULL ,
	DELAY_DAYS           NUMBER(3) CONSTRAINT SYS_C0019629 NOT NULL ,
	DELAY_AMT            NUMBER(12) CONSTRAINT SYS_C0019630 NOT NULL ,
	DISCNT_DAYS          NUMBER(3) CONSTRAINT SYS_C0019631 NOT NULL ,
	DISCNT_AMT           NUMBER(12) CONSTRAINT SYS_C0019632 NOT NULL ,
	REALINCOM_AMT        NUMBER(13) CONSTRAINT SYS_C0019633 NOT NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019634 NOT NULL ,
	BANK_NAME            VARCHAR2(30 BYTE) NULL ,
	PAY_TAG              VARCHAR2(2 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019635 NOT NULL ,
	INCOM_TYPE           VARCHAR2(2 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	REAL_PAY_TAG         VARCHAR2(1 BYTE) NULL ,
	SLIP_DATE            VARCHAR2(8 BYTE) NULL ,
	SLIP_SEQ             NUMBER(5) NULL ,
	TAX_DATE             VARCHAR2(8 BYTE) NULL ,
	TAX_SEQ              NUMBER(5) NULL ,
	SLIP_TYPE            VARCHAR2(1 BYTE) NULL ,
	CALC_YN              VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	VDEPOSIT_NO          VARCHAR2(30 BYTE) NULL ,
	OUT_DT               VARCHAR2(8 BYTE) NULL ,
	OUT_TM               VARCHAR2(6 BYTE) NULL ,
	OUT_SEQ              FLOAT(126) NULL ,
	OUT_BANK             VARCHAR2(6 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL 
);



ALTER TABLE HD_RENT_GURT_INCOME_TEMP
	ADD CONSTRAINT  SYS_C0019636 PRIMARY KEY (SEQ_NUM,CUST_CODE,SEQ,TERM_CHG_SEQ,COUNTS,TIMES);



CREATE TABLE HD_RENT_MANAGEMENT
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025974 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025975 NOT NULL ,
	YM                   VARCHAR2(6 BYTE) CONSTRAINT SYS_C0025976 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025977 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0025978 NOT NULL ,
	AMT                  NUMBER(15) DEFAULT  0  NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_RENT_MANAGEMENT
	ADD CONSTRAINT  SYS_C0025979 PRIMARY KEY (DEPT_CODE,HOUSETAG,YM,BUILDNO,HOUSENO);



CREATE TABLE HD_RENT_MANAGEMENT
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019637 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019638 NOT NULL ,
	YM                   VARCHAR2(6 BYTE) CONSTRAINT SYS_C0019639 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019640 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019641 NOT NULL ,
	AMT                  NUMBER(15) DEFAULT  0  NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_RENT_MANAGEMENT
	ADD CONSTRAINT  SYS_C0019642 PRIMARY KEY (DEPT_CODE,HOUSETAG,YM,BUILDNO,HOUSENO);



CREATE TABLE HD_RENT_MANAGEMENT_CONV
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0025980 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0025981 NOT NULL ,
	YM                   VARCHAR2(6 BYTE) CONSTRAINT SYS_C0025982 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025983 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	AMT                  NUMBER(15) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL 
);



CREATE UNIQUE INDEX XPKHD_RENT_MANAGEMENT_CONV ON HD_RENT_MANAGEMENT_CONV
(DEPT_CODE   ASC,HOUSETAG   ASC,YM   ASC,SEQ   ASC);



ALTER TABLE HD_RENT_MANAGEMENT_CONV
	ADD CONSTRAINT  SYS_C0025984 PRIMARY KEY (DEPT_CODE,HOUSETAG,YM,SEQ);



CREATE TABLE HD_RENT_MANAGEMENT_CONV
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019643 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019644 NOT NULL ,
	YM                   VARCHAR2(6 BYTE) CONSTRAINT SYS_C0019645 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019646 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	AMT                  NUMBER(15) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL 
);



CREATE UNIQUE INDEX XPKHD_RENT_MANAGEMENT_CONV ON HD_RENT_MANAGEMENT_CONV
(DEPT_CODE   ASC,HOUSETAG   ASC,YM   ASC,SEQ   ASC);



CREATE TABLE HD_RENT_MASTER
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025985 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025986 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	CUST_NAME            VARCHAR2(50 BYTE) NULL ,
	CONT_DATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025987 NOT NULL ,
	CONT_NO              VARCHAR2(10 BYTE) NULL ,
	CONT_TYPE            VARCHAR2(2 BYTE) NULL ,
	VAT_YN               VARCHAR2(1 BYTE) NULL ,
	GUARANTEE_AMT        NUMBER(12) NULL ,
	RENT_SUPPLY          NUMBER(12) NULL ,
	RENT_VAT             NUMBER(12) NULL ,
	RENT_SDATE           VARCHAR2(8 BYTE) NULL ,
	RENT_EDATE           VARCHAR2(8 BYTE) NULL ,
	REAL_CUST_NAME       VARCHAR2(30 BYTE) NULL ,
	REAL_IN_DATE         VARCHAR2(8 BYTE) NULL ,
	CHANGE_TAG           VARCHAR2(1 BYTE) NULL ,
	CHANGE_DATE          VARCHAR2(8 BYTE) NULL ,
	LAST_CHANGE_DATE     VARCHAR2(8 BYTE) NULL ,
	RENT_CHG_SEQ         NUMBER(3) NULL ,
	TERM_CHG_SEQ         NUMBER(3) NULL ,
	RELA_CUSTCODE        VARCHAR2(20 BYTE) NULL ,
	RELA_SEQ             NUMBER(5) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	RENTHD_YN            VARCHAR2(1 BYTE) NULL ,
	RENTHD_SEQ           NUMBER(5) NULL ,
	DAYMONTH_TAG         VARCHAR2(1 BYTE) NULL ,
	FIXRATE_TAG          VARCHAR2(1 BYTE) NULL ,
	VIR_YN               VARCHAR2(1 BYTE) NULL ,
	VDEPOSIT             VARCHAR2(50 BYTE) NULL ,
	RENT_INS             NUMBER(12) NULL ,
	FIXRATE              FLOAT(126) NULL ,
	FIXRATE2             FLOAT(126) NULL ,
	FIXRATE_DAY          NUMBER(3) NULL ,
	HOPE_HOUSE_TAG       VARCHAR2(1 BYTE) DEFAULT  '0'  NULL ,
	RETURN_YN            VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	RETURN_DATE          VARCHAR2(8 BYTE) NULL ,
	R_GURTAMT            NUMBER(15) DEFAULT  0  NULL ,
	R_RENTAMT            NUMBER(15) DEFAULT  0  NULL ,
	R_DELAYAMT           NUMBER(15) DEFAULT  0  NULL ,
	R_PENALTYAMT         NUMBER(15) DEFAULT  0  NULL ,
	R_ETCAMT1            NUMBER(15) DEFAULT  0  NULL ,
	R_ETCAMT2            NUMBER(15) DEFAULT  0  NULL ,
	R_ETCAMT3            NUMBER(15) DEFAULT  0  NULL ,
	RETURN_AMT           NUMBER(15) DEFAULT  0  NULL ,
	SLIP_DATE            VARCHAR2(8 BYTE) NULL ,
	SLIP_SEQ             NUMBER(5) NULL ,
	HOUSECONTAMT         NUMBER(15) NULL ,
	R_BANK               VARCHAR2(40 BYTE) NULL ,
	R_DEPOSIT            VARCHAR2(30 BYTE) NULL ,
	R_DEPOSITOR          VARCHAR2(100 BYTE) NULL ,
	SLIP_SEQ2            NUMBER(5) NULL 
);



ALTER TABLE HD_RENT_MASTER
	ADD CONSTRAINT  SYS_C0025988 PRIMARY KEY (CUST_CODE,SEQ);



CREATE TABLE HD_RENT_MASTER
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019647 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019648 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  NULL ,
	BUILDNO              VARCHAR2(10 BYTE) NULL ,
	HOUSENO              VARCHAR2(10 BYTE) NULL ,
	CUST_NAME            VARCHAR2(50 BYTE) NULL ,
	CONT_DATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019649 NOT NULL ,
	CONT_NO              VARCHAR2(20 BYTE) NULL ,
	CONT_TYPE            VARCHAR2(2 BYTE) NULL ,
	VAT_YN               VARCHAR2(1 BYTE) NULL ,
	GUARANTEE_AMT        NUMBER(12) NULL ,
	RENT_SUPPLY          NUMBER(12) NULL ,
	RENT_VAT             NUMBER(12) NULL ,
	RENT_SDATE           VARCHAR2(8 BYTE) NULL ,
	RENT_EDATE           VARCHAR2(8 BYTE) NULL ,
	REAL_CUST_NAME       VARCHAR2(30 BYTE) NULL ,
	REAL_IN_DATE         VARCHAR2(8 BYTE) NULL ,
	CHANGE_TAG           VARCHAR2(1 BYTE) NULL ,
	CHANGE_DATE          VARCHAR2(8 BYTE) NULL ,
	LAST_CHANGE_DATE     VARCHAR2(8 BYTE) NULL ,
	RENT_CHG_SEQ         NUMBER(3) NULL ,
	TERM_CHG_SEQ         NUMBER(3) NULL ,
	RELA_CUSTCODE        VARCHAR2(20 BYTE) NULL ,
	RELA_SEQ             NUMBER(5) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	RENTHD_YN            VARCHAR2(1 BYTE) NULL ,
	RENTHD_SEQ           NUMBER(5) NULL ,
	DAYMONTH_TAG         VARCHAR2(1 BYTE) NULL ,
	FIXRATE_TAG          VARCHAR2(1 BYTE) NULL ,
	VIR_YN               VARCHAR2(1 BYTE) NULL ,
	VDEPOSIT             VARCHAR2(50 BYTE) NULL ,
	RENT_INS             NUMBER(12) NULL ,
	FIXRATE              FLOAT(126) NULL ,
	FIXRATE2             FLOAT(126) NULL ,
	FIXRATE_DAY          NUMBER(3) NULL ,
	HOPE_HOUSE_TAG       VARCHAR2(1 BYTE) DEFAULT  '0'  NULL ,
	RETURN_YN            VARCHAR2(1 BYTE) DEFAULT  'N'  NULL ,
	RETURN_DATE          VARCHAR2(8 BYTE) NULL ,
	R_GURTAMT            NUMBER(15) DEFAULT  0  NULL ,
	R_RENTAMT            NUMBER(15) DEFAULT  0  NULL ,
	R_DELAYAMT           NUMBER(15) DEFAULT  0  NULL ,
	R_PENALTYAMT         NUMBER(15) DEFAULT  0  NULL ,
	R_ETCAMT1            NUMBER(15) DEFAULT  0  NULL ,
	R_ETCAMT2            NUMBER(15) DEFAULT  0  NULL ,
	R_ETCAMT3            NUMBER(15) DEFAULT  0  NULL ,
	RETURN_AMT           NUMBER(15) DEFAULT  0  NULL ,
	SLIP_DATE            VARCHAR2(8 BYTE) NULL ,
	SLIP_SEQ             NUMBER(5) NULL ,
	HOUSECONTAMT         NUMBER(15) NULL ,
	R_BANK               VARCHAR2(40 BYTE) NULL ,
	R_DEPOSIT            VARCHAR2(30 BYTE) NULL ,
	R_DEPOSITOR          VARCHAR2(100 BYTE) NULL ,
	SLIP_SEQ2            NUMBER(5) NULL 
);



ALTER TABLE HD_RENT_MASTER
	ADD CONSTRAINT  SYS_C0019650 PRIMARY KEY (CUST_CODE,SEQ);



CREATE TABLE HD_RENT_RATE_DELAY
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0025989 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0025990 NOT NULL ,
	RATE_TAG             VARCHAR2(2 BYTE) CONSTRAINT SYS_C0025991 NOT NULL ,
	START_DAYS           NUMBER(5) CONSTRAINT SYS_C0025992 NOT NULL ,
	END_DAYS             NUMBER(5) CONSTRAINT SYS_C0025993 NOT NULL ,
	STARTDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025994 NOT NULL ,
	ENDDATE              VARCHAR2(8 BYTE) CONSTRAINT SYS_C0025995 NOT NULL ,
	DELAYRATE            FLOAT(126) CONSTRAINT SYS_C0025996 NOT NULL ,
	DELAYCUT             VARCHAR2(2 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0025997 NOT NULL ,
	DELAYUNIT            VARCHAR2(2 BYTE) DEFAULT  '2'  CONSTRAINT SYS_C0025998 NOT NULL ,
	START_TAG            VARCHAR2(1 BYTE) NULL ,
	END_TAG              VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_RENT_RATE_DELAY
	ADD CONSTRAINT  SYS_C0025999 PRIMARY KEY (CUST_CODE,SEQ,RATE_TAG,START_DAYS,END_DAYS,STARTDATE);



CREATE TABLE HD_RENT_RATE_DELAY
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019651 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019652 NOT NULL ,
	RATE_TAG             VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019653 NOT NULL ,
	START_DAYS           NUMBER(5) CONSTRAINT SYS_C0019654 NOT NULL ,
	END_DAYS             NUMBER(5) CONSTRAINT SYS_C0019655 NOT NULL ,
	STARTDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019656 NOT NULL ,
	ENDDATE              VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019657 NOT NULL ,
	DELAYRATE            FLOAT(126) CONSTRAINT SYS_C0019658 NOT NULL ,
	DELAYCUT             VARCHAR2(2 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019659 NOT NULL ,
	DELAYUNIT            VARCHAR2(2 BYTE) DEFAULT  '2'  CONSTRAINT SYS_C0019660 NOT NULL ,
	START_TAG            VARCHAR2(1 BYTE) NULL ,
	END_TAG              VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_RENT_RATE_DELAY
	ADD CONSTRAINT  SYS_C0019661 PRIMARY KEY (CUST_CODE,SEQ,RATE_TAG,START_DAYS,END_DAYS,STARTDATE);



CREATE TABLE HD_RENT_RATE_DISCOUNT
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0026000 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0026001 NOT NULL ,
	RATE_TAG             VARCHAR2(2 BYTE) CONSTRAINT SYS_C0026002 NOT NULL ,
	STARTDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0026003 NOT NULL ,
	ENDDATE              VARCHAR2(8 BYTE) CONSTRAINT SYS_C0026004 NOT NULL ,
	DISCNTRATE           FLOAT(126) CONSTRAINT SYS_C0026005 NOT NULL ,
	DISCNTCUT            VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0026006 NOT NULL ,
	DISCNTUNIT           VARCHAR2(1 BYTE) DEFAULT  '2'  CONSTRAINT SYS_C0026007 NOT NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_RENT_RATE_DISCOUNT
	ADD CONSTRAINT  SYS_C0026008 PRIMARY KEY (CUST_CODE,SEQ,RATE_TAG,STARTDATE);



CREATE TABLE HD_RENT_RATE_DISCOUNT
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019662 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019663 NOT NULL ,
	RATE_TAG             VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019664 NOT NULL ,
	STARTDATE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019665 NOT NULL ,
	ENDDATE              VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019666 NOT NULL ,
	DISCNTRATE           FLOAT(126) CONSTRAINT SYS_C0019667 NOT NULL ,
	DISCNTCUT            VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019668 NOT NULL ,
	DISCNTUNIT           VARCHAR2(1 BYTE) DEFAULT  '2'  CONSTRAINT SYS_C0019669 NOT NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_RENT_RATE_DISCOUNT
	ADD CONSTRAINT  SYS_C0019670 PRIMARY KEY (CUST_CODE,SEQ,RATE_TAG,STARTDATE);



CREATE TABLE HD_RENT_REMARK
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0026009 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0026010 NOT NULL ,
	REMARK_SEQ           NUMBER(5) CONSTRAINT SYS_C0026011 NOT NULL ,
	REMARK_DATE          VARCHAR2(8 BYTE) NULL ,
	REMARK               VARCHAR2(500 BYTE) NULL ,
	USER_ID              VARCHAR2(20 BYTE) CONSTRAINT SYS_C0026012 NOT NULL ,
	CONFIRM_DATE         VARCHAR2(8 BYTE) NULL ,
	END_YN               VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_RENT_REMARK
	ADD CONSTRAINT  SYS_C0026013 PRIMARY KEY (CUST_CODE,SEQ,REMARK_SEQ);



CREATE TABLE HD_RENT_REMARK
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019671 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019672 NOT NULL ,
	REMARK_SEQ           NUMBER(5) CONSTRAINT SYS_C0019673 NOT NULL ,
	REMARK_DATE          VARCHAR2(8 BYTE) NULL ,
	REMARK               VARCHAR2(500 BYTE) NULL ,
	USER_ID              VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019674 NOT NULL ,
	CONFIRM_DATE         VARCHAR2(8 BYTE) NULL ,
	END_YN               VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_RENT_REMARK
	ADD CONSTRAINT  SYS_C0019675 PRIMARY KEY (CUST_CODE,SEQ,REMARK_SEQ);



CREATE TABLE HD_RENT_RENT_AGREE
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0026014 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0026015 NOT NULL ,
	TERM_CHG_SEQ         NUMBER(3) CONSTRAINT SYS_C0026016 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0026017 NOT NULL ,
	AGREE_DATE           VARCHAR2(8 BYTE) CONSTRAINT SYS_C0026018 NOT NULL ,
	AGREE_SDATE          VARCHAR2(8 BYTE) NULL ,
	AGREE_EDATE          VARCHAR2(8 BYTE) NULL ,
	AGREE_DAYS           NUMBER(3) NULL ,
	RENT_AMT             NUMBER(12) NULL ,
	VAT_YN               VARCHAR2(1 BYTE) NULL ,
	RENT_SUPPLY          NUMBER(12) NULL ,
	RENT_VAT             NUMBER(12) NULL ,
	PERPECT_TAG          VARCHAR2(1 BYTE) DEFAULT  'N'  CONSTRAINT SYS_C0026019 NOT NULL ,
	RECEIPT_AMT          NUMBER(12) CONSTRAINT SYS_C0026020 NOT NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	RENT_INS             NUMBER(12) NULL ,
	SLIP_DATE            VARCHAR2(8 BYTE) NULL ,
	SLIP_SEQ             NUMBER(5) NULL 
);



ALTER TABLE HD_RENT_RENT_AGREE
	ADD CONSTRAINT  SYS_C0026021 PRIMARY KEY (CUST_CODE,SEQ,TERM_CHG_SEQ,COUNTS);



CREATE TABLE HD_RENT_RENT_AGREE
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019676 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019677 NOT NULL ,
	TERM_CHG_SEQ         NUMBER(3) CONSTRAINT SYS_C0019678 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019679 NOT NULL ,
	AGREE_DATE           VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019680 NOT NULL ,
	AGREE_SDATE          VARCHAR2(8 BYTE) NULL ,
	AGREE_EDATE          VARCHAR2(8 BYTE) NULL ,
	AGREE_DAYS           NUMBER(3) NULL ,
	RENT_AMT             NUMBER(12) NULL ,
	VAT_YN               VARCHAR2(1 BYTE) NULL ,
	RENT_SUPPLY          NUMBER(12) NULL ,
	RENT_VAT             NUMBER(12) NULL ,
	PERPECT_TAG          VARCHAR2(1 BYTE) DEFAULT  'N'  CONSTRAINT SYS_C0019681 NOT NULL ,
	RECEIPT_AMT          NUMBER(12) CONSTRAINT SYS_C0019682 NOT NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	RENT_INS             NUMBER(12) NULL ,
	SLIP_DATE            VARCHAR2(8 BYTE) NULL ,
	SLIP_SEQ             NUMBER(5) NULL 
);



ALTER TABLE HD_RENT_RENT_AGREE
	ADD CONSTRAINT  SYS_C0019683 PRIMARY KEY (CUST_CODE,SEQ,TERM_CHG_SEQ,COUNTS);



CREATE TABLE HD_RENT_RENT_AGREE_ADJ
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0026022 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0026023 NOT NULL ,
	TERM_CHG_SEQ         NUMBER(3) CONSTRAINT SYS_C0026024 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0026025 NOT NULL ,
	AGREE_DATE           VARCHAR2(8 BYTE) CONSTRAINT SYS_C0026026 NOT NULL ,
	AGREE_SDATE          VARCHAR2(8 BYTE) NULL ,
	AGREE_EDATE          VARCHAR2(8 BYTE) NULL ,
	AGREE_DAYS           NUMBER(3) NULL ,
	RENT_AMT             NUMBER(12) NULL ,
	VAT_YN               VARCHAR2(1 BYTE) NULL ,
	RENT_SUPPLY          NUMBER(12) NULL ,
	RENT_VAT             NUMBER(12) NULL ,
	PERPECT_TAG          VARCHAR2(1 BYTE) DEFAULT  'N'  CONSTRAINT SYS_C0026027 NOT NULL  CONSTRAINT  SYS_C0026029 CHECK (PERPECT_TAG IN ('Y', 'N')),
	RECEIPT_AMT          NUMBER(12) CONSTRAINT SYS_C0026028 NOT NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	RENT_INS             NUMBER(12) NULL ,
	SLIP_DATE            VARCHAR2(8 BYTE) NULL ,
	SLIP_SEQ             NUMBER(5) NULL 
);



CREATE UNIQUE INDEX XPKHD_RENT_RENT_AGREE_ADJ ON HD_RENT_RENT_AGREE_ADJ
(CUST_CODE   ASC,SEQ   ASC,TERM_CHG_SEQ   ASC,COUNTS   ASC);



ALTER TABLE HD_RENT_RENT_AGREE_ADJ
	ADD CONSTRAINT  SYS_C0026030 PRIMARY KEY (CUST_CODE,SEQ,TERM_CHG_SEQ,COUNTS);



CREATE TABLE HD_RENT_RENT_AGREE_ADJ
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019684 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019685 NOT NULL ,
	TERM_CHG_SEQ         NUMBER(3) CONSTRAINT SYS_C0019686 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019687 NOT NULL ,
	AGREE_DATE           VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019688 NOT NULL ,
	AGREE_SDATE          VARCHAR2(8 BYTE) NULL ,
	AGREE_EDATE          VARCHAR2(8 BYTE) NULL ,
	AGREE_DAYS           NUMBER(3) NULL ,
	RENT_AMT             NUMBER(12) NULL ,
	VAT_YN               VARCHAR2(1 BYTE) NULL ,
	RENT_SUPPLY          NUMBER(12) NULL ,
	RENT_VAT             NUMBER(12) NULL ,
	PERPECT_TAG          VARCHAR2(1 BYTE) DEFAULT  'N'  CONSTRAINT SYS_C0019689 NOT NULL  CONSTRAINT  SYS_C0019691 CHECK (PERPECT_TAG IN ('Y', 'N')),
	RECEIPT_AMT          NUMBER(12) CONSTRAINT SYS_C0019690 NOT NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	RENT_INS             NUMBER(12) NULL ,
	SLIP_DATE            VARCHAR2(8 BYTE) NULL ,
	SLIP_SEQ             NUMBER(5) NULL 
);



CREATE UNIQUE INDEX XPKHD_RENT_RENT_AGREE_ADJ ON HD_RENT_RENT_AGREE_ADJ
(CUST_CODE   ASC,SEQ   ASC,TERM_CHG_SEQ   ASC,COUNTS   ASC);



ALTER TABLE HD_RENT_RENT_AGREE_ADJ
	ADD CONSTRAINT  SYS_C0019692 PRIMARY KEY (CUST_CODE,SEQ,TERM_CHG_SEQ,COUNTS);



CREATE TABLE HD_RENT_RENT_AGREE_TEMP
(
	SEQ_NUM              NUMBER(18) CONSTRAINT SYS_C0026031 NOT NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0026032 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0026033 NOT NULL ,
	TERM_CHG_SEQ         NUMBER(3) CONSTRAINT SYS_C0026034 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0026035 NOT NULL ,
	AGREE_DATE           VARCHAR2(8 BYTE) CONSTRAINT SYS_C0026036 NOT NULL ,
	AGREE_SDATE          VARCHAR2(8 BYTE) NULL ,
	AGREE_EDATE          VARCHAR2(8 BYTE) NULL ,
	AGREE_DAYS           NUMBER(3) NULL ,
	RENT_AMT             NUMBER(12) NULL ,
	VAT_YN               VARCHAR2(1 BYTE) NULL ,
	RENT_SUPPLY          NUMBER(12) NULL ,
	RENT_VAT             NUMBER(12) NULL ,
	PERPECT_TAG          VARCHAR2(1 BYTE) DEFAULT  'N'  CONSTRAINT SYS_C0026037 NOT NULL ,
	RECEIPT_AMT          NUMBER(12) CONSTRAINT SYS_C0026038 NOT NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	RENT_INS             NUMBER(12) NULL ,
	SLIP_DATE            VARCHAR2(8 BYTE) NULL ,
	SLIP_SEQ             NUMBER(5) NULL 
);



ALTER TABLE HD_RENT_RENT_AGREE_TEMP
	ADD CONSTRAINT  SYS_C0026039 PRIMARY KEY (SEQ_NUM,CUST_CODE,SEQ,TERM_CHG_SEQ,COUNTS);



CREATE TABLE HD_RENT_RENT_AGREE_TEMP
(
	SEQ_NUM              NUMBER(18) CONSTRAINT SYS_C0019693 NOT NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019694 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019695 NOT NULL ,
	TERM_CHG_SEQ         NUMBER(3) CONSTRAINT SYS_C0019696 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019697 NOT NULL ,
	AGREE_DATE           VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019698 NOT NULL ,
	AGREE_SDATE          VARCHAR2(8 BYTE) NULL ,
	AGREE_EDATE          VARCHAR2(8 BYTE) NULL ,
	AGREE_DAYS           NUMBER(3) NULL ,
	RENT_AMT             NUMBER(12) NULL ,
	VAT_YN               VARCHAR2(1 BYTE) NULL ,
	RENT_SUPPLY          NUMBER(12) NULL ,
	RENT_VAT             NUMBER(12) NULL ,
	PERPECT_TAG          VARCHAR2(1 BYTE) DEFAULT  'N'  CONSTRAINT SYS_C0019699 NOT NULL ,
	RECEIPT_AMT          NUMBER(12) CONSTRAINT SYS_C0019700 NOT NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	RENT_INS             NUMBER(12) NULL ,
	SLIP_DATE            VARCHAR2(8 BYTE) NULL ,
	SLIP_SEQ             NUMBER(5) NULL 
);



ALTER TABLE HD_RENT_RENT_AGREE_TEMP
	ADD CONSTRAINT  SYS_C0019701 PRIMARY KEY (SEQ_NUM,CUST_CODE,SEQ,TERM_CHG_SEQ,COUNTS);



CREATE TABLE HD_RENT_RENT_INCOME
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0026040 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0026041 NOT NULL ,
	TERM_CHG_SEQ         NUMBER(3) CONSTRAINT SYS_C0026042 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0026043 NOT NULL ,
	TIMES                FLOAT(126) CONSTRAINT SYS_C0026044 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) NULL ,
	IN_DATE              VARCHAR2(8 BYTE) NULL ,
	IN_SEQ               NUMBER(5) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) NULL ,
	RECEIPT_DATE         VARCHAR2(8 BYTE) CONSTRAINT SYS_C0026045 NOT NULL ,
	RECEIPT_AMT          NUMBER(13) CONSTRAINT SYS_C0026046 NOT NULL ,
	RECEIPT_SUPPLY       NUMBER(13) NULL ,
	RECEIPT_VAT          NUMBER(13) NULL ,
	DELAY_DAYS           NUMBER(6) CONSTRAINT SYS_C0026047 NOT NULL ,
	DELAY_AMT            NUMBER(12) CONSTRAINT SYS_C0026048 NOT NULL ,
	DISCNT_DAYS          NUMBER(6) CONSTRAINT SYS_C0026049 NOT NULL ,
	DISCNT_AMT           NUMBER(12) CONSTRAINT SYS_C0026050 NOT NULL ,
	REALINCOM_AMT        NUMBER(13) CONSTRAINT SYS_C0026051 NOT NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0026052 NOT NULL ,
	BANK_NAME            VARCHAR2(30 BYTE) NULL ,
	PAY_TAG              VARCHAR2(2 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0026053 NOT NULL ,
	INCOM_TYPE           VARCHAR2(2 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	REAL_PAY_TAG         VARCHAR2(1 BYTE) NULL ,
	SLIP_DATE            VARCHAR2(8 BYTE) NULL ,
	SLIP_SEQ             NUMBER(5) NULL ,
	TAX_DATE             VARCHAR2(8 BYTE) NULL ,
	TAX_SEQ              NUMBER(5) NULL ,
	SLIP_TYPE            VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	RECEIPT_INS          NUMBER(13) NULL ,
	REALINCOM_SUPPLY     NUMBER(13) NULL ,
	REALINCOM_VAT        NUMBER(13) NULL ,
	REALINCOM_INS        NUMBER(13) NULL ,
	VDEPOSIT_NO          VARCHAR2(30 BYTE) NULL ,
	OUT_DT               VARCHAR2(8 BYTE) NULL ,
	OUT_TM               VARCHAR2(6 BYTE) NULL ,
	OUT_SEQ              FLOAT(126) NULL ,
	OUT_BANK             VARCHAR2(6 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	OUT_CUSTNO           VARCHAR2(20 BYTE) NULL 
);



ALTER TABLE HD_RENT_RENT_INCOME
	ADD CONSTRAINT  SYS_C0026054 PRIMARY KEY (CUST_CODE,SEQ,TERM_CHG_SEQ,COUNTS,TIMES);



CREATE TABLE HD_RENT_RENT_INCOME
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019702 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019703 NOT NULL ,
	TERM_CHG_SEQ         NUMBER(3) CONSTRAINT SYS_C0019704 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019705 NOT NULL ,
	TIMES                FLOAT(126) CONSTRAINT SYS_C0019706 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) NULL ,
	IN_DATE              VARCHAR2(8 BYTE) NULL ,
	IN_SEQ               NUMBER(5) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) NULL ,
	RECEIPT_DATE         VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019707 NOT NULL ,
	RECEIPT_AMT          NUMBER(13) CONSTRAINT SYS_C0019708 NOT NULL ,
	RECEIPT_SUPPLY       NUMBER(13) NULL ,
	RECEIPT_VAT          NUMBER(13) NULL ,
	DELAY_DAYS           NUMBER(3) CONSTRAINT SYS_C0019709 NOT NULL ,
	DELAY_AMT            NUMBER(12) CONSTRAINT SYS_C0019710 NOT NULL ,
	DISCNT_DAYS          NUMBER(3) CONSTRAINT SYS_C0019711 NOT NULL ,
	DISCNT_AMT           NUMBER(12) CONSTRAINT SYS_C0019712 NOT NULL ,
	REALINCOM_AMT        NUMBER(13) CONSTRAINT SYS_C0019713 NOT NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019714 NOT NULL ,
	BANK_NAME            VARCHAR2(30 BYTE) NULL ,
	PAY_TAG              VARCHAR2(2 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019715 NOT NULL ,
	INCOM_TYPE           VARCHAR2(2 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	REAL_PAY_TAG         VARCHAR2(1 BYTE) NULL ,
	SLIP_DATE            VARCHAR2(8 BYTE) NULL ,
	SLIP_SEQ             NUMBER(5) NULL ,
	TAX_DATE             VARCHAR2(8 BYTE) NULL ,
	TAX_SEQ              NUMBER(5) NULL ,
	SLIP_TYPE            VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	RECEIPT_INS          NUMBER(13) NULL ,
	REALINCOM_SUPPLY     NUMBER(13) NULL ,
	REALINCOM_VAT        NUMBER(13) NULL ,
	REALINCOM_INS        NUMBER(13) NULL ,
	VDEPOSIT_NO          VARCHAR2(30 BYTE) NULL ,
	OUT_DT               VARCHAR2(8 BYTE) NULL ,
	OUT_TM               VARCHAR2(6 BYTE) NULL ,
	OUT_SEQ              FLOAT(126) NULL ,
	OUT_BANK             VARCHAR2(6 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	OUT_CUSTNO           VARCHAR2(20 BYTE) NULL 
);



ALTER TABLE HD_RENT_RENT_INCOME
	ADD CONSTRAINT  SYS_C0019716 PRIMARY KEY (CUST_CODE,SEQ,TERM_CHG_SEQ,COUNTS,TIMES);



CREATE TABLE HD_RENT_RENT_INCOME_ADJ
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0026055 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0026056 NOT NULL ,
	TERM_CHG_SEQ         NUMBER(3) CONSTRAINT SYS_C0026057 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0026058 NOT NULL ,
	TIMES                FLOAT(126) CONSTRAINT SYS_C0026059 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) NULL ,
	IN_DATE              VARCHAR2(8 BYTE) NULL ,
	IN_SEQ               NUMBER(5) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) NULL ,
	RECEIPT_DATE         VARCHAR2(8 BYTE) CONSTRAINT SYS_C0026060 NOT NULL ,
	RECEIPT_AMT          NUMBER(13) CONSTRAINT SYS_C0026061 NOT NULL ,
	RECEIPT_SUPPLY       NUMBER(13) NULL ,
	RECEIPT_VAT          NUMBER(13) NULL ,
	DELAY_DAYS           NUMBER(3) CONSTRAINT SYS_C0026062 NOT NULL ,
	DELAY_AMT            NUMBER(12) CONSTRAINT SYS_C0026063 NOT NULL ,
	DISCNT_DAYS          NUMBER(3) CONSTRAINT SYS_C0026064 NOT NULL ,
	DISCNT_AMT           NUMBER(12) CONSTRAINT SYS_C0026065 NOT NULL ,
	REALINCOM_AMT        NUMBER(13) CONSTRAINT SYS_C0026066 NOT NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0026067 NOT NULL ,
	BANK_NAME            VARCHAR2(30 BYTE) NULL ,
	PAY_TAG              VARCHAR2(2 BYTE) NULL ,
	INCOM_TYPE           VARCHAR2(2 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	REAL_PAY_TAG         VARCHAR2(1 BYTE) NULL ,
	SLIP_DATE            VARCHAR2(8 BYTE) NULL ,
	SLIP_SEQ             NUMBER(5) NULL ,
	TAX_DATE             VARCHAR2(8 BYTE) NULL ,
	TAX_SEQ              NUMBER(5) NULL ,
	SLIP_TYPE            VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	RECEIPT_INS          NUMBER(13) NULL ,
	REALINCOM_SUPPLY     NUMBER(13) NULL ,
	REALINCOM_VAT        NUMBER(13) NULL ,
	REALINCOM_INS        NUMBER(13) NULL ,
	VDEPOSIT_NO          VARCHAR2(30 BYTE) NULL ,
	OUT_DT               VARCHAR2(8 BYTE) NULL ,
	OUT_TM               VARCHAR2(6 BYTE) NULL ,
	OUT_SEQ              FLOAT(126) NULL ,
	OUT_BANK             VARCHAR2(6 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	OUT_CUSTNO           VARCHAR2(20 BYTE) NULL 
);



CREATE UNIQUE INDEX XPKHD_RENT_RENT_INCOME_ADJ ON HD_RENT_RENT_INCOME_ADJ
(CUST_CODE   ASC,SEQ   ASC,TERM_CHG_SEQ   ASC,COUNTS   ASC,TIMES   ASC);



ALTER TABLE HD_RENT_RENT_INCOME_ADJ
	ADD CONSTRAINT  SYS_C0026068 PRIMARY KEY (CUST_CODE,SEQ,TERM_CHG_SEQ,COUNTS,TIMES);



CREATE TABLE HD_RENT_RENT_INCOME_ADJ
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019717 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019718 NOT NULL ,
	TERM_CHG_SEQ         NUMBER(3) CONSTRAINT SYS_C0019719 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019720 NOT NULL ,
	TIMES                FLOAT(126) CONSTRAINT SYS_C0019721 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) NULL ,
	IN_DATE              VARCHAR2(8 BYTE) NULL ,
	IN_SEQ               NUMBER(5) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) NULL ,
	RECEIPT_DATE         VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019722 NOT NULL ,
	RECEIPT_AMT          NUMBER(13) CONSTRAINT SYS_C0019723 NOT NULL ,
	RECEIPT_SUPPLY       NUMBER(13) NULL ,
	RECEIPT_VAT          NUMBER(13) NULL ,
	DELAY_DAYS           NUMBER(3) CONSTRAINT SYS_C0019724 NOT NULL ,
	DELAY_AMT            NUMBER(12) CONSTRAINT SYS_C0019725 NOT NULL ,
	DISCNT_DAYS          NUMBER(3) CONSTRAINT SYS_C0019726 NOT NULL ,
	DISCNT_AMT           NUMBER(12) CONSTRAINT SYS_C0019727 NOT NULL ,
	REALINCOM_AMT        NUMBER(13) CONSTRAINT SYS_C0019728 NOT NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019729 NOT NULL ,
	BANK_NAME            VARCHAR2(30 BYTE) NULL ,
	PAY_TAG              VARCHAR2(2 BYTE) NULL ,
	INCOM_TYPE           VARCHAR2(2 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	REAL_PAY_TAG         VARCHAR2(1 BYTE) NULL ,
	SLIP_DATE            VARCHAR2(8 BYTE) NULL ,
	SLIP_SEQ             NUMBER(5) NULL ,
	TAX_DATE             VARCHAR2(8 BYTE) NULL ,
	TAX_SEQ              NUMBER(5) NULL ,
	SLIP_TYPE            VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	RECEIPT_INS          NUMBER(13) NULL ,
	REALINCOM_SUPPLY     NUMBER(13) NULL ,
	REALINCOM_VAT        NUMBER(13) NULL ,
	REALINCOM_INS        NUMBER(13) NULL ,
	VDEPOSIT_NO          VARCHAR2(30 BYTE) NULL ,
	OUT_DT               VARCHAR2(8 BYTE) NULL ,
	OUT_TM               VARCHAR2(6 BYTE) NULL ,
	OUT_SEQ              FLOAT(126) NULL ,
	OUT_BANK             VARCHAR2(6 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	OUT_CUSTNO           VARCHAR2(20 BYTE) NULL 
);



CREATE UNIQUE INDEX XPKHD_RENT_RENT_INCOME_ADJ ON HD_RENT_RENT_INCOME_ADJ
(CUST_CODE   ASC,SEQ   ASC,TERM_CHG_SEQ   ASC,COUNTS   ASC,TIMES   ASC);



ALTER TABLE HD_RENT_RENT_INCOME_ADJ
	ADD CONSTRAINT  SYS_C0019730 PRIMARY KEY (CUST_CODE,SEQ,TERM_CHG_SEQ,COUNTS,TIMES);



CREATE TABLE HD_RENT_RENT_INCOME_DAILY
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0026069 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0026070 NOT NULL ,
	IN_DATE              VARCHAR2(8 BYTE) CONSTRAINT SYS_C0026071 NOT NULL ,
	IN_SEQ               NUMBER(5) CONSTRAINT SYS_C0026072 NOT NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) NULL ,
	SEQ                  NUMBER(5) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) NULL ,
	IN_AMT               NUMBER(12) NULL ,
	IN_GUBUN             VARCHAR2(2 BYTE) NULL ,
	IN_TYPE              VARCHAR2(2 BYTE) NULL ,
	TRANS_YN             VARCHAR2(1 BYTE) NULL ,
	CARD_NO              VARCHAR2(20 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	MOD_DELAY_AMT        NUMBER(12) NULL ,
	MOD_DISC_AMT         NUMBER(12) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	VDEPOSIT_NO          VARCHAR2(30 BYTE) NULL ,
	OUT_DT               VARCHAR2(8 BYTE) NULL ,
	OUT_TM               VARCHAR2(6 BYTE) NULL ,
	OUT_SEQ              FLOAT(126) NULL ,
	OUT_BANK             VARCHAR2(6 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	OUT_CUSTNO           VARCHAR2(20 BYTE) NULL 
);



ALTER TABLE HD_RENT_RENT_INCOME_DAILY
	ADD CONSTRAINT  SYS_C0026073 PRIMARY KEY (DEPT_CODE,HOUSETAG,IN_DATE,IN_SEQ);



CREATE TABLE HD_RENT_RENT_INCOME_DAILY
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019731 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019732 NOT NULL ,
	IN_DATE              VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019733 NOT NULL ,
	IN_SEQ               NUMBER(5) CONSTRAINT SYS_C0019734 NOT NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) NULL ,
	SEQ                  NUMBER(5) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) NULL ,
	IN_AMT               NUMBER(12) NULL ,
	IN_GUBUN             VARCHAR2(2 BYTE) NULL ,
	IN_TYPE              VARCHAR2(2 BYTE) NULL ,
	TRANS_YN             VARCHAR2(1 BYTE) NULL ,
	CARD_NO              VARCHAR2(20 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	MOD_DELAY_AMT        NUMBER(12) NULL ,
	MOD_DISC_AMT         NUMBER(12) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	VDEPOSIT_NO          VARCHAR2(30 BYTE) NULL ,
	OUT_DT               VARCHAR2(8 BYTE) NULL ,
	OUT_TM               VARCHAR2(6 BYTE) NULL ,
	OUT_SEQ              FLOAT(126) NULL ,
	OUT_BANK             VARCHAR2(6 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	OUT_CUSTNO           VARCHAR2(20 BYTE) NULL 
);



ALTER TABLE HD_RENT_RENT_INCOME_DAILY
	ADD CONSTRAINT  SYS_C0019735 PRIMARY KEY (DEPT_CODE,HOUSETAG,IN_DATE,IN_SEQ);



CREATE TABLE HD_RENT_RENT_INCOME_DAILY_ADJ
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0026074 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0026075 NOT NULL ,
	IN_DATE              VARCHAR2(8 BYTE) CONSTRAINT SYS_C0026076 NOT NULL ,
	IN_SEQ               NUMBER(5) CONSTRAINT SYS_C0026077 NOT NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) NULL ,
	SEQ                  NUMBER(5) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) NULL ,
	IN_AMT               NUMBER(12) NULL ,
	IN_GUBUN             VARCHAR2(2 BYTE) NULL ,
	IN_TYPE              VARCHAR2(2 BYTE) NULL ,
	TRANS_YN             VARCHAR2(1 BYTE) NULL ,
	CARD_NO              VARCHAR2(20 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	MOD_DELAY_AMT        NUMBER(12) NULL ,
	MOD_DISC_AMT         NUMBER(12) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	VDEPOSIT_NO          VARCHAR2(30 BYTE) NULL ,
	OUT_DT               VARCHAR2(8 BYTE) NULL ,
	OUT_TM               VARCHAR2(6 BYTE) NULL ,
	OUT_SEQ              FLOAT(126) NULL ,
	OUT_BANK             VARCHAR2(6 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	OUT_CUSTNO           VARCHAR2(20 BYTE) NULL 
);



ALTER TABLE HD_RENT_RENT_INCOME_DAILY_ADJ
	ADD CONSTRAINT  SYS_C0026078 PRIMARY KEY (DEPT_CODE,HOUSETAG,IN_DATE,IN_SEQ);



CREATE TABLE HD_RENT_RENT_INCOME_DAILY_ADJ
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019736 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019737 NOT NULL ,
	IN_DATE              VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019738 NOT NULL ,
	IN_SEQ               NUMBER(5) CONSTRAINT SYS_C0019739 NOT NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) NULL ,
	SEQ                  NUMBER(5) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) NULL ,
	IN_AMT               NUMBER(12) NULL ,
	IN_GUBUN             VARCHAR2(2 BYTE) NULL ,
	IN_TYPE              VARCHAR2(2 BYTE) NULL ,
	TRANS_YN             VARCHAR2(1 BYTE) NULL ,
	CARD_NO              VARCHAR2(20 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	MOD_DELAY_AMT        NUMBER(12) NULL ,
	MOD_DISC_AMT         NUMBER(12) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	VDEPOSIT_NO          VARCHAR2(30 BYTE) NULL ,
	OUT_DT               VARCHAR2(8 BYTE) NULL ,
	OUT_TM               VARCHAR2(6 BYTE) NULL ,
	OUT_SEQ              FLOAT(126) NULL ,
	OUT_BANK             VARCHAR2(6 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	OUT_CUSTNO           VARCHAR2(20 BYTE) NULL 
);



ALTER TABLE HD_RENT_RENT_INCOME_DAILY_ADJ
	ADD CONSTRAINT  SYS_C0019740 PRIMARY KEY (DEPT_CODE,HOUSETAG,IN_DATE,IN_SEQ);



CREATE TABLE HD_RENT_RENT_INCOME_TEMP
(
	SEQ_NUM              NUMBER(18) CONSTRAINT SYS_C0026079 NOT NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0026080 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0026081 NOT NULL ,
	TERM_CHG_SEQ         NUMBER(3) CONSTRAINT SYS_C0026082 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0026083 NOT NULL ,
	TIMES                FLOAT(126) CONSTRAINT SYS_C0026084 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) NULL ,
	IN_DATE              VARCHAR2(8 BYTE) NULL ,
	IN_SEQ               NUMBER(5) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) NULL ,
	RECEIPT_DATE         VARCHAR2(8 BYTE) CONSTRAINT SYS_C0026085 NOT NULL ,
	RECEIPT_AMT          NUMBER(13) CONSTRAINT SYS_C0026086 NOT NULL ,
	RECEIPT_SUPPLY       NUMBER(13) NULL ,
	RECEIPT_VAT          NUMBER(13) NULL ,
	DELAY_DAYS           NUMBER(3) CONSTRAINT SYS_C0026087 NOT NULL ,
	DELAY_AMT            NUMBER(12) CONSTRAINT SYS_C0026088 NOT NULL ,
	DISCNT_DAYS          NUMBER(3) CONSTRAINT SYS_C0026089 NOT NULL ,
	DISCNT_AMT           NUMBER(12) CONSTRAINT SYS_C0026090 NOT NULL ,
	REALINCOM_AMT        NUMBER(13) CONSTRAINT SYS_C0026091 NOT NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0026092 NOT NULL ,
	BANK_NAME            VARCHAR2(30 BYTE) NULL ,
	PAY_TAG              VARCHAR2(2 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0026093 NOT NULL ,
	INCOM_TYPE           VARCHAR2(2 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	REAL_PAY_TAG         VARCHAR2(1 BYTE) NULL ,
	SLIP_DATE            VARCHAR2(8 BYTE) NULL ,
	SLIP_SEQ             NUMBER(5) NULL ,
	TAX_DATE             VARCHAR2(8 BYTE) NULL ,
	TAX_SEQ              NUMBER(5) NULL ,
	SLIP_TYPE            VARCHAR2(1 BYTE) NULL ,
	CALC_YN              VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	RECEIPT_INS          NUMBER(13) NULL ,
	REALINCOM_SUPPLY     NUMBER(13) NULL ,
	REALINCOM_VAT        NUMBER(13) NULL ,
	REALINCOM_INS        NUMBER(13) NULL ,
	VDEPOSIT_NO          VARCHAR2(30 BYTE) NULL ,
	OUT_DT               VARCHAR2(8 BYTE) NULL ,
	OUT_TM               VARCHAR2(6 BYTE) NULL ,
	OUT_SEQ              FLOAT(126) NULL ,
	OUT_BANK             VARCHAR2(6 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	OUT_CUSTNO           VARCHAR2(20 BYTE) NULL 
);



ALTER TABLE HD_RENT_RENT_INCOME_TEMP
	ADD CONSTRAINT  SYS_C0026094 PRIMARY KEY (SEQ_NUM,CUST_CODE,SEQ,TERM_CHG_SEQ,COUNTS,TIMES);



CREATE TABLE HD_RENT_RENT_INCOME_TEMP
(
	SEQ_NUM              NUMBER(18) CONSTRAINT SYS_C0019741 NOT NULL ,
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019742 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019743 NOT NULL ,
	TERM_CHG_SEQ         NUMBER(3) CONSTRAINT SYS_C0019744 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019745 NOT NULL ,
	TIMES                FLOAT(126) CONSTRAINT SYS_C0019746 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) NULL ,
	IN_DATE              VARCHAR2(8 BYTE) NULL ,
	IN_SEQ               NUMBER(5) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) NULL ,
	RECEIPT_DATE         VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019747 NOT NULL ,
	RECEIPT_AMT          NUMBER(13) CONSTRAINT SYS_C0019748 NOT NULL ,
	RECEIPT_SUPPLY       NUMBER(13) NULL ,
	RECEIPT_VAT          NUMBER(13) NULL ,
	DELAY_DAYS           NUMBER(3) CONSTRAINT SYS_C0019749 NOT NULL ,
	DELAY_AMT            NUMBER(12) CONSTRAINT SYS_C0019750 NOT NULL ,
	DISCNT_DAYS          NUMBER(3) CONSTRAINT SYS_C0019751 NOT NULL ,
	DISCNT_AMT           NUMBER(12) CONSTRAINT SYS_C0019752 NOT NULL ,
	REALINCOM_AMT        NUMBER(13) CONSTRAINT SYS_C0019753 NOT NULL ,
	BANK_CODE            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019754 NOT NULL ,
	BANK_NAME            VARCHAR2(30 BYTE) NULL ,
	PAY_TAG              VARCHAR2(2 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019755 NOT NULL ,
	INCOM_TYPE           VARCHAR2(2 BYTE) NULL ,
	MOD_YN               VARCHAR2(1 BYTE) NULL ,
	REAL_PAY_TAG         VARCHAR2(1 BYTE) NULL ,
	SLIP_DATE            VARCHAR2(8 BYTE) NULL ,
	SLIP_SEQ             NUMBER(5) NULL ,
	TAX_DATE             VARCHAR2(8 BYTE) NULL ,
	TAX_SEQ              NUMBER(5) NULL ,
	SLIP_TYPE            VARCHAR2(1 BYTE) NULL ,
	CALC_YN              VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	RECEIPT_INS          NUMBER(13) NULL ,
	REALINCOM_SUPPLY     NUMBER(13) NULL ,
	REALINCOM_VAT        NUMBER(13) NULL ,
	REALINCOM_INS        NUMBER(13) NULL ,
	VDEPOSIT_NO          VARCHAR2(30 BYTE) NULL ,
	OUT_DT               VARCHAR2(8 BYTE) NULL ,
	OUT_TM               VARCHAR2(6 BYTE) NULL ,
	OUT_SEQ              FLOAT(126) NULL ,
	OUT_BANK             VARCHAR2(6 BYTE) NULL ,
	REMARK               VARCHAR2(200 BYTE) NULL ,
	OUT_CUSTNO           VARCHAR2(20 BYTE) NULL 
);



ALTER TABLE HD_RENT_RENT_INCOME_TEMP
	ADD CONSTRAINT  SYS_C0019756 PRIMARY KEY (SEQ_NUM,CUST_CODE,SEQ,TERM_CHG_SEQ,COUNTS,TIMES);



CREATE TABLE HD_SALE_ETC
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0026095 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0026096 NOT NULL ,
	ETC_SEQ              NUMBER(3) CONSTRAINT SYS_C0026097 NOT NULL ,
	UNIQUE_DIV           VARCHAR2(2 BYTE) NULL ,
	EFFECT_NO            VARCHAR2(20 BYTE) NULL ,
	DELIVERY_DATE        VARCHAR2(8 BYTE) NULL ,
	CREDITOR             VARCHAR2(10 BYTE) NULL ,
	BOND_AMT             NUMBER(13) NULL ,
	CANCEL_YN            VARCHAR2(1 BYTE) NULL ,
	CANCEL_DATE          VARCHAR2(8 BYTE) NULL ,
	CANCEL_DESC          VARCHAR2(120 BYTE) NULL ,
	REMARK               VARCHAR2(120 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_SALE_ETC
	ADD CONSTRAINT  SYS_C0026098 PRIMARY KEY (CUST_CODE,SEQ,ETC_SEQ);



CREATE TABLE HD_SALE_ETC
(
	CUST_CODE            VARCHAR2(20 BYTE) CONSTRAINT SYS_C0019757 NOT NULL ,
	SEQ                  NUMBER(5) CONSTRAINT SYS_C0019758 NOT NULL ,
	ETC_SEQ              NUMBER(3) CONSTRAINT SYS_C0019759 NOT NULL ,
	UNIQUE_DIV           VARCHAR2(2 BYTE) NULL ,
	EFFECT_NO            VARCHAR2(20 BYTE) NULL ,
	DELIVERY_DATE        VARCHAR2(8 BYTE) NULL ,
	CREDITOR             VARCHAR2(10 BYTE) NULL ,
	BOND_AMT             NUMBER(13) NULL ,
	CANCEL_YN            VARCHAR2(1 BYTE) NULL ,
	CANCEL_DATE          VARCHAR2(8 BYTE) NULL ,
	CANCEL_DESC          VARCHAR2(120 BYTE) NULL ,
	REMARK               VARCHAR2(120 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_SALE_ETC
	ADD CONSTRAINT  SYS_C0019760 PRIMARY KEY (CUST_CODE,SEQ,ETC_SEQ);



CREATE TABLE HD_SALE_INCOME_UNKNOWN
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0026099 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0026100 NOT NULL ,
	RECEIPT_DATE         VARCHAR2(8 BYTE) CONSTRAINT SYS_C0026101 NOT NULL ,
	SEQ                  NUMBER(38) CONSTRAINT SYS_C0026102 NOT NULL ,
	RECEIPT_CODE         VARCHAR2(2 BYTE) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) NULL ,
	R_AMT                NUMBER(13) CONSTRAINT SYS_C0026103 NOT NULL ,
	CONFIRM_AMT          NUMBER(13) CONSTRAINT SYS_C0026104 NOT NULL ,
	PTAG                 VARCHAR2(2 BYTE) NULL ,
	MEMO                 VARCHAR2(500 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_SALE_INCOME_UNKNOWN
	ADD CONSTRAINT  SYS_C0026105 PRIMARY KEY (DEPT_CODE,HOUSETAG,RECEIPT_DATE,SEQ);



CREATE TABLE HD_SALE_INCOME_UNKNOWN
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019761 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019762 NOT NULL ,
	RECEIPT_DATE         VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019763 NOT NULL ,
	SEQ                  NUMBER(38) CONSTRAINT SYS_C0019764 NOT NULL ,
	RECEIPT_CODE         VARCHAR2(2 BYTE) NULL ,
	DEPOSIT_NO           VARCHAR2(30 BYTE) NULL ,
	R_AMT                NUMBER(13) CONSTRAINT SYS_C0019765 NOT NULL ,
	CONFIRM_AMT          NUMBER(13) CONSTRAINT SYS_C0019766 NOT NULL ,
	PTAG                 VARCHAR2(2 BYTE) NULL ,
	MEMO                 VARCHAR2(500 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_SALE_INCOME_UNKNOWN
	ADD CONSTRAINT  SYS_C0019767 PRIMARY KEY (DEPT_CODE,HOUSETAG,RECEIPT_DATE,SEQ);



CREATE TABLE HD_SLIP_MAIN
(
	SLIPDATE             VARCHAR2(8 BYTE) CONSTRAINT SYS_C0026106 NOT NULL ,
	SLIPSEQ              NUMBER(5) CONSTRAINT SYS_C0026107 NOT NULL ,
	SLIPITEM             NUMBER(5) CONSTRAINT SYS_C0026108 NOT NULL ,
	ACNTCODE             VARCHAR2(8 BYTE) CONSTRAINT SYS_C0026109 NOT NULL ,
	DBAMT                NUMBER(13) CONSTRAINT SYS_C0026110 NOT NULL ,
	DBCASH               NUMBER(13) CONSTRAINT SYS_C0026111 NOT NULL ,
	CRAMT                NUMBER(13) CONSTRAINT SYS_C0026112 NOT NULL ,
	CRCASH               NUMBER(13) CONSTRAINT SYS_C0026113 NOT NULL ,
	REMARK1              VARCHAR2(40 BYTE) CONSTRAINT SYS_C0026114 NOT NULL ,
	REMARK2              VARCHAR2(40 BYTE) NULL ,
	STATEDATE            VARCHAR2(8 BYTE) NULL ,
	STATENO              FLOAT(126) CONSTRAINT SYS_C0026115 NOT NULL ,
	VATCODE              VARCHAR2(2 BYTE) NULL ,
	VATAMT               NUMBER(13) CONSTRAINT SYS_C0026116 NOT NULL ,
	VATITEM              FLOAT(126) CONSTRAINT SYS_C0026117 NOT NULL ,
	CUSTGROUP            VARCHAR2(13 BYTE) NULL ,
	CUSTCODE             VARCHAR2(13 BYTE) NULL ,
	CUSTNAME             VARCHAR2(30 BYTE) NULL ,
	COMPCODE             VARCHAR2(6 BYTE) NULL ,
	DEPTCODE             VARCHAR2(12 BYTE) CONSTRAINT SYS_C0026118 NOT NULL ,
	BANKCODE             VARCHAR2(7 BYTE) NULL ,
	DEPOSITNO            VARCHAR2(30 BYTE) NULL ,
	NO1                  VARCHAR2(9 BYTE) NULL ,
	NO2                  VARCHAR2(9 BYTE) NULL ,
	AUTOTAG              VARCHAR2(1 BYTE) DEFAULT  '0'  CONSTRAINT SYS_C0026119 NOT NULL ,
	DETAILTAG            VARCHAR2(1 BYTE) DEFAULT  'Z'  CONSTRAINT SYS_C0026120 NOT NULL ,
	DETAILOK             VARCHAR2(1 BYTE) DEFAULT  '0'  CONSTRAINT SYS_C0026121 NOT NULL ,
	ITEMSEQ              FLOAT(126) CONSTRAINT SYS_C0026122 NOT NULL ,
	INSERTNO             FLOAT(126) NULL ,
	INSERTDATE           VARCHAR2(8 BYTE) NULL ,
	EDITEMP              VARCHAR2(8 BYTE) NULL ,
	REMARKCODE           FLOAT(126) NULL ,
	SEQ1                 FLOAT(126) NULL ,
	SEQ2                 FLOAT(126) NULL ,
	FUNDCODE             VARCHAR2(3 BYTE) NULL ,
	CASHAMT              FLOAT(126) NULL ,
	PFT_ACNTCODE         VARCHAR2(8 BYTE) NULL ,
	CANCEL_TAG           VARCHAR2(1 BYTE) NULL 
);



ALTER TABLE HD_SLIP_MAIN
	ADD CONSTRAINT  SYS_C0026123 PRIMARY KEY (SLIPDATE,SLIPSEQ,SLIPITEM);



CREATE TABLE HD_SLIP_MAIN
(
	SLIPDATE             VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019768 NOT NULL ,
	SLIPSEQ              NUMBER(5) CONSTRAINT SYS_C0019769 NOT NULL ,
	SLIPITEM             NUMBER(5) CONSTRAINT SYS_C0019770 NOT NULL ,
	ACNTCODE             VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019771 NOT NULL ,
	DBAMT                NUMBER(13) CONSTRAINT SYS_C0019772 NOT NULL ,
	DBCASH               NUMBER(13) CONSTRAINT SYS_C0019773 NOT NULL ,
	CRAMT                NUMBER(13) CONSTRAINT SYS_C0019774 NOT NULL ,
	CRCASH               NUMBER(13) CONSTRAINT SYS_C0019775 NOT NULL ,
	REMARK1              VARCHAR2(40 BYTE) CONSTRAINT SYS_C0019776 NOT NULL ,
	REMARK2              VARCHAR2(40 BYTE) NULL ,
	STATEDATE            VARCHAR2(8 BYTE) NULL ,
	STATENO              FLOAT(126) CONSTRAINT SYS_C0019777 NOT NULL ,
	VATCODE              VARCHAR2(2 BYTE) NULL ,
	VATAMT               NUMBER(13) CONSTRAINT SYS_C0019778 NOT NULL ,
	VATITEM              FLOAT(126) CONSTRAINT SYS_C0019779 NOT NULL ,
	CUSTGROUP            VARCHAR2(13 BYTE) NULL ,
	CUSTCODE             VARCHAR2(13 BYTE) NULL ,
	CUSTNAME             VARCHAR2(30 BYTE) NULL ,
	COMPCODE             VARCHAR2(6 BYTE) NULL ,
	DEPTCODE             VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019780 NOT NULL ,
	BANKCODE             VARCHAR2(7 BYTE) NULL ,
	DEPOSITNO            VARCHAR2(30 BYTE) NULL ,
	NO1                  VARCHAR2(9 BYTE) NULL ,
	NO2                  VARCHAR2(9 BYTE) NULL ,
	AUTOTAG              VARCHAR2(1 BYTE) DEFAULT  '0'  CONSTRAINT SYS_C0019781 NOT NULL ,
	DETAILTAG            VARCHAR2(1 BYTE) DEFAULT  'Z'  CONSTRAINT SYS_C0019782 NOT NULL ,
	DETAILOK             VARCHAR2(1 BYTE) DEFAULT  '0'  CONSTRAINT SYS_C0019783 NOT NULL ,
	ITEMSEQ              FLOAT(126) CONSTRAINT SYS_C0019784 NOT NULL ,
	INSERTNO             FLOAT(126) NULL ,
	INSERTDATE           VARCHAR2(8 BYTE) NULL ,
	EDITEMP              VARCHAR2(8 BYTE) NULL ,
	REMARKCODE           FLOAT(126) NULL ,
	SEQ1                 FLOAT(126) NULL ,
	SEQ2                 FLOAT(126) NULL ,
	FUNDCODE             VARCHAR2(3 BYTE) NULL ,
	CASHAMT              FLOAT(126) NULL ,
	PFT_ACNTCODE         VARCHAR2(8 BYTE) NULL ,
	CANCEL_TAG           VARCHAR2(1 BYTE) NULL 
);



ALTER TABLE HD_SLIP_MAIN
	ADD CONSTRAINT  SYS_C0019785 PRIMARY KEY (SLIPDATE,SLIPSEQ,SLIPITEM);



CREATE TABLE HD_SLIP_PARENT
(
	SLIPDATE             VARCHAR2(8 BYTE) CONSTRAINT SYS_C0026124 NOT NULL ,
	SLIPSEQ              NUMBER(5) CONSTRAINT SYS_C0026125 NOT NULL ,
	CASHTAG              VARCHAR2(1 BYTE) DEFAULT  'T'  CONSTRAINT SYS_C0026126 NOT NULL ,
	MAKEDATE             VARCHAR2(8 BYTE) CONSTRAINT SYS_C0026127 NOT NULL ,
	MAKECOMP             VARCHAR2(6 BYTE) NULL ,
	MAKEDEPT             VARCHAR2(12 BYTE) NULL ,
	MAKESEQ              FLOAT(126) NULL ,
	EMPNO                VARCHAR2(8 BYTE) CONSTRAINT SYS_C0026128 NOT NULL ,
	EDITEMP              VARCHAR2(8 BYTE) NULL ,
	EDITDATE             VARCHAR2(8 BYTE) NULL ,
	COMPANY              VARCHAR2(6 BYTE) NULL ,
	EDTCOMPANY           VARCHAR2(6 BYTE) NULL ,
	CASHSUMTAG           VARCHAR2(1 BYTE) NULL ,
	PRINT_SEQ            VARCHAR2(1 BYTE) NULL ,
	CANCEL_TAG           VARCHAR2(1 BYTE) NULL 
);



ALTER TABLE HD_SLIP_PARENT
	ADD CONSTRAINT  SYS_C0026129 PRIMARY KEY (SLIPDATE,SLIPSEQ);



CREATE  INDEX XIF27A_SLIP_PARENT ON HD_SLIP_PARENT
(MAKECOMP   ASC,MAKEDEPT   ASC);



CREATE TABLE HD_SLIP_PARENT
(
	SLIPDATE             VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019786 NOT NULL ,
	SLIPSEQ              NUMBER(5) CONSTRAINT SYS_C0019787 NOT NULL ,
	CASHTAG              VARCHAR2(1 BYTE) DEFAULT  'T'  CONSTRAINT SYS_C0019788 NOT NULL ,
	MAKEDATE             VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019789 NOT NULL ,
	MAKECOMP             VARCHAR2(6 BYTE) NULL ,
	MAKEDEPT             VARCHAR2(12 BYTE) NULL ,
	MAKESEQ              FLOAT(126) NULL ,
	EMPNO                VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019790 NOT NULL ,
	EDITEMP              VARCHAR2(8 BYTE) NULL ,
	EDITDATE             VARCHAR2(8 BYTE) NULL ,
	COMPANY              VARCHAR2(6 BYTE) NULL ,
	EDTCOMPANY           VARCHAR2(6 BYTE) NULL ,
	CASHSUMTAG           VARCHAR2(1 BYTE) NULL ,
	PRINT_SEQ            VARCHAR2(1 BYTE) NULL ,
	CANCEL_TAG           VARCHAR2(1 BYTE) NULL 
);



ALTER TABLE HD_SLIP_PARENT
	ADD CONSTRAINT  SYS_C0019791 PRIMARY KEY (SLIPDATE,SLIPSEQ);



CREATE  INDEX XIF27A_SLIP_PARENT ON HD_SLIP_PARENT
(MAKECOMP   ASC,MAKEDEPT   ASC);



CREATE TABLE HD_SUPPLY_CONV
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0026130 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0026131 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0026132 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0026133 NOT NULL ,
	SQUARE               NUMBER(8,4) NULL ,
	TYPE                 VARCHAR2(4 BYTE) NULL ,
	CLASS                VARCHAR2(1 BYTE) NULL ,
	OPTIONS              VARCHAR2(2 BYTE) DEFAULT  '00'  NULL ,
	EXCLUSIVEAREA        NUMBER(12,4) NULL ,
	COMMONAREA           NUMBER(12,4) NULL ,
	ETCCOMMONAREA        NUMBER(12,4) NULL ,
	PARKINGAREA          NUMBER(12,4) NULL ,
	SERVICEAREA          NUMBER(12,4) NULL ,
	SITEAREA             NUMBER(12,4) NULL ,
	TOT_SUPPLYAMT        NUMBER(13) NULL ,
	TOT_LANDAMT          NUMBER(13) NULL ,
	TOT_BUILDAMT         NUMBER(13) NULL ,
	TOT_VATAMT           NUMBER(13) NULL ,
	TOT_MANAGEAMT        NUMBER(13) NULL ,
	AMT00                NUMBER(13) NULL ,
	AMT00_L              NUMBER(13) NULL ,
	AMT00_B              NUMBER(13) NULL ,
	AMT00_V              NUMBER(13) NULL ,
	AMT00_M              NUMBER(13) NULL ,
	AMT01                NUMBER(13) NULL ,
	AMT01_L              NUMBER(13) NULL ,
	AMT01_B              NUMBER(13) NULL ,
	AMT01_V              NUMBER(13) NULL ,
	AMT01_M              NUMBER(13) NULL ,
	AMT02                NUMBER(13) NULL ,
	AMT02_L              NUMBER(13) NULL ,
	AMT02_B              NUMBER(13) NULL ,
	AMT02_V              NUMBER(13) NULL ,
	AMT02_M              NUMBER(13) NULL ,
	AMT11                NUMBER(13) NULL ,
	AMT11_L              NUMBER(13) NULL ,
	AMT11_B              NUMBER(13) NULL ,
	AMT11_V              NUMBER(13) NULL ,
	AMT11_M              NUMBER(13) NULL ,
	AMT12                NUMBER(13) NULL ,
	AMT12_L              NUMBER(13) NULL ,
	AMT12_B              NUMBER(13) NULL ,
	AMT12_V              NUMBER(13) NULL ,
	AMT12_M              NUMBER(13) NULL ,
	AMT13                NUMBER(13) NULL ,
	AMT13_L              NUMBER(13) NULL ,
	AMT13_B              NUMBER(13) NULL ,
	AMT13_V              NUMBER(13) NULL ,
	AMT13_M              NUMBER(13) NULL ,
	AMT14                NUMBER(13) NULL ,
	AMT14_L              NUMBER(13) NULL ,
	AMT14_B              NUMBER(13) NULL ,
	AMT14_V              NUMBER(13) NULL ,
	AMT14_M              NUMBER(13) NULL ,
	AMT15                NUMBER(13) NULL ,
	AMT15_L              NUMBER(13) NULL ,
	AMT15_B              NUMBER(13) NULL ,
	AMT15_V              NUMBER(13) NULL ,
	AMT15_M              NUMBER(13) NULL ,
	AMT16                NUMBER(13) NULL ,
	AMT16_L              NUMBER(13) NULL ,
	AMT16_B              NUMBER(13) NULL ,
	AMT16_V              NUMBER(13) NULL ,
	AMT16_M              NUMBER(13) NULL ,
	AMT17                NUMBER(13) NULL ,
	AMT17_L              NUMBER(13) NULL ,
	AMT17_B              NUMBER(13) NULL ,
	AMT17_V              NUMBER(13) NULL ,
	AMT17_M              NUMBER(13) NULL ,
	AMT18                NUMBER(13) NULL ,
	AMT18_L              NUMBER(13) NULL ,
	AMT18_B              NUMBER(13) NULL ,
	AMT18_V              NUMBER(13) NULL ,
	AMT18_M              NUMBER(13) NULL ,
	AMT19                NUMBER(13) NULL ,
	AMT19_L              NUMBER(13) NULL ,
	AMT19_B              NUMBER(13) NULL ,
	AMT19_V              NUMBER(13) NULL ,
	AMT19_M              NUMBER(13) NULL ,
	AMT20                NUMBER(13) NULL ,
	AMT20_L              NUMBER(13) NULL ,
	AMT20_B              NUMBER(13) NULL ,
	AMT20_V              NUMBER(13) NULL ,
	AMT20_M              NUMBER(13) NULL ,
	AMT90                NUMBER(13) NULL ,
	AMT90_L              NUMBER(13) NULL ,
	AMT90_B              NUMBER(13) NULL ,
	AMT90_V              NUMBER(13) NULL ,
	AMT90_M              NUMBER(13) NULL 
);



CREATE UNIQUE INDEX XPKHD_SUPPLY_CONV ON HD_SUPPLY_CONV
(DEPT_CODE   ASC,HOUSETAG   ASC,BUILDNO   ASC,HOUSENO   ASC);



ALTER TABLE HD_SUPPLY_CONV
	ADD CONSTRAINT  SYS_C0026134 PRIMARY KEY (DEPT_CODE,HOUSETAG,BUILDNO,HOUSENO);



CREATE TABLE HD_SUPPLY_CONV
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019792 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019793 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019794 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019795 NOT NULL ,
	SQUARE               NUMBER(8,4) NULL ,
	TYPE                 VARCHAR2(4 BYTE) NULL ,
	CLASS                VARCHAR2(1 BYTE) NULL ,
	OPTIONS              VARCHAR2(2 BYTE) DEFAULT  '00'  NULL ,
	EXCLUSIVEAREA        NUMBER(8,4) NULL ,
	COMMONAREA           NUMBER(8,4) NULL ,
	ETCCOMMONAREA        NUMBER(8,4) NULL ,
	PARKINGAREA          NUMBER(8,4) NULL ,
	SERVICEAREA          NUMBER(8,4) NULL ,
	SITEAREA             NUMBER(8,4) NULL ,
	TOT_SUPPLYAMT        NUMBER(13) NULL ,
	TOT_LANDAMT          NUMBER(13) NULL ,
	TOT_BUILDAMT         NUMBER(13) NULL ,
	TOT_VATAMT           NUMBER(13) NULL ,
	TOT_MANAGEAMT        NUMBER(13) NULL ,
	AMT00                NUMBER(13) NULL ,
	AMT00_L              NUMBER(13) NULL ,
	AMT00_B              NUMBER(13) NULL ,
	AMT00_V              NUMBER(13) NULL ,
	AMT00_M              NUMBER(13) NULL ,
	AMT01                NUMBER(13) NULL ,
	AMT01_L              NUMBER(13) NULL ,
	AMT01_B              NUMBER(13) NULL ,
	AMT01_V              NUMBER(13) NULL ,
	AMT01_M              NUMBER(13) NULL ,
	AMT02                NUMBER(13) NULL ,
	AMT02_L              NUMBER(13) NULL ,
	AMT02_B              NUMBER(13) NULL ,
	AMT02_V              NUMBER(13) NULL ,
	AMT02_M              NUMBER(13) NULL ,
	AMT11                NUMBER(13) NULL ,
	AMT11_L              NUMBER(13) NULL ,
	AMT11_B              NUMBER(13) NULL ,
	AMT11_V              NUMBER(13) NULL ,
	AMT11_M              NUMBER(13) NULL ,
	AMT12                NUMBER(13) NULL ,
	AMT12_L              NUMBER(13) NULL ,
	AMT12_B              NUMBER(13) NULL ,
	AMT12_V              NUMBER(13) NULL ,
	AMT12_M              NUMBER(13) NULL ,
	AMT13                NUMBER(13) NULL ,
	AMT13_L              NUMBER(13) NULL ,
	AMT13_B              NUMBER(13) NULL ,
	AMT13_V              NUMBER(13) NULL ,
	AMT13_M              NUMBER(13) NULL ,
	AMT14                NUMBER(13) NULL ,
	AMT14_L              NUMBER(13) NULL ,
	AMT14_B              NUMBER(13) NULL ,
	AMT14_V              NUMBER(13) NULL ,
	AMT14_M              NUMBER(13) NULL ,
	AMT15                NUMBER(13) NULL ,
	AMT15_L              NUMBER(13) NULL ,
	AMT15_B              NUMBER(13) NULL ,
	AMT15_V              NUMBER(13) NULL ,
	AMT15_M              NUMBER(13) NULL ,
	AMT16                NUMBER(13) NULL ,
	AMT16_L              NUMBER(13) NULL ,
	AMT16_B              NUMBER(13) NULL ,
	AMT16_V              NUMBER(13) NULL ,
	AMT16_M              NUMBER(13) NULL ,
	AMT17                NUMBER(13) NULL ,
	AMT17_L              NUMBER(13) NULL ,
	AMT17_B              NUMBER(13) NULL ,
	AMT17_V              NUMBER(13) NULL ,
	AMT17_M              NUMBER(13) NULL ,
	AMT18                NUMBER(13) NULL ,
	AMT18_L              NUMBER(13) NULL ,
	AMT18_B              NUMBER(13) NULL ,
	AMT18_V              NUMBER(13) NULL ,
	AMT18_M              NUMBER(13) NULL ,
	AMT19                NUMBER(13) NULL ,
	AMT19_L              NUMBER(13) NULL ,
	AMT19_B              NUMBER(13) NULL ,
	AMT19_V              NUMBER(13) NULL ,
	AMT19_M              NUMBER(13) NULL ,
	AMT20                NUMBER(13) NULL ,
	AMT20_L              NUMBER(13) NULL ,
	AMT20_B              NUMBER(13) NULL ,
	AMT20_V              NUMBER(13) NULL ,
	AMT20_M              NUMBER(13) NULL ,
	AMT90                NUMBER(13) NULL ,
	AMT90_L              NUMBER(13) NULL ,
	AMT90_B              NUMBER(13) NULL ,
	AMT90_V              NUMBER(13) NULL ,
	AMT90_M              NUMBER(13) NULL 
);



CREATE UNIQUE INDEX XPKHD_SUPPLY_CONV ON HD_SUPPLY_CONV
(DEPT_CODE   ASC,HOUSETAG   ASC,BUILDNO   ASC,HOUSENO   ASC);



CREATE TABLE HD_TAX_CALC_HISTORY
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0026197 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0026198 NOT NULL ,
	WORK_DATE            VARCHAR2(14 BYTE) CONSTRAINT SYS_C0026199 NOT NULL ,
	TERM_FR              VARCHAR2(8 BYTE) NULL ,
	TERM_TO              VARCHAR2(8 BYTE) NULL ,
	TARGET_CNT           NUMBER(5) NULL ,
	WORK_CNT             NUMBER(5) NULL ,
	END_YN               VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_TAX_CALC_HISTORY
	ADD CONSTRAINT  SYS_C0026200 PRIMARY KEY (DEPT_CODE,HOUSETAG,WORK_DATE);



CREATE TABLE HD_TAX_CALC_HISTORY
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019858 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019859 NOT NULL ,
	WORK_DATE            VARCHAR2(14 BYTE) CONSTRAINT SYS_C0019860 NOT NULL ,
	TERM_FR              VARCHAR2(8 BYTE) NULL ,
	TERM_TO              VARCHAR2(8 BYTE) NULL ,
	TARGET_CNT           NUMBER(5) NULL ,
	WORK_CNT             NUMBER(5) NULL ,
	END_YN               VARCHAR2(1 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_TAX_CALC_HISTORY
	ADD CONSTRAINT  SYS_C0019861 PRIMARY KEY (DEPT_CODE,HOUSETAG,WORK_DATE);



CREATE TABLE HD_TAX_CALCULATE
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0026135 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0026136 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0026137 NOT NULL ,
	TIMES                FLOAT(126) CONSTRAINT SYS_C0026138 NOT NULL ,
	CALCULATETAG         VARCHAR2(1 BYTE) CONSTRAINT SYS_C0026139 NOT NULL ,
	TRANSACTIONCODE      VARCHAR2(20 BYTE) CONSTRAINT SYS_C0026140 NOT NULL ,
	DEMANDTAG            VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0026141 NOT NULL ,
	RECEIPTDATE          VARCHAR2(8 BYTE) CONSTRAINT SYS_C0026142 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0026143 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0026144 NOT NULL ,
	CHANGETAG            VARCHAR2(1 BYTE) CONSTRAINT SYS_C0026145 NOT NULL ,
	KUN                  VARCHAR2(4 BYTE) NULL ,
	HO                   VARCHAR2(4 BYTE) NULL ,
	SQUARE               NUMBER(8,4) NULL ,
	SANGHO               VARCHAR2(30 BYTE) NULL ,
	REPRESANTATION       VARCHAR2(30 BYTE) NULL ,
	ADDR                 VARCHAR2(100 BYTE) NULL ,
	ADDR2                VARCHAR2(100 BYTE) NULL ,
	UPTAE                VARCHAR2(30 BYTE) NULL ,
	UPJONG               VARCHAR2(30 BYTE) NULL ,
	BLANK                VARCHAR2(1 BYTE) NULL ,
	SUPPLYAMT            FLOAT(126) NULL ,
	LANDAMT              FLOAT(126) NULL ,
	BUILDAMT             FLOAT(126) NULL ,
	VATAMT               FLOAT(126) NULL ,
	SPECIALNAME          VARCHAR2(50 BYTE) NULL ,
	REMARK               VARCHAR2(50 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_TAX_CALCULATE
	ADD CONSTRAINT  SYS_C0026146 PRIMARY KEY (DEPT_CODE,HOUSETAG,COUNTS,TIMES,CALCULATETAG,TRANSACTIONCODE,DEMANDTAG,RECEIPTDATE,BUILDNO,HOUSENO,CHANGETAG);



CREATE TABLE HD_TAX_CALCULATE
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019796 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019797 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019798 NOT NULL ,
	TIMES                FLOAT(126) CONSTRAINT SYS_C0019799 NOT NULL ,
	CALCULATETAG         VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019800 NOT NULL ,
	TRANSACTIONCODE      VARCHAR2(13 BYTE) CONSTRAINT SYS_C0019801 NOT NULL ,
	DEMANDTAG            VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019802 NOT NULL ,
	RECEIPTDATE          VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019803 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019804 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019805 NOT NULL ,
	CHANGETAG            VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019806 NOT NULL ,
	KUN                  VARCHAR2(4 BYTE) NULL ,
	HO                   VARCHAR2(4 BYTE) NULL ,
	SQUARE               NUMBER(8,4) NULL ,
	SANGHO               VARCHAR2(30 BYTE) NULL ,
	REPRESANTATION       VARCHAR2(30 BYTE) NULL ,
	ADDR                 VARCHAR2(100 BYTE) NULL ,
	ADDR2                VARCHAR2(100 BYTE) NULL ,
	UPTAE                VARCHAR2(30 BYTE) NULL ,
	UPJONG               VARCHAR2(30 BYTE) NULL ,
	BLANK                VARCHAR2(1 BYTE) NULL ,
	SUPPLYAMT            FLOAT(126) NULL ,
	LANDAMT              FLOAT(126) NULL ,
	BUILDAMT             FLOAT(126) NULL ,
	VATAMT               FLOAT(126) NULL ,
	SPECIALNAME          VARCHAR2(50 BYTE) NULL ,
	REMARK               VARCHAR2(50 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_TAX_CALCULATE
	ADD CONSTRAINT  SYS_C0019807 PRIMARY KEY (DEPT_CODE,HOUSETAG,COUNTS,TIMES,CALCULATETAG,TRANSACTIONCODE,DEMANDTAG,RECEIPTDATE,BUILDNO,HOUSENO,CHANGETAG);



CREATE TABLE HD_TAX_CALCULATE_AGREE
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0026147 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0026148 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0026149 NOT NULL ,
	TIMES                FLOAT(126) CONSTRAINT SYS_C0026150 NOT NULL ,
	CALCULATETAG         VARCHAR2(1 BYTE) CONSTRAINT SYS_C0026151 NOT NULL ,
	TRANSACTIONCODE      VARCHAR2(20 BYTE) CONSTRAINT SYS_C0026152 NOT NULL ,
	DEMANDTAG            VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0026153 NOT NULL ,
	RECEIPTDATE          VARCHAR2(8 BYTE) CONSTRAINT SYS_C0026154 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0026155 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0026156 NOT NULL ,
	CHANGETAG            VARCHAR2(1 BYTE) CONSTRAINT SYS_C0026157 NOT NULL ,
	KUN                  VARCHAR2(4 BYTE) NULL ,
	HO                   VARCHAR2(4 BYTE) NULL ,
	SQUARE               NUMBER(8,4) NULL ,
	SANGHO               VARCHAR2(30 BYTE) NULL ,
	REPRESANTATION       VARCHAR2(30 BYTE) NULL ,
	ADDR                 VARCHAR2(100 BYTE) NULL ,
	ADDR2                VARCHAR2(100 BYTE) NULL ,
	UPTAE                VARCHAR2(30 BYTE) NULL ,
	UPJONG               VARCHAR2(30 BYTE) NULL ,
	BLANK                VARCHAR2(1 BYTE) NULL ,
	SUPPLYAMT            FLOAT(126) NULL ,
	LANDAMT              FLOAT(126) NULL ,
	BUILDAMT             FLOAT(126) NULL ,
	VATAMT               FLOAT(126) NULL ,
	SPECIALNAME          VARCHAR2(50 BYTE) NULL ,
	REMARK               VARCHAR2(50 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_TAX_CALCULATE_AGREE
	ADD CONSTRAINT  SYS_C0026158 PRIMARY KEY (DEPT_CODE,HOUSETAG,COUNTS,TIMES,CALCULATETAG,TRANSACTIONCODE,DEMANDTAG,RECEIPTDATE,BUILDNO,HOUSENO,CHANGETAG);



CREATE TABLE HD_TAX_CALCULATE_AGREE
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019808 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019809 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019810 NOT NULL ,
	TIMES                FLOAT(126) CONSTRAINT SYS_C0019811 NOT NULL ,
	CALCULATETAG         VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019812 NOT NULL ,
	TRANSACTIONCODE      VARCHAR2(13 BYTE) CONSTRAINT SYS_C0019813 NOT NULL ,
	DEMANDTAG            VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019814 NOT NULL ,
	RECEIPTDATE          VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019815 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019816 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019817 NOT NULL ,
	CHANGETAG            VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019818 NOT NULL ,
	KUN                  VARCHAR2(4 BYTE) NULL ,
	HO                   VARCHAR2(4 BYTE) NULL ,
	SQUARE               NUMBER(8,4) NULL ,
	SANGHO               VARCHAR2(30 BYTE) NULL ,
	REPRESANTATION       VARCHAR2(30 BYTE) NULL ,
	ADDR                 VARCHAR2(100 BYTE) NULL ,
	ADDR2                VARCHAR2(100 BYTE) NULL ,
	UPTAE                VARCHAR2(30 BYTE) NULL ,
	UPJONG               VARCHAR2(30 BYTE) NULL ,
	BLANK                VARCHAR2(1 BYTE) NULL ,
	SUPPLYAMT            FLOAT(126) NULL ,
	LANDAMT              FLOAT(126) NULL ,
	BUILDAMT             FLOAT(126) NULL ,
	VATAMT               FLOAT(126) NULL ,
	SPECIALNAME          VARCHAR2(50 BYTE) NULL ,
	REMARK               VARCHAR2(50 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_TAX_CALCULATE_AGREE
	ADD CONSTRAINT  SYS_C0019819 PRIMARY KEY (DEPT_CODE,HOUSETAG,COUNTS,TIMES,CALCULATETAG,TRANSACTIONCODE,DEMANDTAG,RECEIPTDATE,BUILDNO,HOUSENO,CHANGETAG);



CREATE TABLE HD_TAX_CALCULATE_HIST
(
	HIST_DATE            DATE CONSTRAINT SYS_C0026159 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0026160 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0026161 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0026162 NOT NULL ,
	TIMES                FLOAT(126) CONSTRAINT SYS_C0026163 NOT NULL ,
	CALCULATETAG         VARCHAR2(1 BYTE) CONSTRAINT SYS_C0026164 NOT NULL ,
	TRANSACTIONCODE      VARCHAR2(13 BYTE) CONSTRAINT SYS_C0026165 NOT NULL ,
	DEMANDTAG            VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0026166 NOT NULL ,
	RECEIPTDATE          VARCHAR2(8 BYTE) CONSTRAINT SYS_C0026167 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0026168 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0026169 NOT NULL ,
	CHANGETAG            VARCHAR2(1 BYTE) CONSTRAINT SYS_C0026170 NOT NULL ,
	KUN                  VARCHAR2(4 BYTE) NULL ,
	HO                   VARCHAR2(4 BYTE) NULL ,
	SQUARE               NUMBER(8,4) NULL ,
	SANGHO               VARCHAR2(30 BYTE) NULL ,
	REPRESANTATION       VARCHAR2(30 BYTE) NULL ,
	ADDR                 VARCHAR2(50 BYTE) NULL ,
	ADDR2                VARCHAR2(50 BYTE) NULL ,
	UPTAE                VARCHAR2(30 BYTE) NULL ,
	UPJONG               VARCHAR2(30 BYTE) NULL ,
	BLANK                VARCHAR2(1 BYTE) NULL ,
	SUPPLYAMT            FLOAT(126) NULL ,
	LANDAMT              FLOAT(126) NULL ,
	BUILDAMT             FLOAT(126) NULL ,
	VATAMT               FLOAT(126) NULL ,
	SPECIALNAME          VARCHAR2(50 BYTE) NULL ,
	REMARK               VARCHAR2(50 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	TRI_TAG              VARCHAR2(1 BYTE) NULL 
);



ALTER TABLE HD_TAX_CALCULATE_HIST
	ADD CONSTRAINT  SYS_C0026171 PRIMARY KEY (HIST_DATE,DEPT_CODE,HOUSETAG,COUNTS,TIMES,CALCULATETAG,TRANSACTIONCODE,DEMANDTAG,RECEIPTDATE,BUILDNO,HOUSENO,CHANGETAG);



CREATE TABLE HD_TAX_CALCULATE_HIST
(
	HIST_DATE            DATE CONSTRAINT SYS_C0019820 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019821 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019822 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019823 NOT NULL ,
	TIMES                FLOAT(126) CONSTRAINT SYS_C0019824 NOT NULL ,
	CALCULATETAG         VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019825 NOT NULL ,
	TRANSACTIONCODE      VARCHAR2(13 BYTE) CONSTRAINT SYS_C0019826 NOT NULL ,
	DEMANDTAG            VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019827 NOT NULL ,
	RECEIPTDATE          VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019828 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019829 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019830 NOT NULL ,
	CHANGETAG            VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019831 NOT NULL ,
	KUN                  VARCHAR2(4 BYTE) NULL ,
	HO                   VARCHAR2(4 BYTE) NULL ,
	SQUARE               NUMBER(8,4) NULL ,
	SANGHO               VARCHAR2(30 BYTE) NULL ,
	REPRESANTATION       VARCHAR2(30 BYTE) NULL ,
	ADDR                 VARCHAR2(50 BYTE) NULL ,
	ADDR2                VARCHAR2(50 BYTE) NULL ,
	UPTAE                VARCHAR2(30 BYTE) NULL ,
	UPJONG               VARCHAR2(30 BYTE) NULL ,
	BLANK                VARCHAR2(1 BYTE) NULL ,
	SUPPLYAMT            FLOAT(126) NULL ,
	LANDAMT              FLOAT(126) NULL ,
	BUILDAMT             FLOAT(126) NULL ,
	VATAMT               FLOAT(126) NULL ,
	SPECIALNAME          VARCHAR2(50 BYTE) NULL ,
	REMARK               VARCHAR2(50 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	TRI_TAG              VARCHAR2(1 BYTE) NULL 
);



ALTER TABLE HD_TAX_CALCULATE_HIST
	ADD CONSTRAINT  SYS_C0019832 PRIMARY KEY (HIST_DATE,DEPT_CODE,HOUSETAG,COUNTS,TIMES,CALCULATETAG,TRANSACTIONCODE,DEMANDTAG,RECEIPTDATE,BUILDNO,HOUSENO,CHANGETAG);



CREATE TABLE HD_TAX_CALCULATE_REAL
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0026172 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0026173 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0026174 NOT NULL ,
	TIMES                FLOAT(126) CONSTRAINT SYS_C0026175 NOT NULL ,
	CALCULATETAG         VARCHAR2(1 BYTE) CONSTRAINT SYS_C0026176 NOT NULL ,
	TRANSACTIONCODE      VARCHAR2(20 BYTE) CONSTRAINT SYS_C0026177 NOT NULL ,
	DEMANDTAG            VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0026178 NOT NULL ,
	RECEIPTDATE          VARCHAR2(8 BYTE) CONSTRAINT SYS_C0026179 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0026180 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0026181 NOT NULL ,
	CHANGETAG            VARCHAR2(1 BYTE) CONSTRAINT SYS_C0026182 NOT NULL ,
	KUN                  VARCHAR2(4 BYTE) NULL ,
	HO                   VARCHAR2(4 BYTE) NULL ,
	SQUARE               NUMBER(8,4) NULL ,
	SANGHO               VARCHAR2(30 BYTE) NULL ,
	REPRESANTATION       VARCHAR2(30 BYTE) NULL ,
	ADDR                 VARCHAR2(100 BYTE) NULL ,
	ADDR2                VARCHAR2(100 BYTE) NULL ,
	UPTAE                VARCHAR2(30 BYTE) NULL ,
	UPJONG               VARCHAR2(30 BYTE) NULL ,
	BLANK                VARCHAR2(1 BYTE) NULL ,
	SUPPLYAMT            FLOAT(126) NULL ,
	LANDAMT              FLOAT(126) NULL ,
	BUILDAMT             FLOAT(126) NULL ,
	VATAMT               FLOAT(126) NULL ,
	SPECIALNAME          VARCHAR2(50 BYTE) NULL ,
	REMARK               VARCHAR2(50 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_TAX_CALCULATE_REAL
	ADD CONSTRAINT  SYS_C0026183 PRIMARY KEY (DEPT_CODE,HOUSETAG,COUNTS,TIMES,CALCULATETAG,TRANSACTIONCODE,DEMANDTAG,RECEIPTDATE,BUILDNO,HOUSENO,CHANGETAG);



CREATE TABLE HD_TAX_CALCULATE_REAL
(
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019833 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019834 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019835 NOT NULL ,
	TIMES                FLOAT(126) CONSTRAINT SYS_C0019836 NOT NULL ,
	CALCULATETAG         VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019837 NOT NULL ,
	TRANSACTIONCODE      VARCHAR2(13 BYTE) CONSTRAINT SYS_C0019838 NOT NULL ,
	DEMANDTAG            VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019839 NOT NULL ,
	RECEIPTDATE          VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019840 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019841 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019842 NOT NULL ,
	CHANGETAG            VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019843 NOT NULL ,
	KUN                  VARCHAR2(4 BYTE) NULL ,
	HO                   VARCHAR2(4 BYTE) NULL ,
	SQUARE               NUMBER(8,4) NULL ,
	SANGHO               VARCHAR2(30 BYTE) NULL ,
	REPRESANTATION       VARCHAR2(30 BYTE) NULL ,
	ADDR                 VARCHAR2(100 BYTE) NULL ,
	ADDR2                VARCHAR2(100 BYTE) NULL ,
	UPTAE                VARCHAR2(30 BYTE) NULL ,
	UPJONG               VARCHAR2(30 BYTE) NULL ,
	BLANK                VARCHAR2(1 BYTE) NULL ,
	SUPPLYAMT            FLOAT(126) NULL ,
	LANDAMT              FLOAT(126) NULL ,
	BUILDAMT             FLOAT(126) NULL ,
	VATAMT               FLOAT(126) NULL ,
	SPECIALNAME          VARCHAR2(50 BYTE) NULL ,
	REMARK               VARCHAR2(50 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL 
);



ALTER TABLE HD_TAX_CALCULATE_REAL
	ADD CONSTRAINT  SYS_C0019844 PRIMARY KEY (DEPT_CODE,HOUSETAG,COUNTS,TIMES,CALCULATETAG,TRANSACTIONCODE,DEMANDTAG,RECEIPTDATE,BUILDNO,HOUSENO,CHANGETAG);



CREATE TABLE HD_TAX_CALCULATE_REAL_HIST
(
	HIST_DATE            DATE CONSTRAINT SYS_C0026184 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0026185 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0026186 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0026187 NOT NULL ,
	TIMES                FLOAT(126) CONSTRAINT SYS_C0026188 NOT NULL ,
	CALCULATETAG         VARCHAR2(1 BYTE) CONSTRAINT SYS_C0026189 NOT NULL ,
	TRANSACTIONCODE      VARCHAR2(20 BYTE) CONSTRAINT SYS_C0026190 NOT NULL ,
	DEMANDTAG            VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0026191 NOT NULL ,
	RECEIPTDATE          VARCHAR2(8 BYTE) CONSTRAINT SYS_C0026192 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0026193 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0026194 NOT NULL ,
	CHANGETAG            VARCHAR2(1 BYTE) CONSTRAINT SYS_C0026195 NOT NULL ,
	KUN                  VARCHAR2(4 BYTE) NULL ,
	HO                   VARCHAR2(4 BYTE) NULL ,
	SQUARE               NUMBER(8,4) NULL ,
	SANGHO               VARCHAR2(30 BYTE) NULL ,
	REPRESANTATION       VARCHAR2(30 BYTE) NULL ,
	ADDR                 VARCHAR2(50 BYTE) NULL ,
	ADDR2                VARCHAR2(50 BYTE) NULL ,
	UPTAE                VARCHAR2(30 BYTE) NULL ,
	UPJONG               VARCHAR2(30 BYTE) NULL ,
	BLANK                VARCHAR2(1 BYTE) NULL ,
	SUPPLYAMT            FLOAT(126) NULL ,
	LANDAMT              FLOAT(126) NULL ,
	BUILDAMT             FLOAT(126) NULL ,
	VATAMT               FLOAT(126) NULL ,
	SPECIALNAME          VARCHAR2(50 BYTE) NULL ,
	REMARK               VARCHAR2(50 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	TRI_TAG              VARCHAR2(1 BYTE) NULL 
);



ALTER TABLE HD_TAX_CALCULATE_REAL_HIST
	ADD CONSTRAINT  SYS_C0026196 PRIMARY KEY (HIST_DATE,DEPT_CODE,HOUSETAG,COUNTS,TIMES,CALCULATETAG,TRANSACTIONCODE,DEMANDTAG,RECEIPTDATE,BUILDNO,HOUSENO,CHANGETAG);



CREATE TABLE HD_TAX_CALCULATE_REAL_HIST
(
	HIST_DATE            DATE CONSTRAINT SYS_C0019845 NOT NULL ,
	DEPT_CODE            VARCHAR2(12 BYTE) CONSTRAINT SYS_C0019846 NOT NULL ,
	HOUSETAG             VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019847 NOT NULL ,
	COUNTS               VARCHAR2(2 BYTE) CONSTRAINT SYS_C0019848 NOT NULL ,
	TIMES                FLOAT(126) CONSTRAINT SYS_C0019849 NOT NULL ,
	CALCULATETAG         VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019850 NOT NULL ,
	TRANSACTIONCODE      VARCHAR2(13 BYTE) CONSTRAINT SYS_C0019851 NOT NULL ,
	DEMANDTAG            VARCHAR2(1 BYTE) DEFAULT  '1'  CONSTRAINT SYS_C0019852 NOT NULL ,
	RECEIPTDATE          VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019853 NOT NULL ,
	BUILDNO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019854 NOT NULL ,
	HOUSENO              VARCHAR2(10 BYTE) CONSTRAINT SYS_C0019855 NOT NULL ,
	CHANGETAG            VARCHAR2(1 BYTE) CONSTRAINT SYS_C0019856 NOT NULL ,
	KUN                  VARCHAR2(4 BYTE) NULL ,
	HO                   VARCHAR2(4 BYTE) NULL ,
	SQUARE               NUMBER(8,4) NULL ,
	SANGHO               VARCHAR2(30 BYTE) NULL ,
	REPRESANTATION       VARCHAR2(30 BYTE) NULL ,
	ADDR                 VARCHAR2(50 BYTE) NULL ,
	ADDR2                VARCHAR2(50 BYTE) NULL ,
	UPTAE                VARCHAR2(30 BYTE) NULL ,
	UPJONG               VARCHAR2(30 BYTE) NULL ,
	BLANK                VARCHAR2(1 BYTE) NULL ,
	SUPPLYAMT            FLOAT(126) NULL ,
	LANDAMT              FLOAT(126) NULL ,
	BUILDAMT             FLOAT(126) NULL ,
	VATAMT               FLOAT(126) NULL ,
	SPECIALNAME          VARCHAR2(50 BYTE) NULL ,
	REMARK               VARCHAR2(50 BYTE) NULL ,
	INPUT_DUTY_ID        VARCHAR2(12 BYTE) NULL ,
	INPUT_DATE           VARCHAR2(14 BYTE) NULL ,
	CHG_DUTY_ID          VARCHAR2(12 BYTE) NULL ,
	CHG_DATE             VARCHAR2(14 BYTE) NULL ,
	TRI_TAG              VARCHAR2(1 BYTE) NULL 
);



ALTER TABLE HD_TAX_CALCULATE_REAL_HIST
	ADD CONSTRAINT  SYS_C0019857 PRIMARY KEY (HIST_DATE,DEPT_CODE,HOUSETAG,COUNTS,TIMES,CALCULATETAG,TRANSACTIONCODE,DEMANDTAG,RECEIPTDATE,BUILDNO,HOUSENO,CHANGETAG);



CREATE TABLE HD_TEMP_VIRTURE_DEPOSIT
(
	VIR_DEPOSITNO        VARCHAR2(20 BYTE) CONSTRAINT SYS_C0026201 NOT NULL ,
	MAKE_SEQ             VARCHAR2(10 BYTE) CONSTRAINT SYS_C0026202 NOT NULL 
);



CREATE UNIQUE INDEX PI_HD_TEMP_VIRTURE_DEPOSIT ON HD_TEMP_VIRTURE_DEPOSIT
(VIR_DEPOSITNO   ASC);



ALTER TABLE HD_TEMP_VIRTURE_DEPOSIT
	ADD CONSTRAINT  PI_HD_TEMP_VIRTURE_DEPOSIT PRIMARY KEY (VIR_DEPOSITNO);



CREATE TABLE HD_VIRTURE_ACCOUNT
(
	TROCCORG_CD          VARCHAR2(8 BYTE) CONSTRAINT SYS_C0026204 NOT NULL ,
	TR_IL                VARCHAR2(8 BYTE) CONSTRAINT SYS_C0026205 NOT NULL ,
	CPORG_CD             VARCHAR2(8 BYTE) CONSTRAINT SYS_C0026206 NOT NULL ,
	DEPTR_SEQ            VARCHAR2(7 BYTE) CONSTRAINT SYS_C0026207 NOT NULL ,
	HNDORG_CD            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0026208 NOT NULL ,
	TR_SI                VARCHAR2(6 BYTE) NULL ,
	TX_SEQ               VARCHAR2(10 BYTE) NULL ,
	TX_CD                VARCHAR2(4 BYTE) NULL ,
	TR_CD                VARCHAR2(4 BYTE) NULL ,
	FN_GB                NUMBER(1) DEFAULT  1  NULL ,
	VA_NO                VARCHAR2(16 BYTE) NULL ,
	DEPBNK_CD            VARCHAR2(8 BYTE) NULL ,
	DEP_AMT              NUMBER(13) NULL ,
	YTSTJM_AMT           NUMBER(13) NULL ,
	DEPBNK_NM            VARCHAR2(10 BYTE) NULL ,
	CUST_NM              VARCHAR2(20 BYTE) NULL ,
	DEPT_ST              CHAR(1 BYTE) NULL ,
	DEPCNT_GB            CHAR(1 BYTE) NULL 
);



ALTER TABLE HD_VIRTURE_ACCOUNT
	ADD CONSTRAINT  SYS_C0026209 PRIMARY KEY (TROCCORG_CD,TR_IL,CPORG_CD,DEPTR_SEQ);



CREATE TABLE HD_VIRTURE_ACCOUNT
(
	TROCCORG_CD          VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019862 NOT NULL ,
	TR_IL                VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019863 NOT NULL ,
	CPORG_CD             VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019864 NOT NULL ,
	DEPTR_SEQ            VARCHAR2(7 BYTE) CONSTRAINT SYS_C0019865 NOT NULL ,
	HNDORG_CD            VARCHAR2(8 BYTE) CONSTRAINT SYS_C0019866 NOT NULL ,
	TR_SI                VARCHAR2(6 BYTE) NULL ,
	TX_SEQ               VARCHAR2(10 BYTE) NULL ,
	TX_CD                VARCHAR2(4 BYTE) NULL ,
	TR_CD                VARCHAR2(4 BYTE) NULL ,
	FN_GB                NUMBER(1) DEFAULT  1  NULL ,
	VA_NO                VARCHAR2(16 BYTE) NULL ,
	DEPBNK_CD            VARCHAR2(8 BYTE) NULL ,
	DEP_AMT              NUMBER(13) NULL ,
	YTSTJM_AMT           NUMBER(13) NULL ,
	DEPBNK_NM            VARCHAR2(10 BYTE) NULL ,
	CUST_NM              VARCHAR2(20 BYTE) NULL ,
	DEPT_ST              CHAR(1 BYTE) NULL ,
	DEPCNT_GB            CHAR(1 BYTE) NULL 
);



ALTER TABLE HD_VIRTURE_ACCOUNT
	ADD CONSTRAINT  SYS_C0019867 PRIMARY KEY (TROCCORG_CD,TR_IL,CPORG_CD,DEPTR_SEQ);



CREATE  OR REPLACE  FUNCTION XDB$EXTNAME2INTNAME

  (schemaURL IN VARCHAR2, schemaOwner IN VARCHAR2 := '')
return varchar2 authid current_user deterministic
is external name "EXT2INT_NAME" library XMLSCHEMA_LIB with context
parameters (context, schemaURL OCIString, schemaOwner OCIString,
            return INDICATOR sb4, return OCIString);

/





CREATE  OR REPLACE  FUNCTION GET_XDB_TABLESPACE wrapped
a000000
1
abcd
abcd
abcd


/





CREATE  OR REPLACE  FUNCTION CONTENTSCHEMAIS wrapped
a000000
1
abcd
abcd
abc

/





CREATE  OR REPLACE  FUNCTION UNDER_PATH_FUNC wrapped
a000000
1
abcd
abcd
abc

/





CREATE  OR REPLACE  FUNCTION XMLINDEXLOADFUNC

       return XDB.XMLIndexTab_t authid current_user
pipelined using XDB.XMLIndexLoad_Imp_t;

/





CREATE  OR REPLACE  FUNCTION F_HD_ISDATE ( 

  as_dt    IN VARCHAR2
) RETURN VARCHAR2 IS

-------------------------------------------------------------
v_dt  VARCHAR2(8);
i     NUMBER;

-------------------------------------------------------------
BEGIN
   v_dt := TRIM(NVL(as_dt, ''));

   IF NVL(LENGTH(v_dt), 0) <> 8 THEN
      RETURN 'ERR';
   END IF;

   i := 0;
   LOOP
      i := i + 1;
      IF SUBSTR(v_dt, i, 1) < '0' OR SUBSTR(v_dt, i, 1) > '9' THEN
         RETURN 'ERR';
      END IF;

      IF i = 8 THEN
         EXIT;
      END IF;
   END LOOP;

   IF SUBSTR(v_dt, 1, 4) < '0000' OR SUBSTR(v_dt, 1, 4) > '9999' THEN
      RETURN 'ERR';
   END IF;

   IF SUBSTR(v_dt, 5, 2) < '01' OR SUBSTR(v_dt, 5, 2) > '12' THEN
      RETURN 'ERR';
   END IF;

   IF SUBSTR(v_dt, 7, 2) < '01' OR SUBSTR(v_dt, 7, 2) > '31' THEN
      RETURN 'ERR';
   END IF;

   IF v_dt < SUBSTR(v_dt, 1, 6) || '01' OR v_dt > TO_CHAR(LAST_DAY(TO_DATE(SUBSTR(v_dt, 1, 6) || '01', 'YYYYMMDD')), 'YYYYMMDD') THEN
      RETURN 'ERR';
   END IF;

   RETURN 'Y';
END; 

/





CREATE  OR REPLACE  FUNCTION F_HD_ADDDAY ( 

  as_dt    IN VARCHAR2,
  as_num   IN NUMBER
) RETURN VARCHAR2 IS

-------------------------------------------------------------
v_dt  VARCHAR2(8);

-------------------------------------------------------------
BEGIN
   IF F_HD_ISDATE(as_dt) = 'ERR' THEN
      RETURN 'ERR';
   END IF;

   RETURN TO_CHAR(TO_DATE(as_dt, 'YYYYMMDD') + as_num, 'YYYYMMDD');
END; 

/





CREATE  OR REPLACE  FUNCTION F_HD_DIFFDAY ( 

  as_fr    IN VARCHAR2,
  as_to    IN VARCHAR2
) RETURN NUMBER IS

-------------------------------------------------------------
v_dt  VARCHAR2(8);

-------------------------------------------------------------
BEGIN
   IF F_HD_ISDATE(as_fr) = 'ERR' OR F_HD_ISDATE(as_to) = 'ERR' THEN
      RETURN 0;
   END IF;

   RETURN TO_DATE(as_to, 'YYYYMMDD') - TO_DATE(as_fr, 'YYYYMMDD');
END; 

/





CREATE  OR REPLACE  FUNCTION F_HD_MONTHSBETWEEN ( 

  as_fr    IN VARCHAR2,
  as_to    IN VARCHAR2
) RETURN NUMBER IS

-------------------------------------------------------------
v_dt  VARCHAR2(8);

-------------------------------------------------------------
BEGIN
   IF F_HD_ISDATE(as_fr) = 'ERR' OR F_HD_ISDATE(as_to) = 'ERR' THEN
      RETURN 0;
   END IF;

   RETURN MONTHS_BETWEEN(TO_DATE(as_fr, 'YYYYMMDD'), TO_DATE(as_to, 'YYYYMMDD'));
END; 

/





CREATE OR REPLACE FUNCTION      "F_MM_COMMISSION_NEWFEE"  ( av_code varchar2, av_date varchar2 )

 return varchar2 is
    lv_newfee_yn varchar2(1);
 begin

    select CASE WHEN (select min(change_date) from mm_comm_commission 
    where contract_code = av_code and fee_class in ('71', '99')) between substr(av_date,1,4)||'0101' and av_date
    THEN 'Y' ELSE 'N' END as new_feeclass_tag
    into lv_newfee_yn 
    from dual 
    ;

    return lv_newfee_yn;
 end; 

/





CREATE  OR REPLACE  FUNCTION F_HD_GET_VALIDCODE

(
   as_code   VARCHAR2,   --
   as_tp     VARCHAR2    -- 1: 2:
)
RETURN NUMBER IS -- 1: 0:

-------------------------------------------------------------------VALUES
v_code       VARCHAR2(13);
v_sum        NUMBER(10);
v_chk        NUMBER(10);
v_nchk       NUMBER(10);

-------------------------------------------------------------------------
BEGIN
   v_code := TRIM(REPLACE(as_code, '-', ''));
   v_sum  := 0;

   --    --
   IF as_tp = '1' THEN
      IF LENGTH(NVL(v_code, 'X')) <> 10 THEN
         RETURN 0;
      END IF;

      v_sum := v_sum + TO_NUMBER(SUBSTR(v_code,  1, 1)) * 1;
      v_sum := v_sum + TO_NUMBER(SUBSTR(v_code,  2, 1)) * 3;
      v_sum := v_sum + TO_NUMBER(SUBSTR(v_code,  3, 1)) * 7;
      v_sum := v_sum + TO_NUMBER(SUBSTR(v_code,  4, 1)) * 1;
      v_sum := v_sum + TO_NUMBER(SUBSTR(v_code,  5, 1)) * 3;
      v_sum := v_sum + TO_NUMBER(SUBSTR(v_code,  6, 1)) * 7;
      v_sum := v_sum + TO_NUMBER(SUBSTR(v_code,  7, 1)) * 1;
      v_sum := v_sum + TO_NUMBER(SUBSTR(v_code,  8, 1)) * 3;
      v_nchk := TO_NUMBER(SUBSTR(v_code,  9, 1)) * 5;
      v_chk  := TO_NUMBER(SUBSTR(v_code, 10, 1));

      v_sum := v_sum + TRUNC(v_nchk / 10);
      v_sum := v_sum + MOD(v_nchk, 10);
      v_sum := MOD(v_sum, 10);
      v_sum := 10 - v_sum;
      
      IF (v_sum = 10) THEN
         v_sum := 0;
      END IF;

      IF (v_sum = v_chk) THEN
         RETURN 1;
      ELSE
         RETURN 0;
      END IF;
   END IF;

   --   --
   IF as_tp = '2' THEN
      IF LENGTH(NVL(v_code, 'X')) <> 13 THEN
         RETURN 0;
      END IF;

      v_sum := v_sum +  TO_NUMBER(SUBSTR(v_code,  1, 1)) * 2;
      v_sum := v_sum +  TO_NUMBER(SUBSTR(v_code,  2, 1)) * 3;
      v_sum := v_sum +  TO_NUMBER(SUBSTR(v_code,  3, 1)) * 4;
      v_sum := v_sum +  TO_NUMBER(SUBSTR(v_code,  4, 1)) * 5;
      v_sum := v_sum +  TO_NUMBER(SUBSTR(v_code,  5, 1)) * 6;
      v_sum := v_sum +  TO_NUMBER(SUBSTR(v_code,  6, 1)) * 7;
      v_sum := v_sum +  TO_NUMBER(SUBSTR(v_code,  7, 1)) * 8;
      v_sum := v_sum +  TO_NUMBER(SUBSTR(v_code,  8, 1)) * 9;
      v_sum := v_sum +  TO_NUMBER(SUBSTR(v_code,  9, 1)) * 2;
      v_sum := v_sum +  TO_NUMBER(SUBSTR(v_code, 10, 1)) * 3;
      v_sum := v_sum +  TO_NUMBER(SUBSTR(v_code, 11, 1)) * 4;
      v_sum := v_sum +  TO_NUMBER(SUBSTR(v_code, 12, 1)) * 5;
      v_chk := TO_NUMBER(SUBSTR(v_code, 13, 1));

      v_sum := 11 - MOD(v_sum, 11);
      IF v_sum = 10 THEN
         v_sum := 0;
      ELSIF v_sum = 11 THEN
         v_sum := 1;
      END IF;
      
      IF v_sum = v_chk THEN
         RETURN 1;
      ELSE
         RETURN 0;
      END IF;
   END IF;
   
   RETURN 0;
END;


/





CREATE OR REPLACE FUNCTION "F_AM_GET_DEPOSIT_CALCSUM"  

( av_deposit varchar2
 , av_date varchar2
 , av_enddate varchar2
 , av_holiday_yn varchar2
 )
 return integer is
    lv_nexdate   varchar2(8);
	lv_lastdate   varchar2(8);
	lv_days    integer;
	lv_amt    integer;
	lv_holday integer;
 begin
    
	select (case when expire_date < av_enddate and  expire_date > av_date then expire_date
	                                    else av_enddate  end) INTO lv_lastdate
	from am_code_deposit
	where deposit_no = av_deposit 
	;						 
	
	
	select  min(a.end_date)  into lv_nexdate
	 from am_endx_deposit a,
		  am_code_calc_acnt acnt
	  where a.acnt_code = acnt.acnt_code
	   and  a.end_date > av_date 
	   and   a.end_date <= lv_lastdate
	   and  acnt.calc_kind_code=  '000'
	   and acnt.calc_list_code = 'Depo0001'
	   and a.deposit_no = av_deposit ;
		
    if lv_nexdate is null then 
	   lv_nexdate := to_char(to_date(lv_lastdate) + 1,'yyyymmdd');
	end if;
	
	if av_holiday_yn = 'N' then  /*   */
		select sum(decode(to_char(to_date(work_date),'d'),1,1,7,1,decode(holiday_yn,'Y',1,0))) into lv_holday
		from sm_code_calendar
		where work_date between av_date  and lv_nexdate
		;
	else
	   lv_holday := 0;
	end if;
	
	/*if lv_nexdate = av_enddate then 
	   lv_nexdate := to_char(to_date(lv_nexdate) + 1,'yyyymmdd');
	end if;
	*/
	lv_days := (to_date(lv_nexdate) - to_date(av_date ))  - lv_holday ;
	--lv_amt  := av_amt *  lv_days;
	
    return lv_days;
 end;

/





CREATE OR REPLACE FUNCTION "F_HR_PERS_COUNT"(as_yymm varchar2, as_kind varchar2) RETURN number

 AS
   ln_cnt  number :=0;
 BEGIN
  if as_kind = 'total'  then  /**/
 	  select count(distinct emp_no)
 	    into ln_cnt
 	    from hr_payx_result_mst
 	   where work_yymm= as_yymm;
   else   /* cnt*/
        select count(distinct emp_no)
 	    into ln_cnt
 	    from hr_payx_result_detail

 	   where work_yymm= as_yymm
 	    and allow_code = 'AA'; /**/
    end if ;
    return ln_cnt;
 END;

/





CREATE OR REPLACE FUNCTION             "F_AM_SET_VATAMT" ( ag_amt number

 , ag_len number
 )
 return varchar2 is
    ag_amt_st varchar2(20);
    ag_alpha varchar2(20);
 begin
    if abs(ag_amt  / trunc(ag_amt)) > 1 then
       select lpad(trunc(abs(ag_amt),0),ag_len - 2,'0') ||to_char((abs(ag_amt) - trunc(abs(ag_amt),0))  * 100)
         into ag_amt_st
         from dual
       ;


       if substr(ag_amt_st,ag_len -2 ,1) = '0' then
          ag_alpha := '}';
       elsif substr(ag_amt_st,ag_len -2,1) = '1' then
          ag_alpha := 'J';
       elsif substr(ag_amt_st,ag_len -2,1) = '2' then
          ag_alpha := 'K';
       elsif substr(ag_amt_st,ag_len -2,1) = '3' then
          ag_alpha := 'L';
       elsif substr(ag_amt_st,ag_len -2,1) = '4' then
          ag_alpha := 'M';
       elsif substr(ag_amt_st,ag_len -2,1) = '5' then
          ag_alpha := 'N';
       elsif substr(ag_amt_st,ag_len -2,1) = '6' then

          ag_alpha := 'O';
       elsif substr(ag_amt_st,ag_len -2,1) = '7' then
          ag_alpha := 'P' ;
       elsif substr(ag_amt_st,ag_len -2,1) = '8' then
          ag_alpha := 'Q';
       elsif substr(ag_amt_st,ag_len -2,1) = '9' then
          ag_alpha := 'R';
       end if;

       select substr(ag_amt_st,1,ag_len -3) ||ag_alpha||substr(ag_amt_st,ag_len -1,2)
         into ag_amt_st
         from dual
       ;

    else
       select lpad(trim(to_char(abs(ag_amt ))),ag_len,'0')
         into ag_amt_st
         from dual
       ;

       if substr(ag_amt_st,ag_len  ,1) = '0' then
          ag_alpha :='}' ;
       elsif substr(ag_amt_st,ag_len ,1) = '1' then
          ag_alpha :='J';
       elsif substr(ag_amt_st,ag_len ,1) = '2' then
          ag_alpha :='K';
       elsif substr(ag_amt_st,ag_len ,1) = '3' then

          ag_alpha :='L';
       elsif substr(ag_amt_st,ag_len ,1) = '4' then
          ag_alpha :='M';
       elsif substr(ag_amt_st,ag_len ,1) = '5' then
          ag_alpha :='N';
       elsif substr(ag_amt_st,ag_len ,1) = '6' then
          ag_alpha :='O';
       elsif substr(ag_amt_st,ag_len ,1) = '7' then
          ag_alpha :='P' ;
       elsif substr(ag_amt_st,ag_len ,1) = '8' then
          ag_alpha :='Q';
       elsif substr(ag_amt_st,ag_len ,1) = '9' then
          ag_alpha :='R';

       end if ;

       select substr(ag_amt_st,1,ag_len -1) ||ag_alpha
         into ag_amt_st
         from dual
       ;
    end if;
    return ag_amt_st;
 end;

/





CREATE  OR REPLACE  FUNCTION F_HR_PERS_LUNAR_TO_SOLAR ( as_lunar IN CHAR )

     RETURN VARCHAR2
     IS
        ls_return VARCHAR2(100);

 BEGIN
    select min(solar_date)
       into ls_return
      from HR_PERS_LUNAR_TO_SOLAR
     where lunar_date =  as_lunar;

     Return ls_return;

    exception
    when NO_DATA_FOUND then
      return('99991231');
     

 END;

/





CREATE OR REPLACE FUNCTION           "F_FM_SET_VATAMT" ( ag_amt number

 , ag_len number
 )
 return varchar2 is
    ag_amt_st varchar2(20);
    ag_alpha varchar2(20);
 begin
    if abs(ag_amt  / trunc(ag_amt)) > 1 then
       select lpad(trunc(abs(ag_amt),0),ag_len - 2,'0') ||to_char((abs(ag_amt) - trunc(abs(ag_amt),0))  * 100)
         into ag_amt_st
         from dual
       ;


       if substr(ag_amt_st,ag_len -2 ,1) = '0' then
          ag_alpha := '}';
       elsif substr(ag_amt_st,ag_len -2,1) = '1' then
          ag_alpha := 'J';
       elsif substr(ag_amt_st,ag_len -2,1) = '2' then
          ag_alpha := 'K';
       elsif substr(ag_amt_st,ag_len -2,1) = '3' then
          ag_alpha := 'L';
       elsif substr(ag_amt_st,ag_len -2,1) = '4' then
          ag_alpha := 'M';
       elsif substr(ag_amt_st,ag_len -2,1) = '5' then
          ag_alpha := 'N';
       elsif substr(ag_amt_st,ag_len -2,1) = '6' then

          ag_alpha := 'O';
       elsif substr(ag_amt_st,ag_len -2,1) = '7' then
          ag_alpha := 'P' ;
       elsif substr(ag_amt_st,ag_len -2,1) = '8' then
          ag_alpha := 'Q';
       elsif substr(ag_amt_st,ag_len -2,1) = '9' then
          ag_alpha := 'R';
       end if;

       select substr(ag_amt_st,1,ag_len -3) ||ag_alpha||substr(ag_amt_st,ag_len -1,2)
         into ag_amt_st
         from dual
       ;

    else
       select lpad(trim(to_char(abs(ag_amt ))),ag_len,'0')
         into ag_amt_st
         from dual
       ;

       if substr(ag_amt_st,ag_len  ,1) = '0' then
          ag_alpha :='}' ;
       elsif substr(ag_amt_st,ag_len ,1) = '1' then
          ag_alpha :='J';
       elsif substr(ag_amt_st,ag_len ,1) = '2' then
          ag_alpha :='K';
       elsif substr(ag_amt_st,ag_len ,1) = '3' then

          ag_alpha :='L';
       elsif substr(ag_amt_st,ag_len ,1) = '4' then
          ag_alpha :='M';
       elsif substr(ag_amt_st,ag_len ,1) = '5' then
          ag_alpha :='N';
       elsif substr(ag_amt_st,ag_len ,1) = '6' then
          ag_alpha :='O';
       elsif substr(ag_amt_st,ag_len ,1) = '7' then
          ag_alpha :='P' ;
       elsif substr(ag_amt_st,ag_len ,1) = '8' then
          ag_alpha :='Q';
       elsif substr(ag_amt_st,ag_len ,1) = '9' then
          ag_alpha :='R';

       end if ;

       select substr(ag_amt_st,1,ag_len -1) ||ag_alpha
         into ag_amt_st
         from dual
       ;
    end if;
    return ag_amt_st;
 end;

/





CREATE  OR REPLACE  FUNCTION F_HD_GET_RENTAMT (

   as_cust VARCHAR2,
   as_seq  VARCHAR2,
   as_fr   VARCHAR2,
   as_to   VARCHAR2,
   as_tp   VARCHAR2,
   as_day  VARCHAR2   -- 
)
RETURN NUMBER IS
/* ****************************************************************** */
/*        
/* ****************************************************************** */

-------------------------------------------------------------------VALUES
ll_amt  NUMBER;

-------------------------------------------------------------------------
-------------------------------------------------------------------------
BEGIN
/*   SELECT SUM(TRUNC(DECODE(NVL(TDAY, 0), 0, 0, SDAY / TDAY * AMT))) */

   SELECT SUM(TRUNC(DECODE(NVL(TDAY, 0), 0, 0, SDAY / TO_NUMBER(as_day) * AMT)))
     INTO ll_amt
     FROM (SELECT TO_DATE(TODT, 'YYYYMMDD') - TO_DATE(FRDT, 'YYYYMMDD') + 1 AS SDAY,
                  TO_DATE(as_to, 'YYYYMMDD') - TO_DATE(as_fr, 'YYYYMMDD') + 1 AS TDAY,
                  AMT
             FROM (SELECT CASE WHEN FRDT <= as_fr THEN as_fr ELSE FRDT END FRDT,
                          CASE WHEN TODT >= as_to THEN as_to ELSE TODT END TODT,
                          AMT
                     FROM (SELECT A.APPLY_YYMM AS FRDT,
                                  TO_CHAR(TO_DATE((SELECT NVL(MIN(B.APPLY_YYMM), '99991231')
                                                     FROM HD_RENT_DETAIL_RENT B
                                                    WHERE B.CUST_CODE = A.CUST_CODE
                                                      AND B.SEQ       = A.SEQ
                                                      AND B.APPLY_YYMM > A.APPLY_YYMM
                                                  ), 'YYYYMMDD') - 1, 'YYYYMMDD') AS TODT,
                                  DECODE(as_tp, '1', A.RENT_SUPPLY,
                                                '2', A.RENT_VAT,
                                                '3', A.RENT_INS,
                                                A.RENT_SUPPLY + A.RENT_VAT + A.RENT_INS
                                        ) AS AMT
                             FROM HD_RENT_DETAIL_RENT A
                            WHERE A.CUST_CODE = as_cust
                              AND A.SEQ       = TO_NUMBER(as_seq)
                          )
                    WHERE ((as_fr BETWEEN FRDT AND TODT)  OR
                           (as_to BETWEEN FRDT AND TODT))
                  )
          );

   RETURN ll_amt;
END;

/





CREATE  OR REPLACE  FUNCTION F_MM_GET_CONTCUSTNAME(

	AS_CONTRACT_CODE    VARCHAR2,
	AS_CUSTOMER_CLASS 	VARCHAR2
) RETURN VARCHAR2 IS

    --   ,  RETURN
    LS_CUST_NAME  VARCHAR2(200);
 	LS_RETURN     VARCHAR2(4000);
 
 	CURSOR CUR_CUST IS
		SELECT CUST_NAME
		  FROM MM_COMM_CUSTOMER
		 WHERE CONTRACT_CODE = AS_CONTRACT_CODE AND
		 	   CUSTOMER_CLASS = AS_CUSTOMER_CLASS
	  ORDER BY RELATION_PRIOR DESC, -- 
	  		   CUST_CODE
	   ;
BEGIN
 	LS_RETURN := '';

	OPEN CUR_CUST;
	LOOP
		FETCH CUR_CUST INTO LS_CUST_NAME;
		EXIT WHEN CUR_CUST%NOTFOUND;
		
		LS_RETURN := LS_RETURN || ', ' || LS_CUST_NAME;
		
	END LOOP;
	CLOSE CUR_CUST;

	IF LS_RETURN = '' THEN
	   RETURN LS_RETURN;
	ELSE
       RETURN SUBSTR(LS_RETURN, 3);
	END IF;
	
EXCEPTION
	WHEN NO_DATA_FOUND THEN
		 NULL;
	WHEN OTHERS THEN
		 -- Consider logging the error and then re-raise
		 RAISE;
END F_MM_GET_CONTCUSTNAME;

/





CREATE OR REPLACE FUNCTION "F_MM_NUMTOKOR"(

    AN_NUM VARCHAR
)
RETURN VARCHAR2 IS
    vNum	  NUMBER;
    vReturn   VARCHAR2(60);
BEGIN
 	vNum := TO_NUMBER(AN_NUM);
	
    vReturn := F_SM_NUMTOKOR(vNum);
	
    RETURN vReturn;
	
EXCEPTION
	  WHEN OTHERS THEN
	    -- Consider logging the error and then re-raise
	    RETURN '';
END;

/





CREATE OR REPLACE FUNCTION          "F_AM_GET_SLIP_NO" (

   AS_COMP VARCHAR2
 , AS_DATE VARCHAR2
 , AN_NO   NUMBER
 )
 Return VARCHAR2 Is
    vReturn VARCHAR2(40);
    vNumber VARCHAR2(10);
 Begin
    If (AS_DATE Is NULL Or AS_DATE = '') Then Return ''; End If;
    vNumber := LTRIM(RTRIM(To_Char(AN_NO, '0000')));
    vReturn := AS_DATE || '-' || vNumber;
    Return vReturn;

 End;

/





CREATE OR REPLACE FUNCTION "F_HR_GET_REFCOLUMN" (

   as_gbn  varchar2, --ref_gbn_code
   as_code varchar2, --ref_code
   as_div  varchar2  --'1':ref_name, '2':ref_name2
   ) RETURN VARCHAR2
 AS

   ref_rec   hr_code_ref%ROWTYPE;
   ls_return varchar2(100);

 BEGIN

   select *
     into ref_rec
     from hr_code_ref
    where ref_gbn_code = as_gbn
      and ref_code     = as_code;

   IF as_div = '1' THEN
     ls_return := trim(ref_rec.ref_name);
   ELSIF as_div = '2' THEN
     ls_return := trim(ref_rec.ref_name2);
   END IF;

   RETURN(ls_return);

 END;

/





CREATE OR REPLACE FUNCTION "F_HR_SPACE" (

 ai_num number
 ) RETURN VARCHAR2
 AS
   ls_space varchar2(32767);
   li_index pls_integer;
 BEGIN
   ls_space := '';
   FOR li_index in 1..ai_num LOOP
     ls_space := ls_space || ' ';
   END LOOP;
   RETURN(ls_space);
 END;

/





CREATE  OR REPLACE  FUNCTION F_HR_COLUMN_STRCHK (as_str varchar2, ai_num pls_integer) RETURN VARCHAR2

 AS
   --       . : 
   ls_str varchar2(32767);
 BEGIN
     ls_str := as_str;
     ls_str := nvl(ls_str, F_HR_SPACE(ai_num));
     IF lengthb(ls_str) > ai_num THEN
       ls_str := substr(ls_str,1,ai_num);
     ELSE
       ls_str := ls_str || F_HR_SPACE(ai_num - lengthb(ls_str));
     END IF;

   RETURN(ls_str);
 END;

/





CREATE  OR REPLACE  FUNCTION F_HR_COLUMN_NUMCHK (an_amt number, ai_num pls_integer) RETURN VARCHAR2

 AS
 --       . 
   ln_amt      number;
   ls_str      varchar2(32767);
 BEGIN
   ln_amt := nvl(an_amt, 0);
   ls_str := lpad(to_char(ln_amt), ai_num, '0');
   RETURN(ls_str);
 END;

/





CREATE  OR REPLACE  FUNCTION F_HD_GET_RENT_RENT_DELAYALL (

   as_cust VARCHAR2,
   as_seq  VARCHAR2,
   as_dt   VARCHAR2
)
RETURN NUMBER IS

/* ****************************************************************** */
/*    
/* ****************************************************************** */

-------------------------------------------------------------------VALUES
ll_damt  NUMBER;

---------------------------------------------------------------CUR VALUES
c_term   NUMBER(3);
c_counts VARCHAR2(2);

---------------------------------------------------------------------
CURSOR CURD IS
SELECT TERM_CHG_SEQ, COUNTS
  FROM HD_RENT_RENT_AGREE
 WHERE CUST_CODE    = as_cust
   AND SEQ          = TO_NUMBER(as_seq)
   AND TERM_CHG_SEQ <> 99
 ORDER BY TERM_CHG_SEQ, COUNTS;

-------------------------------------------------------------------------
BEGIN
   ll_damt := 0;

   OPEN CURD;
   LOOP
      FETCH CURD INTO c_term, c_counts;
         EXIT WHEN CURD%NOTFOUND;
      ll_damt := ll_damt + NVL(F_HD_GET_RENT_RENT_DELAY(as_cust, as_seq, c_term, c_counts, as_dt), 0);
   END LOOP;
   CLOSE CURD;
   RETURN ll_damt;
END;

/





CREATE  OR REPLACE  FUNCTION F_HD_GET_RENT_RENT_DELAY ( 

  AS_CUST           IN VARCHAR2,   -- 
  AS_SEQ            IN VARCHAR2,   -- 
  AS_TERM           IN VARCHAR2,   -- 
  AS_COUNTS         IN VARCHAR2,   -- 
  AS_BASE_DATE      IN VARCHAR2    -- 
) RETURN NUMBER IS

CURSOR DETAIL_CUR (a_dt VARCHAR2, a_mon INTEGER )IS
   SELECT DELAYRATE, DELAYCUT, DELAYUNIT, STARTDATE, ENDDATE
     FROM HD_RENT_RATE_DELAY
    WHERE CUST_CODE   = AS_CUST
      AND SEQ         = TO_NUMBER(AS_SEQ)
      AND ENDDATE    >= a_dt
      AND STARTDATE  <= AS_BASE_DATE
      AND RATE_TAG    = '3' /*2 3*/
      AND ((END_TAG   = '1' AND END_DAYS   >= a_mon) OR
           (END_TAG   = '2' AND END_DAYS    > a_mon))
      AND ((START_TAG = '1' AND START_DAYS <= a_mon) OR
           (START_TAG = '2' AND START_DAYS  < a_mon));

-------------------------------------------------------------
-- 
-------------------------------------------------------------
--  
   C_DEPT_CODE         VARCHAR2(12);  -- 
   C_HOUSETAG          VARCHAR2(1);   -- 
   C_DT_BASE_DATE      DATE;          --  
   C_DT_AGREEDATE      DATE;          --  
   C_CNT               NUMBER;        --
   C_MONTHS            NUMBER(10,5);   -- 
   C_DAYS              NUMBER(10,5);   --
   C_DELAY_DAY         NUMBER(10,5);   -- 
   C_DELAY_AMT         NUMBER(30,9);   -- 
   C_BUNAMT            NUMBER(30,9);   -- 
   C_AGREEDATE         VARCHAR2(8);    -- 
   C_RECEIPTAMT        NUMBER(30,9);   -- 
   C_WORK_AMT          NUMBER(30,9);   -- 
   C_TEMP_RATE         NUMBER;         -- 
   C_TEMP_CNT          NUMBER(10,5);   -- 

   C_DELAYRATE         NUMBER(30,9);
   C_DELAYCUT          VARCHAR2(2);
   C_DELAYUNIT         VARCHAR2(2);
   C_STARTDATE         VARCHAR2(8);
   C_ENDDATE           VARCHAR2(8);

   C_COMP_UNIT         INTEGER;
   C_TEMP_DAYS         NUMBER(10,5);   --
   C_DAYMONTH          VARCHAR2(1); --

   C_TEMPDT            VARCHAR(8);

BEGIN
   BEGIN
      C_DELAY_AMT := 0;
      C_DT_BASE_DATE := TO_DATE(AS_BASE_DATE, 'YYYYMMDD'); --Date
      -----------------------------------------------------
      -- ,  .
      SELECT DEPT_CODE,   HOUSETAG,   DAYMONTH_TAG
        INTO C_DEPT_CODE, C_HOUSETAG, C_DAYMONTH
        FROM HD_RENT_MASTER
       WHERE CUST_CODE = AS_CUST
         AND SEQ       = TO_NUMBER(AS_SEQ);

      -- ,, 
      SELECT NVL((TO_DATE(AGREE_DATE, 'YYYYMMDD') - TO_DATE(AS_BASE_DATE, 'YYYYMMDD')) * -1,0),
             NVL(RENT_AMT,0), AGREE_DATE
        INTO C_DAYS, C_BUNAMT, C_AGREEDATE
        FROM HD_RENT_RENT_AGREE
       WHERE CUST_CODE    = AS_CUST
         AND SEQ          = TO_NUMBER(AS_SEQ)
         AND TERM_CHG_SEQ = TO_NUMBER(AS_TERM)
         AND COUNTS       = AS_COUNTS;

      IF C_DAYS > 0 THEN --  
         --  .
         C_TEMPDT := F_HD_GET_HOLIDAY(C_DEPT_CODE, C_HOUSETAG, C_AGREEDATE, 'N');
         IF C_TEMPDT >= AS_BASE_DATE THEN
            C_DAYS := 0;
         END IF;
      END IF;

      IF C_DAYS <= 0 THEN
         RETURN 0;
      END IF;

      --  .
      SELECT NVL(SUM(RECEIPT_AMT), 0)
        INTO C_RECEIPTAMT
        FROM HD_RENT_RENT_INCOME
       WHERE CUST_CODE    = AS_CUST
         AND SEQ          = TO_NUMBER(AS_SEQ)
         AND TERM_CHG_SEQ = TO_NUMBER(AS_TERM)
         AND COUNTS       = AS_COUNTS;
      --   ().
      C_WORK_AMT := C_BUNAMT - C_RECEIPTAMT;

      IF C_WORK_AMT = 0 THEN
         RETURN 0;
      END IF;

      ---------------------------------------------------------------------
      C_DELAY_AMT := 0;
      C_DELAY_DAY := C_DAYS;
      C_TEMP_RATE := 0;
      -- 

      C_DT_AGREEDATE := TO_DATE(C_AGREEDATE, 'YYYYMMDD') + 1;
--      C_DT_AGREEDATE := TO_DATE(C_AGREEDATE, 'YYYYMMDD');

      IF C_DAYMONTH = '2' THEN
         C_MONTHS := MONTHS_BETWEEN(C_DT_BASE_DATE, C_DT_AGREEDATE);
      ELSE
         C_MONTHS := C_DT_BASE_DATE - C_DT_AGREEDATE;
      END IF;

      OPEN DETAIL_CUR(C_AGREEDATE, C_MONTHS);
      LOOP
         FETCH DETAIL_CUR INTO C_DELAYRATE, C_DELAYCUT, C_DELAYUNIT, C_STARTDATE, C_ENDDATE;
         EXIT WHEN DETAIL_CUR%NOTFOUND;
         C_COMP_UNIT := CASE C_DELAYUNIT
                             WHEN '1' THEN 1
                             WHEN '2' THEN 10
                             WHEN '3' THEN 100
                             WHEN '4' THEN 1000
                             WHEN '5' THEN 10000
                             WHEN '6' THEN 100000
                             ELSE 1
                        END;

         IF C_AGREEDATE >= C_STARTDATE AND AS_BASE_DATE <= C_ENDDATE THEN
            C_TEMP_RATE := ( C_DELAY_DAY / 365 ) * ( C_DELAYRATE / 100 ) ;

            IF C_DELAYCUT = '1' THEN
               C_DELAY_AMT := TRUNC((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
            ELSE
               IF C_DELAYCUT = '2' THEN
                  C_DELAY_AMT := TRUNC((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT + 0.9,0) * C_COMP_UNIT;
               ELSE
                  C_DELAY_AMT := ROUND((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
               END IF;
            END IF;
            EXIT;
         END IF;

         IF C_AGREEDATE >= C_STARTDATE THEN
            C_TEMP_CNT := NVL(TO_DATE(C_ENDDATE, 'YYYYMMDD') - TO_DATE(C_AGREEDATE, 'YYYYMMDD') ,0);
         ELSE
            IF AS_BASE_DATE <= C_ENDDATE THEN
               C_TEMP_CNT := NVL(TO_DATE(AS_BASE_DATE, 'YYYYMMDD') - TO_DATE(C_STARTDATE, 'YYYYMMDD') + 1,0);
            ELSE
               C_TEMP_CNT := NVL(TO_DATE(C_ENDDATE, 'YYYYMMDD') - TO_DATE(C_STARTDATE, 'YYYYMMDD') + 1,0);
            END IF;
         END IF;

         C_TEMP_RATE := (C_TEMP_CNT / 365) * (C_DELAYRATE / 100);
         IF C_DELAYCUT = '1' THEN
            C_DELAY_AMT := C_DELAY_AMT + TRUNC((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
         ELSE
            IF C_DELAYCUT = '2' THEN
               C_DELAY_AMT := C_DELAY_AMT + TRUNC((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT + 0.9,0) * C_COMP_UNIT;
            ELSE
               C_DELAY_AMT := C_DELAY_AMT + ROUND((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
            END IF;
         END IF;
      END LOOP;
      CLOSE DETAIL_CUR;
   END;

   RETURN C_DELAY_AMT;
END;


/





CREATE  OR REPLACE  FUNCTION F_HD_GET_CHKDGT

(
   as_str    VARCHAR2,   --
   as_tp     VARCHAR2    -- 1: 2:
)
RETURN VARCHAR2 IS

-------------------------------------------------------------------VALUES
i        NUMBER(2);
vChk     NUMBER(10);
vTmp     NUMBER(10);
vWeight  NUMBER(2);
vResult  VARCHAR2(1);
vSum     NUMBER(10);

-------------------------------------------------------------------VALUES
BEGIN
   IF as_tp = '1' THEN BEGIN
      /* ---------------------------------------------------------------- */
      /*   */
      vChk    := 0;
      vWeight := 2;

      i := LENGTH(as_str);
      LOOP
         IF i < 1 THEN
            EXIT;
         END IF;

         vTmp := TO_NUMBER(SUBSTR(as_str, i, 1)) * vWeight;

         IF vTmp >= 10 then
            vChk := vChk + MOD(vTmp, 10);
            vChk := vChk + TRUNC(vTmp / 10);
         ELSE
            vChk := vChk + vTmp;
         END IF;


         IF vWeight = 1 THEN
            vWeight := 2;
         ELSE
            vWeight := 1;
         END IF;

         i := i -1;
      END LOOP;
   END; ELSE BEGIN
      /* ---------------------------------------------------------------- */
      /*   */
      vChk    := 0;
      vWeight := 7;

      i := LENGTH(as_str);
      LOOP
         IF i < 1 THEN
            EXIT;
         END IF;

         vChk := vChk + TO_NUMBER(SUBSTR(as_str, i, 1)) * vWeight;

         vWeight := CASE vWeight
                       WHEN 7 THEN 3
                       WHEN 3 THEN 1
                       WHEN 1 THEN 7
                    END;

         i := i -1;
      END LOOP;
   END; END IF;

   /* ------------------------------------------------------------------- */
   /* ------------------------------------------------------------------- */
   vSum := MOD(vChk, 10);
   IF vSum <> 0 THEN
      vSum := 10 - vSum;
   END IF;
      
   /* ------------------------------------------------------------------- */
   RETURN TO_CHAR(vSum);
END;








/





CREATE  OR REPLACE  FUNCTION F_HD_GET_HOLIDAY

(
   as_dept   VARCHAR2,   --
   as_htag   VARCHAR2,   --
   as_dt     VARCHAR2,   --
   as_hdyn   VARCHAR2    --Y: N:  --   
)
RETURN VARCHAR2 IS

-------------------------------------------------------------------VALUES
v_tmp   VARCHAR2(8);
v_tdt   VARCHAR2(8);
v_day   VARCHAR2(1);

-------------------------------------------------------------------------
BEGIN
   v_tdt := as_dt;

   LOOP
      SELECT NVL(MAX(TO_CHAR(TO_DATE(HOLIDAY, 'YYYYMMDD') + NVL(GONG_DAYS, 0), 'YYYYMMDD')), 'X')
        INTO v_tmp
        FROM HD_REFER_HOLIDAY
       WHERE DEPT_CODE = as_dept
         AND HOUSETAG  = as_htag
         AND AD_TAG    = '1' --
/*         AND RATE_TAG  = (CASE WHEN as_hdyn = 'Y' THEN '1' ELSE '2' END)*/
         AND RATE_TAG  = '1' --  /  
         AND v_tdt BETWEEN HOLIDAY AND TO_CHAR(TO_DATE(HOLIDAY, 'YYYYMMDD') + NVL(GONG_DAYS, 0) -1, 'YYYYMMDD');
      IF v_tmp <> 'X' THEN
         v_tdt := v_tmp;
      ELSE
         v_day := TO_CHAR(TO_DATE(v_tdt, 'YYYYMMDD'), 'D');
         IF v_day = '1' THEN
            v_tdt := TO_CHAR(TO_DATE(v_tdt, 'YYYYMMDD') + 1, 'YYYYMMDD');
         ELSIF v_day = '7' THEN
            v_tdt := TO_CHAR(TO_DATE(v_tdt, 'YYYYMMDD') + 2, 'YYYYMMDD');
         ELSE
            RETURN v_tdt;
            EXIT;
         END IF;
      END IF;
   END LOOP;
END;


/





CREATE  OR REPLACE  FUNCTION F_HD_GET_MAGAM

(
   as_dept  VARCHAR2,
   as_htag  VARCHAR2,
   as_dt    VARCHAR2
)
RETURN NUMBER IS

/* ****************************************************************** */
/*    
/* ****************************************************************** */

-------------------------------------------------------------------VALUES
v_cnt  NUMBER(10);

-------------------------------------------------------------------------
BEGIN
   v_cnt := 0;
   SELECT COUNT(*)
     INTO v_cnt
     FROM HD_HOUS_MAGAM
    WHERE DEPT_CODE  = as_dept
      AND HOUSETAG   = as_htag
      AND MAGAMDATE >= as_dt;
   IF v_cnt > 0 THEN RETURN -1; END IF; --

   v_cnt := 0;
   SELECT COUNT(*)
     INTO v_cnt
     FROM HD_CODE_DEPT
    WHERE DEPT_CODE = as_dept
      AND DEPT_TYPE_CODE IN ('01', '02');
   IF v_cnt < 1 THEN RETURN 0; END IF; --      .

   v_cnt := 0;
   SELECT COUNT(*)
     INTO v_cnt
     FROM TM_ENDX_HIS_DAY A,
          HD_CODE_DEPT B
    WHERE A.COMPANY_CODE = B.COMPANY_CODE
      AND B.DEPT_CODE    = as_dept
      AND A.END_DAY      = as_dt
      AND A.END_YN       = 'Y';
   IF v_cnt > 0 THEN RETURN -2; END IF; --

   RETURN 0;
END;

/





CREATE OR REPLACE FUNCTION "F_HR_PAYX_YLY_CNT" (as_empno       varchar2,

  as_rdate       varchar2)
 RETURN VARCHAR2
 AS
  ls_workymd    varchar2(8);
  ln_tot        number :=0; -- 
  ls_chk_date   varchar2(8);
  ls_stnd_date  varchar2(8);
  ln_cnt        number :=0; --    
  ln_remcnt     number :=0; --   
 BEGIN

   begin
     select stnd_date
       into ls_chk_date
       from hr_time_base_holidays
      where work_year = substr(as_rdate,1,4)
        and emp_no = as_empno;
   end;

   begin
     select work_year||'1231'
          , yearly_holidays
          , stnd_date
       into ls_workymd
          , ln_tot
          , ls_stnd_date
       from hr_time_base_holidays
      where work_year = (
                          select max(work_year)
                            from hr_time_base_holidays
                           where emp_no = as_empno
                             and stnd_date <= as_rdate
                        )
        and emp_no = as_empno;
   end;

   if ls_chk_date > as_rdate then
     begin
       select nvl(count(*),0)
         into ln_cnt
         from hr_time_absence
        where emp_no = as_empno
          and absence_code = '5I'
          and check_date between ls_stnd_date and to_char(to_date(ls_stnd_date) + 365, 'yyyymmdd')
        group by emp_no;
     exception
       when no_data_found then
         ln_cnt := 0;
     end;
     
     ln_remcnt := (ln_tot - (to_date(ls_workymd) - to_date(ls_stnd_date) + 1)) + ln_cnt;
     
     if ln_remcnt <= 0 then
       ln_remcnt := 0;
     end if;
     
     --
     ln_remcnt := ln_remcnt * -1;
     
   else
     begin
       select count(*)
         into ln_cnt
         from hr_time_absence
        where emp_no = as_empno
          and absence_code = '5I'
          and check_date between ls_stnd_date and as_rdate
        group by emp_no;
     exception
       when no_data_found then
         ln_cnt := 0;
     end;
     
     ln_remcnt := ln_tot - ln_cnt;
   end if;

   RETURN ln_remcnt;

 EXCEPTION
   WHEN OTHERS THEN
     RAISE_APPLICATION_ERROR(-20001, 'F_HR_PAYX_YLY_CNT '||TO_CHAR(SQLCODE)||SQLERRM);
 END;

/





CREATE OR REPLACE FUNCTION "F_HR_PAYX_STND_AMT" (as_empno       varchar2,

  as_yymm       varchar2)
 RETURN NUMBER
 AS
   ln_stnd_amt     number :=0;
 BEGIN

  begin
    select nvl(sum(allow_amt),0)
      into ln_stnd_amt
      from hr_payx_result_detail a
         , hr_code_allow         b
     where a.work_yymm  = as_yymm
       and a.pay_kind   = 'P'
       and a.emp_no     = as_empno
       and b.ordinary_pay_yn = 'Y'   /*  */
       and a.allow_code = b.allow_code
       and b.pay_div    = '0';
  exception
    when no_data_found then
      ln_stnd_amt := 0;
  end;
  
   RETURN(ln_stnd_amt);
 END;

/





CREATE OR REPLACE FUNCTION "F_HR_YETA_DEDUCT_CHK" (as_year varchar2, as_rrn varchar2)

  RETURN VARCHAR2
  AS

  ls_mandiv   varchar2(1);
  ls_yearrrn  varchar2(4);
  ll_age      integer;

  ls_basicyn      varchar2(1) := 'N';
  ls_depnt20yn    varchar2(1) := 'N';
  ls_depnt60yn    varchar2(1) := 'N';
  ls_childyn      varchar2(1) := 'N';
  ls_respectyn    varchar2(1) := 'N';
  ls_respect70yn  varchar2(1) := 'N';

  BEGIN
    ls_mandiv  := substr(as_rrn,7,1);
    ls_yearrrn := '';

    if (ls_mandiv = '1' or ls_mandiv = '2' or ls_mandiv = '5' or ls_mandiv = '6') then
      ls_yearrrn := '19' || substr(as_rrn,1,2);
    else
      ls_yearrrn := '20' || substr(as_rrn,1,2);
    end if;

    ll_age := to_number(as_year) - to_number(ls_yearrrn);
    
    if as_year >= '2009' then
      --(20)
      if (ll_age <= 20) then
        ls_basicyn   := 'Y';
        ls_depnt20yn := 'Y';
        if (ll_age <= 6) then
          ls_childyn := 'Y';
        end if;
      --(  :60) (65-69 ) (70)
      elsif (ll_age >= 60) then
        ls_basicyn   := 'Y';
        ls_depnt60yn := 'Y';
        if (ll_age >= 70) then
          ls_respect70yn := 'Y';
        end if;
      end if;
    else
      --(20)
      if (ll_age <= 20) then
        ls_basicyn   := 'Y';
        ls_depnt20yn := 'Y';
        if (ll_age <= 6) then
          ls_childyn := 'Y';
        end if;
  
      --(:60, :55) (65-69) (70)
      elsif (ll_age >= 55) then
        if (ls_mandiv = '1') then
          if (ll_age >= 60) then
            ls_basicyn   := 'Y';
            ls_depnt60yn := 'Y';
          end if;
          if (ll_age >= 65 and ll_age <= 69) then
            ls_respectyn := 'Y';
          elsif (ll_age >= 70) then
            ls_respect70yn := 'Y';
          end if;
        elsif (ls_mandiv = '2') then
          if (ll_age >= 55) then
            ls_basicyn   := 'Y';
            ls_depnt60yn := 'Y';
          end if;
          if (ll_age >= 65 and ll_age <= 69) then
            ls_respectyn := 'Y';
          elsif (ll_age >= 70) then
            ls_respect70yn := 'Y';
          end if;
        end if;
      end if;
    end if;

    RETURN(ls_basicyn || ls_childyn || ls_respectyn || ls_respect70yn || ls_depnt20yn || ls_depnt60yn);
  END;

/





CREATE OR REPLACE FUNCTION      "F_HR_TIME_BASE_YEARLYDAYS" 


 (as_yyyy varchar2, as_date varchar2, as_empno varchar2) RETURN NUMBER

 AS

  ls_year_days  number;
  ls_month_days number;
  ls_sum_days   number;
  ls_workdays   number;
  ls_retireym varchar2(4);

 BEGIN

  --  
  -- 1     2012.2.9. by kacee
  select to_date(to_char(sysdate, 'yyyymmdd')) - to_date(as_date) into ls_workdays from dual;
  --ls_workdays := 90;
  
    select retire_date into ls_retireym from ( 
    select nvl(substr(retire_date,5,4),'1231') as retire_date from hr_pers_master where emp_no = as_empno
    union all
    select nvl(substr(end_date,5,4),'1231') as retire_date from hr_etcx_earner where emp_no = as_empno
    );  
  
  
  if ls_workdays < 30 then
    ls_sum_days := 0;
  elsif ls_workdays >= 30 and ls_workdays < 365 then
    ls_sum_days := trunc((ls_workdays / 30),0);
  else
    select base_year_days
      into ls_year_days
      from hr_time_yearly_chart
     where work_year = as_yyyy
       and yearly_no = trunc((to_date(as_yyyy||ls_retireym) - to_date(as_date) + 1) / 365);
       
    ls_sum_days := ls_year_days;
  end if;

  RETURN(ls_sum_days);

 EXCEPTION
  when NO_DATA_FOUND then
  RETURN('99991231');
  
 END; 

/





CREATE OR REPLACE FUNCTION "F_HR_TERM_CALC" (

 as_sdate VARCHAR2,
 as_edate VARCHAR2,
 as_div   VARCHAR2 DEFAULT NULL
 ) RETURN VARCHAR2
 AS
     ls_sdate VARCHAR2(8);
     ls_edate VARCHAR2(8);
     li_year_sdate  INTEGER;
     li_month_sdate INTEGER;
     li_days_sdate  INTEGER;
     li_year_edate  INTEGER;
     li_month_edate INTEGER;
     li_days_edate  INTEGER;


     li_basic_days  INTEGER;
     li_years       INTEGER;
     li_months      INTEGER;
     li_days        INTEGER;
     li_total_days  INTEGER;
     --, 
     li_calc_year   INTEGER;
     li_calc_months INTEGER;
     --
     li_months_tot  INTEGER;

     ls_return VARCHAR2(100);

 BEGIN
     -- 
     ls_sdate := as_sdate;
     ls_edate := trim(TO_CHAR(TO_DATE(as_edate,'yyyymmdd') + 1, 'yyyymmdd')); -- .

     li_months_tot  := CEIL(MONTHS_BETWEEN(TO_DATE(ls_edate,'yyyymmdd'), to_date(ls_sdate,'yyyymmdd')));
     li_year_sdate  := TO_NUMBER(SUBSTR(ls_sdate,1,4));

     li_month_sdate := TO_NUMBER(SUBSTR(ls_sdate,5,2));
     li_days_sdate  := TO_NUMBER(SUBSTR(ls_sdate,7,2));
     li_year_edate  := TO_NUMBER(SUBSTR(ls_edate,1,4));
     li_month_edate := TO_NUMBER(SUBSTR(ls_edate,5,2));
     li_days_edate  := TO_NUMBER(SUBSTR(ls_edate,7,2));
 --    li_days := li_days_edate - li_days_sdate + 1;
     li_days := li_days_edate - li_days_sdate;
     --  '-'    ,  1 .
     IF li_days < 0 THEN
       --
       li_basic_days  := TO_NUMBER(TO_CHAR(LAST_DAY(ADD_MONTHS(TO_DATE(ls_edate,'yyyymmdd'), -1)),'dd'));
       li_days        := li_days + li_basic_days;
       li_month_edate := li_month_edate - 1;
       IF li_days <= 0 THEN
         li_days := 0;
       END IF;
     END IF;
     li_months := li_month_edate - li_month_sdate;
     -- '-'  12 ,  1 .
     IF li_months < 0 THEN
       li_months     := li_months + 12;
       li_year_edate := li_year_edate - 1;
     END IF;
     li_years      := li_year_edate - li_year_sdate;
     li_total_days := TO_DATE(ls_edate,'yyyymmdd') - TO_DATE(ls_sdate,'yyyymmdd');
     --    :   1 , 12 1 

     IF li_days > 0 THEN
         li_calc_months := li_months + 1;
     ELSE
         li_calc_months := li_months;
     END IF;
     IF li_calc_months >= 12 THEN
       li_calc_months := 0;
       li_calc_year   := li_years + 1;
     ELSE
       li_calc_year   := li_years;
     END IF;
     li_years       := NVL(li_years,0);

     li_months      := NVL(li_months,0);
     li_days        := NVL(li_days,0);
     li_total_days  := NVL(li_total_days,0);
     li_calc_year   := NVL(li_calc_year,0);

     li_calc_months := NVL(li_calc_months,0);

   -- 1., 2., 3., 4., 5., 6., 7., 8.
     ls_return := CASE as_div
                    WHEN '1'  THEN TO_CHAR(li_years)
                    WHEN '2'  THEN TO_CHAR(li_months)
                    WHEN '3'  THEN TO_CHAR(li_days)
                    WHEN '4'  THEN TO_CHAR(li_total_days)
                    WHEN '5'  THEN TO_CHAR(li_calc_year)
                    WHEN '6'  THEN TO_CHAR(li_calc_months)
                    WHEN '7'  THEN TO_CHAR(li_months_tot)
                    WHEN '8'  THEN TO_CHAR(ceil(li_months_tot/12))
                  END;

     IF ls_return IS NULL THEN
       RETURN (TO_CHAR(li_years)||'-'||TO_CHAR(li_months)||'-'||TO_CHAR(li_days)||'-'||TO_CHAR(li_total_days)||'-'||TO_CHAR(li_calc_year)||'-'||TO_CHAR(li_calc_months)||'-'||TO_CHAR(li_months_tot)||'-'||TO_CHAR(ceil(li_months_tot/12)));
     ELSE
       RETURN ls_return;
     END IF;
 END;

/





CREATE  OR REPLACE  FUNCTION F_HR_RETI_TERM_AMT(

 	as_empno          VARCHAR2,
 	as_retire_date 	  VARCHAR2,
	as_div			      VARCHAR2,
	an_avr_pay	      number
 ) RETURN VARCHAR2 IS

    ls_retire_date VARCHAR2(8);
	ls_sdate VARCHAR2(8);
    ls_edate VARCHAR2(8);
	ln_rate       number(6,3);
	ln_month   number;

	ln_pay_rate       number(6,3);
	ln_sum_rate       number(6,3);
  	ln_retire_pay   number ;
	
  	ls_return        varchar2(100) ;

	--    
  	CURSOR cur_term_rate IS
    select 
       to_char(to_date(as_retire_date, 'yyyymmdd'), 'yyyymmdd') as retire_date,
       greatest(t.sdate, s.start_date) as sdate, 
       least(nvl(t.edate, as_retire_date), s.end_date) as edate,
       s.reti_rate, 
 	   ceil(months_between(to_date(least(nvl(t.edate, as_retire_date), s.end_date), 'yyyymmdd') + 1, greatest(t.sdate, s.start_date))) as months
    from ( select 
                nvl(b.retire_join_date, a.join_date) sdate,
                as_retire_date   edate
           from hr_pers_master a,
                hr_payx_master b
          where a.emp_no = as_empno
            and a.emp_no = b.emp_no
       ) t,
	   ( select value_conf1 as start_date,
	   	 		value_conf2 as end_date,
				to_number(value_name) as reti_rate
		from sm_code_validation
		where sys_id = 'HR' and
			  	valid_code = 'RT' and
				use_yn = 'Y' ) s
    where substr(as_empno, 1, 1) = 'A' and   /*  */
	          (t.sdate between s.start_date and s.end_date or nvl(t.edate, as_retire_date) between s.start_date and s.end_date)

    union all

   select 
       to_char(to_date(as_retire_date, 'yyyymmdd'), 'yyyymmdd') as retire_date,
       t.sdate, 
       t.edate,
       1 as reti_rate, 
       ceil(months_between(to_date(t.edate, 'yyyymmdd') + 1,t.sdate)) months
    from ( select 
                nvl(b.retire_join_date, a.join_date) sdate,
                as_retire_date   edate
           from hr_pers_master a,
                hr_payx_master b
          where a.emp_no = as_empno
            and a.emp_no = b.emp_no
           ) t
	where substr(as_empno, 1, 1) = 'K'	   /*  */
	 ;

 BEGIN

  	ln_retire_pay := 0;
  	ln_sum_rate := 0;
	ls_return := '0|0';
	
 	OPEN cur_term_rate;
 	LOOP
 		FETCH cur_term_rate INTO ls_retire_date, ls_sdate, ls_edate, ln_rate, ln_month;
 		EXIT WHEN cur_term_rate%NOTFOUND;

		ln_pay_rate   := round(ln_rate * ln_month / 12, 2);
		ln_retire_pay  := ln_retire_pay + nvl(trunc(an_avr_pay * ln_pay_rate,0),0);
		
		ln_sum_rate := ln_sum_rate + ln_pay_rate;
		
 	END LOOP;
 	CLOSE cur_term_rate;

   RETURN (to_char(ln_retire_pay)||'|'||to_char(ln_sum_rate));

 EXCEPTION
 	WHEN NO_DATA_FOUND THEN
 		 RETURN ls_return;

 	WHEN OTHERS THEN
 		 -- Consider logging the error and then re-raise
 		 RAISE;
 END F_HR_RETI_TERM_AMT;

/





CREATE OR REPLACE FUNCTION "F_HR_MONTHSAFTER" ( ad_sdate  date,

   ad_edate  date ) return number
 AS
 --    
 li_months integer;
 li_years  integer;
 begin
  li_months := trunc(months_between(ad_edate, ad_sdate - 1), 0);
  li_years := trunc(li_months / 12, 0);
  li_months := mod(li_months, 12);
  return li_years + li_months / 100;
 END;

/





CREATE  OR REPLACE  FUNCTION F_HR_PAYX_SLIP_YN (

 	as_comp 	varchar2,
 	as_workyymm varchar2,
 	as_kind 	varchar2
 ) RETURN VARCHAR2
 AS
   ls_endyn 		varchar2(1);
   ls_work_date	varchar2(8);
   ln_work_no	number;
   ln_work_seq	number;
 BEGIN
 	BEGIN
 		--  


 		SELECT distinct work_date, nvl(work_no,0)
 		INTO	ls_work_date,	ln_work_no
 		FROM 	hr_payx_slip_trans
 		WHERE	company_code 	= as_comp
 		and		work_yymm		= as_workyymm
 		and		work_div		= as_kind ;
 		--
 		EXCEPTION
 			WHEN NO_DATA_FOUND THEN
 		    	NULL;
 	END;
 	-- 

 	IF ls_work_date IS NOT NULL AND ln_work_no IS NOT NULL THEN
 		ls_endyn := 'Y';
 	ELSE
 		ls_endyn := 'N';
 	END IF;
 	RETURN(ls_endyn);
 END;

/





CREATE OR REPLACE FUNCTION      "F_AM_GET_WORKITEM_NO" (

   AS_COMP VARCHAR2
 , AS_DATE VARCHAR2
 , AS_DEPT VARCHAR2
 , AN_NO   NUMBER
 , AN_SEQ  NUMBER
 )
 Return VARCHAR2 Is
    vReturn VARCHAR2(40);
    vNumber VARCHAR2(10);
 Begin
    If (AS_DATE Is NULL Or AS_DATE = '') Then Return ''; End If;
    vNumber := LTRIM(RTRIM(To_Char(AN_NO, '0000'))) || '-' || LTRIM(RTRIM(To_Char(AN_SEQ, '0000')));

    vReturn := AS_DATE || '-' || LTRIM(RTRIM(AS_DEPT)) || '-' || vNumber;
    Return vReturn;
 End; 

/





CREATE OR REPLACE FUNCTION          "F_AM_GET_WORK_NO" (

   AS_COMP VARCHAR2
 , AS_DATE VARCHAR2
 , AS_DEPT VARCHAR2
 , AN_NO   NUMBER
 )
 Return VARCHAR2 Is
    vReturn VARCHAR2(40);
    vNumber VARCHAR2(10);
 Begin
    If (AS_DATE Is NULL Or AS_DATE = '') Then Return ''; End If;
    vNumber := LTRIM(RTRIM(To_Char(AN_NO, '0000')));
    vReturn := AS_DATE || '-' || LTRIM(RTRIM(AS_DEPT)) || '-' || vNumber;

    Return vReturn;
 End;

/





CREATE OR REPLACE FUNCTION           "F_FM_GET_BASEDATE" ( av_comp varchar2 )

 return varchar2 is
    lv_base_date varchar2(8);
 begin
    --   .
    select am_s_date
      into lv_base_date
      from sm_code_company
     where company_code = av_comp
    ;
    return lv_base_date;
 end;

/





CREATE OR REPLACE FUNCTION           "F_FM_GET_BASEMONTH" ( av_comp varchar2

 , av_date varchar2
 )
 return varchar2 is
    lv_date   varchar2(8);
    lv_base_m varchar2(2);
    lv_base_y varchar2(4);
 begin
    --  .
    select am_start_month
      into lv_base_m
      from sm_code_company
     where company_code = av_comp

    ;
    lv_date := substr(av_date || '0101', 1, 8);
    lv_base_y := substr(lv_date, 1, 4);
    if (lv_date < lv_base_y || lv_base_m || '01') then
       lv_base_y := to_char(lv_base_y - 1);
    end if;
    return lv_base_y || lv_base_m;
 end;

/





CREATE OR REPLACE FUNCTION           "F_FM_GET_BASEMONTHTO" ( av_comp varchar2

 , av_date varchar2
 )
 return varchar2 is
    lv_date   varchar2(8);
    lv_base_m varchar2(2);
    lv_base_y varchar2(4);
 begin
    --  .
    select am_start_month
      into lv_base_m
      from sm_code_company
     where company_code = av_comp

    ;
    lv_date := substr(av_date || '0101', 1, 8);
    lv_base_y := substr(lv_date, 1, 4);
    if (lv_date < lv_base_y || lv_base_m || '01') then
       lv_base_y := to_char(lv_base_y - 1);
    end if;
    return To_Char(Add_Months(To_Date(lv_base_y || lv_base_m || '01'), 11), 'yyyymmdd');
 end;

/





CREATE OR REPLACE FUNCTION           "F_FM_GET_BASEYEAR" ( av_comp varchar2

 , av_date varchar2
 )
 return varchar2 is
    lv_date   varchar2(8);
    lv_base_m varchar2(2);
    lv_base_y varchar2(4);
 begin
    --  .
    select am_start_month
      into lv_base_m
      from sm_code_company
     where company_code = av_comp

    ;
    lv_date := substr(av_date || '0101', 1, 8);
    lv_base_y := substr(lv_date, 1, 4);
    if (lv_date < lv_base_y || lv_base_m || '01') then
       lv_base_y := to_char(lv_base_y - 1);
    end if;
    return lv_base_y;
 end;

/





CREATE OR REPLACE FUNCTION           "F_FM_GET_SLIPITEM_NO" (

   AS_COMP VARCHAR2
 , AS_DATE VARCHAR2
 , AN_NO   NUMBER
 , AN_SEQ  NUMBER
 )
 Return VARCHAR2 Is
    vReturn VARCHAR2(40);
    vNumber VARCHAR2(10);
 Begin
    vNumber := LTRIM(RTRIM(To_Char(AN_NO, '0000'))) || '-' || LTRIM(RTRIM(To_Char(AN_SEQ, '0000')));
    vReturn := AS_DATE || '-' || vNumber;
    Return vReturn;

 End;

/





CREATE OR REPLACE FUNCTION           "F_FM_GET_ESTABLISH_SLIPNO" ( av_comp varchar2

 , ad_date varchar2
 , an_no number
 , an_seq number
 )
 --  =  +  + 
 return varchar2 is
    cursor c_cur1_sql is
       select b.slip_date
            , b.slip_no
            , b.work_seq_scr
         from fm_slip_dc a
            , fm_slip_detail b

        where a.slip_yyyy = substr(ad_date,1,4)
          and a.work_comp = av_comp
          and a.work_date = ad_date
          and a.work_no = an_no
          and a.work_seq = an_seq
          and a.work_comp = b.work_comp
          and b.work_date = a.set_work_date
          and b.work_no = a.set_work_no
          and b.work_seq = a.set_work_seq
    ;
    c_cur1_val c_cur1_sql%ROWTYPE;
    lv_return varchar2(2000);
 begin

    lv_return := '';

    OPEN c_cur1_sql;
    loop
       fetch c_cur1_sql into c_cur1_val;
       exit when c_cur1_sql%notfound;

       if( c_cur1_val.slip_date <> '' or c_cur1_val.slip_date is not null ) then
          if ( lv_return = '' or lv_return is null) then
             lv_return := f_fm_get_slipitem_no(av_comp, c_cur1_val.slip_date, c_cur1_val.slip_no, c_cur1_val.work_seq_scr);
          else
             lv_return := lv_return || ',' ||  f_fm_get_slipitem_no(av_comp, c_cur1_val.slip_date, c_cur1_val.slip_no, c_cur1_val.work_seq_scr);
          end if;

       end if;
    end loop;
    close c_cur1_sql;

    return lv_return;
 end;

/





CREATE OR REPLACE FUNCTION "F_FM_GET_SLIPMNG" ( av_comp varchar2

 , ad_date varchar2
 , an_no number
 , an_seq number
 )
 return varchar2 is
    cursor c_cur1_sql is
       select decode( workd.dr_amt ,0 ,'2', '1') as SLIP_DRCR                              --
            , acnt.BOND_YN                                                                 --
            , acnt.ADJUSTED_DRCR                                                           --
            , nvl(workd.BANK_CODE,'') as BANK_CODE                                         --
            , nvl(bank.BANK_NAME, workd.BANK_CODE ) as BANK_NAME                           --
            , nvl(workd.DEPOSIT_NO, '') as DEPOSIT_NO                                      --

            , nvl(workd.USER_ID,'') as  USER_ID                                            --
            , nvl(pers.USER_NAME, workd.USER_ID) as EMP_NAME                                --
            , nvl(workd.PHONE, '') as PHONE                                                --
            , nvl(workd.EVIDENCE_CODE, '') as EVIDENCE_CODE                                --
            , nvl(evid.EVIDENCE_NAME, workd.EVIDENCE_CODE ) as EVIDENCE_NAME               --
            , decode( workd.DR_VAT ,0 ,workd.CR_VAT, workd.DR_VAT) as VAT_AMT              --
            , decode( workd.DR_SUPPLY ,0 ,workd.CR_SUPPLY,workd.DR_SUPPLY) as SUPPLY_AMT   --
            , acnt.QTY1_NAME
            , decode(decode(acnt.QTY1_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.QTY1,0), 0) as QTY1
            , acnt.QTY2_NAME
            , decode(decode(acnt.QTY2_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.QTY2,0), 0) as QTY2
            , acnt.QTY3_NAME
            , decode(decode(acnt.QTY3_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.QTY3,0), 0) as QTY3

            , acnt.AMT1_NAME
            , decode(decode(acnt.AMT1_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT1,0), 0) as AMT1
            , acnt.AMT2_NAME
            , decode(decode(acnt.AMT2_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT2,0), 0) as AMT2
            , acnt.AMT3_NAME
            , decode(decode(acnt.AMT3_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT3,0), 0) as AMT3
            , acnt.AMT4_NAME
            , decode(decode(acnt.AMT4_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT4,0), 0) as AMT4
            , acnt.AMT5_NAME
            , decode(decode(acnt.AMT5_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT5,0), 0) as AMT5
            , acnt.AMT6_NAME
            , decode(decode(acnt.AMT6_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT6,0), 0) as AMT6
            , acnt.RATE1_NAME

            , decode(decode(acnt.RATE1_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.RATE1,0), 0) as RATE1
            , acnt.RATE2_NAME
            , decode(decode(acnt.RATE2_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.RATE2,0), 0) as RATE2
            , acnt.RATE3_NAME
            , decode(decode(acnt.RATE3_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.RATE3,0), 0) as RATE3
            , acnt.DATE1_NAME
            , decode(decode(acnt.DATE1_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(replace(workd.DATE1,' '),''), '') AS DATE1
            , acnt.DATE2_NAME
            , decode(decode(acnt.DATE2_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(replace(workd.DATE2,' '),''), '') AS DATE2
            , acnt.DATE3_NAME
            , decode(decode(acnt.DATE3_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(replace(workd.DATE3,' '),''), '') AS DATE3
            , acnt.DATE4_NAME
            , decode(decode(acnt.DATE4_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(replace(workd.DATE4,' '),''), '') AS DATE4

            , acnt.DESC1_NAME
            , decode(decode(acnt.DESC1_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DESC1,''), '') as DESC1
            , acnt.DESC2_NAME
            , decode(decode(acnt.DESC2_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DESC2,''), '') as DESC2
            , acnt.DESC3_NAME
            , decode(decode(acnt.DESC3_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DESC3,''), '') as DESC3
            , acnt.DESC4_NAME
            , decode(decode(acnt.DESC4_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DESC4,''), '') as DESC4
            , acnt.DESC5_NAME
            , decode(decode(acnt.DESC5_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DESC5,''), '') as DESC5
         from fm_slip_detail workd
            , fm_code_acnt acnt
            , fm_CODE_BANK bank

            , SM_AUTH_USER pers
            , fm_code_evidence evid
        where workd.acnt_code = acnt.acnt_code
          and workd.BANK_CODE = bank.BANK_CODE (+)
          and workd.USER_ID = pers.USER_ID (+)
          and workd.EVIDENCE_CODE = evid.EVIDENCE_CODE (+)
          and workd.WORK_COMP = av_comp
          and workd.WORK_DATE = ad_date
          and workd.WORK_NO = an_no
          and workd.WORK_SEQ = an_seq
    ;
    c_cur1_val c_cur1_sql%ROWTYPE ;
    ls_give_name varchar2(30);

    ls_give_depositor varchar2(100);
    ls_work_return_data varchar2(2000);
 begin
    open c_cur1_sql;
    loop
       fetch c_cur1_sql into c_cur1_val;
       exit when c_cur1_sql%notfound;

       --  
       if ( c_cur1_val.BOND_YN = 'Y' ) THEN
          --  /  
          if ( c_cur1_val.SLIP_DRCR <> c_cur1_val.ADJUSTED_DRCR ) then
             ls_work_return_data := F_fm_GET_ESTABLISH_SLIPNO(av_comp, ad_date, an_no, an_seq  );

             if (ls_work_return_data is not null) then
                ls_work_return_data := ':' || ls_work_return_data ;
             end if;
 /*         else
                begin
                select
                   valam.valid_value_name
                   , F_fm_GET_SLIP_BANKDESC(supp.work_comp, supp.work_date, supp.work_no, supp.work_seq, supp.supply_seq) as give_deposit
                into
                   ls_give_name
                   , ls_give_depositor
                from
                   fm_slip_supply supp

                   , fm_code_validation valam
                   , (
                      select
                         work_date
                         , work_no
                         , work_seq
                         , min(supply_seq) as supply_seq
                      from
                         fm_slip_supply
                      where
                            work_comp = av_comp
                         and work_date = ad_date
                         and work_no = an_no

                         and work_seq = an_seq
                      group by
                         work_date
                         , work_no
                         , work_seq
                      ) mins
                where
                   supp.work_date = mins.work_date
                   and supp.work_no = mins.work_no
                   and supp.work_seq = mins.work_seq
                   and supp.supply_seq = mins.supply_seq
                   and supp.acnt_code = valam.valid_value_level
                   and valam.validation_code = '39'

                ;
             --
             exception
                when no_data_found then ls_give_name := null ;
             end;
             --
             if (ls_give_name is not null) then
                ls_work_return_data := ':'||'['||ls_give_name||']' ;
                --
                if ls_give_depositor is not null then
                   ls_work_return_data := ls_work_return_data ||'=> '||ls_give_depositor ;
                end if ;
             end if ;

 */         end if;
       end if;

       --
       if (c_cur1_val.BANK_CODE is not null) then
          ls_work_return_data := ls_work_return_data ||':'|| c_cur1_val.BANK_NAME ;
       end if;

       --
       if (c_cur1_val.DEPOSIT_NO is not null) then
          ls_work_return_data := ls_work_return_data ||':'|| c_cur1_val.DEPOSIT_NO;
       end if;


       --
       if (c_cur1_val.USER_ID is not null) then
          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.EMP_NAME;
       end if ;

       --
       if (c_cur1_val.PHONE is not null) then
          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.PHONE;
       end if ;

       --1
       if ( c_cur1_val.QTY1 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.QTY1_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.QTY1,'999,999,999.999')));

       end if ;

       --2
       if ( c_cur1_val.QTY2 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.QTY2_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.QTY2,'999,999,999.999')));
       end if ;

       --3
       if ( c_cur1_val.QTY3 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.QTY3_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.QTY3,'999,999,999.999')));
       end if ;

       --1

       if ( c_cur1_val.AMT1 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT1_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT1,'999,999,999,999,999')));
       end if ;

       --2
       if ( c_cur1_val.AMT2 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT2_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT2,'999,999,999,999,999')));
       end if ;

       --3
       if ( c_cur1_val.AMT3 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT3_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT3,'999,999,999,999,999')));
       end if ;


       --4
       if ( c_cur1_val.AMT4 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT4_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT4,'999,999,999,999,999')));
       end if ;

       --5
       if ( c_cur1_val.AMT5 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT5_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT5,'999,999,999,999,999')));
       end if ;

       --6
       if ( c_cur1_val.AMT6 <> 0 ) then

             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT6_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT6,'999,999,999,999,999')));
       end if ;

       --1
       if ( c_cur1_val.RATE1 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.RATE1_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.RATE1,'999,999.99')));
       end if ;

       --2
       if ( c_cur1_val.RATE2 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.RATE2_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.RATE2,'999,999.99')));
       end if ;


       --3
       if ( c_cur1_val.RATE3 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.RATE3_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.RATE3,'999,999.99')));
       end if ;

       --1
       if (c_cur1_val.DATE1 is not null and trim(c_cur1_val.DATE1) <> '') then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DATE1_NAME||':'||ltrim(rtrim(to_char(to_date(c_cur1_val.DATE1),'yyyy-mm-dd')));
       end if ;

       --2
       if (c_cur1_val.DATE2 is not null and trim(c_cur1_val.DATE2) <> '') then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DATE2_NAME||':'||ltrim(rtrim(to_char(to_date(c_cur1_val.DATE2),'yyyy-mm-dd')));

       end if ;

       --3
       if (c_cur1_val.DATE3 is not null and trim(c_cur1_val.DATE3) <> '') then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DATE3_NAME||':'||ltrim(rtrim(to_char(to_date(c_cur1_val.DATE3),'yyyy-mm-dd')));
       end if ;

       --4
       if (c_cur1_val.DATE4 is not null and trim(c_cur1_val.DATE4) <> '') then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DATE4_NAME||':'||ltrim(rtrim(to_char(to_date(c_cur1_val.DATE4),'yyyy-mm-dd')));
       end if ;

       --1

       if (c_cur1_val.DESC1 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DESC1_NAME||':'||c_cur1_val.DESC1;
       end if ;

       --2
       if (c_cur1_val.DESC2 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DESC2_NAME||':'||c_cur1_val.DESC2;
       end if ;

       --3
       if (c_cur1_val.DESC3 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DESC3_NAME||':'||c_cur1_val.DESC3;
       end if ;


       --4
       if (c_cur1_val.DESC4 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DESC4_NAME||':'||c_cur1_val.DESC4;
       end if ;

       --5
       if (c_cur1_val.DESC5 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DESC5_NAME||':'||c_cur1_val.DESC5;
       end if ;

    end loop;
    close c_cur1_sql;


    return ls_work_return_data ;
 end;

/





CREATE OR REPLACE FUNCTION           "F_FM_GET_SLIP_NO" (

   AS_COMP VARCHAR2
 , AS_DATE VARCHAR2
 , AN_NO   NUMBER
 )
 Return VARCHAR2 Is
    vReturn VARCHAR2(40);
    vNumber VARCHAR2(10);
 Begin
    If (AS_DATE Is NULL Or AS_DATE = '') Then Return ''; End If;
    vNumber := LTRIM(RTRIM(To_Char(AN_NO, '0000')));
    vReturn := AS_DATE || '-' || vNumber;
    Return vReturn;

 End;

/





CREATE OR REPLACE FUNCTION           "F_FM_GET_WORKITEM_NO" (

   AS_COMP VARCHAR2
 , AS_DATE VARCHAR2
 , AS_DEPT VARCHAR2
 , AN_NO   NUMBER
 , AN_SEQ  NUMBER
 )
 Return VARCHAR2 Is
    vReturn VARCHAR2(40);
    vNumber VARCHAR2(10);
 Begin
    If (AS_DATE Is NULL Or AS_DATE = '') Then Return ''; End If;
    vNumber := LTRIM(RTRIM(To_Char(AN_NO, '0000'))) || '-' || LTRIM(RTRIM(To_Char(AN_SEQ, '000')));

    vReturn := AS_DATE || '-' || LTRIM(RTRIM(AS_DEPT)) || '-' || vNumber;
    Return vReturn;
 End;

/





CREATE OR REPLACE FUNCTION           "F_FM_GET_WORK_NO" (

   AS_COMP VARCHAR2
 , AS_DATE VARCHAR2
 , AS_DEPT VARCHAR2
 , AN_NO   NUMBER
 )
 Return VARCHAR2 Is
    vReturn VARCHAR2(40);
    vNumber VARCHAR2(10);
 Begin
    If (AS_DATE Is NULL Or AS_DATE = '') Then Return ''; End If;
    vNumber := LTRIM(RTRIM(To_Char(AN_NO, '0000')));
    vReturn := AS_DATE || '-' || LTRIM(RTRIM(AS_DEPT)) || '-' || vNumber;

    Return vReturn;
 End;

/





CREATE  OR REPLACE  FUNCTION F_HD_GET_DELAY ( 

  as_custcode       IN VARCHAR2,   -- 
  as_seq            IN VARCHAR2,   -- 
  as_counts         IN VARCHAR2,   -- 
  as_base_date      IN VARCHAR2    -- 
) return NUMBER IS
CURSOR DELAY_CUR (V_AGREEDATE VARCHAR2, V_MONTHS INTEGER )IS
  SELECT delayrate,delaycut, NVL(TO_NUMBER(RPAD('1', DELAYUNIT, '0')), 1), startdate,enddate
    FROM hd_hous_rate_delay
    WHERE cust_code  = as_custcode
      AND seq        = TO_NUMBER(as_seq)
      AND enddate   >= V_AGREEDATE
      AND startdate  <= as_base_date
      AND ((end_tag = '1' and end_days >= V_MONTHS) or (end_tag = '2' and end_days > V_MONTHS))
      AND ((start_tag = '1' and start_days <= V_MONTHS) or (start_tag = '2' and start_days < V_MONTHS));

-------------------------------------------------------------
-- 
-------------------------------------------------------------
--  
   C_DEPT_CODE         VARCHAR2(12);  -- 
   C_HOUSETAG          VARCHAR2(1);   -- 
   C_DELAYBLOCK        VARCHAR2(1);   -- 1: 2:

   C_DT_BASE_DATE      DATE;     --  
   C_DT_AGREEDATE      DATE;     --  
   C_CNT               NUMBER;   --
   C_MONTHS            NUMBER(10,5);   -- 
   C_DAYS              NUMBER(10,5);   --
   C_DELAY_DAY         NUMBER(10,5);   -- 
   C_DELAY_AMT         NUMBER(30,9);   -- 
   C_BUNAMT            NUMBER(30,9);   -- 
   C_AGREEDATE         VARCHAR2(8);    -- 
   C_RECEIPTAMT        NUMBER(30,9);   -- 
   C_WORK_AMT          NUMBER(30,9);   -- 
--   C_TEMP_RATE         NUMBER(30,9);   -- 
   C_TEMP_RATE         NUMBER;         -- 
   C_TEMP_CNT          NUMBER(10,5);   -- 
   C_DELAYRATE         NUMBER(30,9);
   C_DELAYCUT          VARCHAR2(2);
   C_STARTDATE         VARCHAR2(8);
   C_ENDDATE           VARCHAR2(8);
   C_COMP_UNIT         INTEGER;
   C_DC_YN             VARCHAR2(1);
   C_AC_YN             VARCHAR2(1);
   C_TEMP_DAYS         NUMBER(10,5);   --
   C_MOVEINENDDATE     VARCHAR2(8);
   C_DAYMONTH          VARCHAR2(1); --

   C_TEMPDT            VARCHAR2(8);
   C_BLOCKDT           VARCHAR2(8);

BEGIN
   BEGIN
      C_DELAY_AMT := 0;
      C_DT_BASE_DATE := TO_DATE(as_base_date, 'YYYYMMDD'); --Date
      -----------------------------------------------------
      -- ,  .
-- 2014-07-01  :      TRIM         
      select dept_code, housetag, TRIM(moveinenddate), daymonth_tag
        INTO C_DEPT_CODE, C_HOUSETAG, C_MOVEINENDDATE, C_DAYMONTH
        FROM hd_hous_sell
       WHERE cust_code = as_custcode
         AND seq       = TO_NUMBER(as_seq);

      SELECT NVL(DELAY_BLOCK, '1')
        INTO C_DELAYBLOCK
        FROM HD_CODE_HOUSE
       WHERE DEPT_CODE = C_DEPT_CODE
         AND HOUSETAG  = C_HOUSETAG;

      -- ,, ,  
      select NVL((TO_DATE(agreedate, 'YYYYMMDD') - TO_DATE(as_base_date, 'YYYYMMDD')) * -1, 0), NVL(bunamt, 0), agreedate, dc_yn, ac_yn
        into C_DAYS,C_BUNAMT,C_AGREEDATE,C_DC_YN,C_AC_YN
        from hd_hous_selldetail
       where cust_code = as_custcode
         and seq       = TO_NUMBER(as_seq)
         and counts    = as_counts;

      --   
      IF C_DAYS > 0 THEN --  
         IF as_counts = '90' THEN
            IF NVL(C_MOVEINENDDATE, 'X') <> 'X' AND C_AGREEDATE < C_MOVEINENDDATE THEN
               C_TEMP_DAYS := NVL((TO_DATE(C_AGREEDATE, 'YYYYMMDD') - TO_DATE(C_MOVEINENDDATE, 'YYYYMMDD')) * -1,0);
               IF C_DAYS <= C_TEMP_DAYS THEN
                  C_DAYS := 0;
               ELSE
                  C_AGREEDATE := C_MOVEINENDDATE;
                  C_DAYS := NVL((TO_DATE(C_AGREEDATE, 'YYYYMMDD') - TO_DATE(as_base_date, 'YYYYMMDD')) * -1,0);
               END IF;
            END IF;
         END IF;

         --  .
         C_TEMPDT := F_HD_GET_HOLIDAY(C_DEPT_CODE, C_HOUSETAG, C_AGREEDATE, 'Y');
         IF C_TEMPDT >= as_base_date THEN
            C_DAYS := 0;
         END IF;
      ELSE
         C_DAYS := 0;
      END IF;

      --  .
      select NVL(sum(receiptamt),0)
        into C_RECEIPTAMT
        from hd_hous_income
        where cust_code = as_custcode
          and seq = TO_NUMBER(as_seq)
          and counts = as_counts;

      --   ().
      C_WORK_AMT := C_BUNAMT - C_RECEIPTAMT;

      ---------------------------------------------------------------------
      IF C_DAYS > 0 THEN 
         C_DELAY_DAY := 0;
         C_DELAY_AMT := 0;

         IF C_AC_YN = 'Y' THEN
            C_DELAY_DAY := C_DAYS;
            C_TEMP_RATE := 0;
            -- 

--    + 1   ...  2013-01-17  
            IF (as_counts = '90' AND C_MOVEINENDDATE IS NOT NULL AND C_AGREEDATE < C_MOVEINENDDATE) THEN
               C_DT_AGREEDATE := TO_DATE(C_MOVEINENDDATE, 'YYYYMMDD');
               C_BLOCKDT      := C_MOVEINENDDATE;
            ELSE
               C_DT_AGREEDATE := TO_DATE(C_AGREEDATE, 'YYYYMMDD');
               C_BLOCKDT      := C_AGREEDATE;
            END IF;                    

            IF C_DAYMONTH = '2' THEN
               C_MONTHS := MONTHS_BETWEEN(C_DT_BASE_DATE, C_DT_AGREEDATE);
            ELSE
               C_MONTHS := C_DT_BASE_DATE - C_DT_AGREEDATE;
            END IF;

            IF C_DELAYBLOCK = '1' THEN -- 
               OPEN DELAY_CUR(C_AGREEDATE,C_MONTHS);
               LOOP
                  FETCH DELAY_CUR INTO C_DELAYRATE,C_DELAYCUT,C_COMP_UNIT,C_STARTDATE,C_ENDDATE;
                  EXIT WHEN DELAY_CUR%NOTFOUND;
                  IF C_AGREEDATE >= C_STARTDATE and as_base_date <= C_ENDDATE THEN
                     C_TEMP_RATE := ( C_DELAY_DAY / 365 ) * ( C_DELAYRATE / 100 );
                     IF C_DELAYCUT = '1' THEN
                        C_DELAY_AMT := TRUNC((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT, 0) * C_COMP_UNIT;
                     ELSIF C_DELAYCUT = '2' THEN
                        C_DELAY_AMT := TRUNC((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT + 0.9, 0) * C_COMP_UNIT;
                     ELSE
                        C_DELAY_AMT := ROUND((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT, 0) * C_COMP_UNIT;
                     END IF;
                     EXIT;
                  END IF;
                  IF C_AGREEDATE >= C_STARTDATE THEN
                     C_TEMP_CNT := NVL(TO_DATE(C_ENDDATE, 'YYYYMMDD') - TO_DATE(C_AGREEDATE, 'YYYYMMDD'), 0);
                  ELSIF as_base_date <= C_ENDDATE THEN
                     C_TEMP_CNT := NVL(TO_DATE(as_base_date, 'YYYYMMDD') - TO_DATE(C_STARTDATE, 'YYYYMMDD') + 1, 0);
                  ELSE
                     C_TEMP_CNT := NVL(TO_DATE(C_ENDDATE, 'YYYYMMDD') - TO_DATE(C_STARTDATE, 'YYYYMMDD') + 1, 0);
                  END IF;
                  C_TEMP_RATE := (C_TEMP_CNT / 365) * (C_DELAYRATE / 100);
                  IF C_DELAYCUT = '1' THEN
                     C_DELAY_AMT := C_DELAY_AMT + TRUNC((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT, 0) * C_COMP_UNIT;
                  ELSIF C_DELAYCUT = '2' THEN
                     C_DELAY_AMT := C_DELAY_AMT + TRUNC((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT + 0.9, 0) * C_COMP_UNIT;
                  ELSE
                     C_DELAY_AMT := C_DELAY_AMT + ROUND((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT, 0) * C_COMP_UNIT;
                  END IF;
               END LOOP;
               CLOSE DELAY_CUR;
            ELSE --   
-- *********************************************************************************************************
-- *********************************************************************************************************
-->>>>               C_DELAY_AMT := F_HD_GET_DELAY_BLOCK(as_custcode, as_seq, C_AGREEDATE, as_base_date, TRIM(TO_CHAR(C_BUNAMT)));
               C_DELAY_AMT := F_HD_GET_DELAYRANGE(as_custcode, as_seq, C_AGREEDATE, as_base_date, TRIM(TO_CHAR(C_WORK_AMT)));
/*
               SELECT NVL(SUM(CASE DELAYCUT WHEN '1' THEN TRUNC(AMT / DUNIT)
                                    WHEN '2' THEN TRUNC((AMT / DUNIT) + 0.9)
                                             ELSE ROUND(AMT / DUNIT)
                      END * DUNIT), 0)
                 INTO C_DELAY_AMT
                 FROM (SELECT (DDY / 365) * (DELAYRATE / 100) * (DY / TOT) * C_WORK_AMT AS AMT,
                              DDY, DY, TOT, DELAYRATE, DELAYCUT, DUNIT
                         FROM (SELECT A.DY, A.TOT, B.DELAYRATE, B.DELAYCUT,
                                      NVL(TO_NUMBER(RPAD('1', B.DELAYUNIT, '0')), 1) AS DUNIT,
                                      CASE WHEN A.TOT < B.START_DAYS
                                           THEN 0
                                           ELSE CASE WHEN A.TOT > B.END_DAYS
                                                     THEN B.END_DAYS - B.START_DAYS + 1
                                                     ELSE A.DY - B.START_DAYS + 1
                                                END
                                      END DDY
                                 FROM (SELECT STARTDATE, ENDDATE, TOT,
                                              DECODE(C_DAYMONTH, '1', F_HD_DIFFDAY(FRDT, TODT),
                                                                      MONTHS_BETWEEN(TO_DATE(TODT,'YYYYMMDD'), TO_DATE(FRDT, 'YYYYMMDD'))) +
                                              CASE WHEN FRDT || TODT = MIN(FRDT || TODT) OVER (ORDER BY FRDT || TODT)
                                                   THEN 0
                                                   ELSE 1
                                              END AS DY
                                         FROM (SELECT GREATEST(STARTDATE, ADT) AS FRDT, LEAST(ENDDATE, IDT) AS TODT,
                                                      STARTDATE, ENDDATE, ADT, IDT, TOT
                                                 FROM (SELECT DISTINCT A.STARTDATE, A.ENDDATE, B.ADT, B.IDT, B.TOT
                                                         FROM HD_HOUS_RATE_DELAY A,
                                                              (SELECT C_BLOCKDT AS ADT,
                                                                      as_base_date AS IDT,
                                                                      DECODE(C_DAYMONTH, '1', F_HD_DIFFDAY(C_BLOCKDT, as_base_date),
                                                                                              MONTHS_BETWEEN(TO_DATE(as_base_date,'YYYYMMDD'), TO_DATE(C_BLOCKDT, 'YYYYMMDD'))) AS TOT
                                                                 FROM DUAL
                                                              ) B
                                                        WHERE A.CUST_CODE = as_custcode
                                                          AND A.SEQ       = TO_NUMBER(as_seq)
                                                          AND A.ENDDATE   >= B.ADT
                                                          AND A.STARTDATE <= B.IDT
                                                      )
                                              )
                                      ) A,
                                      HD_HOUS_RATE_DELAY B
                                WHERE B.CUST_CODE = as_custcode
                                  AND B.SEQ       = TO_NUMBER(as_seq)
                                  AND B.STARTDATE = A.STARTDATE
                                  AND B.ENDDATE   = A.ENDDATE
                              )
                        WHERE DDY > 0
                      );
*/
-- *********************************************************************************************************
-- *********************************************************************************************************
            END IF;
         ELSE
            C_DELAY_AMT := 0;
         END IF;
      ELSE
         C_DELAY_AMT := 0;
      END IF;
   END;

   RETURN C_DELAY_AMT;
END;

/





CREATE  OR REPLACE  FUNCTION F_HD_GET_DELAYALL (

   as_cust VARCHAR2,
   as_seq  VARCHAR2,
   as_dt   VARCHAR2
)
RETURN NUMBER IS
/* ****************************************************************** */
/*    
/* ****************************************************************** */

-------------------------------------------------------------------VALUES
ll_damt  NUMBER;

---------------------------------------------------------------CUR VALUES
c_counts VARCHAR2(2);

---------------------------------------------------------------------
CURSOR CURD IS
SELECT COUNTS
  FROM HD_HOUS_SELLDETAIL
 WHERE CUST_CODE = as_cust
   AND SEQ       = TO_NUMBER(as_seq)
   AND COUNTS <> '99'
 ORDER BY COUNTS;

-------------------------------------------------------------------------
BEGIN
   ll_damt := 0;

   OPEN CURD;
   LOOP
      FETCH CURD INTO c_counts;
         EXIT WHEN CURD%NOTFOUND;
      ll_damt := ll_damt + NVL(F_HD_GET_DELAY(as_cust, as_seq, c_counts, as_dt), 0);
   END LOOP;
   CLOSE CURD;
   RETURN ll_damt;
END;

/





CREATE  OR REPLACE  FUNCTION F_HD_GET_DELAYDAYCNT

(
   as_dept  VARCHAR2,
   as_htag  VARCHAR2,
   as_dt    VARCHAR2
)
RETURN NUMBER IS

-------------------------------------------------------------------VALUES
v_cnt    NUMBER(10);
v_day    VARCHAR2(8);
v_tmp    VARCHAR2(8);
-------------------------------------------------------------------------
BEGIN
   v_cnt := 0;
   v_day := as_dt;

   LOOP
      SELECT COUNT(*), MAX(TO_CHAR(TO_DATE(HOLIDAY, 'YYYYMMDD') + GONG_DAYS, 'YYYYMMDD'))
        INTO v_cnt,    v_tmp
        FROM HD_REFER_HOLIDAY
       WHERE DEPT_CODE         = as_dept
         AND HOUSETAG          = as_htag
         AND RATE_TAG          = '1'
         AND AD_TAG            = '1'
         AND NVL(GONG_DAYS, 0) > 0
         AND ((HOLIDAY = v_day) OR
              (v_day BETWEEN HOLIDAY AND TO_CHAR((TO_DATE(HOLIDAY, 'YYYYMMDD') - 1 + GONG_DAYS), 'YYYYMMDD')));
      IF v_cnt < 1 THEN EXIT; END IF;
      v_day := v_tmp;
   END LOOP;

   RETURN NVL(TO_DATE(v_day, 'YYYYMMDD') - TO_DATE(as_dt, 'YYYYMMDD'), 0);
END;

/





CREATE  OR REPLACE  FUNCTION F_HD_GET_DELAYDAY ( 

  as_custcode       IN VARCHAR2,   -- 
  ai_seq            IN INTEGER,    -- 
  as_counts         IN VARCHAR2,   -- 
  as_base_date      IN VARCHAR2    -- 
) return NUMBER IS
-------------------------------------------------------------
-- 
-------------------------------------------------------------
--  
   C_DEPT_CODE         VARCHAR2(12);  -- 
   C_HOUSETAG          VARCHAR2(1);   -- 
   C_CNT               NUMBER;   --
   C_DAYS              NUMBER(10,5);   --
   C_TEMP_DAYS         NUMBER(10,5);   --
   C_DELAY_DAY         NUMBER(10,5);   -- 
   C_AGREEDATE         VARCHAR2(8);    -- 
   C_TEMP_CNT          NUMBER(10,5);   -- 
   C_DC_YN             VARCHAR2(1);
   C_AC_YN             VARCHAR2(1);
   C_MOVEINENDDATE     VARCHAR2(8);

BEGIN
   BEGIN
      -----------------------------------------------------
      -- , ,  .
      select dept_code, housetag, moveinenddate
        into C_DEPT_CODE,C_HOUSETAG,C_MOVEINENDDATE
        from hd_hous_sell
        where cust_code = as_custcode
          and seq = ai_seq;

      -- ,, ,  
      select nvl((to_date(agreedate, 'YYYYMMDD') - to_date(as_base_date, 'YYYYMMDD')) * -1,0),agreedate,dc_yn,ac_yn
        into C_DAYS,C_AGREEDATE,C_DC_YN,C_AC_YN
        from hd_hous_selldetail
        where cust_code = as_custcode
          and seq = ai_seq
          and counts = as_counts;

      if C_DAYS <= 0 then
         return 0; 
      end if;

      --   
      if as_counts = '90' then
         if nvl(C_MOVEINENDDATE, 'X') <> 'X' then
            C_TEMP_DAYS := nvl((to_date(C_AGREEDATE, 'YYYYMMDD') - to_date(C_MOVEINENDDATE, 'YYYYMMDD')) * -1,0);
            if C_DAYS <= C_TEMP_DAYS then
               C_DAYS := 0;
            else 
               C_AGREEDATE := C_MOVEINENDDATE;
               C_DAYS := nvl((to_date(C_AGREEDATE, 'YYYYMMDD') - to_date(as_base_date, 'YYYYMMDD')) * -1,0);
            end if;
         end if;
      end if;

      --  .
      if C_DAYS > 0 THEN --  
--         select count(*),nvl(max(gong_days),0) into C_CNT,C_TEMP_CNT
--           from hd_refer_holiday
--           where dept_code = C_DEPT_CODE
--             and housetag = C_HOUSETAG
--             and ad_tag = '1'
--             and holiday = C_AGREEDATE;
--         if C_CNT > 0 then
--            if C_DAYS <= C_TEMP_CNT then
--               C_DAYS := 0;
--            end if;
--         end if;
         C_CNT := F_HD_GET_DELAYDAYCNT(C_DEPT_CODE, C_HOUSETAG, C_AGREEDATE);
         IF C_DAYS <= C_CNT THEN
            C_DAYS := 0;
         END IF;

         C_DELAY_DAY := C_DAYS;
      else
         C_DELAY_DAY := 0;
      end if;
   END;
   return C_DELAY_DAY; 
END;

/





CREATE  OR REPLACE  FUNCTION F_HD_GET_DISCNT ( 

  as_custcode       IN VARCHAR2,   -- 
  ai_seq            IN INTEGER,    -- 
  as_counts         IN VARCHAR2,   -- 
  as_base_date      IN VARCHAR2    -- 
) return NUMBER IS
CURSOR DETAIL_CUR (V_AGREEDATE VARCHAR2 )IS
  SELECT discntrate,discntcut,discntunit,startdate,enddate
    FROM hd_hous_rate_discount
    WHERE cust_code  = as_custcode
      AND seq        = ai_seq
      AND enddate >= as_base_date
      AND startdate <= V_AGREEDATE;
-------------------------------------------------------------
-- 
-------------------------------------------------------------
--  
   C_DEPT_CODE         VARCHAR2(12);  -- 
   C_HOUSETAG          VARCHAR2(1);   -- 
   C_CNT               NUMBER;   --
   C_DAYS              NUMBER(10,5);   --
   C_TEMP_DAYS         NUMBER(10,5);   --
   C_DISCOUNT_DAY      NUMBER(10,5);   -- 
   C_DISCOUNT_AMT      NUMBER(30,9);   -- 
   C_BUNAMT            NUMBER(30,9);   -- 
   C_AGREEDATE         VARCHAR2(8);    -- 
   C_RECEIPTAMT        NUMBER(30,9);   -- 
   C_WORK_AMT          NUMBER(30,9);   -- 
   C_TEMP_RATE         NUMBER(30,9);   -- 
   C_TEMP_CNT          NUMBER(10,5);   -- 
   C_STARTDATE         VARCHAR2(8);
   C_ENDDATE           VARCHAR2(8);
   C_DISCNTRATE        NUMBER(30,9);
   C_DISCNTCUT         VARCHAR2(1);
   C_DISCNTUNIT        VARCHAR2(1);
   C_COMP_UNIT         INTEGER;
   C_DC_YN             VARCHAR2(1);
   C_AC_YN             VARCHAR2(1);
   C_MOVEINENDDATE     VARCHAR2(8);
   C_DAYMONTH          VARCHAR2(1); --

BEGIN
   BEGIN
      -----------------------------------------------------
      -- , ,  .
      select dept_code, housetag, moveinenddate, daymonth_tag
        into C_DEPT_CODE,C_HOUSETAG,C_MOVEINENDDATE, C_DAYMONTH
        from hd_hous_sell
        where cust_code = as_custcode
          and seq = ai_seq;

      -- ,, ,  
      select nvl((to_date(agreedate, 'YYYYMMDD') - to_date(as_base_date, 'YYYYMMDD')) * -1,0),nvl(bunamt,0),agreedate,dc_yn,ac_yn
        into C_DAYS,C_BUNAMT,C_AGREEDATE,C_DC_YN,C_AC_YN
        from hd_hous_selldetail
        where cust_code = as_custcode
          and seq = ai_seq
          and counts = as_counts;

      --   
      if as_counts = '90' then
         if nvl(C_MOVEINENDDATE, 'X') <> 'X' then
            C_TEMP_DAYS := nvl((to_date(C_AGREEDATE, 'YYYYMMDD') - to_date(C_MOVEINENDDATE, 'YYYYMMDD')) * -1,0);
            if C_DAYS <= C_TEMP_DAYS then
               C_DAYS := 0;
            else 
               C_AGREEDATE := C_MOVEINENDDATE;
               C_DAYS := nvl((to_date(C_AGREEDATE, 'YYYYMMDD') - to_date(as_base_date, 'YYYYMMDD')) * -1,0);
            end if;
         end if;
      end if;

      --  .
      if C_DAYS < 0 THEN --  
         select count(*),nvl(max(gong_days),0) into C_CNT,C_TEMP_CNT
           from hd_refer_holiday
           where dept_code = C_DEPT_CODE
             and housetag = C_HOUSETAG
             and ad_tag = '2'
             and holiday = C_AGREEDATE;
         if C_CNT > 0 then
            C_CNT := C_DAYS * -1;
            if C_CNT <= C_TEMP_CNT then
               C_DAYS := 0;
            end if;
         end if;
      end if;

      --  .
      select nvl(sum(receiptamt),0)
        into C_RECEIPTAMT
        from hd_hous_income
        where cust_code = as_custcode
          and seq = ai_seq
          and counts = as_counts;
      --   ().
      C_WORK_AMT := C_BUNAMT - C_RECEIPTAMT;

      if C_DAYS < 0 THEN --  
         ------------------------------------------------------------
         --  
         ------------------------------------------------------------
         C_DISCOUNT_DAY := 0;
         C_DISCOUNT_AMT := 0;
         if C_DC_YN = 'Y' THEN  -- 
            C_DISCOUNT_DAY   := C_DAYS * -1;
            C_TEMP_RATE := 0;
            OPEN DETAIL_CUR(C_AGREEDATE);
            LOOP
               FETCH DETAIL_CUR INTO C_DISCNTRATE,C_DISCNTCUT,C_DISCNTUNIT,C_STARTDATE,C_ENDDATE;
                 EXIT WHEN DETAIL_CUR%NOTFOUND;
               C_COMP_UNIT :=
                  CASE C_DISCNTUNIT
                     WHEN '1' THEN 1
                     WHEN '2' THEN 10
                     WHEN '3' THEN 100
                     WHEN '4' THEN 1000
                     WHEN '5' THEN 10000
                     WHEN '6' THEN 100000
                  ELSE 1
                  END;
               if C_AGREEDATE <= C_ENDDATE and as_base_date >= C_STARTDATE then
--@@                  C_TEMP_RATE := 1 - ( C_DISCOUNT_DAY / 365 ) * ( C_DISCNTRATE / 100 ) ;
                  C_TEMP_RATE := ( C_DISCOUNT_DAY / 365 ) * ( C_DISCNTRATE / 100 ) ;
                  if C_DISCNTCUT = '1' then
--@@                     C_DISCOUNT_AMT := trunc((C_WORK_AMT - (C_WORK_AMT * C_TEMP_RATE)) / C_COMP_UNIT,0) * C_COMP_UNIT;
                     C_DISCOUNT_AMT := trunc((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
                  else
                     if C_DISCNTCUT = '2' then
--@@                        C_DISCOUNT_AMT := trunc((C_WORK_AMT - (C_WORK_AMT * C_TEMP_RATE)) / C_COMP_UNIT + 0.9,0) * C_COMP_UNIT;
                        C_DISCOUNT_AMT := trunc((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT + 0.9,0) * C_COMP_UNIT;
                     else
--@@                        C_DISCOUNT_AMT := round((C_WORK_AMT - (C_WORK_AMT * C_TEMP_RATE)) / C_COMP_UNIT,0) * C_COMP_UNIT;
                        C_DISCOUNT_AMT := round((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
                     end if;
                  end if;
                  EXIT;
               end if;
               if as_base_date >= C_STARTDATE then
                  C_TEMP_CNT := nvl(to_date(C_ENDDATE, 'YYYYMMDD') - to_date(as_base_date, 'YYYYMMDD') ,0);
               else
                  if C_AGREEDATE <= C_ENDDATE then
                     C_TEMP_CNT := nvl(to_date(C_AGREEDATE, 'YYYYMMDD') - to_date(C_STARTDATE, 'YYYYMMDD') + 1,0);
                  else
                     C_TEMP_CNT := nvl(to_date(C_ENDDATE, 'YYYYMMDD') - to_date(C_STARTDATE, 'YYYYMMDD') + 1,0);
                  end if;
               end if;
--@@               C_TEMP_RATE := 1 - (C_TEMP_CNT / 365) * (C_DISCNTRATE / 100);
               C_TEMP_RATE := (C_TEMP_CNT / 365) * (C_DISCNTRATE / 100);
               if C_DISCNTCUT = '1' then
--@@                  C_DISCOUNT_AMT := C_DISCOUNT_AMT + trunc((C_WORK_AMT - (C_WORK_AMT * C_TEMP_RATE)) / C_COMP_UNIT,0) * C_COMP_UNIT;
                  C_DISCOUNT_AMT := C_DISCOUNT_AMT + trunc((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
               else
                  if C_DISCNTCUT = '2' then
--@@                     C_DISCOUNT_AMT := C_DISCOUNT_AMT + trunc((C_WORK_AMT - (C_WORK_AMT * C_TEMP_RATE)) / C_COMP_UNIT + 0.9,0) * C_COMP_UNIT;
                     C_DISCOUNT_AMT := C_DISCOUNT_AMT + trunc((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT + 0.9,0) * C_COMP_UNIT;
                  else
--@@                     C_DISCOUNT_AMT := C_DISCOUNT_AMT + round((C_WORK_AMT - (C_WORK_AMT * C_TEMP_RATE)) / C_COMP_UNIT,0) * C_COMP_UNIT;
                     C_DISCOUNT_AMT := C_DISCOUNT_AMT + round((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
                  end if;
               end if;
            END LOOP;
            CLOSE DETAIL_CUR;
         else
            C_DISCOUNT_AMT := 0;
         end if;
      else
         C_DISCOUNT_AMT := 0;
      end if;
   END;
   return C_DISCOUNT_AMT; 
END;

/





CREATE  OR REPLACE  FUNCTION F_HD_GET_DISCNTDAY ( 

  as_custcode       IN VARCHAR2,   -- 
  ai_seq            IN INTEGER,    -- 
  as_counts         IN VARCHAR2,   -- 
  as_base_date      IN VARCHAR2    -- 
) return NUMBER IS
-------------------------------------------------------------
-- 
-------------------------------------------------------------
--  
   C_DEPT_CODE         VARCHAR2(12);  -- 
   C_HOUSETAG          VARCHAR2(1);   -- 
   C_CNT               NUMBER;   --
   C_DAYS              NUMBER(10,5);   --
   C_TEMP_DAYS         NUMBER(10,5);   --
   C_DISCOUNT_DAY      NUMBER(10,5);   -- 
   C_AGREEDATE         VARCHAR2(8);    -- 
   C_TEMP_CNT          NUMBER(10,5);   -- 
   C_DC_YN             VARCHAR2(1);
   C_AC_YN             VARCHAR2(1);
   C_MOVEINENDDATE     VARCHAR2(8);

BEGIN
   BEGIN
      -----------------------------------------------------
      -- , ,  .
      select dept_code, housetag, moveinenddate
        into C_DEPT_CODE,C_HOUSETAG,C_MOVEINENDDATE
        from hd_hous_sell
        where cust_code = as_custcode
          and seq = ai_seq;

      -- ,, ,  
      select nvl((to_date(agreedate, 'YYYYMMDD') - to_date(as_base_date, 'YYYYMMDD')) * -1,0),agreedate,dc_yn,ac_yn
        into C_DAYS,C_AGREEDATE,C_DC_YN,C_AC_YN
        from hd_hous_selldetail
        where cust_code = as_custcode
          and seq = ai_seq
          and counts = as_counts;

      --  .
      if C_DAYS < 0 THEN --  
         select count(*),nvl(max(gong_days),0) into C_CNT,C_TEMP_CNT
           from hd_refer_holiday
           where dept_code = C_DEPT_CODE
             and housetag = C_HOUSETAG
             and ad_tag = '2'
             and holiday = C_AGREEDATE;
         if C_CNT > 0 then
            C_CNT := C_DAYS * -1;
            if C_CNT <= C_TEMP_CNT then
               C_DAYS := 0;
            end if;
         end if;
         C_DISCOUNT_DAY   := C_DAYS * -1;
      else
         C_DISCOUNT_DAY := 0;
      end if;
   END;
   return C_DISCOUNT_DAY; 
END;

/





CREATE  OR REPLACE  FUNCTION F_HD_GET_FIXRATE

(
   as_cust   VARCHAR2,   --
   as_seq    VARCHAR2,   --
   as_term   VARCHAR2,   --
   as_counts VARCHAR2,   --
   as_dt     VARCHAR2    --
)
RETURN FLOAT IS

-------------------------------------------------------------------VALUES
v_adt    VARCHAR2(8);
v_temp   VARCHAR2(8);
vd_temp  DATE;
vy_temp  VARCHAR2(1);
v_cnt    NUMBER(5);

v_day    NUMBER(3);    
v_rt1    FLOAT;
v_rt2    FLOAT;

-------------------------------------------------------------------------
BEGIN
   SELECT AGREE_DATE
     INTO v_adt
     FROM HD_RENT_RENT_AGREE
    WHERE CUST_CODE    = as_cust
      AND SEQ          = TO_NUMBER(as_seq)
      AND TERM_CHG_SEQ = TO_NUMBER(as_term) 
      AND COUNTS       = as_counts;

   SELECT NVL(FIXRATE_DAY, 0), NVL(FIXRATE, 0), NVL(FIXRATE2, 0)
     INTO v_day,               v_rt1,           v_rt2
     FROM HD_RENT_MASTER
    WHERE CUST_CODE = as_cust
      AND SEQ       = TO_NUMBER(as_seq);

   /* ********************************************************************* 1:   */
   v_cnt := 0;
   SELECT COUNT(*)
     INTO v_cnt
     FROM HD_RENT_MASTER A,
          HD_REFER_HOLIDAY B
    WHERE A.DEPT_CODE = B.DEPT_CODE
      AND A.HOUSETAG  = B.HOUSETAG
      AND A.CUST_CODE = as_cust
      AND A.SEQ       = TO_NUMBER(as_seq)
      AND B.RATE_TAG  = '1'
      AND B.AD_TAG    = '2'
      AND v_adt BETWEEN HOLIDAY AND TO_CHAR(TO_DATE(HOLIDAY, 'YYYYMMDD') + GONG_DAYS, 'YYYYMMDD');

   IF v_cnt < 1 THEN
      v_temp := v_adt;
   ELSE
      SELECT MAX(TO_CHAR(TO_DATE(HOLIDAY, 'YYYYMMDD') + GONG_DAYS, 'YYYYMMDD'))
        INTO v_temp
        FROM HD_RENT_MASTER A,
             HD_REFER_HOLIDAY B
       WHERE A.DEPT_CODE = B.DEPT_CODE
         AND A.HOUSETAG  = B.HOUSETAG
         AND A.CUST_CODE = as_cust
         AND A.SEQ       = TO_NUMBER(as_seq)
         AND B.RATE_TAG  = '1'
         AND B.AD_TAG    = '2'
         AND v_adt BETWEEN HOLIDAY AND TO_CHAR(TO_DATE(HOLIDAY, 'YYYYMMDD') + GONG_DAYS, 'YYYYMMDD');
   END IF;

   vd_temp := TO_DATE(v_temp, 'YYYYMMDD');
   vy_temp := TO_CHAR(vd_temp, 'D');
   IF vy_temp = '7' THEN
      v_temp := TO_CHAR(vd_temp + 2, 'YYYYMMDD');
   ELSIF vy_temp = '1' THEN
      v_temp := TO_CHAR(vd_temp + 1, 'YYYYMMDD');
   ELSE
      v_temp := TO_CHAR(vd_temp, 'YYYYMMDD');
   END IF;

   IF as_dt <= v_temp THEN
      RETURN 0; /* ..  0 */
   END IF;

   /* ********************************************************************* 2:   */
   v_adt := TO_CHAR(TO_DATE(v_adt, 'YYYYMMDD') + v_day, 'YYYYMMDD');
   v_cnt := 0;
   SELECT COUNT(*)
     INTO v_cnt
     FROM HD_RENT_MASTER A,
          HD_REFER_HOLIDAY B
    WHERE A.DEPT_CODE = B.DEPT_CODE
      AND A.HOUSETAG  = B.HOUSETAG
      AND A.CUST_CODE = as_cust
      AND A.SEQ       = TO_NUMBER(as_seq)
      AND B.RATE_TAG  = '1'
      AND B.AD_TAG    = '2'
      AND v_adt BETWEEN HOLIDAY AND TO_CHAR(TO_DATE(HOLIDAY, 'YYYYMMDD') + GONG_DAYS, 'YYYYMMDD');

   IF v_cnt < 1 THEN
      v_temp := v_adt;
   ELSE
      SELECT MAX(TO_CHAR(TO_DATE(HOLIDAY, 'YYYYMMDD') + GONG_DAYS, 'YYYYMMDD'))
        INTO v_temp
        FROM HD_RENT_MASTER A,
             HD_REFER_HOLIDAY B
       WHERE A.DEPT_CODE = B.DEPT_CODE
         AND A.HOUSETAG  = B.HOUSETAG
         AND A.CUST_CODE = as_cust
         AND A.SEQ       = TO_NUMBER(as_seq)
         AND B.RATE_TAG  = '1'
         AND B.AD_TAG    = '2'
         AND v_adt BETWEEN HOLIDAY AND TO_CHAR(TO_DATE(HOLIDAY, 'YYYYMMDD') + GONG_DAYS, 'YYYYMMDD');
   END IF;

   vd_temp := TO_DATE(v_temp, 'YYYYMMDD');
   vy_temp := TO_CHAR(vd_temp, 'D');
   IF vy_temp = '7' THEN
      v_temp := TO_CHAR(vd_temp + 2, 'YYYYMMDD');
   ELSIF vy_temp = '1' THEN
      v_temp := TO_CHAR(vd_temp + 1, 'YYYYMMDD');
   ELSE
      v_temp := TO_CHAR(vd_temp, 'YYYYMMDD');
   END IF;

   IF as_dt <= v_temp THEN
      RETURN v_rt1; /*  */
   END IF;

   /* ********************************************************************* 3:  */
   RETURN v_rt2;
END;








/





CREATE  OR REPLACE  FUNCTION F_HD_GET_RENT_GURT_DELAY ( 

  AS_CUST           IN VARCHAR2,   -- 
  AS_SEQ            IN VARCHAR2,   -- 
  AS_TERM           IN VARCHAR2,   -- 
  AS_COUNTS         IN VARCHAR2,   -- 
  AS_BASE_DATE      IN VARCHAR2    -- 
) RETURN NUMBER IS

CURSOR DETAIL_CUR (a_dt VARCHAR2, a_mon INTEGER )IS
   SELECT DELAYRATE, DELAYCUT, DELAYUNIT, STARTDATE, ENDDATE
     FROM HD_RENT_RATE_DELAY
    WHERE CUST_CODE   = AS_CUST
      AND SEQ         = TO_NUMBER(AS_SEQ)
      AND ENDDATE    >= a_dt
      AND STARTDATE  <= AS_BASE_DATE
      AND RATE_TAG    = '2' /*2  3*/
      AND ((END_TAG   = '1' AND END_DAYS   >= a_mon) OR
           (END_TAG   = '2' AND END_DAYS    > a_mon))
      AND ((START_TAG = '1' AND START_DAYS <= a_mon) OR
           (START_TAG = '2' AND START_DAYS  < a_mon));

-------------------------------------------------------------
-- 
-------------------------------------------------------------
--  
   C_DEPT_CODE         VARCHAR2(12);  -- 
   C_HOUSETAG          VARCHAR2(1);   -- 
   C_DT_BASE_DATE      DATE;          --  
   C_DT_AGREEDATE      DATE;          --  
   C_CNT               NUMBER;        --
   C_MONTHS            NUMBER(10,5);   -- 
   C_DAYS              NUMBER(10,5);   --
   C_DELAY_DAY         NUMBER(10,5);   -- 
   C_DELAY_AMT         NUMBER(30,9);   -- 
   C_BUNAMT            NUMBER(30,9);   -- 
   C_AGREEDATE         VARCHAR2(8);    -- 
   C_DELAY_YN          VARCHAR2(1);    -- 
   C_RECEIPTAMT        NUMBER(30,9);   -- 
   C_WORK_AMT          NUMBER(30,9);   -- 
   C_TEMP_RATE         NUMBER;         -- 
   C_TEMP_CNT          NUMBER(10,5);   -- 

   C_DELAYRATE         NUMBER(30,9);
   C_DELAYCUT          VARCHAR2(2);
   C_DELAYUNIT         VARCHAR2(2);
   C_STARTDATE         VARCHAR2(8);
   C_ENDDATE           VARCHAR2(8);

   C_COMP_UNIT         INTEGER;
   C_TEMP_DAYS         NUMBER(10,5);   --
   C_DAYMONTH          VARCHAR2(1); --

   C_TEMPDT            VARCHAR(8);

BEGIN
   BEGIN
      C_DELAY_AMT := 0;
      C_DT_BASE_DATE := TO_DATE(AS_BASE_DATE, 'YYYYMMDD'); --Date
      -----------------------------------------------------
      -- ,  .
      SELECT DEPT_CODE,   HOUSETAG,   DAYMONTH_TAG
        INTO C_DEPT_CODE, C_HOUSETAG, C_DAYMONTH
        FROM HD_RENT_MASTER
       WHERE CUST_CODE = AS_CUST
         AND SEQ       = TO_NUMBER(AS_SEQ);

      -- ,, 
      SELECT NVL((TO_DATE(AGREE_DATE, 'YYYYMMDD') - TO_DATE(AS_BASE_DATE, 'YYYYMMDD')) * -1,0),
             NVL(AGREE_AMT,0), AGREE_DATE,  DELAY_YN
        INTO C_DAYS, C_BUNAMT, C_AGREEDATE, C_DELAY_YN
        FROM HD_RENT_GURT_AGREE
       WHERE CUST_CODE    = AS_CUST
         AND SEQ          = TO_NUMBER(AS_SEQ)
         AND TERM_CHG_SEQ = TO_NUMBER(AS_TERM)
         AND COUNTS       = AS_COUNTS;

      IF C_DAYS > 0 THEN --  
         --  .
         C_TEMPDT := F_HD_GET_HOLIDAY(C_DEPT_CODE, C_HOUSETAG, C_AGREEDATE, 'N');
         IF C_TEMPDT >= AS_BASE_DATE THEN
            C_DAYS := 0;
         END IF;
      END IF;

      IF C_DAYS <= 0 OR C_DELAY_YN = 'N' THEN
         RETURN 0;
      END IF;

      --  .
      SELECT NVL(SUM(RECEIPT_AMT), 0)
        INTO C_RECEIPTAMT
        FROM HD_RENT_GURT_INCOME
       WHERE CUST_CODE    = AS_CUST
         AND SEQ          = TO_NUMBER(AS_SEQ)
         AND TERM_CHG_SEQ = TO_NUMBER(AS_TERM)
         AND COUNTS       = AS_COUNTS;
      --   ().
      C_WORK_AMT := C_BUNAMT - C_RECEIPTAMT;

      IF C_WORK_AMT = 0 THEN
         RETURN 0;
      END IF;

      ---------------------------------------------------------------------
      C_DELAY_AMT := 0;
      C_DELAY_DAY := C_DAYS;
      C_TEMP_RATE := 0;
      -- 

      C_DT_AGREEDATE := TO_DATE(C_AGREEDATE, 'YYYYMMDD') + 1;

      IF C_DAYMONTH = '2' THEN
         C_MONTHS := MONTHS_BETWEEN(C_DT_BASE_DATE, C_DT_AGREEDATE);
      ELSE
         C_MONTHS := C_DT_BASE_DATE - C_DT_AGREEDATE;
      END IF;

      OPEN DETAIL_CUR(C_AGREEDATE, C_MONTHS);
      LOOP
         FETCH DETAIL_CUR INTO C_DELAYRATE, C_DELAYCUT, C_DELAYUNIT, C_STARTDATE, C_ENDDATE;
         EXIT WHEN DETAIL_CUR%NOTFOUND;
         C_COMP_UNIT := CASE C_DELAYUNIT
                             WHEN '1' THEN 1
                             WHEN '2' THEN 10
                             WHEN '3' THEN 100
                             WHEN '4' THEN 1000
                             WHEN '5' THEN 10000
                             WHEN '6' THEN 100000
                             ELSE 1
                        END;


         IF C_AGREEDATE >= C_STARTDATE AND AS_BASE_DATE <= C_ENDDATE THEN
            C_TEMP_RATE := ( C_DELAY_DAY / 365 ) * ( C_DELAYRATE / 100 ) ;
            IF C_DELAYCUT = '1' THEN
               C_DELAY_AMT := TRUNC((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
            ELSE
               IF C_DELAYCUT = '2' THEN
                  C_DELAY_AMT := TRUNC((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT + 0.9,0) * C_COMP_UNIT;
               ELSE
                  C_DELAY_AMT := ROUND((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
               END IF;
            END IF;
            EXIT;
         END IF;

         IF C_AGREEDATE >= C_STARTDATE THEN
            C_TEMP_CNT := NVL(TO_DATE(C_ENDDATE, 'YYYYMMDD') - TO_DATE(C_AGREEDATE, 'YYYYMMDD') ,0);
         ELSE
            IF AS_BASE_DATE <= C_ENDDATE THEN
               C_TEMP_CNT := NVL(TO_DATE(AS_BASE_DATE, 'YYYYMMDD') - TO_DATE(C_STARTDATE, 'YYYYMMDD') + 1,0);
            ELSE
               C_TEMP_CNT := NVL(TO_DATE(C_ENDDATE, 'YYYYMMDD') - TO_DATE(C_STARTDATE, 'YYYYMMDD') + 1,0);
            END IF;
         END IF;

         C_TEMP_RATE := (C_TEMP_CNT / 365) * (C_DELAYRATE / 100);
         IF C_DELAYCUT = '1' THEN
            C_DELAY_AMT := C_DELAY_AMT + TRUNC((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
         ELSE
            IF C_DELAYCUT = '2' THEN
               C_DELAY_AMT := C_DELAY_AMT + TRUNC((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT + 0.9,0) * C_COMP_UNIT;
            ELSE
               C_DELAY_AMT := C_DELAY_AMT + ROUND((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
            END IF;
         END IF;
      END LOOP;
      CLOSE DETAIL_CUR;
   END;

   RETURN C_DELAY_AMT;
END;


/





CREATE  OR REPLACE  FUNCTION F_HD_GET_RENT_GURT_DELAYALL (

   as_cust VARCHAR2,
   as_seq  VARCHAR2,
   as_dt   VARCHAR2
)
RETURN NUMBER IS

/* ****************************************************************** */
/*    
/* ****************************************************************** */

-------------------------------------------------------------------VALUES
ll_damt  NUMBER;

---------------------------------------------------------------CUR VALUES
c_term   NUMBER(3);
c_counts VARCHAR2(2);

---------------------------------------------------------------------
CURSOR CURD IS
SELECT TERM_CHG_SEQ, COUNTS
  FROM HD_RENT_GURT_AGREE
 WHERE CUST_CODE    = as_cust
   AND SEQ          = TO_NUMBER(as_seq)
   AND TERM_CHG_SEQ <> 99
 ORDER BY TERM_CHG_SEQ, COUNTS;

-------------------------------------------------------------------------
BEGIN
   ll_damt := 0;

   OPEN CURD;
   LOOP
      FETCH CURD INTO c_term, c_counts;
         EXIT WHEN CURD%NOTFOUND;
      ll_damt := ll_damt + NVL(F_HD_GET_RENT_GURT_DELAY(as_cust, as_seq, c_term, c_counts, as_dt), 0);
   END LOOP;
   CLOSE CURD;
   RETURN ll_damt;
END;

/





CREATE  OR REPLACE  FUNCTION F_HD_GET_RENT_GURT_DISCNT ( 

  as_custcode       IN VARCHAR2,   -- 
  ai_seq            IN INTEGER,    -- 
  as_counts         IN VARCHAR2,   -- 
  as_base_date      IN VARCHAR2    -- 
) return NUMBER IS
CURSOR DETAIL_CUR (V_AGREEDATE VARCHAR2 )IS
  SELECT discntrate,discntcut,discntunit,startdate,enddate
    FROM hd_hous_rate_discount
    WHERE cust_code  = as_custcode
      AND seq        = ai_seq
      AND enddate >= as_base_date
      AND startdate <= V_AGREEDATE;
-------------------------------------------------------------
-- 
-------------------------------------------------------------
--  
   C_DEPT_CODE         VARCHAR2(12);  -- 
   C_HOUSETAG          VARCHAR2(1);   -- 
   C_CNT               NUMBER;   --
   C_DAYS              NUMBER(10,5);   --
   C_TEMP_DAYS         NUMBER(10,5);   --
   C_DISCOUNT_DAY      NUMBER(10,5);   -- 
   C_DISCOUNT_AMT      NUMBER(30,9);   -- 
   C_BUNAMT            NUMBER(30,9);   -- 
   C_AGREEDATE         VARCHAR2(8);    -- 
   C_RECEIPTAMT        NUMBER(30,9);   -- 
   C_WORK_AMT          NUMBER(30,9);   -- 
   C_TEMP_RATE         NUMBER(30,9);   -- 
   C_TEMP_CNT          NUMBER(10,5);   -- 
   C_STARTDATE         VARCHAR2(8);
   C_ENDDATE           VARCHAR2(8);
   C_DISCNTRATE        NUMBER(30,9);
   C_DISCNTCUT         VARCHAR2(1);
   C_DISCNTUNIT        VARCHAR2(1);
   C_COMP_UNIT         INTEGER;
   C_DC_YN             VARCHAR2(1);
   C_AC_YN             VARCHAR2(1);
   C_MOVEINENDDATE     VARCHAR2(8);
   C_DAYMONTH          VARCHAR2(1); --

BEGIN
   BEGIN
      -----------------------------------------------------
      -- , ,  .
      select dept_code, housetag, moveinenddate, daymonth_tag
        into C_DEPT_CODE,C_HOUSETAG,C_MOVEINENDDATE, C_DAYMONTH
        from hd_hous_sell
        where cust_code = as_custcode
          and seq = ai_seq;

      -- ,, ,  
      select nvl((to_date(agreedate, 'YYYYMMDD') - to_date(as_base_date, 'YYYYMMDD')) * -1,0),nvl(bunamt,0),agreedate,dc_yn,ac_yn
        into C_DAYS,C_BUNAMT,C_AGREEDATE,C_DC_YN,C_AC_YN
        from hd_hous_selldetail
        where cust_code = as_custcode
          and seq = ai_seq
          and counts = as_counts;

      --   
      if as_counts = '90' then
         if nvl(C_MOVEINENDDATE, 'X') <> 'X' then
            C_TEMP_DAYS := nvl((to_date(C_AGREEDATE, 'YYYYMMDD') - to_date(C_MOVEINENDDATE, 'YYYYMMDD')) * -1,0);
            if C_DAYS <= C_TEMP_DAYS then
               C_DAYS := 0;
            else 
               C_AGREEDATE := C_MOVEINENDDATE;
               C_DAYS := nvl((to_date(C_AGREEDATE, 'YYYYMMDD') - to_date(as_base_date, 'YYYYMMDD')) * -1,0);
            end if;
         end if;
      end if;

      --  .
      if C_DAYS < 0 THEN --  
         select count(*),nvl(max(gong_days),0) into C_CNT,C_TEMP_CNT
           from hd_refer_holiday
           where dept_code = C_DEPT_CODE
             and housetag = C_HOUSETAG
             and ad_tag = '2'
             and holiday = C_AGREEDATE;
         if C_CNT > 0 then
            C_CNT := C_DAYS * -1;
            if C_CNT <= C_TEMP_CNT then
               C_DAYS := 0;
            end if;
         end if;
      end if;

      --  .
      select nvl(sum(receiptamt),0)
        into C_RECEIPTAMT
        from hd_hous_income
        where cust_code = as_custcode
          and seq = ai_seq
          and counts = as_counts;
      --   ().
      C_WORK_AMT := C_BUNAMT - C_RECEIPTAMT;

      if C_DAYS < 0 THEN --  
         ------------------------------------------------------------
         --  
         ------------------------------------------------------------
         C_DISCOUNT_DAY := 0;
         C_DISCOUNT_AMT := 0;
         if C_DC_YN = 'Y' THEN  -- 
            C_DISCOUNT_DAY   := C_DAYS * -1;
            C_TEMP_RATE := 0;
            OPEN DETAIL_CUR(C_AGREEDATE);
            LOOP
               FETCH DETAIL_CUR INTO C_DISCNTRATE,C_DISCNTCUT,C_DISCNTUNIT,C_STARTDATE,C_ENDDATE;
                 EXIT WHEN DETAIL_CUR%NOTFOUND;
               C_COMP_UNIT :=
                  CASE C_DISCNTUNIT
                     WHEN '1' THEN 1
                     WHEN '2' THEN 10
                     WHEN '3' THEN 100
                     WHEN '4' THEN 1000
                     WHEN '5' THEN 10000
                     WHEN '6' THEN 100000
                  ELSE 1
                  END;
               if C_AGREEDATE <= C_ENDDATE and as_base_date >= C_STARTDATE then
--@@                  C_TEMP_RATE := 1 - ( C_DISCOUNT_DAY / 365 ) * ( C_DISCNTRATE / 100 ) ;
                  C_TEMP_RATE := ( C_DISCOUNT_DAY / 365 ) * ( C_DISCNTRATE / 100 ) ;
                  if C_DISCNTCUT = '1' then
--@@                     C_DISCOUNT_AMT := trunc((C_WORK_AMT - (C_WORK_AMT * C_TEMP_RATE)) / C_COMP_UNIT,0) * C_COMP_UNIT;
                     C_DISCOUNT_AMT := trunc((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
                  else
                     if C_DISCNTCUT = '2' then
--@@                        C_DISCOUNT_AMT := trunc((C_WORK_AMT - (C_WORK_AMT * C_TEMP_RATE)) / C_COMP_UNIT + 0.9,0) * C_COMP_UNIT;
                        C_DISCOUNT_AMT := trunc((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT + 0.9,0) * C_COMP_UNIT;
                     else
--@@                        C_DISCOUNT_AMT := round((C_WORK_AMT - (C_WORK_AMT * C_TEMP_RATE)) / C_COMP_UNIT,0) * C_COMP_UNIT;
                        C_DISCOUNT_AMT := round((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
                     end if;
                  end if;
                  EXIT;
               end if;
               if as_base_date >= C_STARTDATE then
                  C_TEMP_CNT := nvl(to_date(C_ENDDATE, 'YYYYMMDD') - to_date(as_base_date, 'YYYYMMDD') ,0);
               else
                  if C_AGREEDATE <= C_ENDDATE then
                     C_TEMP_CNT := nvl(to_date(C_AGREEDATE, 'YYYYMMDD') - to_date(C_STARTDATE, 'YYYYMMDD') + 1,0);
                  else
                     C_TEMP_CNT := nvl(to_date(C_ENDDATE, 'YYYYMMDD') - to_date(C_STARTDATE, 'YYYYMMDD') + 1,0);
                  end if;
               end if;
--@@               C_TEMP_RATE := 1 - (C_TEMP_CNT / 365) * (C_DISCNTRATE / 100);
               C_TEMP_RATE := (C_TEMP_CNT / 365) * (C_DISCNTRATE / 100);
               if C_DISCNTCUT = '1' then
--@@                  C_DISCOUNT_AMT := C_DISCOUNT_AMT + trunc((C_WORK_AMT - (C_WORK_AMT * C_TEMP_RATE)) / C_COMP_UNIT,0) * C_COMP_UNIT;
                  C_DISCOUNT_AMT := C_DISCOUNT_AMT + trunc((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
               else
                  if C_DISCNTCUT = '2' then
--@@                     C_DISCOUNT_AMT := C_DISCOUNT_AMT + trunc((C_WORK_AMT - (C_WORK_AMT * C_TEMP_RATE)) / C_COMP_UNIT + 0.9,0) * C_COMP_UNIT;
                     C_DISCOUNT_AMT := C_DISCOUNT_AMT + trunc((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT + 0.9,0) * C_COMP_UNIT;
                  else
--@@                     C_DISCOUNT_AMT := C_DISCOUNT_AMT + round((C_WORK_AMT - (C_WORK_AMT * C_TEMP_RATE)) / C_COMP_UNIT,0) * C_COMP_UNIT;
                     C_DISCOUNT_AMT := C_DISCOUNT_AMT + round((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
                  end if;
               end if;
            END LOOP;
            CLOSE DETAIL_CUR;
         else
            C_DISCOUNT_AMT := 0;
         end if;
      else
         C_DISCOUNT_AMT := 0;
      end if;
   END;
   return C_DISCOUNT_AMT; 
END;

/





CREATE OR REPLACE FUNCTION "F_HR_GET_DECHULLIMIT" (

   as_emp IN VARCHAR2,   -- 
   as_dt  IN VARCHAR2,   -- 
   as_tp  IN VARCHAR2,   -- 
   as_cb  IN VARCHAR2    -- 
 ) return NUMBER IS

 -------------------------------------------------------------
 -- TEMP VALUE
    t_cnt     NUMBER;
    t_lamt    NUMBER;
    t_bamt    NUMBER;
    t_tamt    NUMBER;

 -- LOCAL VALUE
    l_marr    VARCHAR2(1); -- 0 1
    l_jmno    VARCHAR2(8); --
    l_jmnop   VARCHAR2(1); -- 1
    l_jdt     VARCHAR2(8); --
    l_rdt     VARCHAR2(8); --
    l_lcd     VARCHAR2(2); --
    l_gdt     VARCHAR2(8); --
 -- RETURN VALUE
    v_return  NUMBER;

 -------------------------------------------------------------
 /* ERR CODE

   -1:     
   -2:     
   -3:  
   -4:   
 -  -5:  1  
 -  -6:    3  
 -  -7:   3  30   
 -  -8:  ,   
 - -51:    
 - -52:   
 - -53:     .
 */
 -------------------------------------------------------------

 BEGIN
    t_cnt := 0; v_return := 0;

    -- -------------     
    SELECT NVL(COUNT(*), 0)
      INTO t_cnt
      FROM HR_LOAN_INTEREST_RATE
     WHERE LOAN_KIND_CODE = as_tp
       AND as_dt BETWEEN APPLY_SDATE AND APPLY_EDATE;
    IF t_cnt <> 1 THEN RETURN -1; END IF;

    t_cnt := 0;
    SELECT NVL(COUNT(*), 0)

      INTO t_cnt
      FROM HR_LOAN_MASTER
     WHERE EMP_NO         = as_emp
       AND LOAN_KIND_CODE = as_tp
       AND LOAN_DATE      = as_dt;
    IF t_cnt > 0 THEN RETURN -2; END IF;

    BEGIN
       SELECT B.MARRIED_YN, B.RRN_PRE, SUBSTR(B.RRN_POST, 1, 1), B.JOIN_DATE, DECODE(NVL(B.RETIRE_DATE, '0'), '', '0', B.RETIRE_DATE), A.LEVEL_CODE, B.GROUP_JOIN_DATE
         INTO l_marr,       l_jmno,    l_jmnop,                  l_jdt,       l_rdt,                                                   l_lcd,        l_gdt
         FROM HR_ORDE_MASTER A,
              HR_PERS_MASTER B
        WHERE A.EMP_NO = B.EMP_NO

          AND A.EMP_NO = as_emp
          AND APPLY_ORDER_DATE || TO_CHAR(SEQ) = (SELECT MAX(APPLY_ORDER_DATE || TO_CHAR(SEQ))
                                                    FROM HR_ORDE_MASTER
                                                   WHERE EMP_NO = A.EMP_NO
                                                     AND APPLY_ORDER_DATE <= as_dt);
       EXCEPTION WHEN no_data_found THEN RETURN -3;
    END;

    -- ------------- 
    IF l_rdt <= as_dt THEN RETURN -4; END IF; --

 /*
    IF LENGTH(l_gdt) = 8 THEN BEGIN

       IF TO_DATE(as_dt, 'YYYYMMDD') < ADD_MONTHS(TO_DATE(l_gdt, 'YYYYMMDD'), 12) THEN RETURN -5; END IF; -- 1
    END; ELSE BEGIN
       IF TO_DATE(as_dt, 'YYYYMMDD') < ADD_MONTHS(TO_DATE(l_jdt, 'YYYYMMDD'), 12) THEN RETURN -5; END IF; -- 1
    END; END IF;

    -- ------------- 
    IF as_cb = '40' AND l_lcd > 'BD' THEN
       IF TO_DATE(as_dt, 'YYYYMMDD') < ADD_MONTHS(TO_DATE(l_jdt, 'YYYYMMDD'), 36) THEN RETURN -6; END IF; -- 3
    END IF;

    -- -------------  ()
    IF as_tp = '10' AND l_marr = '0' THEN
       IF l_jmnop IN ('1', '2') THEN BEGIN

          l_jmno := '19' || l_jmno;
       END; ELSE BEGIN
          l_jmno := '20' || l_jmno;
       END; END IF;

       IF NOT (TO_DATE(as_dt, 'YYYYMMDD') >= ADD_MONTHS(TO_DATE(l_jdt, 'YYYYMMDD'), 36) OR TO_DATE(as_dt, 'YYYYMMDD') >= ADD_MONTHS(TO_DATE(l_jmno, 'YYYYMMDD'), 12 * 30)) THEN
          RETURN -7;
       END IF;
    END IF;

    -- ------------- ,   (   )
    IF as_tp IN ('10', '20') THEN
       t_cnt := 0;

       SELECT NVL(COUNT(*), 0)
         INTO t_cnt
         FROM HR_LOAN_MASTER
        WHERE EMP_NO = as_emp
          AND LOAN_KIND_CODE IN ('10', '20')
          AND NVL(FINISH_TAG, 'N') = 'N';
       IF t_cnt > 0 THEN RETURN -8; END IF;
    END IF;

    -- ==================  ====================================
    --   
    SELECT MAX(TO_NUMBER(NVL(REF_NAME, 0)))
      INTO t_lamt

      FROM HR_CODE_REF
     WHERE REF_GBN_CODE = 'S4'
       AND as_tp || l_lcd BETWEEN SUBSTR(REF_CODE, 1, 4) AND SUBSTR(REF_CODE, 5, 4);

    --   
    SELECT SUM(A.LAMT) - SUM(A.RAMT) AS LAMT
      INTO t_bamt
      FROM (SELECT NVL(SUM(LOAN_AMT), 0) AS LAMT, 0 AS RAMT
              FROM HR_LOAN_MASTER
             WHERE EMP_NO = as_emp
               AND LOAN_KIND_CODE = as_tp
             UNION ALL
            SELECT 0 AS LAMT, NVL(SUM(RECEIPT_AMT), 0) AS RAMT

              FROM HR_LOAN_REPAYMENT
             WHERE EMP_NO = as_emp
               AND LOAN_KIND_CODE = as_tp
           ) A;
    IF t_lamt <= t_bamt THEN
       RETURN -51; --    
    ELSE
       v_return := t_lamt - t_bamt;
    END IF;

    -- >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>   
    IF as_cb = '40' THEN
       --  

       SELECT MAX(TO_NUMBER(NVL(REF_NAME, 0)))
         INTO t_lamt
         FROM HR_CODE_REF
        WHERE REF_GBN_CODE = 'S3'
          AND l_lcd BETWEEN SUBSTR(REF_CODE, 1, 2) AND SUBSTR(REF_CODE, 3, 2);

       --
       t_cnt := 0;
       SELECT COUNT(*)
         INTO t_cnt
         FROM HR_RETI_RESULT
        WHERE EMP_NO      = as_emp
          AND RETIRE_TAG  = '2'

          AND RETIRE_DATE > TRIM(TO_CHAR(TO_NUMBER(SUBSTR(as_dt, 1,4)) -1, '0000')) || '1231';
       IF t_cnt > 0 THEN
          --   
          t_bamt := 0;
       ELSE
          --  50%
          SELECT NVL(MAX(TRUNC(A.RETIRE_PAY_TOT / 2)), 0)
            INTO t_bamt
            FROM HR_RETI_ESTIMATE A
           WHERE A.EMP_NO = as_emp
             AND A.RETIRE_DATE = (SELECT MAX(RETIRE_DATE) FROM HR_RETI_ESTIMATE
                                   WHERE EMP_NO      = A.EMP_NO
                                     AND RETIRE_DATE < SUBSTR(as_dt, 1,4) || '0101');

       END IF;

       SELECT SUM(A.LAMT) - SUM(A.RAMT) AS LAMT
         INTO t_tamt
         FROM (SELECT NVL(SUM(LOAN_AMT3), 0) AS LAMT, 0 AS RAMT
                 FROM HR_LOAN_MASTER
                WHERE EMP_NO = as_emp
                UNION ALL
               SELECT 0 AS LAMT, NVL(SUM(RECEIPT_AMT3), 0) AS RAMT
                 FROM HR_LOAN_REPAYMENT
                WHERE EMP_NO = as_emp
              ) A;


       IF t_lamt <= t_bamt THEN t_lamt := t_bamt; END IF;

       IF t_lamt <= t_tamt THEN
          RETURN -52; --   
       ELSE
          v_return := t_lamt - t_tamt;
       END IF;
    END IF;

    -- >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

    -- 
    SELECT MAX(TO_NUMBER(NVL(REF_NAME, 0)))

      INTO t_lamt
      FROM HR_CODE_REF
     WHERE REF_GBN_CODE = 'S2'
       AND l_lcd BETWEEN SUBSTR(REF_CODE, 1, 2) AND SUBSTR(REF_CODE, 3, 2);

    --   
    SELECT SUM(A.LAMT) - SUM(A.RAMT) AS LAMT
      INTO t_bamt
      FROM (SELECT NVL(SUM(LOAN_AMT), 0) AS LAMT, 0 AS RAMT
              FROM HR_LOAN_MASTER
             WHERE EMP_NO = as_emp
             UNION ALL
            SELECT 0 AS LAMT, NVL(SUM(RECEIPT_AMT), 0) AS RAMT

              FROM HR_LOAN_REPAYMENT
             WHERE EMP_NO = as_emp
           ) A;
    t_lamt := t_lamt - t_bamt;

    IF t_lamt = 0 THEN RETURN -53; END IF; --     .

    IF v_return <= t_lamt THEN
       RETURN v_return;
    ELSE
       RETURN t_lamt;
    END IF;
 */

  RETURN 0;
 END;

/





CREATE  OR REPLACE  FUNCTION F_HR_GET_DECHULTOTLIMIT (

   as_emp IN VARCHAR2,   -- 
   as_dt  IN VARCHAR2   -- 
 ) return NUMBER IS

 -------------------------------------------------------------
 -- TEMP VALUE
    t_lamt    NUMBER;
    t_bamt    NUMBER;

 -- LOCAL VALUE
    l_lcd     VARCHAR2(2); --



 -------------------------------------------------------------
 /* ERR CODE
   -1:     
   -2:     
   -3:  
   -4:   
 -  -5:  1  
 -  -6:    3  
 -  -7:   3  30   
 -  -8:  ,   
 - -51:    
 - -52:   

 - -53:     .

 */
 -------------------------------------------------------------
 BEGIN
    BEGIN
       SELECT A.LEVEL_CODE
         INTO l_lcd
         FROM HR_ORDE_MASTER A,
              HR_PERS_MASTER B
        WHERE A.EMP_NO = B.EMP_NO
          AND A.EMP_NO = as_emp
          AND APPLY_ORDER_DATE || TO_CHAR(SEQ) = (SELECT MAX(APPLY_ORDER_DATE || TO_CHAR(SEQ))

                                                    FROM HR_ORDE_MASTER
                                                   WHERE EMP_NO = A.EMP_NO

                                                     AND APPLY_ORDER_DATE <= as_dt);
       EXCEPTION WHEN no_data_found THEN RETURN -3;
    END;
 /*
    -- ==================  ====================================
    -- 
    SELECT MAX(TO_NUMBER(NVL(REF_NAME, 0)))
      INTO t_lamt
      FROM HR_CODE_REF
     WHERE REF_GBN_CODE = 'S2'

       AND l_lcd BETWEEN SUBSTR(REF_CODE, 1, 2) AND SUBSTR(REF_CODE, 3, 2);

    --   

    SELECT SUM(A.LAMT) - SUM(A.RAMT) AS LAMT
      INTO t_bamt
      FROM (SELECT NVL(SUM(LOAN_AMT), 0) AS LAMT, 0 AS RAMT
              FROM HR_LOAN_MASTER
             WHERE EMP_NO = as_emp
             UNION ALL
            SELECT 0 AS LAMT, NVL(SUM(RECEIPT_AMT), 0) AS RAMT
              FROM HR_LOAN_REPAYMENT
             WHERE EMP_NO = as_emp

           ) A;
    RETURN t_lamt - t_bamt;
 */
   RETURN 0;
 END;

/





CREATE OR REPLACE FUNCTION "F_HR_GET_DEPTAUTH" (

   as_empno  varchar2, --emp_no
   as_div    varchar2  --'1':   Value, '2':   Value
   ) RETURN VARCHAR2
 AS

   ls_dept    hr_pers_master.dept_code%TYPE;
   ls_query   hr_code_dept.query_auth_code%TYPE;
   ls_head    hr_code_dept.headquater_code%TYPE;
   ls_query_title   hr_code_title.query_auth_yn%TYPE;

   ls_value1  varchar2(20);
   ls_value2  varchar2(20);

 BEGIN

   begin
     select a.dept_code, b.query_auth_code, b.headquater_code, nvl(c.query_auth_yn,'N')
       into ls_dept, ls_query, ls_head, ls_query_title
       from hr_pers_master a,
            hr_code_dept   b,
            hr_code_title  c
      where a.emp_no = as_empno
        and a.dept_code  = b.dept_code(+)
        and a.title_code = c.title_code(+);
   exception
     when NO_DATA_FOUND then
       null;
   end;

   if as_empno = '%' then
     ls_value1 := '%';
     ls_value2 := '%';
   else
     if ls_query_title = 'Y' then
       if ls_query = '%' then
         ls_value1 := '%';
         ls_value2 := '%';
       else
         ls_value1 := ls_query;
         ls_value2 := case ls_query
                        when 'H' then ls_head
                        when 'D' then ls_dept
                      end;
       end if;
     else
        ls_value1 := 'E';
        ls_value2 := as_empno;
     end if;
   end if;

   if as_div = '1' then
     RETURN(ls_value1);
   else
     RETURN(ls_value2);
   end if;
 END;

/





CREATE  OR REPLACE  FUNCTION F_HR_AGE (an_year number, as_rrnpre varchar2, as_rrnpost varchar2)RETURN NUMBER AS

  ls_num varchar2(2);
BEGIN
  ls_num := case substr(as_rrnpost,1,1)
              when '3' then '20'
              when '4' then '20'
              else '19'
            end;
  
  RETURN an_year - to_number(ls_num||substr(as_rrnpre,1,2))  + 1;
END F_HR_AGE;

/





CREATE  OR REPLACE  FUNCTION F_AM_GET_AVGREMAINDER_TERMTO

( Av_AcntCode VARCHAR2, 
  Av_CompCode VARCHAR2, 
  as_dept varchar2,
  Adt_TermDate DATE,
  Adt_ToDate   DATE
 )
 
RETURN NUMBER IS
n_TermCnt     NUMBER;
n_Loop        NUMBER;
n_DailyRemain NUMBER;
n_CumRemain   NUMBER;
n_Remainder   NUMBER;
BEGIN
   --   .(,, )
   IF Av_AcntCode < '4' THEN
      SELECT nvl(SUM(a.dr_balance+a.cr_balance),0) INTO n_CumRemain
        FROM am_endx_dept A
       WHERE A.end_Date   < Adt_TermDate
         AND A.Acnt_Code  = Av_AcntCode
         AND A.Company_Code LIKE Av_CompCode
         and a.dept_code like as_dept ;
   ELSE
      n_CumRemain := 0;
   END IF;
   --     .
   n_TermCnt := Adt_ToDate - Adt_TermDate + 1;
   --      .
   n_Remainder := 0;
   FOR n_Loop IN 1..n_TermCnt LOOP
      SELECT NVL(SUM(dr_balance+cr_balance), 0) INTO n_DailyRemain
        FROM am_endx_dept
       WHERE end_year = TO_CHAR(Adt_TermDate + n_Loop - 1, 'YYYY')
	     AND end_Date  = TO_CHAR(Adt_TermDate + n_Loop - 1, 'YYYYMMDD')
         AND Acnt_Code = Av_AcntCode
         AND Company_Code LIKE Av_CompCode
         and dept_code like as_dept  ;
      n_CumRemain := n_CumRemain + n_DailyRemain;
      n_Remainder := n_Remainder + n_CumRemain;
   END LOOP;
   --  
   n_Remainder := TRUNC(n_Remainder / n_TermCnt, 0);
   RETURN n_Remainder;
END;

/





CREATE  OR REPLACE  FUNCTION F_HR_ISDATE (as_date varchar2) return varchar2 

as
ld_date date;
begin
  ld_date := to_date(as_date);
  return 'Y';
exception
  when others then
    return 'N';
end f_hr_isdate;

/





CREATE OR REPLACE FUNCTION "F_HR_GET_MONTHENG" (as_yyyymmdd varchar2, as_div varchar2) RETURN VARCHAR2

 AS

 ls_engname varchar2(3);
 li_month   integer;
 BEGIN

   li_month := to_number(substr(as_yyyymmdd,5,2));

   if li_month = 1 then
     ls_engname := 'Jan';
   elsif li_month = 2 then
     ls_engname := 'Feb';


   elsif li_month = 3 then
     ls_engname := 'Mar';
   elsif li_month = 4 then
     ls_engname := 'Apr';
   elsif li_month = 5 then
     ls_engname := 'May';
   elsif li_month = 6 then
     ls_engname := 'Jun';
   elsif li_month = 7 then
     ls_engname := 'Jul';
   elsif li_month = 8 then
     ls_engname := 'Aug';

   elsif li_month = 9 then

     ls_engname := 'Sep';
   elsif li_month = 10 then
     ls_engname := 'Oct';
   elsif li_month = 11 then
     ls_engname := 'Nov';
   elsif li_month = 12 then
     ls_engname := 'Dec';
   end if;

   if as_yyyymmdd is null or length(as_yyyymmdd) = 0 then
     RETURN null;

   end if;
   if as_div = '1' then

     RETURN(ls_engname||'.'||substr(as_yyyymmdd,0,4));
   elsif as_div = '2' then
     RETURN(ls_engname||'.'||substr(as_yyyymmdd,7,2)||'.'||substr(as_yyyymmdd,0,4));
   end if;

 END;

/





CREATE OR REPLACE FUNCTION "F_HR_GET_SINLIMIT" (

   as_emp IN VARCHAR2,   -- 
   as_dt  IN VARCHAR2    -- 
 ) return NUMBER IS

 -------------------------------------------------------------
 -- TEMP VALUE
    t_cnt     NUMBER;
    t_lamt    NUMBER;
    t_bamt    NUMBER;
    t_tamt    NUMBER;
 -- LOCAL VALUE
    l_marr    VARCHAR2(1); -- 0 1

    l_jmno    VARCHAR2(8); --
    l_jmnop   VARCHAR2(1); -- 1
    l_jdt     VARCHAR2(8); --
    l_rdt     VARCHAR2(8); --
    l_lcd     VARCHAR2(2); --
    l_gdt     VARCHAR2(8); --
 -- RETURN VALUE
    v_return  NUMBER;

 -------------------------------------------------------------
 /* ERR CODE
   -1:     
   -2:     

   -3:  
   -4:   
   -5:  1  
   -6:    3  
   -7:   3  30   
   -8:  ,   
  -51:    
  -52:   
  -53:     .
 */
 -------------------------------------------------------------
 BEGIN
    t_cnt := 0; v_return := 0;


    BEGIN
       SELECT B.MARRIED_YN, B.RRN_PRE, SUBSTR(B.RRN_POST, 1, 1), B.JOIN_DATE, DECODE(NVL(B.RETIRE_DATE, '0'), '', '0', B.RETIRE_DATE), A.LEVEL_CODE, TRIM(B.GROUP_JOIN_DATE)
         INTO l_marr,       l_jmno,    l_jmnop,                  l_jdt,       l_rdt,                                                   l_lcd,        l_gdt
         FROM HR_ORDE_MASTER A,
              HR_PERS_MASTER B
        WHERE A.EMP_NO = B.EMP_NO
          AND A.EMP_NO = as_emp
          AND APPLY_ORDER_DATE || TO_CHAR(SEQ) = (SELECT MAX(APPLY_ORDER_DATE || TO_CHAR(SEQ))
                                                    FROM HR_ORDE_MASTER
                                                   WHERE EMP_NO = A.EMP_NO
                                                     AND APPLY_ORDER_DATE <= as_dt);
       EXCEPTION WHEN no_data_found THEN RETURN -3;

    END;

    -- ------------- 
    IF l_rdt <= as_dt THEN RETURN -4; END IF; --

    IF LENGTH(l_gdt) = 8 THEN
    	  BEGIN
       	   IF TO_DATE(as_dt, 'YYYYMMDD') < ADD_MONTHS(TO_DATE(l_gdt, 'YYYYMMDD'), 12) THEN RETURN -5; END IF; -- 1
 	  EXCEPTION WHEN OTHERS THEN RETURN -3;
    	  END;
    ELSE
       BEGIN
            IF TO_DATE(as_dt, 'YYYYMMDD') < ADD_MONTHS(TO_DATE(l_jdt, 'YYYYMMDD'), 12) THEN RETURN -5; END IF; -- 1

 	  EXCEPTION WHEN OTHERS THEN RETURN -3;
       END;
     END IF;

    IF l_lcd > 'BD' THEN BEGIN
    	  BEGIN
       	   IF TO_DATE(as_dt, 'YYYYMMDD') < ADD_MONTHS(TO_DATE(l_jdt, 'YYYYMMDD'), 36) THEN RETURN -6; END IF; -- 3
 	  EXCEPTION WHEN OTHERS THEN RETURN -3;
       END;
    END; END IF;

    -- -------------  ()
    IF l_marr = '0' THEN

       IF l_jmnop IN ('1', '2') THEN BEGIN
          l_jmno := '19' || l_jmno;
       END; ELSE BEGIN
          l_jmno := '20' || l_jmno;
       END; END IF;

       IF NOT (TO_DATE(as_dt, 'YYYYMMDD') >= ADD_MONTHS(TO_DATE(l_jdt, 'YYYYMMDD'), 36) OR TO_DATE(as_dt, 'YYYYMMDD') >= ADD_MONTHS(TO_DATE(l_jmno, 'YYYYMMDD'), 12 * 30)) THEN
          RETURN -7;
       END IF;
    END IF;

    --  
    SELECT MAX(TO_NUMBER(NVL(REF_NAME, 0)))

      INTO t_lamt
      FROM HR_CODE_REF
     WHERE REF_GBN_CODE = 'S3'
       AND l_lcd BETWEEN SUBSTR(REF_CODE, 1, 2) AND SUBSTR(REF_CODE, 3, 2);

    --
    t_cnt := 0;
    SELECT COUNT(*)
      INTO t_cnt
      FROM HR_RETI_RESULT
     WHERE EMP_NO      = as_emp
       AND RETIRE_TAG  = '2'
       AND RETIRE_DATE > TRIM(TO_CHAR(TO_NUMBER(SUBSTR(as_dt, 1,4)) -1, '0000')) || '1231';

    IF t_cnt > 0 THEN
       --   
       t_bamt := 0;
    ELSE
       --  50%
       SELECT NVL(MAX(TRUNC(A.RETIRE_PAY_TOT / 2)), 0)
         INTO t_bamt
         FROM HR_RETI_ESTIMATE A
        WHERE A.EMP_NO = as_emp
          AND A.RETIRE_DATE = (SELECT MAX(RETIRE_DATE) FROM HR_RETI_ESTIMATE
                                WHERE EMP_NO      = A.EMP_NO
                                  AND RETIRE_DATE < SUBSTR(as_dt, 1,4) || '0101');
    END IF;


    IF t_lamt > t_bamt THEN RETURN t_lamt; END IF;
    RETURN t_bamt;
 END;

/





CREATE OR REPLACE FUNCTION "F_HR_JOB_INTERVAL" (ai_job integer, ai_num integer) RETURN DATE

 AS
   ld_date date;
   ln_time number;
 BEGIN

   ln_time := case ai_num
                when 1 then 9.1/24
                when 2 then 11.5/24
              end;

   select trunc(next_date + 1) + ln_time
     into ld_date

     from user_jobs where job = ai_job;

   return ld_date;
 END;

/





CREATE  OR REPLACE  FUNCTION F_HR_MONTHSAFTER_STR 

( ad_sdate  date, 
  ad_edate  date ) 
return string is 
--     
li_months integer; 
li_years  integer; 
lv_return varchar2(50); 
begin 
 li_months := trunc(months_between(ad_edate, ad_sdate - 1), 0); 
 li_years := trunc(li_months / 12, 0); 
 li_months := mod(li_months, 12); 
 if li_years > 0 then 
  lv_return := to_char(li_years, '99') || ' '; 
 else 
  lv_return := '     '; 
 end if; 
 if li_months > 0 then 
  lv_return := lv_return || ' ' || to_char(li_months, '99') || ' '; 
 else 
  lv_return := lv_return || '        '; 
 end if; 
 return lv_return; 
end;

/





CREATE  OR REPLACE  FUNCTION F_HR_MONTHSAFTER_STR_STND 

( ad_join    date, 
  ad_retire  date,
  ad_stnd    date) 
return string is 
  ld_date   date;
  li_months integer; 
  li_years  integer; 
  lv_return varchar2(50); 
begin 
 
 if ad_retire is null then
   ld_date := ad_stnd;
 else
   ld_date := ad_retire;
 end if;

 if ld_date > ad_stnd then
   ld_date := ad_stnd;
 end if;
 
 if ld_date > sysdate then
   ld_date := sysdate;
 end if;
 
 li_months := trunc(months_between(ld_date, ad_join - 1), 0); 
 li_years  := trunc(li_months / 12, 0); 
 li_months := mod(li_months, 12); 
 if li_years > 0 then 
   lv_return := trim(to_char(li_years, '99') || ''); 
 end if; 
 if li_months > 0 then 
  lv_return := lv_return || ' ' || trim(to_char(li_months, '99') || ''); 
 end if; 
 return lv_return; 
end;

/





CREATE  OR REPLACE  FUNCTION F_HR_PAYX_CNT (

    as_yymm VARCHAR2
 )
 RETURN NUMBER IS
 vCnt NUMBER;
 /*********************************************************/
 /*           */
 /*********************************************************/
 BEGIN
 SELECT COUNT(DISTINCT EMP_NO)
  INTO vCnt
 FROM (
 		SELECT  EMP_NO


 		  FROM HR_PAYX_RESULT_MST
 		 WHERE WORK_YYMM = as_yymm
 		UNION ALL
 		SELECT  EMP_NO
 		  FROM HR_YETA_RESULT
 		 WHERE WORK_YEAR = substr(as_yymm,0,4)
 		   AND '12' = SUBSTR(AS_YYMM,5,2)
 );
 RETURN vCnt;
 END F_HR_PAYX_CNT;


/





CREATE  OR REPLACE  FUNCTION F_HR_PAYX_END_YN (

 	as_comp varchar2,
 	as_workyymm varchar2,
 	as_kind varchar2
 ) RETURN VARCHAR2
 AS
   ls_endyn varchar2(1);
 BEGIN
   select nvl(max(end_yn), 'N')
     into ls_endyn
     from hr_payx_end
    where company_code like as_comp
      and work_yymm    = as_workyymm


      and pay_kind     = as_kind;
   RETURN(ls_endyn);
 END;

/





CREATE OR REPLACE FUNCTION       "F_HR_PAYX_STND_ALLOW" (

   V_B2_11 NUMBER,
   V_B2_12 NUMBER,
   V_B2_14 NUMBER,
   V_B2_15 NUMBER,
   V_B2_17 NUMBER
  )
 RETURN NUMBER
 AS
   V_B2_13 NUMBER := 0;
 BEGIN

   --   : ( +  +  +  + ) * 0.1

   V_B2_13 := trunc((V_B2_11 + V_B2_12 + V_B2_14 + V_B2_15 + V_B2_17) * 0.1, -1); --   trunc 

   RETURN(V_B2_13);
 END;

/





CREATE OR REPLACE FUNCTION       "F_HR_RETI_SLIP_DATE" (as_comp varchar2, as_rdate varchar2, as_empno varchar2) RETURN VARCHAR2

 AS
     ls_date varchar2(8);
 BEGIN

     select slip_date
       into ls_date
       from am_slip_master
      where (work_comp, work_date, work_no) in
                                               (
                                                 select company_code, work_date, work_no
                                                   from hr_payx_slip_trans
                                                  where company_code   = as_comp

                                                    and work_yymm      = as_rdate
                                                    and work_div       = as_empno
                                                    and slip_kind_code = 'HR4'
                                                 group by company_code, work_date, work_no
                                               )
        and check_status = '2';
   RETURN(ls_date);

 exception
     when NO_DATA_FOUND then
         return('99991231');
 END;

/





CREATE OR REPLACE FUNCTION "F_HR_RETI_SLIP_YN" (as_comp varchar2, as_rdate varchar2, as_empno varchar2, as_div varchar2) RETURN VARCHAR2

 AS
  /*
    :               .

   as_comp  - ('100')
   as_rdate - ('20060101')
   as_empno - ('00064')
   as_div   - ('1':, '2':)

  */
   ls_summ_yn  varchar2(1) := 'Y';
   ls_slip_yn  varchar2(1);


 BEGIN

   begin
     select decode(work_date, null, 'N', 'Y')
       into ls_slip_yn
       from hr_payx_slip_trans
      where company_code = as_comp
        and work_yymm    = as_rdate
        and work_div     = as_empno
      group by work_date;
   exception
     when NO_DATA_FOUND then

       ls_summ_yn := 'N';

       ls_slip_yn := 'N';
   end;

   if as_div = '1' then
     RETURN(ls_summ_yn);
   else
     RETURN(ls_slip_yn);
   end if;

 END;

/





CREATE OR REPLACE FUNCTION "F_HR_RETI_TRUST_AMT" (

  as_year varchar2,
  as_empno varchar2
 ) RETURN VARCHAR2
 AS
   ldec_pnret_amt    number;
   ldec_account_amt  number;
 BEGIN
     -- 
     select nvl(sum(pnret_amt),0)
       into ldec_pnret_amt
       from hr_reti_transfer_amt
      where emp_no = as_empno


        and (end_yn is null or end_yn = 'N');

 	--
     select nvl(sum(account_amt),0)
       into ldec_account_amt
       from hr_reti_trust
      where work_yyyy = as_year
        and emp_no    = as_empno;
   RETURN(trim(to_char(ldec_pnret_amt)) ||'|'||trim(to_char(ldec_account_amt)));
 END;

/





CREATE OR REPLACE FUNCTION           "F_HR_ROWTOCOL" (

 p_slct IN VARCHAR2, p_dlmtr IN VARCHAR2 DEFAULT ',', p_opt IN VARCHAR2 DEFAULT 'N' 
)
return VARCHAR2
as
     TYPE c_refcur IS REF CURSOR;
     lc_str VARCHAR2(4000);
     lc_colval VARCHAR2(4000);
     c_dummy c_refcur;
     l number;
begin
     OPEN c_dummy FOR p_slct;
     LOOP
       FETCH c_dummy INTO lc_colval;


       EXIT WHEN c_dummy%NOTFOUND;
       lc_str := lc_str || p_dlmtr || lc_colval;
     END LOOP;
     CLOSE c_dummy;

     IF p_opt = 'Y' THEN
      RETURN SUBSTR(lc_str,1);
     ELSE
      RETURN SUBSTR(lc_str,2);
     END IF;

 EXCEPTION
     WHEN OTHERS THEN
     lc_str := SQLERRM;
     IF c_dummy%ISOPEN THEN
       CLOSE c_dummy;
     END IF;

     RETURN lc_str;
end;

/





CREATE  OR REPLACE  FUNCTION F_HR_TIME_END_YN (

 	as_date varchar2
 ) RETURN VARCHAR2
 AS
   ls_endyn varchar2(1);
 BEGIN

   select nvl(max(magam_tag), 'N')
     into ls_endyn
     from hr_time_magam
    where magam_date   = as_date;

   RETURN(ls_endyn);

 END;

/





CREATE  OR REPLACE  FUNCTION F_HR_YETA_END_YN (

  as_comp VARCHAR2,
  as_year VARCHAR2
 ) RETURN VARCHAR2
 AS
   ls_endyn VARCHAR2(1);
 BEGIN
   -- .
   SELECT NVL(MAX(end_yn), 'N')
     INTO ls_endyn
     FROM HR_YETA_END
    WHERE company_code like as_comp
      AND work_year    = as_year;

   RETURN(ls_endyn);
 END;

/





CREATE OR REPLACE FUNCTION "F_MM_CHARTONUMYN"(

    AN_NUM VARCHAR
)
RETURN VARCHAR2 IS
    vNum	  NUMBER;
BEGIN
 	vNum := TO_NUMBER(AN_NUM);

    RETURN 'Y';

EXCEPTION
	  WHEN OTHERS THEN
	    -- Consider logging the error and then re-raise
	    RETURN 'N';
END;

/





CREATE OR REPLACE FUNCTION "F_MM_CONTPAPER_CHANGE" ( vSrc VARCHAR2, vA1 VARCHAR2, vA2 VARCHAR2, vA3 VARCHAR2 )

RETURN VARCHAR2 IS
   vReturn VARCHAR2(2000);
BEGIN
   vReturn := REPLACE(REPLACE(REPLACE(vSrc, ':A1', vA1), ':A2', vA2), ':A3', vA3);
   RETURN vReturn;
END;

/





CREATE  OR REPLACE  FUNCTION F_MM_GET_CUSTFORMAT(

 	AS_CUST_CODE    VARCHAR2
 ) RETURN VARCHAR2 IS

	LS_CUST_CODE VARCHAR2(20);
	LN_CUST_CODE NUMBER(20);
 BEGIN

  	LS_CUST_CODE := TRIM(REPLACE(AS_CUST_CODE, '-', ''));

	BEGIN
		LN_CUST_CODE := TO_NUMBER(AS_CUST_CODE);
	EXCEPTION WHEN OTHERS THEN
		RETURN AS_CUST_CODE;
	END;

	IF LENGTH(LS_CUST_CODE) = 10 THEN
	   LS_CUST_CODE := TRIM(TO_CHAR(LN_CUST_CODE, '999,99,99999'));
	END IF;

	IF LENGTH(LS_CUST_CODE) = 13 THEN
	   LS_CUST_CODE := TRIM(TO_CHAR(LN_CUST_CODE, '999999,9999999'));
	END IF;

	LS_CUST_CODE := REPLACE(LS_CUST_CODE, ',', '-');

	RETURN LS_CUST_CODE;

 EXCEPTION
 	WHEN NO_DATA_FOUND THEN
 		 NULL;

 	WHEN OTHERS THEN
 		 -- Consider logging the error and then re-raise
 		 RAISE;
 END F_MM_GET_CUSTFORMAT;

/





CREATE  OR REPLACE  FUNCTION F_MM_GET_BONDCUST(

 	AS_CONTRACT_CODE    VARCHAR2,
 	AS_BOND_SERIAL 		VARCHAR2,
	AS_CUST_DIV			VARCHAR2,
	AS_TAG				VARCHAR2
 ) RETURN VARCHAR2 IS

    LS_REAL_CUST_CODE VARCHAR2(20);
	LS_CUST_CODE VARCHAR2(20);
    LS_CUST_NAME VARCHAR2(200);
	LS_TAG VARCHAR2(1);
	LS_ADDR VARCHAR2(150);
  	LS_RETURN VARCHAR2(2000);

	-- :     
  	CURSOR CUR_BOND IS
		SELECT '1' TAG,
			   A.BOND_CLIENT_NUM AS REAL_CUST_CODE,
			   DECODE(TRIM(B.CUST_LEGAL_NO), NULL, A.BOND_CLIENT_NUM, B.CUST_LEGAL_NO) AS CUST_CODE,
			   A.BOND_CLIENT_NAME AS CUST_NAME
		  FROM MM_COMM_BOND A,
		  	   SM_CODE_CUST B
		 WHERE A.BOND_CLIENT_NUM = B.CUST_CODE(+) AND
		 	   A.CONTRACT_CODE = AS_CONTRACT_CODE AND
 		 	   A.BOND_SERIAL = TO_NUMBER(AS_BOND_SERIAL) AND
			   AS_CUST_DIV = 'W'
		UNION ALL
		SELECT '1' TAG,
			   A.DEBTOR_NUM AS REAL_CUST_CODE,
			   DECODE(TRIM(B.CUST_LEGAL_NO), NULL, A.DEBTOR_NUM, B.CUST_LEGAL_NO) AS CUST_CODE,
			   A.DEBTOR_NAME AS CUST_NAME
		  FROM MM_COMM_BOND A,
		  	   SM_CODE_CUST B
		 WHERE A.DEBTOR_NUM = B.CUST_CODE(+) AND
		 	   	A.CONTRACT_CODE = AS_CONTRACT_CODE AND
 		 	   A.BOND_SERIAL = TO_NUMBER(AS_BOND_SERIAL) AND
			   AS_CUST_DIV = 'C'
		UNION ALL
 		SELECT '2' TAG,
			   A.CUST_CODE AS REAL_CUST_CODE,
			   DECODE(TRIM(B.CUST_LEGAL_NO), NULL, A.CUST_CODE, B.CUST_LEGAL_NO),
			   A.CUST_NAME
 		  FROM MM_COMM_BOND_PERSON A,
		  	   SM_CODE_CUST B
 		 WHERE A.CUST_CODE = B.CUST_CODE(+) AND
		 	   A.CONTRACT_CODE = AS_CONTRACT_CODE AND
 		 	   A.BOND_SERIAL = TO_NUMBER(AS_BOND_SERIAL) AND
			   A.CUST_DIV = AS_CUST_DIV
 	  ORDER BY TAG, CUST_CODE
 	   ;
 BEGIN

  	LS_RETURN := '';

 	OPEN CUR_BOND;
 	LOOP
 		FETCH CUR_BOND INTO LS_TAG, LS_REAL_CUST_CODE, LS_CUST_CODE, LS_CUST_NAME;
 		EXIT WHEN CUR_BOND%NOTFOUND;

		IF AS_TAG = '1' THEN
 		   LS_RETURN := LS_RETURN || ', ' || F_Mm_Get_Custformat(LS_CUST_CODE);
		END IF;

		IF AS_TAG = '2' THEN
		   LS_RETURN := LS_RETURN || ', ' || LS_CUST_NAME;
		END IF;

		IF AS_TAG = '3' THEN
		   BEGIN
		      SELECT ADDR1 || ' ' || ADDR2
			    INTO LS_ADDR
			    FROM SM_CODE_CUST
			   WHERE CUST_CODE = LS_REAL_CUST_CODE;
		   EXCEPTION WHEN NO_DATA_FOUND THEN
		      LS_ADDR := '';
		   END;
		   LS_RETURN := LS_RETURN || ', ' || LS_ADDR;
		   EXIT;
		END IF;

 	END LOOP;
 	CLOSE CUR_BOND;

 	IF LS_RETURN = '' THEN
 	   RETURN LS_RETURN;
 	ELSE
       RETURN SUBSTR(LS_RETURN, 3);
 	END IF;

 EXCEPTION
 	WHEN NO_DATA_FOUND THEN
 		 NULL;

 	WHEN OTHERS THEN
 		 -- Consider logging the error and then re-raise
 		 RAISE;
 END F_Mm_Get_Bondcust;

/





CREATE  OR REPLACE  FUNCTION F_MM_GET_BONDPRIOR(

 	AS_CONTRACT_CODE    VARCHAR2,
	AS_BOND_SERIAL		VARCHAR2,
 	AS_RANK				VARCHAR2,
	AS_ROW_NUM			VARCHAR2,
	AS_TAG				VARCHAR2
 ) RETURN VARCHAR2 IS

    LN_RANK NUMBER(3);

	LN_ROW_NUM NUMBER(3);
	AS_SEP_TAG VARCHAR2(1);
	LS_CUST_CODE VARCHAR2(20);
    LS_CUST_NAME VARCHAR2(200);
	LS_PRIOR_AMT VARCHAR2(30);
	LN_BENE_RANK NUMBER(3);

  	LS_RETURN VARCHAR2(200);

  	CURSOR CUR_BOND IS
		SELECT ROW_NUMBER() OVER (ORDER BY PRIOR_BENE_RANK, BOND_BENE_NUM) AS ROW_NUM,
			   BOND_BENE_NUM,
			   BOND_BENE_NAME,
			   PRIOR_AMT,
			   PRIOR_BENE_RANK
		  FROM MM_COMM_BOND
		 WHERE CONTRACT_CODE = AS_CONTRACT_CODE AND
			   PRIOR_BENE_RANK <= TO_NUMBER(AS_RANK) AND
			   ISSUE_TAG = '01' AND
			   BOND_SERIAL <> TO_NUMBER(AS_BOND_SERIAL)
	  ORDER BY PRIOR_BENE_RANK,
	  		   BOND_BENE_NUM
 	   ;
 BEGIN

 	BEGIN
	   SELECT PRIOR_SEP_PAPER_TAG
	     INTO AS_SEP_TAG
		 FROM MM_COMM_BOND
		WHERE CONTRACT_CODE = AS_CONTRACT_CODE AND
			  BOND_SERIAL = TO_NUMBER(AS_BOND_SERIAL);
	EXCEPTION WHEN NO_DATA_FOUND THEN
	   RETURN '';
	END;

	IF AS_SEP_TAG = 'Y' THEN
	   RETURN '';
	END IF;

  	LS_RETURN := '';

 	OPEN CUR_BOND;
 	LOOP
 		FETCH CUR_BOND INTO LN_ROW_NUM, LS_CUST_CODE, LS_CUST_NAME, LS_PRIOR_AMT, LN_BENE_RANK;
 		EXIT WHEN CUR_BOND%NOTFOUND;

		IF LN_ROW_NUM = TO_NUMBER(AS_ROW_NUM) THEN
			IF AS_TAG = '1' THEN
	 		   LS_RETURN := F_MM_GET_CUSTFORMAT(LS_CUST_CODE);
			END IF;

			IF AS_TAG = '2' THEN
			   LS_RETURN := LS_CUST_NAME;
			END IF;

			IF AS_TAG = '3' THEN
			   LS_RETURN := NVL(TRIM(LS_PRIOR_AMT), '-');
			END IF;

			IF AS_TAG = '4' THEN
			   LS_RETURN := '' || TO_CHAR(LN_BENE_RANK);
			END IF;
		END IF;

		EXIT WHEN LN_ROW_NUM = AS_ROW_NUM;
 	END LOOP;
 	CLOSE CUR_BOND;

 	RETURN LS_RETURN;

 EXCEPTION
 	WHEN NO_DATA_FOUND THEN
 		 NULL;

 	WHEN OTHERS THEN
 		 -- Consider logging the error and then re-raise
 		 RAISE;
 END F_MM_GET_BONDPRIOR;

/





CREATE  OR REPLACE  FUNCTION F_MM_GET_BONDTHING(

 	AS_CONTRACT_CODE    VARCHAR2,
 	AS_BOND_SERIAL 		VARCHAR2,
	AS_ROW_NUM			VARCHAR2,
	AS_TAG				VARCHAR2
 ) RETURN VARCHAR2 IS

	LS_SEP_TAG VARCHAR2(1);
	LN_ROW_NUM NUMBER(3);
    LS_ADDR  VARCHAR2(400);
	LS_CLASS1 VARCHAR2(10);
	LS_AREA1 NUMBER(12,4);
	LS_CLASS2 VARCHAR2(10);
	LS_AREA2 NUMBER(12,4);

  	LS_RETURN VARCHAR2(4000);

  	CURSOR CUR_THING IS
 		SELECT ROW_NUMBER() OVER (ORDER BY SEQ) AS ROW_NUM,
			   ADDR1 || ' ' || ADDR2,
			   THING_CLASS1,
			   THING_AREA1_M2,
			   THING_CLASS2,
			   THING_AREA2_M2
 		  FROM MM_COMM_BOND_THING
 		 WHERE CONTRACT_CODE = AS_CONTRACT_CODE AND
 		 	   BOND_SERIAL = TO_NUMBER(AS_BOND_SERIAL)
 	  ORDER BY SEQ
 	   ;
 BEGIN
	BEGIN
		SELECT THING_SEP_PAPER_TAG
		  INTO LS_SEP_TAG
		  FROM MM_COMM_BOND
		 WHERE CONTRACT_CODE = AS_CONTRACT_CODE AND
		 	   BOND_SERIAL = TO_NUMBER(AS_BOND_SERIAL);
	EXCEPTION WHEN NO_DATA_FOUND THEN
		RETURN '';
	END;
	--
	IF LS_SEP_TAG = 'Y' THEN
	   RETURN '';
	END IF;

	LS_RETURN := '';

 	OPEN CUR_THING;
 	LOOP
 		FETCH CUR_THING INTO LN_ROW_NUM, LS_ADDR, LS_CLASS1, LS_AREA1, LS_CLASS2, LS_AREA2;
 		EXIT WHEN CUR_THING%NOTFOUND;

		IF LN_ROW_NUM = TO_NUMBER(AS_ROW_NUM) THEN
			IF AS_TAG = '1' THEN
	 		   LS_RETURN := LS_ADDR;
			END IF;

			IF AS_TAG = '2' THEN
			   LS_RETURN := LS_CLASS1;
			END IF;

			IF AS_TAG = '3' THEN
			   LS_RETURN := TRIM(TO_CHAR(LS_AREA1, '99,999,999.99'));
			END IF;

			IF AS_TAG = '4' THEN
			   LS_RETURN := LS_CLASS2;
			END IF;

			IF AS_TAG = '5' THEN
			   LS_RETURN := TRIM(TO_CHAR(LS_AREA2, '99,999,999.99'));
			END IF;
		END IF;

		EXIT WHEN LN_ROW_NUM = AS_ROW_NUM;
 	END LOOP;
 	CLOSE CUR_THING;

 	RETURN LS_RETURN;

 EXCEPTION
 	WHEN NO_DATA_FOUND THEN
 		 NULL;

 	WHEN OTHERS THEN
 		 -- Consider logging the error and then re-raise
 		 RAISE;
 END F_Mm_Get_Bondthing;

/





CREATE OR REPLACE FUNCTION        "F_MM_GET_DEPTAUTHYN" (

    AS_CONTRACT_CODE VARCHAR2
  , AS_USER_ID VARCHAR2
  )
RETURN VARCHAR2 IS
   vCnt NUMBER;
   vMasterYn VARCHAR2(1);
   vGroupCode VARCHAR2(12);
BEGIN
   -- 
   --RETURN 'Y';

   SELECT PROJ_USER_DIV, GROUP_CODE
     INTO vMasterYn, vGroupCode
	 FROM SM_AUTH_USER
	WHERE USER_ID = AS_USER_ID;

   IF vMasterYn = 'Y' THEN
      RETURN 'Y';
   ELSE
      SELECT COUNT(*)
	    INTO vCnt
	    FROM SM_AUTH_PROJECT A
	   WHERE GROUP_CODE = vGroupCode AND
	   		 PROJ_CODE = ( SELECT PROJ_CODE FROM MM_COMM_CONTRACT WHERE CONTRACT_CODE = AS_CONTRACT_CODE );

      IF vCnt > 0 THEN
	     RETURN 'Y';
	  ELSE
	     RETURN 'N';
	  END IF;
   END IF;

   RETURN 'Y';
END;

/





CREATE OR REPLACE FUNCTION "F_MM_GET_RECEVIDENCENO"(

    AS_WORK_COMP VARCHAR2,
	AS_WORK_DATE VARCHAR2,
	AS_WORK_NO VARCHAR2,
	AS_CUST_CODE VARCHAR2
)
RETURN VARCHAR2 IS
    vReturn   VARCHAR2(60);
BEGIN
    IF AS_WORK_COMP IS NULL OR AS_WORK_DATE IS NULL OR AS_WORK_NO IS NULL OR AS_CUST_CODE IS NULL THEN
	    RETURN NULL;
    END IF;
	
	BEGIN
 	   SELECT SUBSTR(B.YYMM, 1, 4) || '-' ||TRIM(TO_CHAR(B.SEQ, '0000'))
	      INTO vReturn
		  FROM AM_SLIP_DETAIL A,
		  	   		AM_TAXA_EVID B
	    WHERE A.WORK_COMP = B.COMPANY_CODE AND
			  		A.EVIDENCE_NO = B.EVIDENCE_NO AND
					A.WORK_COMP = AS_WORK_COMP AND
			  		A.WORK_DATE = AS_WORK_DATE AND
					A.WORK_NO = AS_WORK_NO AND
					A.CUST_CODE = AS_CUST_CODE AND
					A.EVIDENCE_NO IS NOT NULL;
	EXCEPTION WHEN NO_DATA_FOUND THEN
	    vReturn := NULL;
	END;

    RETURN vReturn;

EXCEPTION
	  WHEN OTHERS THEN
	    -- Consider logging the error and then re-raise
	    RETURN '';
END;

/





CREATE OR REPLACE FUNCTION "F_MM_NUMFORMAT"(

     AN_NUM VARCHAR
 )
 RETURN VARCHAR2 IS
     vNum	  NUMBER;
     vReturn   VARCHAR2(60);
 BEGIN
  	vNum := TO_NUMBER(AN_NUM);

     vReturn := TRIM(TO_CHAR(vNum, '999,999,999,999,999,999,999,999,999,990'));

     RETURN vReturn;


 EXCEPTION
 	  WHEN OTHERS THEN
 	    -- Consider logging the error and then re-raise
 	    RETURN AN_NUM;
 END;

/





CREATE  OR REPLACE  FUNCTION F_MM_P_EXPR_CALC

(
vexpr   VARCHAR2
)
RETURN NUMBER AS
/*///////////////////////////////////////////////////////////////////
//
//    *** Error Code ***
//
//    - Error 1 :   .
//    - Error 2 :      .
//    - Error 3 :    .
//    - Error 4 : 0  .
//
///////////////////////////////////////////////////////////////////*/
TYPE expr_order_table IS TABLE OF MM_PROJ_PROJECT_CAL.REMARK%TYPE
INDEX BY BINARY_INTEGER;
expr_order  expr_order_table ;
k BINARY_INTEGER;

TYPE expr_parse_table IS TABLE OF MM_PROJ_PROJECT_CAL.REMARK%TYPE
INDEX BY BINARY_INTEGER;
expr_parse  expr_parse_table ;
l BINARY_INTEGER;

i              NUMBER := 1 ;
j              NUMBER;
expr_len       NUMBER;
order_level    NUMBER;
order_max      NUMBER;
calc_order     NUMBER;
array_max      NUMBER := 1;
is_operator    NUMBER := 0;
expr_result    NUMBER;
expr_char      VARCHAR2(100);
ref_msg        VARCHAR2(20);
--
BEGIN

expr_len := LENGTHB(vexpr);

expr_parse(1) := '';
expr_order(1) := 0;
order_level   := 0;

FOR i IN 1..expr_len LOOP
   expr_char := SUBSTR(vexpr, i, 1);
   IF expr_char <> ' ' THEN

      IF expr_char = '(' THEN
         order_level := order_level + 4;
      ELSIF expr_char = ')' THEN
         order_level := order_level - 4;
      ELSIF expr_char = '+' THEN
         IF is_operator <> 0 THEN
            ref_msg := 'error 1';
            RETURN 0;
         END IF;
         array_max := array_max + 1;
         expr_parse(array_max) := expr_char;
         expr_order(array_max) := order_level + 1;
         is_operator := 1;
      ELSIF expr_char = '-' THEN
         IF is_operator = -1 THEN
            ref_msg := 'error 1';
            RETURN 0;
         ELSIF is_operator = 0 THEN
            array_max := array_max +1;
            expr_parse(array_max) := expr_char;
            expr_order(array_max) := order_level + 1;
            is_operator := 1;
         ELSE
            array_max := array_max +1;
            expr_parse(array_max) := '';
            expr_parse(array_max) := expr_parse(array_max) || expr_char;
            is_operator := -1;
         END IF;
      ELSIF expr_char = '*' OR expr_char =  '/' THEN
         IF is_operator <> 0 THEN
            ref_msg := 'error 1';
            RETURN 0;
         END IF;
         array_max := array_max +1;
         expr_parse(array_max) := expr_char;
         expr_order(array_max) := order_level + 2;
         is_operator := 1;
      ELSIF expr_char =  '^' THEN
         IF is_operator <> 0 THEN
            ref_msg := 'error 1';
            RETURN 0;
         END IF;
         array_max := array_max +1;
         expr_parse(array_max) := expr_char;
         expr_order(array_max) := order_level + 3;
         is_operator := 1;
      ELSIF expr_char ='0' OR expr_char = '1' OR expr_char = '2' OR expr_char = '3' OR expr_char = '4' OR expr_char = '5'
            OR expr_char = '6' OR expr_char = '7' OR expr_char = '8' OR expr_char = '9' OR expr_char = '.' THEN
         IF is_operator > 0 THEN
            array_max := array_max +1;
            expr_parse(array_max) := '';
            expr_order(array_max) := 0;
         END IF;
         expr_parse(array_max) := expr_parse(array_max) || expr_char;
         is_operator := 0;
      ELSE
         ref_msg := 'error 2';
         RETURN 0;
      END IF;

   END IF;

END LOOP;


IF is_operator <> 0 THEN
   ref_msg := 'error 1';
   RETURN 0;
END IF;

IF order_level <> 0 THEN
   ref_msg := 'error 3';
   RETURN 0;
END IF;


expr_result := TO_NUMBER(expr_parse(1));


i := 2 ;
LOOP
   EXIT WHEN i > array_max - 1 ;

   order_max := 0;

   j := 2 ;
   LOOP
      EXIT WHEN j > array_max - 1 ;
      IF expr_order(j) > order_max THEN
         order_max := expr_order(j);
         calc_order := j;
      END IF;
      j := j + 2;
   END LOOP;


   IF expr_parse(calc_order) = '*' THEN
      expr_result := TO_NUMBER(expr_parse(calc_order - 1)) * TO_NUMBER(expr_parse(calc_order + 1));
   ELSIF  expr_parse(calc_order) = '/' THEN
      IF TO_NUMBER(expr_parse(calc_order + 1)) = 0 THEN
         ref_msg := 'error 4';
         RETURN 0;
      END IF;
      expr_result := TO_NUMBER(expr_parse(calc_order - 1)) / TO_NUMBER(expr_parse(calc_order + 1));
   ELSIF  expr_parse(calc_order) = '+' THEN
      expr_result := TO_NUMBER(expr_parse(calc_order - 1)) + TO_NUMBER(expr_parse(calc_order + 1));
   ELSIF  expr_parse(calc_order) = '-' THEN
      expr_result := TO_NUMBER(expr_parse(calc_order - 1)) - TO_NUMBER(expr_parse(calc_order + 1));
   END IF;


   IF i < array_max - 1 THEN
      expr_order(calc_order) := 0;

      j := calc_order;
      LOOP
         j := j - 1;
         EXIT WHEN j = 1 ;
         EXIT WHEN expr_order(j - 1) <> 0 ;
      END LOOP;
      expr_parse(j) := TO_CHAR(expr_result) ;

      j := calc_order;
      LOOP
         j := j + 1;
         EXIT WHEN j = array_max ;
         EXIT WHEN expr_order(j + 1) <> 0 ;
      END LOOP;
      expr_parse(j) := TO_CHAR(expr_result) ;

   END IF;


   i := i + 2 ;


END LOOP;


ref_msg := 'success';

RETURN expr_result;

END ;

/





CREATE  OR REPLACE  FUNCTION F_PM_WORKDAY

 (
    as_date varchar2
 )

 RETURN NUMBER IS WORKDAY NUMBER;

 --    1  0 
 --     

 BEGIN
 --   SELECT NVL(SUM(DECODE((DECODE(NVL(SATURDAY_YN, 'N'), 'Y', 1, 0) +
 --                          DECODE(NVL(SUNDAY_YN,   'N'), 'Y', 1, 0) +

 --                          DECODE(NVL(HOLIDAY_YN,  'N'), 'Y', 1, 0) +
 --                          DECODE(NVL(WORK_YN,     'N'), 'Y', 1, 0) +
 --                          DECODE(SUBSTR(TO_CHAR(TO_DATE(WORK_DATE), 'DAY'), 1, 1), '', 1,
 --                                                                                   '', 1,
 --                                                                                         0)), 0, 1, 0)), 0) AS TP1
 --     INTO WORKDAY
 --     FROM SM_CODE_CALENDAR
 --    WHERE WORK_DATE LIKE as_date || '%';

    SELECT SUM(CASE WHEN NVL(SATURDAY_YN, 'N') = 'Y' OR
                         NVL(SUNDAY_YN,   'N') = 'Y' OR
                         NVL(HOLIDAY_YN,  'N') = 'Y' OR
                         NVL(WORK_YN,     'Y') = 'N' OR

                         CASE WHEN SUBSTR(TO_CHAR(TO_DATE(WORK_DATE), 'DAY'), 1, 1) IN ('', '')
                              THEN 'Y'
                              ELSE 'N'
                         END = 'Y'
                    THEN 0
                    ELSE 1
               END
           )
      INTO WORKDAY
      FROM SM_CODE_CALENDAR
     WHERE WORK_DATE LIKE as_date || '%';

     RETURN( WORKDAY );

 END F_PM_WORKDAY;

/





CREATE OR REPLACE FUNCTION        "F_SM_ENTER_CHANGE" ( vSrc varchar2 )

return varchar2 is
   vReturn varchar2(2000);
begin
   vReturn := Replace(vSrc, chr(13) || chr(10), '');
   return vReturn;
end;

/





CREATE OR REPLACE FUNCTION      "F_SM_USBLOCK" (

    sUser VARCHAR2
 ,  SLock VARCHAR2
 )
 Return VARCHAR2 Is
    vState  VARCHAR2(1);
    vUser   VARCHAR2(12);
    vDate   VARCHAR2(8);
    vUse    VARCHAR2(1);
    vRows   NUMBER;
 Begin
    If (sLock = '') Then return 'O'; End If;


    Select min(state_div)
         , min(user_id)
         , min(valid_date)
         , min(use_div)
         , count(state_div)
      Into vState
         , vUser
         , vDate
         , vUse
         , vRows
      From SM_AUTH_USB
     Where usb_no = sLock
    ;


    If (vRows <= 0) Then return 'N'; End If;
    If (vState <> 'O' and vState <> 'C') Then return vState; End If;
    If (SysDate > To_Date(vDate || '235959', 'yyyymmddhh24miss')) Then return 'V'; End If;
    If (vUse = 'A') Then return vState; End If;
    If (vUser <> sUser) Then return 'U'; End If;

    Return vState;
 End;

/





CREATE OR REPLACE FUNCTION          "F_TM_GET_BASEDATE"   ( av_comp varchar2 )

 return varchar2 is
    lv_base_date varchar2(8);
 begin
    --   .
    select am_s_date
      into lv_base_date
      from sm_code_company
     where company_code = av_comp
    ;
    return lv_base_date;
 end;

/





CREATE OR REPLACE FUNCTION          "F_TM_GET_BASEMONTH"   ( av_comp varchar2

 , av_date varchar2
 )
 return varchar2 is
    lv_date   varchar2(8);
    lv_base_m varchar2(2);
    lv_base_y varchar2(4);
 begin
    --  .
    select am_start_month
      into lv_base_m
      from sm_code_company
     where company_code = av_comp

    ;
    lv_date := substr(av_date || '0101', 1, 8);
    lv_base_y := substr(lv_date, 1, 4);
    if (lv_date < lv_base_y || lv_base_m || '01') then
       lv_base_y := to_char(lv_base_y - 1);
    end if;
    return lv_base_y || lv_base_m;
 end;

/





CREATE OR REPLACE FUNCTION          "F_TM_GET_BASEMONTHTO"   ( av_comp varchar2

 , av_date varchar2
 )
 return varchar2 is
    lv_date   varchar2(8);
    lv_base_m varchar2(2);
    lv_base_y varchar2(4);
 begin
    --  .
    select am_start_month
      into lv_base_m
      from sm_code_company
     where company_code = av_comp

    ;
    lv_date := substr(av_date || '0101', 1, 8);
    lv_base_y := substr(lv_date, 1, 4);
    if (lv_date < lv_base_y || lv_base_m || '01') then
       lv_base_y := to_char(lv_base_y - 1);
    end if;
    return To_Char(Add_Months(To_Date(lv_base_y || lv_base_m || '01'), 11), 'yyyymmdd');
 end;

/





CREATE OR REPLACE FUNCTION          "F_TM_GET_BASEYEAR"    ( av_comp varchar2

 , av_date varchar2
 )
 return varchar2 is
    lv_date   varchar2(8);
    lv_base_m varchar2(2);
    lv_base_y varchar2(4);
 begin
    --  .
    select am_start_month
      into lv_base_m
      from sm_code_company
     where company_code = av_comp

    ;
    lv_date := substr(av_date || '0101', 1, 8);
    lv_base_y := substr(lv_date, 1, 4);
    if (lv_date < lv_base_y || lv_base_m || '01') then
       lv_base_y := to_char(lv_base_y - 1);
    end if;
    return lv_base_y;
 end;

/





CREATE OR REPLACE FUNCTION          "F_TM_GET_SLIPITEM_NO" (

   AS_COMP VARCHAR2
 , AS_DATE VARCHAR2
 , AN_NO   NUMBER
 , AN_SEQ  NUMBER
 )
 Return VARCHAR2 Is
    vReturn VARCHAR2(40);
    vNumber VARCHAR2(10);
 Begin
    If AS_DATE Is NULL Then Return ''; End If;
    vNumber := LTRIM(RTRIM(To_Char(AN_NO, '0000'))) || '-' || LTRIM(RTRIM(To_Char(AN_SEQ, '000')));
    vReturn := AS_DATE || '-' || vNumber;

    Return vReturn;
 End;

/





CREATE OR REPLACE FUNCTION "F_TM_GET_ESTABLISH_SLIPNO" ( av_comp varchar2

 , ad_date varchar2
 , an_no number
 , an_seq number
 )
 --  =  +  + 
 return varchar2 is
    cursor c_cur1_sql is
       select b.slip_date
            , b.slip_no
            , b.work_seq_scr
         from tm_slip_dc a
            , tm_slip_detail b

        where a.work_comp = b.work_comp
          and a.set_work_date = b.work_date
          and a.set_work_no = b.work_no
          and a.set_work_seq = b.work_seq
          and a.slip_yyyy = substr(ad_date,1,4)
          and a.work_comp = av_comp
          and a.work_date = ad_date
          and a.work_no = an_no
          and a.work_seq = an_seq
    ;
    c_cur1_val c_cur1_sql%ROWTYPE;
    lv_return varchar2(4000);
 begin

    lv_return := '';

    OPEN c_cur1_sql;
    loop
       fetch c_cur1_sql into c_cur1_val;
       exit when c_cur1_sql%notfound;

       if( c_cur1_val.slip_date <> '' or c_cur1_val.slip_date is not null ) then
          if ( lv_return = '' or lv_return is null) then
                lv_return := f_tm_get_slipitem_no(av_comp, c_cur1_val.slip_date, c_cur1_val.slip_no, c_cur1_val.work_seq_scr);
          else
             lv_return := lv_return || ',' ||  f_tm_get_slipitem_no(av_comp, c_cur1_val.slip_date, c_cur1_val.slip_no, c_cur1_val.work_seq_scr);
          end if;

       end if;
    end loop;
    close c_cur1_sql;

    return lv_return;
 end;

/





CREATE OR REPLACE FUNCTION "F_TM_GET_SLIPMNG" ( av_comp varchar2

 , ad_date varchar2
 , an_no number
 , an_seq number
 )
 return varchar2 is
    cursor c_cur1_sql is
       select decode( workd.dr_amt ,0 ,'2', '1') as SLIP_DRCR                              --
            , acnt.BOND_YN                                                                 --
            , acnt.MONTH_COST_YN                                                           --
            , acnt.ADJUSTED_DRCR                                                           --
            , nvl(workd.BANK_CODE,'') as BANK_CODE                                         --
            , nvl(bank.BANK_NAME, workd.BANK_CODE ) as BANK_NAME                           --

            , nvl(workd.DEPOSIT_NO, '') as DEPOSIT_NO                                      --
            , nvl(workd.CHECK_NO, '') as CHECK_NO                                          --
            , nvl(workd.BILL_NO, '') as BILL_NO                                            --
            , nvl(workd.BILL_R_NO, '') as BILL_R_NO                                        --
            , nvl(workd.LOAN_NO, '') as LOAN_NO                                            --
            , nvl(workd.STCK_CODE, '') as STCK_CODE                                        --
            , '' as FA_NO                                                                  --
            , '' as FA_NAME                                                                --
            , nvl(workd.CD_CARD_NO,'') as CD_CARD_NO                                       --
            , nvl(workd.USER_ID,'') as  USER_ID                                            --
            , nvl(pers.USER_NAME, workd.USER_ID) as EMP_NAME                               --
            , nvl(workd.INCOME_CODE, '') as INCOME_CODE                                    --
            , nvl(incm.INCOME_NAME, workd.INCOME_CODE ) as   INCOME_NAME                   --

            , nvl(workd.PHONE, '') as PHONE                                                --
            , nvl(workd.SALES_DIV, '') as SALES_DIV                                        --
            , nvl(val44.VALID_VALUE_NAME, workd.SALES_DIV ) as  SALES_NAME                 --
            , nvl(workd.EVIDENCE_CODE, '') as EVIDENCE_CODE                                --
            , nvl(evid.EVIDENCE_NAME, workd.EVIDENCE_CODE ) as EVIDENCE_NAME               -- 
            , decode( workd.DR_VAT ,0 ,workd.CR_VAT, workd.DR_VAT) as VAT_AMT              --
            , decode( workd.DR_SUPPLY ,0 ,workd.CR_SUPPLY,workd.DR_SUPPLY) as SUPPLY_AMT   --
            , acnt.QTY1_NAME
            , decode(decode(acnt.QTY1_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.QTY1,0), 0) as QTY1
            , acnt.QTY2_NAME
            , decode(decode(acnt.QTY2_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.QTY2,0), 0) as QTY2
            , acnt.QTY3_NAME
            , decode(decode(acnt.QTY3_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.QTY3,0), 0) as QTY3

            , acnt.AMT1_NAME
            , decode(decode(acnt.AMT1_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT1,0), 0) as AMT1
            , acnt.AMT2_NAME
            , decode(decode(acnt.AMT2_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT2,0), 0) as AMT2
            , acnt.AMT3_NAME
            , decode(decode(acnt.AMT3_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT3,0), 0) as AMT3
            , acnt.AMT4_NAME
            , decode(decode(acnt.AMT4_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT4,0), 0) as AMT4
            , acnt.AMT5_NAME
            , decode(decode(acnt.AMT5_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT5,0), 0) as AMT5
            , acnt.AMT6_NAME
            , decode(decode(acnt.AMT6_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT6,0), 0) as AMT6
            , acnt.RATE1_NAME

            , decode(decode(acnt.RATE1_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.RATE1,0), 0) as RATE1
            , acnt.RATE2_NAME
            , decode(decode(acnt.RATE2_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.RATE2,0), 0) as RATE2
            , acnt.RATE3_NAME
            , decode(decode(acnt.RATE3_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.RATE3,0), 0) as RATE3
            , acnt.DATE1_NAME
            , decode(decode(acnt.DATE1_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(replace(workd.DATE1,' '),''), '') AS DATE1
            , acnt.DATE2_NAME
            , decode(decode(acnt.DATE2_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(replace(workd.DATE2,' '),''), '') AS DATE2
            , acnt.DATE3_NAME
            , decode(decode(acnt.DATE3_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(replace(workd.DATE3,' '),''), '') AS DATE3
            , acnt.DATE4_NAME
            , decode(decode(acnt.DATE4_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(replace(workd.DATE4,' '),''), '') AS DATE4

            , acnt.DESC1_NAME
            , decode(decode(acnt.DESC1_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DESC1,''), '') as DESC1
            , acnt.DESC2_NAME
            , decode(decode(acnt.DESC2_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DESC2,''), '') as DESC2
            , acnt.DESC3_NAME
            , decode(decode(acnt.DESC3_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DESC3,''), '') as DESC3
            , acnt.DESC4_NAME
            , decode(decode(acnt.DESC4_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DESC4,''), '') as DESC4
            , acnt.DESC5_NAME
            , decode(decode(acnt.DESC5_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DESC5,''), '') as DESC5
         from tm_slip_detail workd
            , tm_code_acnt acnt
            , TM_CODE_BANK bank

            , SM_AUTH_USER pers
            , TM_CODE_INCOME incm
            , TM_CODE_VALIDATION val44
            , tm_code_evidence evid
        where workd.acnt_code = acnt.acnt_code
          and workd.BANK_CODE = bank.BANK_CODE (+)
          and workd.USER_ID = pers.USER_ID (+)
          and workd.INCOME_CODE = incm.INCOME_CODE (+)
          and val44.VALIDATION_CODE (+)= '44'
          and workd.SALES_DIV = val44.VALID_VALUE_CODE (+)
          and workd.EVIDENCE_CODE = evid.EVIDENCE_CODE (+)
          and workd.WORK_COMP = av_comp
          and workd.WORK_DATE = ad_date

          and workd.WORK_NO = an_no
          and workd.WORK_SEQ = an_seq
    ;
    c_cur1_val c_cur1_sql%ROWTYPE ;
    --ls_give_name varchar2(30);
    --ls_give_depositor varchar2(100);
    vComYN varchar2(1);
    vComCnt number(2);
    vComName varchar2(60);
    ls_work_return_data varchar2(4000);
 begin
    open c_cur1_sql;
    loop

       fetch c_cur1_sql into c_cur1_val;
       exit when c_cur1_sql%notfound;

       --  
       if ( c_cur1_val.BOND_YN = 'Y' ) THEN
          --  /  
          if ( c_cur1_val.SLIP_DRCR <> c_cur1_val.ADJUSTED_DRCR ) then
             ls_work_return_data := F_TM_GET_ESTABLISH_SLIPNO(av_comp, ad_date, an_no, an_seq  );
             if (ls_work_return_data is not null) then
                ls_work_return_data := ':' || ls_work_return_data ;
             end if;
 /*         else
                begin

                select
                   valam.valid_value_name
                   , F_TM_GET_SLIP_BANKDESC(supp.work_comp, supp.work_date, supp.work_no, supp.work_seq, supp.supply_seq) as give_deposit
                into
                   ls_give_name
                   , ls_give_depositor
                from
                   tm_slip_supply supp
                   , tm_code_validation valam
                   , (
                      select
                         work_date
                         , work_no

                         , work_seq
                         , min(supply_seq) as supply_seq
                      from
                         tm_slip_supply
                      where
                            work_comp = av_comp
                         and work_date = ad_date
                         and work_no = an_no
                         and work_seq = an_seq
                      group by
                         work_date
                         , work_no
                         , work_seq

                      ) mins
                where
                   supp.work_date = mins.work_date
                   and supp.work_no = mins.work_no
                   and supp.work_seq = mins.work_seq
                   and supp.supply_seq = mins.supply_seq
                   and supp.acnt_code = valam.valid_value_level
                   and valam.validation_code = '39'
                ;
             --
             exception
                when no_data_found then ls_give_name := null ;
             end;

             --
             if (ls_give_name is not null) then
                ls_work_return_data := ':'||'['||ls_give_name||']' ;
                --
                if ls_give_depositor is not null then
                   ls_work_return_data := ls_work_return_data ||'=> '||ls_give_depositor ;
                end if ;
             end if ;
 */         end if;
       end if;

       --
       if (c_cur1_val.BANK_CODE is not null) then

          ls_work_return_data := ls_work_return_data ||':'|| c_cur1_val.BANK_NAME ;
       end if;

       --
       if (c_cur1_val.DEPOSIT_NO is not null) then
          ls_work_return_data := ls_work_return_data ||':'|| c_cur1_val.DEPOSIT_NO;
          select d.com_yn, sum(decode(c.com_seq, null, 0, 1))-1 com_cnt, max(nvl(c.com_name,'')) com_name
            into vComYN, vComCnt, vComName
            from tm_code_deposit d
               , tm_code_deposit_etccom c
           where d.deposit_no = c_cur1_val.DEPOSIT_NO
             and c.deposit_no (+)= d.deposit_no
           group by d.com_yn

          ;
          if (vComYN = 'Y') then
             ls_work_return_data := ls_work_return_data ||':'|| vComName;
             if (vComCnt > 0) then ls_work_return_data := ls_work_return_data ||'  '||to_char(vComCnt); end if;
          end if;
       end if;

       --
       if (c_cur1_val.CHECK_NO is not null ) then
          ls_work_return_data := ls_work_return_data ||':'|| c_cur1_val.CHECK_NO;
       end if ;

       --

       if (c_cur1_val.BILL_NO is not null ) then
          ls_work_return_data := ls_work_return_data ||':'|| c_cur1_val.BILL_NO;
       end if ;
       --
       --
       if (c_cur1_val.BILL_R_NO is not null ) then
          ls_work_return_data := ls_work_return_data ||':'|| c_cur1_val.BILL_R_NO;
       end if ;

       --
       if (c_cur1_val.LOAN_NO is not null) then
          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.LOAN_NO;
       end if ;

       --
       --
       if (c_cur1_val.STCK_CODE is not null ) then
          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.STCK_CODE;
       end if ;

       --
       if (c_cur1_val.FA_NO is not null) then
          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.FA_NAME;
       end if ;

       --
       if (c_cur1_val.CD_CARD_NO is not null) then

          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.CD_CARD_NO;
       end if ;

       --
       if (c_cur1_val.USER_ID is not null) then
          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.EMP_NAME;
       end if ;

       --
       if (c_cur1_val.INCOME_CODE is not null) then
          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.INCOME_NAME;
       end if ;


       --
       if (c_cur1_val.PHONE is not null) then
          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.PHONE;
       end if ;

       --
       --if (c_cur1_val.SALES_DIV is not null) then
       --   ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.SALES_NAME;
       --end if;

       --
       if (c_cur1_val.EVIDENCE_CODE is not null) then
          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.EVIDENCE_NAME||'('||c_cur1_val.EVIDENCE_CODE||')';

          ls_work_return_data := ls_work_return_data ||':'||ltrim(rtrim(to_char(c_cur1_val.SUPPLY_AMT,'999,999,999,999')));
          ls_work_return_data := ls_work_return_data ||':'||ltrim(rtrim(to_char(c_cur1_val.VAT_AMT,'999,999,999,999')));
       end if;

       --, , ( )

       --1
       if ( c_cur1_val.QTY1 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.QTY1_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.QTY1,'999,999,999.999')));
       end if ;

       --2
       if ( c_cur1_val.QTY2 <> 0 ) then

             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.QTY2_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.QTY2,'999,999,999.999')));
       end if ;

       --3
       if ( c_cur1_val.QTY3 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.QTY3_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.QTY3,'999,999,999.999')));
       end if ;

       --1
       if ( c_cur1_val.AMT1 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT1_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT1,'999,999,999,999,999')));
       end if ;


       --2
       if ( c_cur1_val.AMT2 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT2_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT2,'999,999,999,999,999')));
       end if ;

       --3
       if ( c_cur1_val.AMT3 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT3_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT3,'999,999,999,999,999')));
       end if ;

       --4
       if ( c_cur1_val.AMT4 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT4_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT4,'999,999,999,999,999')));

       end if ;

       --5
       if ( c_cur1_val.AMT5 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT5_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT5,'999,999,999,999,999')));
       end if ;

       --6
       if ( c_cur1_val.AMT6 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT6_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT6,'999,999,999,999,999')));
       end if ;

       --1

       if ( c_cur1_val.RATE1 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.RATE1_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.RATE1,'999,999.99')));
       end if ;

       --2
       if ( c_cur1_val.RATE2 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.RATE2_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.RATE2,'999,999.99')));
       end if ;

       --3
       if ( c_cur1_val.RATE3 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.RATE3_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.RATE3,'999,999.99')));
       end if ;


       --1
       if (c_cur1_val.DATE1 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DATE1_NAME||':'||ltrim(rtrim(to_char(to_date(c_cur1_val.DATE1),'yyyy-mm-dd')));
       end if ;

       --2
       if (c_cur1_val.DATE2 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DATE2_NAME||':'||ltrim(rtrim(to_char(to_date(c_cur1_val.DATE2),'yyyy-mm-dd')));
       end if ;

       --3
       if (c_cur1_val.DATE3 is not null) then

             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DATE3_NAME||':'||ltrim(rtrim(to_char(to_date(c_cur1_val.DATE3),'yyyy-mm-dd')));
       end if ;

       --4
       if (c_cur1_val.DATE4 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DATE4_NAME||':'||ltrim(rtrim(to_char(to_date(c_cur1_val.DATE4),'yyyy-mm-dd')));
       end if ;

       --1
       if (c_cur1_val.DESC1 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DESC1_NAME||':'||c_cur1_val.DESC1;
       end if ;


       --2
       if (c_cur1_val.DESC2 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DESC2_NAME||':'||c_cur1_val.DESC2;
       end if ;

       --3
       if (c_cur1_val.DESC3 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DESC3_NAME||':'||c_cur1_val.DESC3;
       end if ;

       --4
       if (c_cur1_val.DESC4 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DESC4_NAME||':'||c_cur1_val.DESC4;

       end if ;

       --5
       if (c_cur1_val.DESC5 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DESC5_NAME||':'||c_cur1_val.DESC5;
       end if ;

    end loop;
    close c_cur1_sql;

    return ls_work_return_data ;
 end;

/





CREATE OR REPLACE FUNCTION          "F_TM_GET_SLIP_NO" (

   AS_COMP VARCHAR2
 , AS_DATE VARCHAR2
 , AN_NO   NUMBER
 )
 Return VARCHAR2 Is
    vReturn VARCHAR2(40);
    vNumber VARCHAR2(10);
 Begin
    If (AS_DATE Is NULL Or AS_DATE = '') Then Return ''; End If;
    vNumber := LTRIM(RTRIM(To_Char(AN_NO, '0000')));
    vReturn := AS_DATE || '-' || vNumber;
    Return vReturn;

 End;

/





CREATE OR REPLACE FUNCTION          "F_TM_GET_WORKITEM_NO" (

   AS_COMP VARCHAR2
 , AS_DATE VARCHAR2
 , AS_DEPT VARCHAR2
 , AN_NO   NUMBER
 , AN_SEQ  NUMBER
 )
 Return VARCHAR2 Is
    vReturn VARCHAR2(40);
    vNumber VARCHAR2(10);
 Begin
    If (AS_DATE Is NULL Or AS_DATE = '') Then Return ''; End If;
    vNumber := LTRIM(RTRIM(To_Char(AN_NO, '0000'))) || '-' || LTRIM(RTRIM(To_Char(AN_SEQ, '000')));

    vReturn := AS_DATE || '-' || LTRIM(RTRIM(AS_DEPT)) || '-' || vNumber;
    Return vReturn;
 End;

/





CREATE OR REPLACE FUNCTION          "F_TM_GET_WORK_NO" (

   AS_COMP VARCHAR2
 , AS_DATE VARCHAR2
 , AS_DEPT VARCHAR2
 , AN_NO   NUMBER
 )
 Return VARCHAR2 Is
    vReturn VARCHAR2(40);
    vNumber VARCHAR2(10);
 Begin
    If (AS_DATE Is NULL Or AS_DATE = '') Then Return ''; End If;
    vNumber := LTRIM(RTRIM(To_Char(AN_NO, '0000')));
    vReturn := AS_DATE || '-' || LTRIM(RTRIM(AS_DEPT)) || '-' || vNumber;

    Return vReturn;
 End;

/





CREATE OR REPLACE FUNCTION             "F_TM_SET_VATAMT" ( ag_amt number

 , ag_len number
 )
 return varchar2 is
    ag_amt_st varchar2(20);
    ag_alpha varchar2(20);
 begin
    if abs(ag_amt  / trunc(ag_amt)) > 1 then
       select lpad(trunc(abs(ag_amt),0),ag_len - 2,'0') ||to_char((abs(ag_amt) - trunc(abs(ag_amt),0))  * 100)
         into ag_amt_st
         from dual
       ;


       if substr(ag_amt_st,ag_len -2 ,1) = '0' then
          ag_alpha := '}';
       elsif substr(ag_amt_st,ag_len -2,1) = '1' then
          ag_alpha := 'J';
       elsif substr(ag_amt_st,ag_len -2,1) = '2' then
          ag_alpha := 'K';
       elsif substr(ag_amt_st,ag_len -2,1) = '3' then
          ag_alpha := 'L';
       elsif substr(ag_amt_st,ag_len -2,1) = '4' then
          ag_alpha := 'M';
       elsif substr(ag_amt_st,ag_len -2,1) = '5' then
          ag_alpha := 'N';
       elsif substr(ag_amt_st,ag_len -2,1) = '6' then

          ag_alpha := 'O';
       elsif substr(ag_amt_st,ag_len -2,1) = '7' then
          ag_alpha := 'P' ;
       elsif substr(ag_amt_st,ag_len -2,1) = '8' then
          ag_alpha := 'Q';
       elsif substr(ag_amt_st,ag_len -2,1) = '9' then
          ag_alpha := 'R';
       end if;

       select substr(ag_amt_st,1,ag_len -3) ||ag_alpha||substr(ag_amt_st,ag_len -1,2)
         into ag_amt_st
         from dual
       ;

    else
       select lpad(trim(to_char(abs(ag_amt ))),ag_len,'0')
         into ag_amt_st
         from dual
       ;

       if substr(ag_amt_st,ag_len  ,1) = '0' then
          ag_alpha :='}' ;
       elsif substr(ag_amt_st,ag_len ,1) = '1' then
          ag_alpha :='J';
       elsif substr(ag_amt_st,ag_len ,1) = '2' then
          ag_alpha :='K';
       elsif substr(ag_amt_st,ag_len ,1) = '3' then

          ag_alpha :='L';
       elsif substr(ag_amt_st,ag_len ,1) = '4' then
          ag_alpha :='M';
       elsif substr(ag_amt_st,ag_len ,1) = '5' then
          ag_alpha :='N';
       elsif substr(ag_amt_st,ag_len ,1) = '6' then
          ag_alpha :='O';
       elsif substr(ag_amt_st,ag_len ,1) = '7' then
          ag_alpha :='P' ;
       elsif substr(ag_amt_st,ag_len ,1) = '8' then
          ag_alpha :='Q';
       elsif substr(ag_amt_st,ag_len ,1) = '9' then
          ag_alpha :='R';

       end if ;

       select substr(ag_amt_st,1,ag_len -1) ||ag_alpha
         into ag_amt_st
         from dual
       ;
    end if;
    return ag_amt_st;
 end;

/





CREATE OR REPLACE FUNCTION          "F_AM_GET_BASEDATE"  ( av_comp varchar2 )

 return varchar2 is
    lv_base_date varchar2(8);
 begin
    --   .
    select am_s_date
      into lv_base_date
      from sm_code_company
     where company_code = av_comp
    ;
    return lv_base_date;
 end;

/





CREATE OR REPLACE FUNCTION          "F_AM_GET_BASEMONTH"  ( av_comp varchar2

 , av_date varchar2
 )
 return varchar2 is
    lv_date   varchar2(8);
    lv_base_m varchar2(2);
    lv_base_y varchar2(4);
 begin
    --  .
    select am_start_month
      into lv_base_m
      from sm_code_company
     where company_code = av_comp

    ;
    lv_date := substr(av_date || '0101', 1, 8);
    lv_base_y := substr(lv_date, 1, 4);
    if (lv_date < lv_base_y || lv_base_m || '01') then
       lv_base_y := to_char(lv_base_y - 1);
    end if;
    return lv_base_y || lv_base_m;
 end;

/





CREATE OR REPLACE FUNCTION          "F_AM_GET_BASEMONTHTO"  ( av_comp varchar2

 , av_date varchar2
 )
 return varchar2 is
    lv_date   varchar2(8);
    lv_base_m varchar2(2);
    lv_base_y varchar2(4);
 begin
    --  .
    select am_start_month
      into lv_base_m
      from sm_code_company
     where company_code = av_comp

    ;
    lv_date := substr(av_date || '0101', 1, 8);
    lv_base_y := substr(lv_date, 1, 4);
    if (lv_date < lv_base_y || lv_base_m || '01') then
       lv_base_y := to_char(lv_base_y - 1);
    end if;
    return To_Char(Add_Months(To_Date(lv_base_y || lv_base_m || '01'), 11), 'yyyymmdd');
 end;

/





CREATE OR REPLACE FUNCTION          "F_AM_GET_BASEYEAR"   ( av_comp varchar2

 , av_date varchar2
 )
 return varchar2 is
    lv_date   varchar2(8);
    lv_base_m varchar2(2);
    lv_base_y varchar2(4);
 begin
    --  .
    select am_start_month
      into lv_base_m
      from sm_code_company
     where company_code = av_comp

    ;
    lv_date := substr(av_date || '0101', 1, 8);
    lv_base_y := substr(lv_date, 1, 4);
    if (lv_date < lv_base_y || lv_base_m || '01') then
       lv_base_y := to_char(lv_base_y - 1);
    end if;
    return lv_base_y;
 end;

/





CREATE OR REPLACE FUNCTION "F_AM_GET_COMMI_FIRSTDELAYDATE"

 	   ( av_date VARCHAR2,          --
 	     av_contract_code VARCHAR2, --
 		 av_comp_code VARCHAR2,     --
 		 av_dept_code VARCHAR2,     --
 		 an_change_order NUMBER,    --
 		 av_acnt_code VARCHAR2 )    --
 RETURN VARCHAR2 IS
    ln_remain_amt NUMBER;
    lv_date VARCHAR2(9);
 BEGIN
    --      .


    SELECT SUM(b.dr_amt) - SUM(b.cr_amt)
      INTO ln_remain_amt
      FROM am_slip_detail a,
 	 	  ( SELECT a.work_comp,
 		  		   a.set_work_date,
 				   a.set_work_no,
 				   a.set_work_seq,
 				   a.dr_amt,
 				   a.cr_amt
 			  FROM am_slip_dc a,
 			  	   am_slip_detail b
 			 WHERE a.work_comp = b.work_comp AND
 			 	   a.work_date = b.work_date AND

 				   a.work_no = b.work_no AND
 				   a.work_seq = b.work_seq AND
 				   b.slip_date <= av_date AND
 				   a.slip_yyyy = SUBSTR(av_date, 1, 4)) b
 	WHERE a.work_comp = b.work_comp AND
 		  a.work_date = b.set_work_date AND
 		  a.work_no = b.set_work_no AND
 		  a.work_seq = b.set_work_seq AND
 		  a.work_comp = av_comp_code AND
 		  a.proj_code = av_dept_code AND
 		  a.desc1 = av_acnt_code AND
 		  a.slip_date <= av_date AND
 		  a.acnt_code IN (SELECT acnt_code

 		  			  	    FROM am_code_calc_acnt
 						   WHERE calc_kind_code = '000' AND
 						   		 calc_list_code = '10110102');

    IF NVL(ln_remain_amt, 0) > 0 THEN --     
    	  SELECT MAX(agree_date)
 	    INTO lv_date
  	    FROM ( SELECT a.agree_date,
 			   		  a.agree_amt,
 					  SUM(b.agree_amt) cum_agree_amount
 			     FROM MM_COMM_AGREEMENT a,
 	 			 	  MM_COMM_AGREEMENT b
 			    WHERE a.contract_code = av_contract_code AND

 	  				  a.change_order = an_change_order AND
 	  				  a.contract_code = b.contract_code AND
 					  a.change_order = b.change_order AND
 	  				  a.agree_date <= b.agree_date AND
 					  a.agree_date <= av_date
 			 GROUP BY a.agree_date, a.agree_amt)
 	   WHERE cum_agree_amount >= ln_remain_amt;
    ELSE --     
    	  SELECT MIN(agree_date)
 	    INTO lv_date
 	    FROM ( SELECT a.agree_order,
 			   		  a.agree_date,
 					  a.agree_amt - NVL(SUM(CASE WHEN b.slip_date <= av_date THEN receipt_amt ELSE 0 END), 0)

 			     FROM MM_COMM_AGREEMENT a,
 	 			 	  MM_COMM_RECEIPT b
 				WHERE a.contract_code = b.contract_code(+) AND
 	  				  a.change_order = b.change_order(+) AND
 	  				  a.agree_order = b.agree_order(+) AND
 	  				  a.contract_code = av_contract_code AND
 	  				  a.change_order = an_change_order AND
 					  a.agree_date <= av_date
 			 GROUP BY a.agree_order,
 			 	   	  a.agree_date,
 					  a.agree_amt
 			   HAVING a.agree_amt - NVL(SUM(CASE WHEN b.slip_date <= av_date THEN receipt_amt ELSE 0 END), 0) > 0 );
    END IF;


    RETURN TO_CHAR(lv_date);
 END;

/





CREATE OR REPLACE FUNCTION "F_AM_GET_DECISION_STATUS" (

   AS_Check VARCHAR2
 , AS_Appr  VARCHAR2
 , AS_Decision   VARCHAR2
 )
 Return VARCHAR2 Is
    
 Begin
 
    if (AS_Check = '0') then return '01'; end if;
	if (AS_Check = '1' ) then 
	  if (AS_appr is null or  AS_appr = '9') then return '02'; end if;
	  if (AS_appr = 'Y' and  (AS_Decision  is null or AS_Decision = '9')) then return '03'; end if;
	  if (AS_appr = 'N' and  (AS_Decision  is null or AS_Decision = '9')) then return '04'; end if;
	  if (AS_appr = 'Z' and  (AS_Decision  is null or AS_Decision = '9')) then return '07'; end if;
	  if (AS_appr = 'Y' and  ( AS_Decision = 'N')) then return '09'; end if;
	elsif (AS_Check = '2' ) then 
      if (AS_appr = 'Y' and  (AS_Decision  is null or AS_Decision = '9')) then return '05'; end if;
	  if (AS_appr = 'Y' and  ( AS_Decision = 'Y')) then return '08'; end if;
	  return '05';  
	end if;
	return '01';  
 End;

/





CREATE OR REPLACE FUNCTION "F_AM_GET_DEPOSIT_ETCCOM"   ( av_deposit_no varchar2, av_seq number, av_com_yn varchar2 )

 return varchar2 is
    lv_com_name  varchar2(60);
 begin
    --
    if av_com_yn = 'N' then
    	  return '';
    end if;

    select com_name
      into lv_com_name
      from ( select com_name,
 	 	  		   rownum as row_num

 	 	  	  from tm_code_deposit_etccom
 			 where deposit_no = av_deposit_no
 		  order by com_name) a
     where row_num = av_seq
    ;

    return lv_com_name;
 end;

/





CREATE OR REPLACE FUNCTION          "F_AM_GET_SLIPITEM_NO" (

   AS_COMP VARCHAR2
 , AS_DATE VARCHAR2
 , AN_NO   NUMBER
 , AN_SEQ  NUMBER
 )
 Return VARCHAR2 Is
    vReturn VARCHAR2(40);
    vNumber VARCHAR2(10);
 Begin
    If (AS_DATE Is NULL Or AS_DATE = '') Then Return ''; End If;
    vNumber := LTRIM(RTRIM(To_Char(AN_NO, '0000'))) || '-' || LTRIM(RTRIM(To_Char(AN_SEQ, '000')));
    vReturn := AS_DATE || '-' || vNumber;

    Return vReturn;
 End;

/





CREATE OR REPLACE FUNCTION      "F_AM_GET_ESTABLISH_SLIPNO" ( av_comp varchar2

 , ad_date varchar2
 , an_no number
 , an_seq number
 )
 --  =  +  + 
 return varchar2 is
    cursor c_cur1_sql is
       select b.slip_date
            , b.slip_no
            , b.work_seq_scr
         from am_slip_dc a
            , am_slip_detail b

        where a.slip_yyyy = substr(ad_date,1,4)
          and a.work_comp = av_comp
          and a.work_date = ad_date
          and a.work_no = an_no
          and a.work_seq = an_seq
          and a.work_comp = b.work_comp
          and b.work_date = a.set_work_date
          and b.work_no = a.set_work_no
          and b.work_seq = a.set_work_seq
    ;
    c_cur1_val c_cur1_sql%ROWTYPE;
    lv_return varchar2(4000);
 begin

    lv_return := '';

    OPEN c_cur1_sql;
    loop
       fetch c_cur1_sql into c_cur1_val;
       exit when c_cur1_sql%notfound;

       if( c_cur1_val.slip_date <> '' or c_cur1_val.slip_date is not null ) then
          if ( lv_return = '' or lv_return is null) then
             lv_return := f_am_get_slipitem_no(av_comp, c_cur1_val.slip_date, c_cur1_val.slip_no, c_cur1_val.work_seq_scr);
          else
             lv_return := lv_return || ',' ||  f_am_get_slipitem_no(av_comp, c_cur1_val.slip_date, c_cur1_val.slip_no, c_cur1_val.work_seq_scr);
          end if;

       end if;
    end loop;
    close c_cur1_sql;

    return lv_return;
 end;

/





CREATE OR REPLACE FUNCTION      "F_AM_GET_SLIPMNG" ( av_comp varchar2

 , ad_date varchar2
 , an_no number
 , an_seq number
 )
 return varchar2 is
    cursor c_cur1_sql is
       select decode( workd.dr_amt ,0 ,'2', '1') as SLIP_DRCR                              --
            , acnt.BOND_YN                                                                 --
            , acnt.MONTH_COST_YN                                                           --
            , acnt.ADJUSTED_DRCR                                                           --
            , nvl(workd.BANK_CODE,'') as BANK_CODE                                         --
            , nvl(bank.BANK_NAME, workd.BANK_CODE ) as BANK_NAME                           --

            , nvl(workd.DEPOSIT_NO, '') as DEPOSIT_NO                                      --
            , nvl(workd.CHECK_NO, '') as CHECK_NO                                          --
            , nvl(workd.BILL_NO, '') as BILL_NO                                            --
            , nvl(workd.BILL_R_NO, '') as BILL_R_NO                                        --
            , nvl(workd.LOAN_NO, '') as LOAN_NO                                            --
            , nvl(workd.STCK_CODE, '') as STCK_CODE                                        --
            , nvl(workd.FA_NO,'') as FA_NO                                                 --
            , nvl(asst.FA_NAME, workd.FA_NO) as FA_NAME                                    --
            , nvl(workd.CD_CARD_NO,'') as CD_CARD_NO                                       --
            , decode(decode(acnt.emp_no_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.USER_ID,''), '') as  USER_ID                                            --
            , decode(decode(acnt.emp_no_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(pers.USER_NAME, workd.USER_ID), '') as EMP_NAME                                --
            , nvl(workd.INCOME_CODE, '') as INCOME_CODE                                    --
            , nvl(incm.INCOME_NAME, workd.INCOME_CODE ) as   INCOME_NAME                   --

            , nvl(workd.PHONE, '') as PHONE                                                --
            , nvl(workd.SALES_DIV, '') as SALES_DIV                                        --
            , nvl(val44.VALID_VALUE_NAME, workd.SALES_DIV ) as  SALES_NAME                 --
            , nvl(workd.EVIDENCE_CODE, '') as EVIDENCE_CODE                                --
            , nvl(evid.EVIDENCE_NAME, workd.EVIDENCE_CODE ) as EVIDENCE_NAME               --
            , decode( workd.DR_VAT ,0 ,workd.CR_VAT, workd.DR_VAT) as VAT_AMT              --
            , decode( workd.DR_SUPPLY ,0 ,workd.CR_SUPPLY,workd.DR_SUPPLY) as SUPPLY_AMT   --
            , acnt.QTY1_NAME
            , decode(decode(acnt.QTY1_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.QTY1,0), 0) as QTY1
            , acnt.QTY2_NAME
            , decode(decode(acnt.QTY2_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.QTY2,0), 0) as QTY2
            , acnt.QTY3_NAME
            , decode(decode(acnt.QTY3_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.QTY3,0), 0) as QTY3

            , acnt.AMT1_NAME
            , decode(decode(acnt.AMT1_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT1,0), 0) as AMT1
            , acnt.AMT2_NAME
            , decode(decode(acnt.AMT2_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT2,0), 0) as AMT2
            , acnt.AMT3_NAME
            , decode(decode(acnt.AMT3_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT3,0), 0) as AMT3
            , acnt.AMT4_NAME
            , decode(decode(acnt.AMT4_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT4,0), 0) as AMT4
            , acnt.AMT5_NAME
            , decode(decode(acnt.AMT5_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT5,0), 0) as AMT5
            , acnt.AMT6_NAME
            , decode(decode(acnt.AMT6_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT6,0), 0) as AMT6
            , acnt.RATE1_NAME

            , decode(decode(acnt.RATE1_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.RATE1,0), 0) as RATE1
            , acnt.RATE2_NAME
            , decode(decode(acnt.RATE2_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.RATE2,0), 0) as RATE2
            , acnt.RATE3_NAME
            , decode(decode(acnt.RATE3_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.RATE3,0), 0) as RATE3
            , acnt.DATE1_NAME
            , decode(decode(acnt.DATE1_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(replace(workd.DATE1,' '),''), '') AS DATE1
            , acnt.DATE2_NAME
            , decode(decode(acnt.DATE2_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(replace(workd.DATE2,' '),''), '') AS DATE2
            , acnt.DATE3_NAME
            , decode(decode(acnt.DATE3_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(replace(workd.DATE3,' '),''), '') AS DATE3
            , acnt.DATE4_NAME
            , decode(decode(acnt.DATE4_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(replace(workd.DATE4,' '),''), '') AS DATE4

            , acnt.DESC1_NAME
            , decode(decode(acnt.DESC1_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DESC1,''), '') as DESC1
            , acnt.DESC2_NAME
            , decode(decode(acnt.DESC2_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DESC2,''), '') as DESC2
            , acnt.DESC3_NAME
            , decode(decode(acnt.DESC3_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DESC3,''), '') as DESC3
            , acnt.DESC4_NAME
            , decode(decode(acnt.DESC4_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DESC4,''), '') as DESC4
            , acnt.DESC5_NAME
            , decode(decode(acnt.DESC5_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DESC5,''), '') as DESC5
			, decode(acnt.PROJ_YN, NULL,'',workd.proj_code)  AS PROJ_CODE
			, proj.proj_name  AS PROJ_NAME
			 , decode(substr(nvl(workd.etax_div,'A2'),2,1), '1', '()', '()')  etax_div 
         from am_slip_detail workd
            , am_code_acnt acnt
            , AM_CODE_BANK bank
            , sm_code_project proj
            , am_asst_master asst
            , SM_AUTH_USER pers
            , AM_CODE_INCOME incm
            , AM_CODE_VALIDATION val44
            , am_code_evidence evid
        where workd.acnt_code = acnt.acnt_code
          and workd.BANK_CODE = bank.BANK_CODE (+)
          and workd.COMPANY_CODE = asst.COMPANY_CODE (+)
          and workd.FA_NO = asst.FA_NO (+)
          and workd.USER_ID = pers.USER_ID (+)
          and workd.INCOME_CODE = incm.INCOME_CODE (+)
          and val44.VALIDATION_CODE (+)= '44'
          and workd.SALES_DIV = val44.VALID_VALUE_CODE (+)
          and workd.EVIDENCE_CODE = evid.EVIDENCE_CODE (+)
		  and workd.PROJ_CODE = proj.proj_code(+)
          and workd.WORK_COMP = av_comp
          and workd.WORK_DATE = ad_date
          and workd.WORK_NO = an_no
          and workd.WORK_SEQ = an_seq
    ;
    c_cur1_val c_cur1_sql%ROWTYPE ;
    ls_give_name varchar2(30);
    ls_give_depositor varchar2(100);
    ls_work_return_data varchar2(4000);
 begin
    open c_cur1_sql;
    loop

       fetch c_cur1_sql into c_cur1_val;
       exit when c_cur1_sql%notfound;

       --  
       if ( c_cur1_val.BOND_YN = 'Y' ) THEN
          --  /  
          if ( c_cur1_val.SLIP_DRCR <> c_cur1_val.ADJUSTED_DRCR ) then
             ls_work_return_data := F_AM_GET_ESTABLISH_SLIPNO(av_comp, ad_date, an_no, an_seq  );
             if (ls_work_return_data is not null) then
                ls_work_return_data := ':' || ls_work_return_data ;
             end if;
 /*         else
                begin

                select
                   valam.valid_value_name
                   , F_AM_GET_SLIP_BANKDESC(supp.work_comp, supp.work_date, supp.work_no, supp.work_seq, supp.supply_seq) as give_deposit
                into
                   ls_give_name
                   , ls_give_depositor
                from
                   am_slip_supply supp
                   , am_code_validation valam
                   , (
                      select
                         work_date
                         , work_no

                         , work_seq
                         , min(supply_seq) as supply_seq
                      from
                         am_slip_supply
                      where
                            work_comp = av_comp
                         and work_date = ad_date
                         and work_no = an_no
                         and work_seq = an_seq
                      group by
                         work_date
                         , work_no
                         , work_seq

                      ) mins
                where
                   supp.work_date = mins.work_date
                   and supp.work_no = mins.work_no
                   and supp.work_seq = mins.work_seq
                   and supp.supply_seq = mins.supply_seq
                   and supp.acnt_code = valam.valid_value_level
                   and valam.validation_code = '39'
                ;
             --
             exception
                when no_data_found then ls_give_name := null ;
             end;

             --
             if (ls_give_name is not null) then
                ls_work_return_data := ':'||'['||ls_give_name||']' ;
                --
                if ls_give_depositor is not null then
                   ls_work_return_data := ls_work_return_data ||'=> '||ls_give_depositor ;
                end if ;
             end if ;
 */         end if;
       end if;

       --
       if (c_cur1_val.BANK_CODE is not null) then

          ls_work_return_data := ls_work_return_data ||':'|| c_cur1_val.BANK_NAME ;
       end if;

       --
       if (c_cur1_val.DEPOSIT_NO is not null) then
          ls_work_return_data := ls_work_return_data ||':'|| c_cur1_val.DEPOSIT_NO;
       end if;

       --
       if (c_cur1_val.CHECK_NO is not null ) then
          ls_work_return_data := ls_work_return_data ||':'|| c_cur1_val.CHECK_NO;
       end if ;


       --
       if (c_cur1_val.BILL_NO is not null ) then
          ls_work_return_data := ls_work_return_data ||':'|| c_cur1_val.BILL_NO;
       end if ;
       --
       --
       if (c_cur1_val.BILL_R_NO is not null ) then
          ls_work_return_data := ls_work_return_data ||':'|| c_cur1_val.BILL_R_NO;
       end if ;

       --
       if (c_cur1_val.LOAN_NO is not null) then
          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.LOAN_NO;

       end if ;
       --
       --
       if (c_cur1_val.STCK_CODE is not null ) then
          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.STCK_CODE;
       end if ;

       --
       if (c_cur1_val.FA_NO is not null) then
          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.FA_NAME;
       end if ;

       --

       if (c_cur1_val.CD_CARD_NO is not null) then
          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.CD_CARD_NO;
       end if ;

       --
       if (c_cur1_val.USER_ID is not null) then
          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.EMP_NAME;
       end if ;

       --
       if (c_cur1_val.INCOME_CODE is not null) then
          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.INCOME_NAME;
       end if ;


       --
       if (c_cur1_val.PHONE is not null) then
          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.PHONE;
       end if ;

       --
       --if (c_cur1_val.SALES_DIV is not null) then
       --   ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.SALES_NAME;
       --end if;

       --
       if (c_cur1_val.EVIDENCE_CODE is not null) then

          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.EVIDENCE_NAME||'('||c_cur1_val.EVIDENCE_CODE||')';
          ls_work_return_data := ls_work_return_data ||':'||ltrim(rtrim(to_char(c_cur1_val.SUPPLY_AMT,'999,999,999,999')));
          ls_work_return_data := ls_work_return_data ||':'||ltrim(rtrim(to_char(c_cur1_val.VAT_AMT,'999,999,999,999')));
          ls_work_return_data := ls_work_return_data ||':'|| c_cur1_val.etax_div;
	   end if;

       --, , ( )

       --1
       if ( c_cur1_val.QTY1 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.QTY1_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.QTY1,'999,999,999.999')));
       end if ;

       --2

       if ( c_cur1_val.QTY2 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.QTY2_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.QTY2,'999,999,999.999')));
       end if ;

       --3
       if ( c_cur1_val.QTY3 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.QTY3_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.QTY3,'999,999,999.999')));
       end if ;

       --1
       if ( c_cur1_val.AMT1 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT1_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT1,'999,999,999,999,999')));
       end if ;


       --2
       if ( c_cur1_val.AMT2 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT2_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT2,'999,999,999,999,999')));
       end if ;

       --3
       if ( c_cur1_val.AMT3 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT3_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT3,'999,999,999,999,999')));
       end if ;

       --4
       if ( c_cur1_val.AMT4 <> 0 ) then

             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT4_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT4,'999,999,999,999,999')));
       end if ;

       --5
       if ( c_cur1_val.AMT5 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT5_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT5,'999,999,999,999,999')));
       end if ;

       --6
       if ( c_cur1_val.AMT6 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT6_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT6,'999,999,999,999,999')));
       end if ;


       --1
       if ( c_cur1_val.RATE1 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.RATE1_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.RATE1,'999,999.99')));
       end if ;

       --2
       if ( c_cur1_val.RATE2 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.RATE2_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.RATE2,'999,999.99')));
       end if ;

       --3
       if ( c_cur1_val.RATE3 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.RATE3_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.RATE3,'999,999.99')));

       end if ;

       --1
       if (c_cur1_val.DATE1 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DATE1_NAME||':'||ltrim(rtrim(to_char(to_date(c_cur1_val.DATE1),'yyyy-mm-dd')));
       end if ;

       --2
       if (c_cur1_val.DATE2 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DATE2_NAME||':'||ltrim(rtrim(to_char(to_date(c_cur1_val.DATE2),'yyyy-mm-dd')));
       end if ;

       --3

       if (c_cur1_val.DATE3 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DATE3_NAME||':'||ltrim(rtrim(to_char(to_date(c_cur1_val.DATE3),'yyyy-mm-dd')));
       end if ;

       --4
       if (c_cur1_val.DATE4 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DATE4_NAME||':'||ltrim(rtrim(to_char(to_date(c_cur1_val.DATE4),'yyyy-mm-dd')));
       end if ;

       --1
       if (c_cur1_val.DESC1 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DESC1_NAME||':'||c_cur1_val.DESC1;
       end if ;


       --2
       if (c_cur1_val.DESC2 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DESC2_NAME||':'||c_cur1_val.DESC2;
       end if ;

       --3
       if (c_cur1_val.DESC3 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DESC3_NAME||':'||c_cur1_val.DESC3;
       end if ;

       --4
       if (c_cur1_val.DESC4 is not null) then

             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DESC4_NAME||':'||c_cur1_val.DESC4;
       end if ;

       --5
       if (c_cur1_val.DESC5 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DESC5_NAME||':'||c_cur1_val.DESC5;
       end if ;
	   
	   if (c_cur1_val.PROJ_CODE is not null) then
             ls_work_return_data := ls_work_return_data ||':('||c_cur1_val.PROJ_CODE||')'||c_cur1_val.PROJ_NAME;
       end if ;

    end loop;
    close c_cur1_sql;

    return ls_work_return_data ;
 end;

/





CREATE OR REPLACE FUNCTION "F_HR_YETA_SELF_CHK" (

   as_workyear VARCHAR2,
   as_empno  VARCHAR2, --emp_no
   as_rrn    VARCHAR2,
   as_div    VARCHAR2 --  
   ) RETURN VARCHAR2
 AS

  ls_insu  VARCHAR2(20);
  ls_medi  VARCHAR2(20);
  ls_edu  VARCHAR2(20);
  ls_credit  VARCHAR2(20);
  ls_delivery  VARCHAR2(20);
  ls_cont  VARCHAR2(20);

 BEGIN

 BEGIN
  select insu_yn, medi_yn, edu_yn, credit_yn, delivery_yn, cont_yn
    into ls_insu, ls_medi, ls_edu, ls_credit, ls_delivery, ls_cont
    from HR_YETA_SELF 
   where work_year = as_workyear
     and mta_yn    = 'N' 
     and emp_no    = as_empno 
     and rrn       = as_rrn
     and item_code like 'AA%';
     
  EXCEPTION
    WHEN NO_DATA_FOUND THEN
    RETURN SQLCODE || ':' || SQLERRM ;
 END;

   IF as_div = 'insu' then
      if ls_insu = 'Y' then
      return '';
   else
      return SQLCODE || ':' || SQLERRM ;
   end if;
   ELSIF as_div = 'medi' then
      if ls_medi = 'Y' then
      return '';
   else
      return SQLCODE || ':' || SQLERRM ;
   end if;
   ELSIF as_div = 'edu' then
      if ls_edu = 'Y' then
      return '';
   else
      return SQLCODE || ':' || SQLERRM ;
   end if;
   ELSIF as_div = 'credit' then
      if ls_credit = 'Y' then
      return '';
   else
      return SQLCODE || ':' || SQLERRM ;
   end if;
   ELSIF as_div = 'deliverny' then
      if ls_delivery = 'Y' then
      return '';
   else
      return SQLCODE || ':' || SQLERRM ;
   end if;
   ELSIF as_div = 'cont' then
      if ls_cont = 'Y' then
      return '';
   else
      return SQLCODE || ':' || SQLERRM ;
   end if;
   END IF;   

  exception
    when others then
      return SQLCODE || ':' || SQLERRM ;
   
 END;

/





CREATE OR REPLACE FUNCTION "F_HR_YETA_SELF_FAMILY" (

   as_workyear VARCHAR2,
   as_empno  VARCHAR2, --emp_no
   as_rrn    VARCHAR2  
   ) RETURN VARCHAR2
 AS

ln_cnt  NUMBER;

BEGIN

   BEGIN
      select count(*)
        into ln_cnt
        from HR_YETA_SELF 
       where work_year = as_workyear
         and mta_yn    = 'N' 
         and emp_no    = as_empno 
         and rrn       = as_rrn
         and item_code like 'AA%';

   EXCEPTION
        WHEN NO_DATA_FOUND THEN
           RETURN '-'||SQLCODE || ':' || SQLERRM ;
   END;
   
   IF ln_cnt != 0 THEN 
      RETURN '';
   ELSE
      RETURN '   . .'||as_rrn ;
   END IF;    
END;

/





CREATE OR REPLACE FUNCTION "F_HR_YETA_SELF_FAMILY_BASIC" (

   as_workyear VARCHAR2,
   as_empno  VARCHAR2, --emp_no
   as_rrn    VARCHAR2  
   ) RETURN VARCHAR2
 AS

ln_cnt  NUMBER;

BEGIN

   BEGIN
      select count(*)
        into ln_cnt
        from HR_YETA_SELF 
       where work_year = as_workyear
         and mta_yn    = 'N' 
         and emp_no    = as_empno 
         and rrn       = as_rrn
         and item_code like 'AA%'
         and basic_yn = 'Y';

   EXCEPTION
        WHEN NO_DATA_FOUND THEN
           RETURN '()-'||SQLCODE || ':' || SQLERRM || ':' || as_rrn ;
   END;
   
   IF ln_cnt != 0 THEN 
      RETURN '';
   ELSE
      RETURN as_rrn||'  . .';
   END IF;    
END;

/





CREATE OR REPLACE FUNCTION "F_HR_YETA_SELF_SPECIAL_CHK" (

   as_workyear VARCHAR2,
   as_empno  VARCHAR2, --emp_no
   as_rrn    VARCHAR2,
   as_div    VARCHAR2 --  
   ) RETURN VARCHAR2
 AS

  ls_insu  VARCHAR2(20);
  ls_medi  VARCHAR2(20);
  ls_edu  VARCHAR2(20);
  ls_credit  VARCHAR2(20);
  ls_delivery  VARCHAR2(20);
  ls_cont  VARCHAR2(20);

 BEGIN

 BEGIN
  select insu_yn, medi_yn, edu_yn, credit_yn, delivery_yn, cont_yn
    into ls_insu, ls_medi, ls_edu, ls_credit, ls_delivery, ls_cont
    from HR_YETA_SELF 
   where work_year = as_workyear
     and mta_yn    = 'N' 
     and emp_no    = as_empno 
     and rrn       = as_rrn
     and item_code like 'AA%';
     
  EXCEPTION
    WHEN NO_DATA_FOUND THEN
    RETURN SQLCODE || ':' || SQLERRM ;
 END;

   IF as_div = 'insu' then
      if ls_insu = 'Y' then
      return '';
   else
      return ' .';
   end if;
   ELSIF as_div = 'medi' then
      if ls_medi = 'Y' then
      return '';
   else
      return ' .';
   end if;
   ELSIF as_div = 'edu' then
      if ls_edu = 'Y' then
      return '';
   else
      return '  .';
   end if;
   ELSIF as_div = 'credit' then
      if ls_credit = 'Y' then
      return '';
   else
      return '  .';
   end if;
   ELSIF as_div = 'deliverny' then
      if ls_delivery = 'Y' then
      return '';
   else
      return '   .';
   end if;
   ELSIF as_div = 'cont' then
      if ls_cont = 'Y' then
      return '';
   else
      return '  .';
   end if;
   END IF;   

  exception
    when others then
      return SQLCODE || ':' || SQLERRM ;
   
 END;

/





CREATE  OR REPLACE  FUNCTION F_HR_YETA_FUND

 ( 
  as_comp     IN VARCHAR2,
  as_workyear IN VARCHAR2,
  as_empno    IN VARCHAR2,
  as_sdate    IN VARCHAR2,
  as_code     IN VARCHAR2,
  as_businame IN VARCHAR2, 
  as_deposit  IN VARCHAR2,
  as_fund     IN VARCHAR2, 
  as_bank     IN VARCHAR2,
  as_date     IN VARCHAR2, --
  as_year     IN VARCHAR2,--
  an_amt1     IN NUMBER, --
  an_amt2     IN NUMBER, --
  an_amt      IN NUMBER, 
  as_userid   IN VARCHAR2
) RETURN VARCHAR2 IS

vCnt        NUMBER;
ls_value    VARCHAR2(500);
ls_type     VARCHAR2(2);
ld_deduct   NUMBER;
pragma autonomous_transaction;
-------------------------------------------------------------
 /** **/
-------------------------------------------------------------
BEGIN
 

   IF as_code = 'G0016' THEN --
      ld_deduct := an_amt * 0.4;
      ls_type   := '05';
   ELSIF as_code = 'G0017' THEN --
--    15 (07) : 200312.31   600 
--    15-30 (08) : 2012.01.01  , 2009.2.12~2010.2.11    5
--    30(09) : 2012.01.01
--2012
--    (14) : 2012.01.01
--    (15) :2012.01.01
--2015
--15 and  (16)
--15 OR  (17)
--15  (18)
--10~15  (19)
        if as_date < '20120101' then
            if as_year < 15 then
                if as_date < '20040101' then
                    ls_type   := '07';
                else 
                    return'';
                end if;
            elsif as_year < 30 then
                ls_type := '08';
            else
                ls_type := '09';
            end if;
        elsif as_date >= '20150101' then  -- 16,17,18,19
            if as_year >= 15 then
                if an_amt1 > 0 and an_amt2 > 0 then   --    
                    ls_type := '16';
                elsif  an_amt1 > 0 or an_amt2 > 0 then                  
                    ls_type := '17';
                else
                    ls_type := '18';
                end if;
            else
                if as_year >= 10 then
                   if  an_amt1 > 0 or an_amt2 > 0 then
                      ls_type := 19;
                   else
                      return '';
                   end if;
                else
                   return '';
                end if;
            end if;
                
        else  --2012 
            if as_year >= 15 then
                if an_amt1 > 0 or an_amt2 > 0 then   --    
                    ls_type := '14';
                else
                    ls_type := '15';
                end if;
            else
                return '';  
            end if;
        end if;
       ld_deduct := an_amt;
   ELSIF as_code = 'G0018' THEN
    IF as_fund = '1' OR as_fund = '2' THEN  -- 
       begin
       select least(an_amt,2400000) * 0.4, decode(as_fund, '1', '02', '12') 
         into ld_deduct, ls_type
         from dual;
       end;
    END IF;
   ELSIF as_code = 'G0029' THEN
       ls_type := '20';
       select least(an_amt,6000000) * 0.4 
         into ld_deduct
         from dual;
   END IF;
   
       
   BEGIN
      INSERT INTO HR_YETA_FUND
           SELECT as_comp,        as_workyear,    'N',          as_empno,     as_sdate, 
                  NVL(MAX(SEQ),0) + 1, 
                  ls_type,     an_amt,         as_userid,    to_char(sysdate,'yyyymmddhh24miss'), null, null,
                  decode(as_code, 'G0018', as_bank,     'G0029', as_bank,     NULL),
                  decode(as_code, 'G0018', as_businame, 'G0029', as_businame, NULL),
                  decode(as_code, 'G0018', as_deposit,  'G0029', as_deposit,  NULL),   
                  ld_deduct, 
                  'Y',
                  NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, DECODE(as_code, 'G0018', as_date, NULL) --  2015.12.24      
             FROM HR_YETA_FUND
            where company_code = as_comp
              and work_year    = as_workyear
              and mta_yn       = 'N'
              and emp_no       = as_empno
              and work_sdate   = as_sdate;
       commit;
    return '';
   exception
    when others then
   rollback;
      --RAISE_APPLICATION_ERROR( -20001,  SQLCODE || ':' || SQLERRM );
      return ' : '|| SQLCODE || ':' || SQLERRM ;
     
   END;
END;

/





CREATE  OR REPLACE  FUNCTION F_HR_YETA_INSURANCE

 ( 
  as_comp     IN VARCHAR2,
  as_workyear IN VARCHAR2,
  as_empno    IN VARCHAR2,
  as_sdate    IN VARCHAR2,
  as_rrn      IN VARCHAR2,
  as_code     IN VARCHAR2,
  an_amt      IN NUMBER,
  as_userid   IN VARCHAR2
) RETURN VARCHAR2 IS

vCnt       NUMBER;
ls_value   VARCHAR2(500);

pragma autonomous_transaction;
-------------------------------------------------------------
 /** **/
 -- ? 
 -- ? 
 -- ?    
-------------------------------------------------------------
BEGIN
--    /** **/
--    BEGIN
--       select F_HR_YETA_SELF_FAMILY(as_workyear, as_empno, as_rrn)
--         into ls_value
--         from dual;
--    END;
-- 
--    if ls_value != '' then
--       RAISE_APPLICATION_ERROR( -20001,  ls_value );
--       return ls_value;
--    end if; 

   /** **/
   BEGIN
      select F_HR_YETA_SELF_FAMILY_BASIC(as_workyear, as_empno, as_rrn)
        into ls_value
        from dual;
   END;

   if ls_value is not null then
--      RAISE_APPLICATION_ERROR( -20001,  ls_value );
--      return '[]'|| ls_value;
   return '';
   end if; 

   
   /**   **/
   BEGIN
      select F_HR_YETA_SELF_SPECIAL_CHK(as_workyear, as_empno, as_rrn, 'insu')
        into ls_value
        from dual;
   END;

   if ls_value is not null then
--      RAISE_APPLICATION_ERROR( -20001,  ls_value );
--      return ls_value;
   return '';
   end if;  
 
   
   BEGIN
      INSERT INTO HR_YETA_INSURANCE
           SELECT as_comp,             as_workyear,    'N',     as_empno,    as_sdate, 
                  NVL(MAX(SEQ),0) + 1, as_rrn,         decode(as_code, 'G0001', 'D1', 'D2'),   --2015  decode(as_code, 'A01', 'D1', 'D2'),
		          an_amt,      0,      an_amt,         as_userid,      to_char(sysdate,'yyyymmddhh24miss'), null, null, 'Y'
             FROM HR_YETA_INSURANCE
            where company_code = as_comp
              and work_year = as_workyear
              and mta_yn = 'N'
              and emp_no = as_empno
              and work_sdate = as_sdate;
       commit;
    return '';
   exception
    when others then
   rollback;
      --RAISE_APPLICATION_ERROR( -20001,  SQLCODE || ':' || SQLERRM );
      return ' : ';--|| SQLCODE || ':' || SQLERRM ;
     
   END;
END;

/





CREATE  OR REPLACE  FUNCTION F_HR_YETA_INVEST

( 
  as_comp     IN VARCHAR2,
  as_workyear IN VARCHAR2,
  as_empno    IN VARCHAR2,
  as_sdate    IN VARCHAR2,
  as_code     IN VARCHAR2,
  an_amt      IN NUMBER,
  as_userid   IN VARCHAR2
) RETURN VARCHAR2 IS

vCnt        NUMBER;
ls_value    VARCHAR2(500);
ls_relation VARCHAR2(3);
ls_rubber   VARCHAR2(1);
ls_foreign  VARCHAR2(1);
ls_div      VARCHAR2(1);
pragma autonomous_transaction;
-------------------------------------------------------------
 /** . **/
 /**  **/
-------------------------------------------------------------
BEGIN 
  IF as_code = 'G0023' THEN
      BEGIN
          update hr_yeta_self 
       --         set nts_amt = an_amt
             set else_amt = an_amt  --2016.01.07   else  else .. 
               , deduct_amt = least((an_amt * 0.4), 3000000)
               , self_amt = an_amt
           where company_code = as_comp
             and work_year    = as_workyear
             and mta_yn       = 'N'
             and emp_no       = as_empno
             and work_sdate   = as_sdate
             and item_code    = 'FF0070';
          commit;
          return '';
        
       exception
        when others then
       rollback;
          --RAISE_APPLICATION_ERROR( -20001,  SQLCODE || ':' || SQLERRM );
          return '    : '|| SQLCODE || ':' || SQLERRM ;
         
      END;   
  ELSIF as_code = 'G0019' THEN
      BEGIN
          update hr_yeta_self 
             set else_amt = an_amt
               , self_amt = an_amt
           where company_code = as_comp
             and work_year    = as_workyear
             and mta_yn       = 'N'
             and emp_no       = as_empno
             and work_sdate   = as_sdate
       and item_code    = 'FF0016';
          commit;
          return '';
        
       exception
        when others then
       rollback;
          --RAISE_APPLICATION_ERROR( -20001,  SQLCODE || ':' || SQLERRM );
          return '.  : '|| SQLCODE || ':' || SQLERRM ;
         
      END;
  END IF;
END;

/





CREATE  OR REPLACE  FUNCTION F_HR_YETA_MEDICAL

 ( 
  as_comp     IN VARCHAR2,
  as_workyear IN VARCHAR2,
  as_empno    IN VARCHAR2,
  as_sdate    IN VARCHAR2,
  as_rrn      IN VARCHAR2,
  as_code     IN VARCHAR2,
  as_busino   IN VARCHAR2,  
  as_businame IN VARCHAR2, 
  an_amt      IN NUMBER,
  as_userid   IN VARCHAR2
) RETURN VARCHAR2 IS

vCnt       NUMBER;
ls_value   VARCHAR2(500);
ls_relation VARCHAR2(3);
ls_rubber   VARCHAR2(1);
ls_foreign  VARCHAR2(1);
ls_type     VARCHAR2(2);
ls_rrnyear  VARCHAR2(4);
pragma autonomous_transaction;
-------------------------------------------------------------
 /** **/
-------------------------------------------------------------
BEGIN


--    /** **/
--    BEGIN
--       select F_HR_YETA_SELF_FAMILY(as_workyear, as_empno, as_rrn)
--         into ls_value
--         from dual;
--    END;
-- 
--    if ls_value != '' then
--       RAISE_APPLICATION_ERROR( -20001,  ls_value );
--       return ls_value;
--    end if; 

--      /** **/
--    BEGIN
--       select F_HR_YETA_SELF_FAMILY_BASIC(as_workyear, as_empno, as_rrn)
--         into ls_value
--         from dual;
--    END;
-- 
--    if ls_value is not null then
-- --      RAISE_APPLICATION_ERROR( -20001,  ls_value );
--       return '[]'||ls_value;
--    end if; 

   /**   **/
   BEGIN
      select F_HR_YETA_SELF_SPECIAL_CHK(as_workyear, as_empno, as_rrn, 'medi')
        into ls_value
        from dual;
   END;

   if ls_value is not null then
--      RAISE_APPLICATION_ERROR( -20001,  ls_value );
--      return ls_value;
   return '';   
   end if;  
 
   begin
  select decode(substr(as_rrn,7,1), 1, '19', 2, '19', '5', '19', '6', '19', '20')||substr(as_rrn,1,2)
    into ls_rrnyear
    from dual;
   end;
    
 
   BEGIN
      SELECT RELATION_CODE, NVL(DECODE(RUBBER_YN, 'N','N','Y'),'N'), NVL(FOREIGN_TAG,'1')
        INTO ls_relation, ls_rubber, ls_foreign
        FROM HR_YETA_SELF  
       WHERE rrn          = as_rrn
         and company_code = as_comp
         and work_year    = as_workyear
         and mta_yn       = 'N'
         and emp_no       = as_empno
         and work_sdate   = as_sdate;
   
   EXCEPTION
        WHEN NO_DATA_FOUND THEN
           RETURN '-SELF'||SQLCODE || ':' || SQLERRM ;
   
   END; 
   

   IF (substr(as_workyear,1,4) - ls_rrnyear )>= 65 then--1947 1231  
      ls_type := 1;
   ELSE
      BEGIN
      SELECT DECODE(ls_relation, '0', '1', decode(ls_rubber, 'Y', '3', '2')) 
     INTO ls_type
  FROM DUAL;
   END;
   END IF;

   
   BEGIN
      INSERT INTO HR_YETA_MEDICAL
           SELECT as_comp,              as_workyear,    'N',          as_empno,     as_sdate, 
                  NVL(MAX(SEQ),0) + 1, 
                  as_busino,            as_businame,    1,            0,            decode(as_code, 'G0026', least(an_amt,500000), an_amt),  --2015  decode(as_code, 'B04', least(an_amt,500000), an_amt),  -- 500000
                  decode(as_code, 'G0026', least(an_amt,500000), an_amt),             null,           ls_relation,  as_rrn,       ls_type,
                  null,                0,              ls_foreign,   null,
                  as_userid,           to_char(sysdate,'yyyymmddhh24miss'), null, null,  
                  0,              0,              null,         1,         1,  --(),  (1)
                  'Y'   
             FROM HR_YETA_MEDICAL
            where company_code = as_comp
              and work_year    = as_workyear
              and mta_yn       = 'N'
              and emp_no       = as_empno
              and work_sdate   = as_sdate;
       commit;
    return '';
   exception
    when others then
   rollback;
      --RAISE_APPLICATION_ERROR( -20001,  SQLCODE || ':' || SQLERRM );
      return ' : '|| SQLCODE || ':' || SQLERRM ;
     
   END;
END;

/





CREATE  OR REPLACE  FUNCTION F_HR_YETA_SAVE

 ( 
  as_comp     IN VARCHAR2,
  as_workyear IN VARCHAR2,
  as_empno    IN VARCHAR2,
  as_sdate    IN VARCHAR2,
  as_code     IN VARCHAR2, 
  as_businame IN VARCHAR2, 
  as_deposit  IN VARCHAR2, 
  as_bank     IN VARCHAR2, 
  as_pension  IN VARCHAR2,
  an_amt      IN NUMBER,
  as_userid   IN VARCHAR2
) RETURN VARCHAR2 IS

vCnt        NUMBER;
ls_value    VARCHAR2(500);
ls_relation VARCHAR2(3);
ls_rubber   VARCHAR2(1);
ls_foreign  VARCHAR2(1);
ls_div      VARCHAR2(1);
ld_deduct   NUMBER;

pragma autonomous_transaction;
-------------------------------------------------------------
 /** **/
-------------------------------------------------------------
BEGIN

--2015   IF as_code = 'D01' THEN --
   IF as_code = 'G0009' THEN --
   begin
      select greatest(an_amt, 720000) into ld_deduct from dual;
   end;
--   ELSIF as_code = 'E01' OR as_code = 'F01' THEN --,  
   ELSIF as_code = 'G0010' OR as_code = 'G0011' THEN --,  
      ld_deduct := an_amt;
   END IF;
   
    
   BEGIN
      INSERT INTO HR_YETA_SAVE
           SELECT as_comp,        as_workyear,    'N',          as_empno,     as_sdate, 
                  NVL(MAX(SEQ),0) + 1, 
                  DECODE(as_code, 'G0009', '21', 'G0010', '22', 'G0011', '11', decode(as_pension, '13', '11', as_pension)), -- 2013.01.03   
                  as_bank,        as_businame,    as_deposit,   0,            an_amt,      0,
                  ld_deduct,      as_userid,      to_char(sysdate,'yyyymmddhh24miss'),     null, 
                  null,           'Y'
             FROM HR_YETA_SAVE
            where company_code = as_comp
              and work_year    = as_workyear
              and mta_yn       = 'N'
              and emp_no       = as_empno
              and work_sdate   = as_sdate;
     
     
       commit;
    return '';
   exception
    when others then
   rollback;
      --RAISE_APPLICATION_ERROR( -20001,  SQLCODE || ':' || SQLERRM );
      return ' : '|| SQLCODE || ':' || SQLERRM ;
     
   END;
END;

/





CREATE  OR REPLACE  FUNCTION F_HR_YETA_CONTRIBUTE

 ( 
  as_comp     IN VARCHAR2,
  as_workyear IN VARCHAR2,
  as_empno    IN VARCHAR2,
  as_sdate    IN VARCHAR2,
  as_rrn      IN VARCHAR2,
  as_busino   IN VARCHAR2,  
  as_businame IN VARCHAR2, 
  as_type     IN VARCHAR2,
  an_amt      IN NUMBER,
  an_iamt     IN NUMBER, --2016 
  as_userid   IN VARCHAR2
) RETURN VARCHAR2 IS

vCnt         NUMBER;
ls_value     VARCHAR2(500);
ls_relation  VARCHAR2(3);
ls_conttype  VARCHAR2(50); 
ld_limit     NUMBER;
ls_basicyn   VARCHAR2(1);
ln_age       NUMBER;
pragma autonomous_transaction;
-------------------------------------------------------------
 /** **/
-------------------------------------------------------------
BEGIN
   /** **/
   BEGIN
      select F_HR_YETA_SELF_FAMILY(as_workyear, as_empno, as_rrn)
        into ls_value
        from dual;
   END;

   if ls_value is not null then
--      RAISE_APPLICATION_ERROR( -20001,  ls_value );
      return '';
   end if; 

   /**   **/
   BEGIN
      select F_HR_YETA_SELF_SPECIAL_CHK(as_workyear, as_empno, as_rrn, 'cont')
        into ls_value
        from dual;
   END;

   if ls_value is not null then
--      RAISE_APPLICATION_ERROR( -20001,  ls_value );
--      return ls_value;
   return '';
   end if;  
 
   --
   BEGIN
      SELECT RELATION_CODE, BASIC_YN, to_number(substr(work_year,1,4)) - to_number( decode(substr(rrn, 7,1), 1, '19', '2', '19', '5', '19', '6', '19', '20') || substr(rrn,1,2)) as age
        INTO ls_relation, ls_basicyn, ln_age
        FROM HR_YETA_SELF  
       WHERE rrn          = as_rrn
         and company_code = as_comp
         and work_year    = as_workyear
         and mta_yn       = 'N'
         and emp_no       = as_empno
         and work_sdate   = as_sdate;

   EXCEPTION
        WHEN NO_DATA_FOUND THEN
           RETURN '-SELF'||SQLCODE || ':' || SQLERRM ;   
   
   END; 
  
   --  --(10%) 
   BEGIN
   SELECT cont_sname || '('||rate||'%)'
     INTO ls_conttype 
     FROM hr_code_contribute
    WHERE work_year = substr(as_workyear,1,4)
      AND cont_code = as_type;
   END;
   

   if ( ( ls_basicyn = 'N' AND ln_age <= 20 ) or ( ls_basicyn = 'N' AND ln_age >= 60 )) then --      . 
      return ''; 
   end if;

      
    IF (as_type = '10' AND ls_basicyn = 'N') THEN  -- 
      RETURN '';
    end if;  
 

    BEGIN
       INSERT INTO HR_YETA_CONTRIBUTE
            SELECT as_comp,             as_workyear,    'N',        as_empno,     as_sdate, 
                   NVL(MAX(SEQ),0) + 1, 
                   ls_conttype,         as_type,        NULL,       NULL,         NULL,
                   substrb(as_businame, 1, 30),         as_busino,      an_amt,     1,            null,
                   as_userid,           to_char(sysdate,'yyyymmddhh24miss'),      null, null,  
                   null,                ls_relation,    as_rrn,     '1',          null, null, null, an_amt, 0, 'Y' , an_iamt  
              FROM HR_YETA_CONTRIBUTE
             where company_code = as_comp
               and work_year    = as_workyear
               and mta_yn       = 'N'
               and emp_no       = as_empno
               and work_sdate   = as_sdate;
        commit;
     return '';
    exception
     when others then
    rollback;
       --RAISE_APPLICATION_ERROR( -20001,  SQLCODE || ':' || SQLERRM );
       return ' : '|| SQLCODE || ':' || SQLERRM ;
      
    END;
   
END;

/





CREATE  OR REPLACE  FUNCTION F_HR_YETA_CREDIT

 ( 
  as_comp     IN VARCHAR2,
  as_workyear IN VARCHAR2,
  as_empno    IN VARCHAR2,
  as_sdate    IN VARCHAR2,
  as_rrn      IN VARCHAR2,
  as_code     IN VARCHAR2,  -- : , , 
  an_amt      IN NUMBER,
  an_pre_amt  IN NUMBER, --2013_
  an_last_amt IN NUMBER, --2014_
  an_amt4     IN NUMBER, --_
  an_amt5     IN NUMBER, --_
  as_tag      IN VARCHAR2, --  : 1., 2.
  as_userid   IN VARCHAR2
) RETURN VARCHAR2 IS

ln_seq      NUMBER;
ls_value    VARCHAR2(500);
ls_relation VARCHAR2(3);
ls_rubber   VARCHAR2(1);
ls_foreign  VARCHAR2(1);
ls_div      VARCHAR2(2);
ls_self     VARCHAR2(1);
ls_sum      VARCHAR2(1);
pragma autonomous_transaction;
-------------------------------------------------------------
 /** **/   --2016.01.20 
-------------------------------------------------------------
BEGIN
  /** **/
   BEGIN
      select F_HR_YETA_SELF_FAMILY(as_workyear, as_empno, as_rrn)
        into ls_value
        from dual;
   END;

   if ls_value is not null then
--      RAISE_APPLICATION_ERROR( -20001,  ls_value );
      return ls_value;
   end if; 


--   /** **/
--   BEGIN
--      select F_HR_YETA_SELF_FAMILY_BASIC(as_workyear, as_empno, as_rrn)
--        into ls_value
--        from dual;
--   END;
--
--   if ls_value is not null then
--     return '';
--   end if; 
   

   /**   **/
   BEGIN
      select F_HR_YETA_SELF_SPECIAL_CHK(as_workyear, as_empno, as_rrn, 'credit')
        into ls_value
        from dual;
   END;

   if ls_value is not null then
--      RAISE_APPLICATION_ERROR( -20001,  ls_value );
--      return ls_value;
       return '';
   end if;  
 

   -- 
   --  
   BEGIN
      SELECT relation_code
        INTO ls_relation
        FROM HR_YETA_SELF
       WHERE company_code = as_comp
         and work_year    = as_workyear
         and mta_yn       = 'N'
         and emp_no       = as_empno
         and work_sdate   = as_sdate
         and rrn = as_rrn;
   EXCEPTION
        WHEN NO_DATA_FOUND THEN
           ls_relation := '9';   
    
   END;
   
   if ls_relation = '6' then
      return '';
   end if;
   
   
   
   

   begin
   select decode(as_tag, '2', 'D6', '3', 'D7', decode(as_code, 'G0012', 'D1', 'G0013','D2', 'G0014','D5')) 
     into ls_div
     from dual;
   end;
   
   --    
   BEGIN
   select SEQ
     into ln_seq 
     from HR_YETA_credit
    where company_code = as_comp
      and work_year    = as_workyear
      and mta_yn       = 'N'
      and emp_no       = as_empno
      and work_sdate   = as_sdate
      and rrn          = as_rrn
      and div          = ls_div
      and auto_yn      = 'Y';

   EXCEPTION
        WHEN NO_DATA_FOUND THEN
           ln_seq := 0;   
    
   END;
    
   --  
   BEGIN
      SELECT DECODE(RRN, AS_RRN, 'Y', 'N')
        INTO ls_self
        FROM HR_YETA_SELF
       WHERE company_code = as_comp
         and work_year    = as_workyear
         and mta_yn       = 'N'
         and emp_no       = as_empno
         and work_sdate   = as_sdate
         and item_code    = 'AA0010'
         and rrn = as_rrn;
   EXCEPTION
        WHEN NO_DATA_FOUND THEN
           ls_self := 'N';   
    
   END;
 
   
   
   IF ln_seq = 0 THEN
    BEGIN
       INSERT INTO HR_YETA_CREDIT
            SELECT as_comp,        as_workyear,    'N',          as_empno,     as_sdate, 
                   NVL(MAX(SEQ),0) + 1, 
                   as_rrn,         ls_div, 
                   an_amt,         0,              an_amt,
                   as_userid,      to_char(sysdate,'yyyymmddhh24miss'), null, null,
                   0,0,0, 'Y', 
                   nvl(sum(decode(ls_div, div, decode(as_rrn, rrn, PRE_YEAR_AMT,        0),0)),0) + an_pre_amt, 
                   decode(ls_self, 'N', 0, nvl(sum(decode(ls_div, div, decode(as_rrn, rrn, FIRST_HALF_AMT,      0),0)),0)  + an_amt4),
                   decode(ls_self, 'N', 0, nvl(sum(decode(ls_div, div, decode(as_rrn, rrn, SECOND_HALF_AMT,     0),0)),0)  + an_amt5),
                   nvl(sum(decode(ls_div, div, decode(as_rrn, rrn, LAST_YEAR_AMT,        0),0)),0) + nvl(an_last_amt,0)
              FROM HR_YETA_CREDIT
             where company_code = as_comp
               and work_year    = as_workyear
               and mta_yn       = 'N'
               and emp_no       = as_empno
               and work_sdate   = as_sdate;
        DELETE FROM HR_YETA_CREDIT
              WHERE company_code = as_comp
                and work_year    = as_workyear
                and mta_yn       = 'N'
                and emp_no       = as_empno
                and work_sdate   = as_sdate
                and nts_amt + amt + pre_year_amt + first_half_amt + second_half_amt = 0
				and auto_yn = 'Y';
               
        commit;        
        return '';
     exception
      when others then
     rollback;
        --RAISE_APPLICATION_ERROR( -20001,  SQLCODE || ':' || SQLERRM );
        return ' : '|| SQLCODE || ':' || SQLERRM ;
       
      END;
   ELSE
    BEGIN
       UPDATE HR_YETA_CREDIT
       SET nts_amt             = nts_amt             + an_amt
         , amt                 = amt                 + an_amt
         , pre_year_amt        = nvl(decode(ls_div, div, decode(as_rrn, rrn, PRE_YEAR_AMT,0),0),0) + an_pre_amt --decode(ls_sum, 'N', 0, nvl(decode(ls_div, div, decode(as_rrn, rrn, PRE_YEAR_AMT,        0),0),0) + an_amt1) 
         , first_half_amt      = decode(ls_self, 'N', 0, nvl(decode(ls_div, div, decode(as_rrn, rrn, first_half_amt,      0),0),0) + an_amt4)
         , second_half_amt     = decode(ls_self, 'N', 0, nvl(decode(ls_div, div, decode(as_rrn, rrn, second_half_amt,     0),0),0) + an_amt5)
         , last_year_amt       = nvl(decode(ls_div, div, decode(as_rrn, rrn, LAST_YEAR_AMT,0),0),0) + NVL(an_last_amt,0)   --2014
     WHERE company_code = as_comp
       and work_year    = as_workyear
       and mta_yn       = 'N'
       and emp_no       = as_empno
       and work_sdate   = as_sdate
       and seq          = ln_seq ;
       commit;
       return '';
     exception
      when others then
     rollback;
        --RAISE_APPLICATION_ERROR( -20001,  SQLCODE || ':' || SQLERRM );
        return ' : '|| SQLCODE || ':' || SQLERRM ;
       
    END;   
   END IF;
    
END;

/





CREATE  OR REPLACE  FUNCTION F_HR_YETA_DELETE

 ( 
  as_comp     IN VARCHAR2,
  as_workyear IN VARCHAR2,
  as_empno    IN VARCHAR2,
  as_sdate    IN VARCHAR2
) RETURN VARCHAR2 IS

li_cnt        NUMBER;
pragma autonomous_transaction;

-------------------------------------------------------------
 /**  **/
-------------------------------------------------------------
BEGIN


   BEGIN
      SELECT COUNT(*) 
        INTO li_cnt
        FROM HR_YETA_INSURANCE
       WHERE COMPANY_CODE = as_comp
         AND WORK_YEAR    = as_workyear 
         AND MTA_YN       = 'N'
         AND EMP_NO       = as_empno
         AND WORK_SDATE   = as_sdate
         AND AUTO_YN      = 'Y';
   END;
   
   IF li_cnt > 0 then
      BEGIN
         DELETE FROM HR_YETA_INSURANCE
          WHERE COMPANY_CODE = as_comp
            AND WORK_YEAR    = as_workyear 
            AND MTA_YN       = 'N'
            AND EMP_NO       = as_empno
            AND WORK_SDATE   = as_sdate
            AND AUTO_YN      = 'Y';      

         exception when others then
         rollback;
         return '- : '|| SQLCODE || ':' || SQLERRM ;
      END;
   END IF;


   BEGIN
      SELECT COUNT(*) 
        INTO li_cnt
        FROM HR_YETA_MEDICAL
       WHERE COMPANY_CODE = as_comp
         AND WORK_YEAR    = as_workyear 
         AND MTA_YN       = 'N'
         AND EMP_NO       = as_empno
         AND WORK_SDATE   = as_sdate
         AND AUTO_YN      = 'Y';
   END;
   
   IF li_cnt > 0 then
      BEGIN
         DELETE FROM HR_YETA_MEDICAL
          WHERE COMPANY_CODE = as_comp
            AND WORK_YEAR    = as_workyear 
            AND MTA_YN       = 'N'
            AND EMP_NO       = as_empno
            AND WORK_SDATE   = as_sdate
            AND AUTO_YN      = 'Y';      
         
         exception when others then
         rollback;
         return '- : '|| SQLCODE || ':' || SQLERRM ;
      END;
   
   END IF;
   
   
   BEGIN
      SELECT COUNT(*) 
        INTO li_cnt
        FROM HR_YETA_FUND
       WHERE COMPANY_CODE = as_comp
         AND WORK_YEAR    = as_workyear 
         AND MTA_YN       = 'N'
         AND EMP_NO       = as_empno
         AND WORK_SDATE   = as_sdate
         AND AUTO_YN      = 'Y';
   END;
   
   IF li_cnt > 0 then
      BEGIN
         DELETE FROM HR_YETA_FUND
          WHERE COMPANY_CODE = as_comp
            AND WORK_YEAR    = as_workyear 
            AND MTA_YN       = 'N'
            AND EMP_NO       = as_empno
            AND WORK_SDATE   = as_sdate
            AND AUTO_YN      = 'Y';      
      
         exception when others then
         rollback;
         return '- : '|| SQLCODE || ':' || SQLERRM ;
      END;
   END IF;
   
   
   
   BEGIN
      SELECT COUNT(*) 
        INTO li_cnt
        FROM HR_YETA_CONTRIBUTE
       WHERE COMPANY_CODE = as_comp
         AND WORK_YEAR    = as_workyear 
         AND MTA_YN       = 'N'
         AND EMP_NO       = as_empno
         AND WORK_SDATE   = as_sdate
         AND AUTO_YN      = 'Y';
   END;
   
   IF li_cnt > 0 then
      BEGIN
         DELETE FROM HR_YETA_CONTRIBUTE
          WHERE COMPANY_CODE = as_comp
            AND WORK_YEAR    = as_workyear 
            AND MTA_YN       = 'N'
            AND EMP_NO       = as_empno
            AND WORK_SDATE   = as_sdate
            AND AUTO_YN      = 'Y';      
         
         exception when others then
         rollback;
         return '- : '|| SQLCODE || ':' || SQLERRM ;
      END;
   END IF;
   
   
   
   BEGIN
      SELECT COUNT(*) 
        INTO li_cnt
        FROM HR_YETA_CREDIT
       WHERE COMPANY_CODE = as_comp
         AND WORK_YEAR    = as_workyear 
         AND MTA_YN       = 'N'
         AND EMP_NO       = as_empno
         AND WORK_SDATE   = as_sdate
         AND AUTO_YN      = 'Y';
   END;
   
   IF li_cnt > 0 then
      BEGIN
         DELETE FROM HR_YETA_CREDIT
          WHERE COMPANY_CODE = as_comp
            AND WORK_YEAR    = as_workyear 
            AND MTA_YN       = 'N'
            AND EMP_NO       = as_empno
            AND WORK_SDATE   = as_sdate
            AND AUTO_YN      = 'Y';      
         
         exception when others then
         rollback;
         return '- : '|| SQLCODE || ':' || SQLERRM ;
      END;
   END IF;
   
   
   
   BEGIN
      SELECT COUNT(*) 
        INTO li_cnt
        FROM HR_YETA_EDU
       WHERE COMPANY_CODE = as_comp
         AND WORK_YEAR    = as_workyear 
         AND MTA_YN       = 'N'
         AND EMP_NO       = as_empno
         AND WORK_SDATE   = as_sdate
         AND AUTO_YN      = 'Y';
   END;
   
   IF li_cnt > 0 then
      BEGIN
         DELETE FROM HR_YETA_EDU
          WHERE COMPANY_CODE = as_comp
            AND WORK_YEAR    = as_workyear 
            AND MTA_YN       = 'N'
            AND EMP_NO       = as_empno
            AND WORK_SDATE   = as_sdate
            AND AUTO_YN      = 'Y';      
         
         exception when others then
         rollback;
         return '- : '|| SQLCODE || ':' || SQLERRM ;
      END;
   END IF;
   
   
   
   BEGIN
      SELECT COUNT(*) 
        INTO li_cnt
        FROM HR_YETA_SAVE
       WHERE COMPANY_CODE = as_comp
         AND WORK_YEAR    = as_workyear 
         AND MTA_YN       = 'N'
         AND EMP_NO       = as_empno
         AND WORK_SDATE   = as_sdate
         AND AUTO_YN      = 'Y';
   END;
   
   IF li_cnt > 0 then
      BEGIN
         DELETE FROM HR_YETA_SAVE
          WHERE COMPANY_CODE = as_comp
            AND WORK_YEAR    = as_workyear 
            AND MTA_YN       = 'N'
            AND EMP_NO       = as_empno
            AND WORK_SDATE   = as_sdate
            AND AUTO_YN      = 'Y';      
         
         exception when others then
         rollback;
         return '- : '|| SQLCODE || ':' || SQLERRM ;
      END;
   END IF;
   
   
   BEGIN      
   --, 
      UPDATE HR_YETA_SELF
         SET nts_amt = 0, else_amt = 0, self_amt = 0, deduct_amt = 0
       WHERE COMPANY_CODE = as_comp
         AND WORK_YEAR    = as_workyear 
         AND MTA_YN       = 'N'
         AND EMP_NO       = as_empno
         AND WORK_SDATE   = as_sdate
         AND ITEM_CODE    = 'FF0016';      
      
      commit;
      return '';
      exception when others then
      rollback;
      return '- : '|| SQLCODE || ':' || SQLERRM ;
      
   END; 

   BEGIN      
   -- 
      UPDATE HR_YETA_SELF
         SET nts_amt = 0, else_amt = 0, self_amt = 0, deduct_amt = 0
       WHERE COMPANY_CODE = as_comp
         AND WORK_YEAR    = as_workyear 
         AND MTA_YN       = 'N'
         AND EMP_NO       = as_empno
         AND WORK_SDATE   = as_sdate
         AND ITEM_CODE    = 'FF0070';      
      
      commit;
      return '';
      exception when others then
      rollback;
      return '-  '|| SQLCODE || ':' || SQLERRM ;
      
   END; 

   BEGIN      
   -- 
      UPDATE HR_YETA_SELF
         SET nts_amt = 0, else_amt = 0, self_amt = 0, deduct_amt = 0
       WHERE COMPANY_CODE = as_comp
         AND WORK_YEAR    = as_workyear 
         AND MTA_YN       = 'N'
         AND EMP_NO       = as_empno
         AND WORK_SDATE   = as_sdate
         AND ITEM_CODE    = 'FF0080';      
      
      commit;
      return '';
      exception when others then
      rollback;
      return '- '|| SQLCODE || ':' || SQLERRM ;
      
   END; 
   
END;

/





CREATE  OR REPLACE  FUNCTION F_HR_YETA_EDU

 ( 
  as_comp     IN VARCHAR2,
  as_workyear IN VARCHAR2,
  as_empno    IN VARCHAR2,
  as_sdate    IN VARCHAR2,
  as_rrn      IN VARCHAR2,
  as_name     IN VARCHAR2,
  as_code     IN VARCHAR2,
  an_amt      IN NUMBER,
  as_userid   IN VARCHAR2
) RETURN VARCHAR2 IS

vCnt        NUMBER;
ls_value    VARCHAR2(500);
ls_relation VARCHAR2(3);
ls_rubber   VARCHAR2(1);
ls_foreign  VARCHAR2(1);
ls_div      VARCHAR2(1);
pragma autonomous_transaction;
-------------------------------------------------------------
 /** **/
-------------------------------------------------------------
BEGIN
--    /** **/
--    BEGIN
--       select F_HR_YETA_SELF_FAMILY(as_workyear, as_empno, as_rrn)
--         into ls_value
--         from dual;
--    END;
-- 
--    if ls_value != '' then
--       RAISE_APPLICATION_ERROR( -20001,  ls_value );
--       return ls_value;
--    end if; 

   /**   **/
   BEGIN
      select F_HR_YETA_SELF_SPECIAL_CHK(as_workyear, as_empno, as_rrn, 'edu')
        into ls_value
        from dual;
   END;

   if ls_value is not null then
--      RAISE_APPLICATION_ERROR( -20001,  ls_value );
--      return ls_value;
   return '';   
   end if;  
 
   if (as_code = '1' or as_code = '8' or as_code = '2' or as_code = '3' or as_code = '4' or as_code = 'G') then
   -- ,   
      /** **/
      BEGIN
         select F_HR_YETA_SELF_FAMILY_BASIC(as_workyear, as_empno, as_rrn)
           into ls_value
           from dual;
      END;

      if ls_value is not null then
         return '';   
      end if;  
   end if;
 
   BEGIN
      SELECT RELATION_CODE, NVL(RUBBER_YN,'N'), NVL(FOREIGN_TAG,'1')
        INTO ls_relation, ls_rubber, ls_foreign
        FROM HR_YETA_SELF  
       WHERE rrn          = as_rrn
         and company_code = as_comp
         and work_year    = as_workyear
         and mta_yn       = 'N'
         and emp_no       = as_empno
         and work_sdate   = as_sdate;

   EXCEPTION
        WHEN NO_DATA_FOUND THEN
           RETURN '-SELF'||SQLCODE || ':' || SQLERRM ;   
   
   END; 
  
   if ls_relation = '0' then --  
      ls_div := '5';
   else
      SELECT case as_code when '1' then '1'
                       when '8' then '1'
                       when '2' then '2'
                       when '3' then '2'
                       when '4' then '2'
                       when '5' then '3'
                       when '6' then '3'
                       when '7' then '3'
                       when 'C' then '3'
                       when 'D' then '3'
                       when 'E' then 'A' --  
                       when 'F' then 'A' --   
                       when 'G' then '1' --   
                       when 'H' then decode(ls_rubber, 'Y', '4', 'A')
                       when 'J' then decode(ls_rubber, 'Y', '4', 'A')
                       when 'K' then decode(ls_rubber, 'Y', '4', 'A')
        when 'G0005' then '5' 
        when 'G0024' then '6' 
-- 2015         when 'C02' then '5' 
--         when 'C06' then '6' 
           end
    INTO ls_div
    FROM DUAL;
   end if;
   
   IF ls_div <> 'A' THEN
    BEGIN
       INSERT INTO HR_YETA_EDU
            SELECT as_comp,             as_workyear,    'N',          as_empno,     as_sdate, 
                   NVL(MAX(SEQ),0) + 1, 
                   ls_relation,         ls_div,         as_rrn,       as_name,      decode(ls_div, '6', least(an_amt, 500000), an_amt), --  50 
                   0,                   decode(ls_div, '6', least(an_amt, 500000), an_amt),         as_userid,    to_char(sysdate,'yyyymmddhh24miss'), null, null, 'Y'
              FROM HR_YETA_EDU
             where company_code = as_comp
               and work_year    = as_workyear
               and mta_yn       = 'N'
               and emp_no       = as_empno
               and work_sdate   = as_sdate;
        commit;
     return '';
    exception
     when others then
    rollback;
       --RAISE_APPLICATION_ERROR( -20001,  SQLCODE || ':' || SQLERRM );
       return ' : '|| SQLCODE || ':' || SQLERRM ;
      
    END;
   ELSE
        return '';
   END IF;
END;

/





CREATE OR REPLACE FUNCTION "F_FM_GET_DECISION_STATUS" (

   AS_Check VARCHAR2
 , AS_Appr  VARCHAR2
 , AS_Decision   VARCHAR2
 )
 Return VARCHAR2 Is
    
 Begin
 
    if (AS_Check = '0') then return '01'; end if;
 if (AS_Check = '1' ) then 
   if (AS_appr is null or  AS_appr = '9') then return '02'; end if;
   if (AS_appr = 'Y' and  (AS_Decision  is null or AS_Decision = '9')) then return '03'; end if;
   if (AS_appr = 'N' and  (AS_Decision  is null or AS_Decision = '9')) then return '04'; end if;
   if (AS_appr = 'Z' and  (AS_Decision  is null or AS_Decision = '9')) then return '07'; end if;
   if (AS_appr = 'Y' and  ( AS_Decision = 'N')) then return '09'; end if;
 elsif (AS_Check = '2' ) then 
      if (AS_appr = 'Y' and  (AS_Decision  is null or AS_Decision = '9')) then return '05'; end if;
   if (AS_appr = 'Y' and  ( AS_Decision = 'Y')) then return '08'; end if;
   return '05';  
 end if;
 return '01';  
 End;

/





CREATE  OR REPLACE  FUNCTION F_HD_GET_RENT_RENT_DELAYALL (

   as_cust VARCHAR2,
   as_seq  VARCHAR2,
   as_dt   VARCHAR2
)
RETURN NUMBER IS

/* ****************************************************************** */
/*    
/* ****************************************************************** */

-------------------------------------------------------------------VALUES
ll_damt  NUMBER;

---------------------------------------------------------------CUR VALUES
c_term   NUMBER(3);
c_counts VARCHAR2(2);

---------------------------------------------------------------------
CURSOR CURD IS
SELECT TERM_CHG_SEQ, COUNTS
  FROM HD_RENT_RENT_AGREE
 WHERE CUST_CODE    = as_cust
   AND SEQ          = TO_NUMBER(as_seq)
   AND TERM_CHG_SEQ <> 99
 ORDER BY TERM_CHG_SEQ, COUNTS;

-------------------------------------------------------------------------
BEGIN
   ll_damt := 0;

   OPEN CURD;
   LOOP
      FETCH CURD INTO c_term, c_counts;
         EXIT WHEN CURD%NOTFOUND;
      ll_damt := ll_damt + NVL(F_HD_GET_RENT_RENT_DELAY(as_cust, as_seq, c_term, c_counts, as_dt), 0);
   END LOOP;
   CLOSE CURD;
   RETURN ll_damt;
END;

/





CREATE  OR REPLACE  FUNCTION F_HD_GET_RENT_RENT_DELAY ( 

  AS_CUST           IN VARCHAR2,   -- 
  AS_SEQ            IN VARCHAR2,   -- 
  AS_TERM           IN VARCHAR2,   -- 
  AS_COUNTS         IN VARCHAR2,   -- 
  AS_BASE_DATE      IN VARCHAR2    -- 
) RETURN NUMBER IS

CURSOR DETAIL_CUR (a_dt VARCHAR2, a_mon INTEGER )IS
   SELECT DELAYRATE, DELAYCUT, DELAYUNIT, STARTDATE, ENDDATE
     FROM HD_RENT_RATE_DELAY
    WHERE CUST_CODE   = AS_CUST
      AND SEQ         = TO_NUMBER(AS_SEQ)
      AND ENDDATE    >= a_dt
      AND STARTDATE  <= AS_BASE_DATE
      AND RATE_TAG    = '3' /*2 3*/
      AND ((END_TAG   = '1' AND END_DAYS   >= a_mon) OR
           (END_TAG   = '2' AND END_DAYS    > a_mon))
      AND ((START_TAG = '1' AND START_DAYS <= a_mon) OR
           (START_TAG = '2' AND START_DAYS  < a_mon));

-------------------------------------------------------------
-- 
-------------------------------------------------------------
--  
   C_DEPT_CODE         VARCHAR2(12);  -- 
   C_HOUSETAG          VARCHAR2(1);   -- 
   C_DT_BASE_DATE      DATE;          --  
   C_DT_AGREEDATE      DATE;          --  
   C_CNT               NUMBER;        --
   C_MONTHS            NUMBER(10,5);   -- 
   C_DAYS              NUMBER(10,5);   --
   C_DELAY_DAY         NUMBER(10,5);   -- 
   C_DELAY_AMT         NUMBER(30,9);   -- 
   C_BUNAMT            NUMBER(30,9);   -- 
   C_AGREEDATE         VARCHAR2(8);    -- 
   C_RECEIPTAMT        NUMBER(30,9);   -- 
   C_WORK_AMT          NUMBER(30,9);   -- 
   C_TEMP_RATE         NUMBER;         -- 
   C_TEMP_CNT          NUMBER(10,5);   -- 

   C_DELAYRATE         NUMBER(30,9);
   C_DELAYCUT          VARCHAR2(2);
   C_DELAYUNIT         VARCHAR2(2);
   C_STARTDATE         VARCHAR2(8);
   C_ENDDATE           VARCHAR2(8);

   C_COMP_UNIT         INTEGER;
   C_TEMP_DAYS         NUMBER(10,5);   --
   C_DAYMONTH          VARCHAR2(1); --

   C_TEMPDT            VARCHAR(8);

BEGIN
   BEGIN
      C_DELAY_AMT := 0;
      C_DT_BASE_DATE := TO_DATE(AS_BASE_DATE, 'YYYYMMDD'); --Date
      -----------------------------------------------------
      -- ,  .
      SELECT DEPT_CODE,   HOUSETAG,   DAYMONTH_TAG
        INTO C_DEPT_CODE, C_HOUSETAG, C_DAYMONTH
        FROM HD_RENT_MASTER
       WHERE CUST_CODE = AS_CUST
         AND SEQ       = TO_NUMBER(AS_SEQ);

      -- ,, 
      SELECT NVL((TO_DATE(AGREE_DATE, 'YYYYMMDD') - TO_DATE(AS_BASE_DATE, 'YYYYMMDD')) * -1,0),
             NVL(RENT_AMT,0), AGREE_DATE
        INTO C_DAYS, C_BUNAMT, C_AGREEDATE
        FROM HD_RENT_RENT_AGREE
       WHERE CUST_CODE    = AS_CUST
         AND SEQ          = TO_NUMBER(AS_SEQ)
         AND TERM_CHG_SEQ = TO_NUMBER(AS_TERM)
         AND COUNTS       = AS_COUNTS;

      IF C_DAYS > 0 THEN --  
         --  .
         C_TEMPDT := F_HD_GET_HOLIDAY(C_DEPT_CODE, C_HOUSETAG, C_AGREEDATE, 'N');
         IF C_TEMPDT >= AS_BASE_DATE THEN
            C_DAYS := 0;
         END IF;
      END IF;

      IF C_DAYS <= 0 THEN
         RETURN 0;
      END IF;

      --  .
      SELECT NVL(SUM(RECEIPT_AMT), 0)
        INTO C_RECEIPTAMT
        FROM HD_RENT_RENT_INCOME
       WHERE CUST_CODE    = AS_CUST
         AND SEQ          = TO_NUMBER(AS_SEQ)
         AND TERM_CHG_SEQ = TO_NUMBER(AS_TERM)
         AND COUNTS       = AS_COUNTS;
      --   ().
      C_WORK_AMT := C_BUNAMT - C_RECEIPTAMT;

      IF C_WORK_AMT = 0 THEN
         RETURN 0;
      END IF;

      ---------------------------------------------------------------------
      C_DELAY_AMT := 0;
      C_DELAY_DAY := C_DAYS;
      C_TEMP_RATE := 0;
      -- 

      C_DT_AGREEDATE := TO_DATE(C_AGREEDATE, 'YYYYMMDD') + 1;
--      C_DT_AGREEDATE := TO_DATE(C_AGREEDATE, 'YYYYMMDD');

      IF C_DAYMONTH = '2' THEN
         C_MONTHS := MONTHS_BETWEEN(C_DT_BASE_DATE, C_DT_AGREEDATE);
      ELSE
         C_MONTHS := C_DT_BASE_DATE - C_DT_AGREEDATE;
      END IF;

      OPEN DETAIL_CUR(C_AGREEDATE, C_MONTHS);
      LOOP
         FETCH DETAIL_CUR INTO C_DELAYRATE, C_DELAYCUT, C_DELAYUNIT, C_STARTDATE, C_ENDDATE;
         EXIT WHEN DETAIL_CUR%NOTFOUND;
         C_COMP_UNIT := CASE C_DELAYUNIT
                             WHEN '1' THEN 1
                             WHEN '2' THEN 10
                             WHEN '3' THEN 100
                             WHEN '4' THEN 1000
                             WHEN '5' THEN 10000
                             WHEN '6' THEN 100000
                             ELSE 1
                        END;

         IF C_AGREEDATE >= C_STARTDATE AND AS_BASE_DATE <= C_ENDDATE THEN
            C_TEMP_RATE := ( C_DELAY_DAY / 365 ) * ( C_DELAYRATE / 100 ) ;

            IF C_DELAYCUT = '1' THEN
               C_DELAY_AMT := TRUNC((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
            ELSE
               IF C_DELAYCUT = '2' THEN
                  C_DELAY_AMT := TRUNC((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT + 0.9,0) * C_COMP_UNIT;
               ELSE
                  C_DELAY_AMT := ROUND((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
               END IF;
            END IF;
            EXIT;
         END IF;

         IF C_AGREEDATE >= C_STARTDATE THEN
            C_TEMP_CNT := NVL(TO_DATE(C_ENDDATE, 'YYYYMMDD') - TO_DATE(C_AGREEDATE, 'YYYYMMDD') ,0);
         ELSE
            IF AS_BASE_DATE <= C_ENDDATE THEN
               C_TEMP_CNT := NVL(TO_DATE(AS_BASE_DATE, 'YYYYMMDD') - TO_DATE(C_STARTDATE, 'YYYYMMDD') + 1,0);
            ELSE
               C_TEMP_CNT := NVL(TO_DATE(C_ENDDATE, 'YYYYMMDD') - TO_DATE(C_STARTDATE, 'YYYYMMDD') + 1,0);
            END IF;
         END IF;

         C_TEMP_RATE := (C_TEMP_CNT / 365) * (C_DELAYRATE / 100);
         IF C_DELAYCUT = '1' THEN
            C_DELAY_AMT := C_DELAY_AMT + TRUNC((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
         ELSE
            IF C_DELAYCUT = '2' THEN
               C_DELAY_AMT := C_DELAY_AMT + TRUNC((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT + 0.9,0) * C_COMP_UNIT;
            ELSE
               C_DELAY_AMT := C_DELAY_AMT + ROUND((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
            END IF;
         END IF;
      END LOOP;
      CLOSE DETAIL_CUR;
   END;

   RETURN C_DELAY_AMT;
END;


/





CREATE  OR REPLACE  FUNCTION F_HD_GET_CHKDGT

(
   as_str    VARCHAR2,   --
   as_tp     VARCHAR2    -- 1: 2:
)
RETURN VARCHAR2 IS

-------------------------------------------------------------------VALUES
i        NUMBER(2);
vChk     NUMBER(10);
vTmp     NUMBER(10);
vWeight  NUMBER(2);
vResult  VARCHAR2(1);
vSum     NUMBER(10);

-------------------------------------------------------------------VALUES
BEGIN
   IF as_tp = '1' THEN BEGIN
      /* ---------------------------------------------------------------- */
      /*   */
      vChk    := 0;
      vWeight := 2;

      i := LENGTH(as_str);
      LOOP
         IF i < 1 THEN
            EXIT;
         END IF;

         vTmp := TO_NUMBER(SUBSTR(as_str, i, 1)) * vWeight;

         IF vTmp >= 10 then
            vChk := vChk + MOD(vTmp, 10);
            vChk := vChk + TRUNC(vTmp / 10);
         ELSE
            vChk := vChk + vTmp;
         END IF;


         IF vWeight = 1 THEN
            vWeight := 2;
         ELSE
            vWeight := 1;
         END IF;

         i := i -1;
      END LOOP;
   END; ELSE BEGIN
      /* ---------------------------------------------------------------- */
      /*   */
      vChk    := 0;
      vWeight := 7;

      i := LENGTH(as_str);
      LOOP
         IF i < 1 THEN
            EXIT;
         END IF;

         vChk := vChk + TO_NUMBER(SUBSTR(as_str, i, 1)) * vWeight;

         vWeight := CASE vWeight
                       WHEN 7 THEN 3
                       WHEN 3 THEN 1
                       WHEN 1 THEN 7
                    END;

         i := i -1;
      END LOOP;
   END; END IF;

   /* ------------------------------------------------------------------- */
   /* ------------------------------------------------------------------- */
   vSum := MOD(vChk, 10);
   IF vSum <> 0 THEN
      vSum := 10 - vSum;
   END IF;
      
   /* ------------------------------------------------------------------- */
   RETURN TO_CHAR(vSum);
END;








/





CREATE OR REPLACE FUNCTION          "F_AM_GET_WORKITEM_NO" (

   AS_COMP VARCHAR2
 , AS_DATE VARCHAR2
 , AS_DEPT VARCHAR2
 , AN_NO   NUMBER
 , AN_SEQ  NUMBER
 )
 Return VARCHAR2 Is
    vReturn VARCHAR2(40);
    vNumber VARCHAR2(10);
 Begin
    If (AS_DATE Is NULL Or AS_DATE = '') Then Return ''; End If;
    vNumber := LTRIM(RTRIM(To_Char(AN_NO, '0000'))) || '-' || LTRIM(RTRIM(To_Char(AN_SEQ, '000')));

    vReturn := AS_DATE || '-' || LTRIM(RTRIM(AS_DEPT)) || '-' || vNumber;
    Return vReturn;
 End;

/





CREATE OR REPLACE FUNCTION          "F_AM_GET_WORK_NO" (

   AS_COMP VARCHAR2
 , AS_DATE VARCHAR2
 , AS_DEPT VARCHAR2
 , AN_NO   NUMBER
 )
 Return VARCHAR2 Is
    vReturn VARCHAR2(40);
    vNumber VARCHAR2(10);
 Begin
    If (AS_DATE Is NULL Or AS_DATE = '') Then Return ''; End If;
    vNumber := LTRIM(RTRIM(To_Char(AN_NO, '0000')));
    vReturn := AS_DATE || '-' || LTRIM(RTRIM(AS_DEPT)) || '-' || vNumber;

    Return vReturn;
 End;

/





CREATE OR REPLACE FUNCTION           "F_FM_GET_BASEDATE" ( av_comp varchar2 )

 return varchar2 is
    lv_base_date varchar2(8);
 begin
    --   .
    select am_s_date
      into lv_base_date
      from sm_code_company
     where company_code = av_comp
    ;
    return lv_base_date;
 end;

/





CREATE OR REPLACE FUNCTION           "F_FM_GET_BASEMONTH" ( av_comp varchar2

 , av_date varchar2
 )
 return varchar2 is
    lv_date   varchar2(8);
    lv_base_m varchar2(2);
    lv_base_y varchar2(4);
 begin
    --  .
    select am_start_month
      into lv_base_m
      from sm_code_company
     where company_code = av_comp

    ;
    lv_date := substr(av_date || '0101', 1, 8);
    lv_base_y := substr(lv_date, 1, 4);
    if (lv_date < lv_base_y || lv_base_m || '01') then
       lv_base_y := to_char(lv_base_y - 1);
    end if;
    return lv_base_y || lv_base_m;
 end;

/





CREATE OR REPLACE FUNCTION           "F_FM_GET_BASEMONTHTO" ( av_comp varchar2

 , av_date varchar2
 )
 return varchar2 is
    lv_date   varchar2(8);
    lv_base_m varchar2(2);
    lv_base_y varchar2(4);
 begin
    --  .
    select am_start_month
      into lv_base_m
      from sm_code_company
     where company_code = av_comp

    ;
    lv_date := substr(av_date || '0101', 1, 8);
    lv_base_y := substr(lv_date, 1, 4);
    if (lv_date < lv_base_y || lv_base_m || '01') then
       lv_base_y := to_char(lv_base_y - 1);
    end if;
    return To_Char(Add_Months(To_Date(lv_base_y || lv_base_m || '01'), 11), 'yyyymmdd');
 end;

/





CREATE OR REPLACE FUNCTION           "F_FM_GET_BASEYEAR" ( av_comp varchar2

 , av_date varchar2
 )
 return varchar2 is
    lv_date   varchar2(8);
    lv_base_m varchar2(2);
    lv_base_y varchar2(4);
 begin
    --  .
    select am_start_month
      into lv_base_m
      from sm_code_company
     where company_code = av_comp

    ;
    lv_date := substr(av_date || '0101', 1, 8);
    lv_base_y := substr(lv_date, 1, 4);
    if (lv_date < lv_base_y || lv_base_m || '01') then
       lv_base_y := to_char(lv_base_y - 1);
    end if;
    return lv_base_y;
 end;

/





CREATE OR REPLACE FUNCTION           "F_FM_GET_SLIPITEM_NO" (

   AS_COMP VARCHAR2
 , AS_DATE VARCHAR2
 , AN_NO   NUMBER
 , AN_SEQ  NUMBER
 )
 Return VARCHAR2 Is
    vReturn VARCHAR2(40);
    vNumber VARCHAR2(10);
 Begin
    vNumber := LTRIM(RTRIM(To_Char(AN_NO, '0000'))) || '-' || LTRIM(RTRIM(To_Char(AN_SEQ, '0000')));
    vReturn := AS_DATE || '-' || vNumber;
    Return vReturn;

 End;

/





CREATE OR REPLACE FUNCTION           "F_FM_GET_ESTABLISH_SLIPNO" ( av_comp varchar2

 , ad_date varchar2
 , an_no number
 , an_seq number
 )
 --  =  +  + 
 return varchar2 is
    cursor c_cur1_sql is
       select b.slip_date
            , b.slip_no
            , b.work_seq_scr
         from fm_slip_dc a
            , fm_slip_detail b

        where a.slip_yyyy = substr(ad_date,1,4)
          and a.work_comp = av_comp
          and a.work_date = ad_date
          and a.work_no = an_no
          and a.work_seq = an_seq
          and a.work_comp = b.work_comp
          and b.work_date = a.set_work_date
          and b.work_no = a.set_work_no
          and b.work_seq = a.set_work_seq
    ;
    c_cur1_val c_cur1_sql%ROWTYPE;
    lv_return varchar2(2000);
 begin

    lv_return := '';

    OPEN c_cur1_sql;
    loop
       fetch c_cur1_sql into c_cur1_val;
       exit when c_cur1_sql%notfound;

       if( c_cur1_val.slip_date <> '' or c_cur1_val.slip_date is not null ) then
          if ( lv_return = '' or lv_return is null) then
             lv_return := f_fm_get_slipitem_no(av_comp, c_cur1_val.slip_date, c_cur1_val.slip_no, c_cur1_val.work_seq_scr);
          else
             lv_return := lv_return || ',' ||  f_fm_get_slipitem_no(av_comp, c_cur1_val.slip_date, c_cur1_val.slip_no, c_cur1_val.work_seq_scr);
          end if;

       end if;
    end loop;
    close c_cur1_sql;

    return lv_return;
 end;

/





CREATE OR REPLACE FUNCTION         "F_FM_GET_SLIPMNG" ( av_comp varchar2

 , ad_date varchar2
 , an_no number
 , an_seq number
 )
 return varchar2 is
    cursor c_cur1_sql is
       select decode( workd.dr_amt ,0 ,'2', '1') as SLIP_DRCR                              --
            , acnt.BOND_YN                                                                 --
            , acnt.ADJUSTED_DRCR                                                           --
            , nvl(workd.BANK_CODE,'') as BANK_CODE                                         --
            , nvl(bank.BANK_NAME, workd.BANK_CODE ) as BANK_NAME                           --
            , nvl(workd.DEPOSIT_NO, '') as DEPOSIT_NO                                      --

            , nvl(workd.USER_ID,'') as  USER_ID                                            --
            , nvl(pers.USER_NAME, workd.USER_ID) as EMP_NAME                                --
            , nvl(workd.PHONE, '') as PHONE                                                --
            , nvl(workd.EVIDENCE_CODE, '') as EVIDENCE_CODE                                --
            , nvl(evid.EVIDENCE_NAME, workd.EVIDENCE_CODE ) as EVIDENCE_NAME               --
            , decode( workd.DR_VAT ,0 ,workd.CR_VAT, workd.DR_VAT) as VAT_AMT              --
            , decode( workd.DR_SUPPLY ,0 ,workd.CR_SUPPLY,workd.DR_SUPPLY) as SUPPLY_AMT   --
            , acnt.QTY1_NAME
            , decode(decode(acnt.QTY1_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.QTY1,0), 0) as QTY1
            , acnt.QTY2_NAME
            , decode(decode(acnt.QTY2_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.QTY2,0), 0) as QTY2
            , acnt.QTY3_NAME
            , decode(decode(acnt.QTY3_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.QTY3,0), 0) as QTY3

            , acnt.AMT1_NAME
            , decode(decode(acnt.AMT1_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT1,0), 0) as AMT1
            , acnt.AMT2_NAME
            , decode(decode(acnt.AMT2_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT2,0), 0) as AMT2
            , acnt.AMT3_NAME
            , decode(decode(acnt.AMT3_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT3,0), 0) as AMT3
            , acnt.AMT4_NAME
            , decode(decode(acnt.AMT4_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT4,0), 0) as AMT4
            , acnt.AMT5_NAME
            , decode(decode(acnt.AMT5_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT5,0), 0) as AMT5
            , acnt.AMT6_NAME
            , decode(decode(acnt.AMT6_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT6,0), 0) as AMT6
            , acnt.RATE1_NAME

            , decode(decode(acnt.RATE1_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.RATE1,0), 0) as RATE1
            , acnt.RATE2_NAME
            , decode(decode(acnt.RATE2_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.RATE2,0), 0) as RATE2
            , acnt.RATE3_NAME
            , decode(decode(acnt.RATE3_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.RATE3,0), 0) as RATE3
            , acnt.DATE1_NAME
            , decode(decode(acnt.DATE1_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DATE1,''), '') AS DATE1
            , acnt.DATE2_NAME
            , decode(decode(acnt.DATE2_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DATE2,''), '') AS DATE2
            , acnt.DATE3_NAME
            , decode(decode(acnt.DATE3_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DATE3,''), '') AS DATE3
            , acnt.DATE4_NAME
            , decode(decode(acnt.DATE4_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DATE4,''), '') AS DATE4

            , acnt.DESC1_NAME
            , decode(decode(acnt.DESC1_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DESC1,''), '') as DESC1
            , acnt.DESC2_NAME
            , decode(decode(acnt.DESC2_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DESC2,''), '') as DESC2
            , acnt.DESC3_NAME
            , decode(decode(acnt.DESC3_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DESC3,''), '') as DESC3
            , acnt.DESC4_NAME
            , decode(decode(acnt.DESC4_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DESC4,''), '') as DESC4
            , acnt.DESC5_NAME
            , decode(decode(acnt.DESC5_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DESC5,''), '') as DESC5
         from fm_slip_detail workd
            , fm_code_acnt acnt
            , fm_CODE_BANK bank

            , SM_AUTH_USER pers
            , fm_code_evidence evid
        where workd.acnt_code = acnt.acnt_code
          and workd.BANK_CODE = bank.BANK_CODE (+)
          and workd.USER_ID = pers.USER_ID (+)
          and workd.EVIDENCE_CODE = evid.EVIDENCE_CODE (+)
          and workd.WORK_COMP = av_comp
          and workd.WORK_DATE = ad_date
          and workd.WORK_NO = an_no
          and workd.WORK_SEQ = an_seq
    ;
    c_cur1_val c_cur1_sql%ROWTYPE ;
    ls_give_name varchar2(30);

    ls_give_depositor varchar2(100);
    ls_work_return_data varchar2(2000);
 begin
    open c_cur1_sql;
    loop
       fetch c_cur1_sql into c_cur1_val;
       exit when c_cur1_sql%notfound;

       --  
       if ( c_cur1_val.BOND_YN = 'Y' ) THEN
          --  /  
          if ( c_cur1_val.SLIP_DRCR <> c_cur1_val.ADJUSTED_DRCR ) then
             ls_work_return_data := F_fm_GET_ESTABLISH_SLIPNO(av_comp, ad_date, an_no, an_seq  );

             if (ls_work_return_data is not null) then
                ls_work_return_data := ':' || ls_work_return_data ;
             end if;
 /*         else
                begin
                select
                   valam.valid_value_name
                   , F_fm_GET_SLIP_BANKDESC(supp.work_comp, supp.work_date, supp.work_no, supp.work_seq, supp.supply_seq) as give_deposit
                into
                   ls_give_name
                   , ls_give_depositor
                from
                   fm_slip_supply supp

                   , fm_code_validation valam
                   , (
                      select
                         work_date
                         , work_no
                         , work_seq
                         , min(supply_seq) as supply_seq
                      from
                         fm_slip_supply
                      where
                            work_comp = av_comp
                         and work_date = ad_date
                         and work_no = an_no

                         and work_seq = an_seq
                      group by
                         work_date
                         , work_no
                         , work_seq
                      ) mins
                where
                   supp.work_date = mins.work_date
                   and supp.work_no = mins.work_no
                   and supp.work_seq = mins.work_seq
                   and supp.supply_seq = mins.supply_seq
                   and supp.acnt_code = valam.valid_value_level
                   and valam.validation_code = '39'

                ;
             --
             exception
                when no_data_found then ls_give_name := null ;
             end;
             --
             if (ls_give_name is not null) then
                ls_work_return_data := ':'||'['||ls_give_name||']' ;
                --
                if ls_give_depositor is not null then
                   ls_work_return_data := ls_work_return_data ||'=> '||ls_give_depositor ;
                end if ;
             end if ;

 */         end if;
       end if;

       --
       if (c_cur1_val.BANK_CODE is not null) then
          ls_work_return_data := ls_work_return_data ||':'|| c_cur1_val.BANK_NAME ;
       end if;

       --
       if (c_cur1_val.DEPOSIT_NO is not null) then
          ls_work_return_data := ls_work_return_data ||':'|| c_cur1_val.DEPOSIT_NO;
       end if;


       --
       if (c_cur1_val.USER_ID is not null) then
          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.EMP_NAME;
       end if ;

       --
       if (c_cur1_val.PHONE is not null) then
          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.PHONE;
       end if ;

       --1
       if ( c_cur1_val.QTY1 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.QTY1_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.QTY1,'999,999,999.999')));

       end if ;

       --2
       if ( c_cur1_val.QTY2 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.QTY2_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.QTY2,'999,999,999.999')));
       end if ;

       --3
       if ( c_cur1_val.QTY3 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.QTY3_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.QTY3,'999,999,999.999')));
       end if ;

       --1

       if ( c_cur1_val.AMT1 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT1_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT1,'999,999,999,999,999')));
       end if ;

       --2
       if ( c_cur1_val.AMT2 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT2_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT2,'999,999,999,999,999')));
       end if ;

       --3
       if ( c_cur1_val.AMT3 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT3_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT3,'999,999,999,999,999')));
       end if ;


       --4
       if ( c_cur1_val.AMT4 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT4_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT4,'999,999,999,999,999')));
       end if ;

       --5
       if ( c_cur1_val.AMT5 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT5_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT5,'999,999,999,999,999')));
       end if ;

       --6
       if ( c_cur1_val.AMT6 <> 0 ) then

             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT6_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT6,'999,999,999,999,999')));
       end if ;

       --1
       if ( c_cur1_val.RATE1 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.RATE1_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.RATE1,'999,999.99')));
       end if ;

       --2
       if ( c_cur1_val.RATE2 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.RATE2_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.RATE2,'999,999.99')));
       end if ;


       --3
       if ( c_cur1_val.RATE3 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.RATE3_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.RATE3,'999,999.99')));
       end if ;

       --1
       if (c_cur1_val.DATE1 is not null and trim(c_cur1_val.DATE1) <> '') then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DATE1_NAME||':'||ltrim(rtrim(to_char(to_date(c_cur1_val.DATE1),'yyyy-mm-dd')));
       end if ;

       --2
       if (c_cur1_val.DATE2 is not null and trim(c_cur1_val.DATE2) <> '') then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DATE2_NAME||':'||ltrim(rtrim(to_char(to_date(c_cur1_val.DATE2),'yyyy-mm-dd')));

       end if ;

       --3
       if (c_cur1_val.DATE3 is not null and trim(c_cur1_val.DATE3) <> '') then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DATE3_NAME||':'||ltrim(rtrim(to_char(to_date(c_cur1_val.DATE3),'yyyy-mm-dd')));
       end if ;

       --4
       if (c_cur1_val.DATE4 is not null and trim(c_cur1_val.DATE4) <> '') then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DATE4_NAME||':'||ltrim(rtrim(to_char(to_date(c_cur1_val.DATE4),'yyyy-mm-dd')));
       end if ;

       --1

       if (c_cur1_val.DESC1 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DESC1_NAME||':'||c_cur1_val.DESC1;
       end if ;

       --2
       if (c_cur1_val.DESC2 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DESC2_NAME||':'||c_cur1_val.DESC2;
       end if ;

       --3
       if (c_cur1_val.DESC3 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DESC3_NAME||':'||c_cur1_val.DESC3;
       end if ;


       --4
       if (c_cur1_val.DESC4 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DESC4_NAME||':'||c_cur1_val.DESC4;
       end if ;

       --5
       if (c_cur1_val.DESC5 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DESC5_NAME||':'||c_cur1_val.DESC5;
       end if ;

    end loop;
    close c_cur1_sql;


    return ls_work_return_data ;
 end;

/





CREATE OR REPLACE FUNCTION           "F_FM_GET_SLIP_NO" (

   AS_COMP VARCHAR2
 , AS_DATE VARCHAR2
 , AN_NO   NUMBER
 )
 Return VARCHAR2 Is
    vReturn VARCHAR2(40);
    vNumber VARCHAR2(10);
 Begin
    If (AS_DATE Is NULL Or AS_DATE = '') Then Return ''; End If;
    vNumber := LTRIM(RTRIM(To_Char(AN_NO, '0000')));
    vReturn := AS_DATE || '-' || vNumber;
    Return vReturn;

 End;

/





CREATE OR REPLACE FUNCTION           "F_FM_GET_WORKITEM_NO" (

   AS_COMP VARCHAR2
 , AS_DATE VARCHAR2
 , AS_DEPT VARCHAR2
 , AN_NO   NUMBER
 , AN_SEQ  NUMBER
 )
 Return VARCHAR2 Is
    vReturn VARCHAR2(40);
    vNumber VARCHAR2(10);
 Begin
    If (AS_DATE Is NULL Or AS_DATE = '') Then Return ''; End If;
    vNumber := LTRIM(RTRIM(To_Char(AN_NO, '0000'))) || '-' || LTRIM(RTRIM(To_Char(AN_SEQ, '000')));

    vReturn := AS_DATE || '-' || LTRIM(RTRIM(AS_DEPT)) || '-' || vNumber;
    Return vReturn;
 End;

/





CREATE OR REPLACE FUNCTION           "F_FM_GET_WORK_NO" (

   AS_COMP VARCHAR2
 , AS_DATE VARCHAR2
 , AS_DEPT VARCHAR2
 , AN_NO   NUMBER
 )
 Return VARCHAR2 Is
    vReturn VARCHAR2(40);
    vNumber VARCHAR2(10);
 Begin
    If (AS_DATE Is NULL Or AS_DATE = '') Then Return ''; End If;
    vNumber := LTRIM(RTRIM(To_Char(AN_NO, '0000')));
    vReturn := AS_DATE || '-' || LTRIM(RTRIM(AS_DEPT)) || '-' || vNumber;

    Return vReturn;
 End;

/





CREATE  OR REPLACE  FUNCTION F_HD_GET_DELAY ( 

  as_custcode       IN VARCHAR2,   -- 
  as_seq            IN VARCHAR2,   -- 
  as_counts         IN VARCHAR2,   -- 
  as_base_date      IN VARCHAR2    -- 
) return NUMBER IS
CURSOR DETAIL_CUR (V_AGREEDATE VARCHAR2, V_MONTHS INTEGER )IS
  SELECT delayrate,delaycut,delayunit,startdate,enddate
    FROM hd_hous_rate_delay
    WHERE cust_code  = as_custcode
      AND seq        = TO_NUMBER(as_seq)
      AND enddate   >= V_AGREEDATE
      AND startdate  <= as_base_date
      AND ((end_tag = '1' and end_days >= V_MONTHS) or (end_tag = '2' and end_days > V_MONTHS))
      AND ((start_tag = '1' and start_days <= V_MONTHS) or (start_tag = '2' and start_days < V_MONTHS));

-------------------------------------------------------------
-- 
-------------------------------------------------------------
--  
   C_DEPT_CODE         VARCHAR2(12);  -- 
   C_HOUSETAG          VARCHAR2(1);   -- 
   C_DT_BASE_DATE      DATE;     --  
   C_DT_AGREEDATE      DATE;     --  
   C_CNT               NUMBER;   --
   C_MONTHS            NUMBER(10,5);   -- 
   C_DAYS              NUMBER(10,5);   --
   C_DELAY_DAY         NUMBER(10,5);   -- 
   C_DELAY_AMT         NUMBER(30,9);   -- 
   C_BUNAMT            NUMBER(30,9);   -- 
   C_AGREEDATE         VARCHAR2(8);    -- 
   C_RECEIPTAMT        NUMBER(30,9);   -- 
   C_WORK_AMT          NUMBER(30,9);   -- 
--   C_TEMP_RATE         NUMBER(30,9);   -- 
   C_TEMP_RATE         NUMBER;         -- 
   C_TEMP_CNT          NUMBER(10,5);   -- 
   C_DELAYRATE         NUMBER(30,9);
   C_DELAYCUT          VARCHAR2(2);
   C_DELAYUNIT         VARCHAR2(2);
   C_STARTDATE         VARCHAR2(8);
   C_ENDDATE           VARCHAR2(8);
   C_COMP_UNIT         INTEGER;
   C_DC_YN             VARCHAR2(1);
   C_AC_YN             VARCHAR2(1);
   C_TEMP_DAYS         NUMBER(10,5);   --
   C_MOVEINENDDATE     VARCHAR2(8);
   C_DAYMONTH          VARCHAR2(1); --

   C_TEMPDT            VARCHAR(8);

BEGIN
   BEGIN
      C_DELAY_AMT := 0;
      C_DT_BASE_DATE := to_date(as_base_date, 'YYYYMMDD'); --Date
      -----------------------------------------------------
      -- ,  .
      select dept_code, housetag, moveinenddate, daymonth_tag
        into C_DEPT_CODE, C_HOUSETAG, C_MOVEINENDDATE, C_DAYMONTH
        from hd_hous_sell
        where cust_code = as_custcode
          and seq = TO_NUMBER(as_seq);

      -- ,, ,  
      select nvl((TO_DATE(agreedate, 'YYYYMMDD') - TO_DATE(as_base_date, 'YYYYMMDD')) * -1,0),nvl(bunamt,0),agreedate,dc_yn,ac_yn
        into C_DAYS,C_BUNAMT,C_AGREEDATE,C_DC_YN,C_AC_YN
        from hd_hous_selldetail
        where cust_code = as_custcode
          and seq = TO_NUMBER(as_seq)
          and counts = as_counts;

      --   
      if C_DAYS > 0 THEN --  
         if as_counts = '90' then
            if nvl(C_MOVEINENDDATE, 'X') <> 'X' then
               C_TEMP_DAYS := nvl((to_date(C_AGREEDATE, 'YYYYMMDD') - to_date(C_MOVEINENDDATE, 'YYYYMMDD')) * -1,0);
               if C_DAYS <= C_TEMP_DAYS then
                  C_DAYS := 0;
               else
                  C_AGREEDATE := C_MOVEINENDDATE;
                  C_DAYS := nvl((to_date(C_AGREEDATE, 'YYYYMMDD') - to_date(as_base_date, 'YYYYMMDD')) * -1,0);
               end if;
            end if;
         end if;

         --  .
         C_TEMPDT := F_HD_GET_HOLIDAY(C_DEPT_CODE, C_HOUSETAG, C_AGREEDATE, 'Y');
         IF C_TEMPDT >= as_base_date THEN
            C_DAYS := 0;
         END IF;
      else
         C_DAYS := 0;
      end if;

      --  .
      select nvl(sum(receiptamt),0)
        into C_RECEIPTAMT
        from hd_hous_income
        where cust_code = as_custcode
          and seq = TO_NUMBER(as_seq)
          and counts = as_counts;
      --   ().
      C_WORK_AMT := C_BUNAMT - C_RECEIPTAMT;

      ---------------------------------------------------------------------
      if C_DAYS > 0 THEN 
         C_DELAY_DAY    := 0;
         C_DELAY_AMT    := 0;

         if C_AC_YN = 'Y' then
            C_DELAY_DAY   := C_DAYS;
            C_TEMP_RATE := 0;
            -- 

--            C_DT_AGREEDATE := to_date(C_AGREEDATE, 'YYYYMMDD') + 1;
            IF (as_counts = '90' AND C_MOVEINENDDATE IS NOT NULL AND C_AGREEDATE < C_MOVEINENDDATE) THEN
               C_DT_AGREEDATE := to_date(C_MOVEINENDDATE, 'YYYYMMDD') + 1;
            ELSE
               C_DT_AGREEDATE := to_date(C_AGREEDATE, 'YYYYMMDD') + 1;
            END IF;                    

            IF C_DAYMONTH = '2' THEN
               C_MONTHS := months_between(C_DT_BASE_DATE, C_DT_AGREEDATE);
            ELSE
               C_MONTHS := C_DT_BASE_DATE - C_DT_AGREEDATE;
            END IF;

            OPEN DETAIL_CUR(C_AGREEDATE,C_MONTHS);
            LOOP
               FETCH DETAIL_CUR INTO C_DELAYRATE,C_DELAYCUT,C_DELAYUNIT,C_STARTDATE,C_ENDDATE;
               EXIT WHEN DETAIL_CUR%NOTFOUND;
               C_COMP_UNIT :=
                  CASE C_DELAYUNIT
                     WHEN '1' THEN 1
                     WHEN '2' THEN 10
                     WHEN '3' THEN 100
                     WHEN '4' THEN 1000
                     WHEN '5' THEN 10000
                     WHEN '6' THEN 100000
                     ELSE 1
                  END;
               if C_AGREEDATE >= C_STARTDATE and as_base_date <= C_ENDDATE then
--@@                  C_TEMP_RATE := 1 + ( C_DELAY_DAY / 365 ) * ( C_DELAYRATE / 100 ) ;
                  C_TEMP_RATE := ( C_DELAY_DAY / 365 ) * ( C_DELAYRATE / 100 ) ;
                  if C_DELAYCUT = '1' then
--@@                     C_DELAY_AMT := trunc(((C_WORK_AMT * C_TEMP_RATE) - C_WORK_AMT) / C_COMP_UNIT,0) * C_COMP_UNIT;
                     C_DELAY_AMT := trunc((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
                  else
                     if C_DELAYCUT = '2' then
--@@                        C_DELAY_AMT := trunc(((C_WORK_AMT * C_TEMP_RATE) - C_WORK_AMT) / C_COMP_UNIT + 0.9,0) * C_COMP_UNIT;
                        C_DELAY_AMT := trunc((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT + 0.9,0) * C_COMP_UNIT;
                     else
--@@                        C_DELAY_AMT := round(((C_WORK_AMT * C_TEMP_RATE) - C_WORK_AMT) / C_COMP_UNIT,0) * C_COMP_UNIT;
                        C_DELAY_AMT := round((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
                     end if;
                  end if;
                  EXIT;
               end if;

               if C_AGREEDATE >= C_STARTDATE then
                  C_TEMP_CNT := nvl(to_date(C_ENDDATE, 'YYYYMMDD') - to_date(C_AGREEDATE, 'YYYYMMDD') ,0);
               else
                  if as_base_date <= C_ENDDATE then
                     C_TEMP_CNT := nvl(to_date(as_base_date, 'YYYYMMDD') - to_date(C_STARTDATE, 'YYYYMMDD') + 1,0);
                  else
                     C_TEMP_CNT := nvl(to_date(C_ENDDATE, 'YYYYMMDD') - to_date(C_STARTDATE, 'YYYYMMDD') + 1,0);
                  end if;
               end if;

--@@               C_TEMP_RATE := 1 + (C_TEMP_CNT / 365) * (C_DELAYRATE / 100);
               C_TEMP_RATE := (C_TEMP_CNT / 365) * (C_DELAYRATE / 100);
               if C_DELAYCUT = '1' then
--@@                  C_DELAY_AMT := C_DELAY_AMT + trunc(((C_WORK_AMT * C_TEMP_RATE) - C_WORK_AMT) / C_COMP_UNIT,0) * C_COMP_UNIT;
                  C_DELAY_AMT := C_DELAY_AMT + trunc((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
               else
                  if C_DELAYCUT = '2' then
--@@                     C_DELAY_AMT := C_DELAY_AMT + trunc(((C_WORK_AMT * C_TEMP_RATE) - C_WORK_AMT) / C_COMP_UNIT + 0.9,0) * C_COMP_UNIT;
                     C_DELAY_AMT := C_DELAY_AMT + trunc((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT + 0.9,0) * C_COMP_UNIT;
                  else
--@@                     C_DELAY_AMT := C_DELAY_AMT + round(((C_WORK_AMT * C_TEMP_RATE) - C_WORK_AMT) / C_COMP_UNIT,0) * C_COMP_UNIT;
                     C_DELAY_AMT := C_DELAY_AMT + round((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
                  end if;
               end if;
            END LOOP;
            CLOSE DETAIL_CUR;
         else
            C_DELAY_AMT := 0;
         end if;
      else
         C_DELAY_AMT := 0;
      end if;
   END;
   return C_DELAY_AMT;
END;

/





CREATE  OR REPLACE  FUNCTION F_HD_GET_DELAYALL (

   as_cust VARCHAR2,
   as_seq  VARCHAR2,
   as_dt   VARCHAR2
)
RETURN NUMBER IS
/* ****************************************************************** */
/*    
/* ****************************************************************** */

-------------------------------------------------------------------VALUES
ll_damt  NUMBER;

---------------------------------------------------------------CUR VALUES
c_counts VARCHAR2(2);

---------------------------------------------------------------------
CURSOR CURD IS
SELECT COUNTS
  FROM HD_HOUS_SELLDETAIL
 WHERE CUST_CODE = as_cust
   AND SEQ       = TO_NUMBER(as_seq)
   AND COUNTS <> '99'
 ORDER BY COUNTS;

-------------------------------------------------------------------------
BEGIN
   ll_damt := 0;

   OPEN CURD;
   LOOP
      FETCH CURD INTO c_counts;
         EXIT WHEN CURD%NOTFOUND;
      ll_damt := ll_damt + NVL(F_HD_GET_DELAY(as_cust, as_seq, c_counts, as_dt), 0);
   END LOOP;
   CLOSE CURD;
   RETURN ll_damt;
END;

/





CREATE  OR REPLACE  FUNCTION F_HD_GET_DELAYDAYCNT

(
   as_dept  VARCHAR2,
   as_htag  VARCHAR2,
   as_dt    VARCHAR2
)
RETURN NUMBER IS

-------------------------------------------------------------------VALUES
v_cnt    NUMBER(10);
v_day    VARCHAR2(8);
v_tmp    VARCHAR2(8);
-------------------------------------------------------------------------
BEGIN
   v_cnt := 0;
   v_day := as_dt;

   LOOP
      SELECT COUNT(*), MAX(TO_CHAR(TO_DATE(HOLIDAY, 'YYYYMMDD') + GONG_DAYS, 'YYYYMMDD'))
        INTO v_cnt,    v_tmp
        FROM HD_REFER_HOLIDAY
       WHERE DEPT_CODE         = as_dept
         AND HOUSETAG          = as_htag
         AND RATE_TAG          = '1'
         AND AD_TAG            = '1'
         AND NVL(GONG_DAYS, 0) > 0
         AND ((HOLIDAY = v_day) OR
              (v_day BETWEEN HOLIDAY AND TO_CHAR((TO_DATE(HOLIDAY, 'YYYYMMDD') - 1 + GONG_DAYS), 'YYYYMMDD')));
      IF v_cnt < 1 THEN EXIT; END IF;
      v_day := v_tmp;
   END LOOP;

   RETURN NVL(TO_DATE(v_day, 'YYYYMMDD') - TO_DATE(as_dt, 'YYYYMMDD'), 0);
END;

/





CREATE  OR REPLACE  FUNCTION F_HD_GET_DELAYDAY ( 

  as_custcode       IN VARCHAR2,   -- 
  ai_seq            IN INTEGER,    -- 
  as_counts         IN VARCHAR2,   -- 
  as_base_date      IN VARCHAR2    -- 
) return NUMBER IS
-------------------------------------------------------------
-- 
-------------------------------------------------------------
--  
   C_DEPT_CODE         VARCHAR2(12);  -- 
   C_HOUSETAG          VARCHAR2(1);   -- 
   C_CNT               NUMBER;   --
   C_DAYS              NUMBER(10,5);   --
   C_TEMP_DAYS         NUMBER(10,5);   --
   C_DELAY_DAY         NUMBER(10,5);   -- 
   C_AGREEDATE         VARCHAR2(8);    -- 
   C_TEMP_CNT          NUMBER(10,5);   -- 
   C_DC_YN             VARCHAR2(1);
   C_AC_YN             VARCHAR2(1);
   C_MOVEINENDDATE     VARCHAR2(8);

BEGIN
   BEGIN
      -----------------------------------------------------
      -- , ,  .
      select dept_code, housetag, moveinenddate
        into C_DEPT_CODE,C_HOUSETAG,C_MOVEINENDDATE
        from hd_hous_sell
        where cust_code = as_custcode
          and seq = ai_seq;

      -- ,, ,  
      select nvl((to_date(agreedate, 'YYYYMMDD') - to_date(as_base_date, 'YYYYMMDD')) * -1,0),agreedate,dc_yn,ac_yn
        into C_DAYS,C_AGREEDATE,C_DC_YN,C_AC_YN
        from hd_hous_selldetail
        where cust_code = as_custcode
          and seq = ai_seq
          and counts = as_counts;

      if C_DAYS <= 0 then
         return 0; 
      end if;

      --   
      if as_counts = '90' then
         if nvl(C_MOVEINENDDATE, 'X') <> 'X' then
            C_TEMP_DAYS := nvl((to_date(C_AGREEDATE, 'YYYYMMDD') - to_date(C_MOVEINENDDATE, 'YYYYMMDD')) * -1,0);
            if C_DAYS <= C_TEMP_DAYS then
               C_DAYS := 0;
            else 
               C_AGREEDATE := C_MOVEINENDDATE;
               C_DAYS := nvl((to_date(C_AGREEDATE, 'YYYYMMDD') - to_date(as_base_date, 'YYYYMMDD')) * -1,0);
            end if;
         end if;
      end if;

      --  .
      if C_DAYS > 0 THEN --  
--         select count(*),nvl(max(gong_days),0) into C_CNT,C_TEMP_CNT
--           from hd_refer_holiday
--           where dept_code = C_DEPT_CODE
--             and housetag = C_HOUSETAG
--             and ad_tag = '1'
--             and holiday = C_AGREEDATE;
--         if C_CNT > 0 then
--            if C_DAYS <= C_TEMP_CNT then
--               C_DAYS := 0;
--            end if;
--         end if;
         C_CNT := F_HD_GET_DELAYDAYCNT(C_DEPT_CODE, C_HOUSETAG, C_AGREEDATE);
         IF C_DAYS <= C_CNT THEN
            C_DAYS := 0;
         END IF;

         C_DELAY_DAY := C_DAYS;
      else
         C_DELAY_DAY := 0;
      end if;
   END;
   return C_DELAY_DAY; 
END;

/





CREATE  OR REPLACE  FUNCTION F_HD_GET_DISCNT ( 

  as_custcode       IN VARCHAR2,   -- 
  ai_seq            IN INTEGER,    -- 
  as_counts         IN VARCHAR2,   -- 
  as_base_date      IN VARCHAR2    -- 
) return NUMBER IS
CURSOR DETAIL_CUR (V_AGREEDATE VARCHAR2 )IS
  SELECT discntrate,discntcut,discntunit,startdate,enddate
    FROM hd_hous_rate_discount
    WHERE cust_code  = as_custcode
      AND seq        = ai_seq
      AND enddate >= as_base_date
      AND startdate <= V_AGREEDATE;
-------------------------------------------------------------
-- 
-------------------------------------------------------------
--  
   C_DEPT_CODE         VARCHAR2(12);  -- 
   C_HOUSETAG          VARCHAR2(1);   -- 
   C_CNT               NUMBER;   --
   C_DAYS              NUMBER(10,5);   --
   C_TEMP_DAYS         NUMBER(10,5);   --
   C_DISCOUNT_DAY      NUMBER(10,5);   -- 
   C_DISCOUNT_AMT      NUMBER(30,9);   -- 
   C_BUNAMT            NUMBER(30,9);   -- 
   C_AGREEDATE         VARCHAR2(8);    -- 
   C_RECEIPTAMT        NUMBER(30,9);   -- 
   C_WORK_AMT          NUMBER(30,9);   -- 
   C_TEMP_RATE         NUMBER(30,9);   -- 
   C_TEMP_CNT          NUMBER(10,5);   -- 
   C_STARTDATE         VARCHAR2(8);
   C_ENDDATE           VARCHAR2(8);
   C_DISCNTRATE        NUMBER(30,9);
   C_DISCNTCUT         VARCHAR2(1);
   C_DISCNTUNIT        VARCHAR2(1);
   C_COMP_UNIT         INTEGER;
   C_DC_YN             VARCHAR2(1);
   C_AC_YN             VARCHAR2(1);
   C_MOVEINENDDATE     VARCHAR2(8);
   C_DAYMONTH          VARCHAR2(1); --

BEGIN
   BEGIN
      -----------------------------------------------------
      -- , ,  .
      select dept_code, housetag, moveinenddate, daymonth_tag
        into C_DEPT_CODE,C_HOUSETAG,C_MOVEINENDDATE, C_DAYMONTH
        from hd_hous_sell
        where cust_code = as_custcode
          and seq = ai_seq;

      -- ,, ,  
      select nvl((to_date(agreedate, 'YYYYMMDD') - to_date(as_base_date, 'YYYYMMDD')) * -1,0),nvl(bunamt,0),agreedate,dc_yn,ac_yn
        into C_DAYS,C_BUNAMT,C_AGREEDATE,C_DC_YN,C_AC_YN
        from hd_hous_selldetail
        where cust_code = as_custcode
          and seq = ai_seq
          and counts = as_counts;

      --   
      if as_counts = '90' then
         if nvl(C_MOVEINENDDATE, 'X') <> 'X' then
            C_TEMP_DAYS := nvl((to_date(C_AGREEDATE, 'YYYYMMDD') - to_date(C_MOVEINENDDATE, 'YYYYMMDD')) * -1,0);
            if C_DAYS <= C_TEMP_DAYS then
               C_DAYS := 0;
            else 
               C_AGREEDATE := C_MOVEINENDDATE;
               C_DAYS := nvl((to_date(C_AGREEDATE, 'YYYYMMDD') - to_date(as_base_date, 'YYYYMMDD')) * -1,0);
            end if;
         end if;
      end if;

      --  .
      if C_DAYS < 0 THEN --  
         select count(*),nvl(max(gong_days),0) into C_CNT,C_TEMP_CNT
           from hd_refer_holiday
           where dept_code = C_DEPT_CODE
             and housetag = C_HOUSETAG
             and ad_tag = '2'
             and holiday = C_AGREEDATE;
         if C_CNT > 0 then
            C_CNT := C_DAYS * -1;
            if C_CNT <= C_TEMP_CNT then
               C_DAYS := 0;
            end if;
         end if;
      end if;

      --  .
      select nvl(sum(receiptamt),0)
        into C_RECEIPTAMT
        from hd_hous_income
        where cust_code = as_custcode
          and seq = ai_seq
          and counts = as_counts;
      --   ().
      C_WORK_AMT := C_BUNAMT - C_RECEIPTAMT;

      if C_DAYS < 0 THEN --  
         ------------------------------------------------------------
         --  
         ------------------------------------------------------------
         C_DISCOUNT_DAY := 0;
         C_DISCOUNT_AMT := 0;
         if C_DC_YN = 'Y' THEN  -- 
            C_DISCOUNT_DAY   := C_DAYS * -1;
            C_TEMP_RATE := 0;
            OPEN DETAIL_CUR(C_AGREEDATE);
            LOOP
               FETCH DETAIL_CUR INTO C_DISCNTRATE,C_DISCNTCUT,C_DISCNTUNIT,C_STARTDATE,C_ENDDATE;
                 EXIT WHEN DETAIL_CUR%NOTFOUND;
               C_COMP_UNIT :=
                  CASE C_DISCNTUNIT
                     WHEN '1' THEN 1
                     WHEN '2' THEN 10
                     WHEN '3' THEN 100
                     WHEN '4' THEN 1000
                     WHEN '5' THEN 10000
                     WHEN '6' THEN 100000
                  ELSE 1
                  END;
               if C_AGREEDATE <= C_ENDDATE and as_base_date >= C_STARTDATE then
--@@                  C_TEMP_RATE := 1 - ( C_DISCOUNT_DAY / 365 ) * ( C_DISCNTRATE / 100 ) ;
                  C_TEMP_RATE := ( C_DISCOUNT_DAY / 365 ) * ( C_DISCNTRATE / 100 ) ;
                  if C_DISCNTCUT = '1' then
--@@                     C_DISCOUNT_AMT := trunc((C_WORK_AMT - (C_WORK_AMT * C_TEMP_RATE)) / C_COMP_UNIT,0) * C_COMP_UNIT;
                     C_DISCOUNT_AMT := trunc((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
                  else
                     if C_DISCNTCUT = '2' then
--@@                        C_DISCOUNT_AMT := trunc((C_WORK_AMT - (C_WORK_AMT * C_TEMP_RATE)) / C_COMP_UNIT + 0.9,0) * C_COMP_UNIT;
                        C_DISCOUNT_AMT := trunc((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT + 0.9,0) * C_COMP_UNIT;
                     else
--@@                        C_DISCOUNT_AMT := round((C_WORK_AMT - (C_WORK_AMT * C_TEMP_RATE)) / C_COMP_UNIT,0) * C_COMP_UNIT;
                        C_DISCOUNT_AMT := round((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
                     end if;
                  end if;
                  EXIT;
               end if;
               if as_base_date >= C_STARTDATE then
                  C_TEMP_CNT := nvl(to_date(C_ENDDATE, 'YYYYMMDD') - to_date(as_base_date, 'YYYYMMDD') ,0);
               else
                  if C_AGREEDATE <= C_ENDDATE then
                     C_TEMP_CNT := nvl(to_date(C_AGREEDATE, 'YYYYMMDD') - to_date(C_STARTDATE, 'YYYYMMDD') + 1,0);
                  else
                     C_TEMP_CNT := nvl(to_date(C_ENDDATE, 'YYYYMMDD') - to_date(C_STARTDATE, 'YYYYMMDD') + 1,0);
                  end if;
               end if;
--@@               C_TEMP_RATE := 1 - (C_TEMP_CNT / 365) * (C_DISCNTRATE / 100);
               C_TEMP_RATE := (C_TEMP_CNT / 365) * (C_DISCNTRATE / 100);
               if C_DISCNTCUT = '1' then
--@@                  C_DISCOUNT_AMT := C_DISCOUNT_AMT + trunc((C_WORK_AMT - (C_WORK_AMT * C_TEMP_RATE)) / C_COMP_UNIT,0) * C_COMP_UNIT;
                  C_DISCOUNT_AMT := C_DISCOUNT_AMT + trunc((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
               else
                  if C_DISCNTCUT = '2' then
--@@                     C_DISCOUNT_AMT := C_DISCOUNT_AMT + trunc((C_WORK_AMT - (C_WORK_AMT * C_TEMP_RATE)) / C_COMP_UNIT + 0.9,0) * C_COMP_UNIT;
                     C_DISCOUNT_AMT := C_DISCOUNT_AMT + trunc((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT + 0.9,0) * C_COMP_UNIT;
                  else
--@@                     C_DISCOUNT_AMT := C_DISCOUNT_AMT + round((C_WORK_AMT - (C_WORK_AMT * C_TEMP_RATE)) / C_COMP_UNIT,0) * C_COMP_UNIT;
                     C_DISCOUNT_AMT := C_DISCOUNT_AMT + round((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
                  end if;
               end if;
            END LOOP;
            CLOSE DETAIL_CUR;
         else
            C_DISCOUNT_AMT := 0;
         end if;
      else
         C_DISCOUNT_AMT := 0;
      end if;
   END;
   return C_DISCOUNT_AMT; 
END;

/





CREATE  OR REPLACE  FUNCTION F_HD_GET_DISCNTDAY ( 

  as_custcode       IN VARCHAR2,   -- 
  ai_seq            IN INTEGER,    -- 
  as_counts         IN VARCHAR2,   -- 
  as_base_date      IN VARCHAR2    -- 
) return NUMBER IS
-------------------------------------------------------------
-- 
-------------------------------------------------------------
--  
   C_DEPT_CODE         VARCHAR2(12);  -- 
   C_HOUSETAG          VARCHAR2(1);   -- 
   C_CNT               NUMBER;   --
   C_DAYS              NUMBER(10,5);   --
   C_TEMP_DAYS         NUMBER(10,5);   --
   C_DISCOUNT_DAY      NUMBER(10,5);   -- 
   C_AGREEDATE         VARCHAR2(8);    -- 
   C_TEMP_CNT          NUMBER(10,5);   -- 
   C_DC_YN             VARCHAR2(1);
   C_AC_YN             VARCHAR2(1);
   C_MOVEINENDDATE     VARCHAR2(8);

BEGIN
   BEGIN
      -----------------------------------------------------
      -- , ,  .
      select dept_code, housetag, moveinenddate
        into C_DEPT_CODE,C_HOUSETAG,C_MOVEINENDDATE
        from hd_hous_sell
        where cust_code = as_custcode
          and seq = ai_seq;

      -- ,, ,  
      select nvl((to_date(agreedate, 'YYYYMMDD') - to_date(as_base_date, 'YYYYMMDD')) * -1,0),agreedate,dc_yn,ac_yn
        into C_DAYS,C_AGREEDATE,C_DC_YN,C_AC_YN
        from hd_hous_selldetail
        where cust_code = as_custcode
          and seq = ai_seq
          and counts = as_counts;

      --  .
      if C_DAYS < 0 THEN --  
         select count(*),nvl(max(gong_days),0) into C_CNT,C_TEMP_CNT
           from hd_refer_holiday
           where dept_code = C_DEPT_CODE
             and housetag = C_HOUSETAG
             and ad_tag = '2'
             and holiday = C_AGREEDATE;
         if C_CNT > 0 then
            C_CNT := C_DAYS * -1;
            if C_CNT <= C_TEMP_CNT then
               C_DAYS := 0;
            end if;
         end if;
         C_DISCOUNT_DAY   := C_DAYS * -1;
      else
         C_DISCOUNT_DAY := 0;
      end if;
   END;
   return C_DISCOUNT_DAY; 
END;

/





CREATE  OR REPLACE  FUNCTION F_HD_GET_FIXRATE

(
   as_cust   VARCHAR2,   --
   as_seq    VARCHAR2,   --
   as_term   VARCHAR2,   --
   as_counts VARCHAR2,   --
   as_dt     VARCHAR2    --
)
RETURN FLOAT IS

-------------------------------------------------------------------VALUES
v_adt    VARCHAR2(8);
v_temp   VARCHAR2(8);
vd_temp  DATE;
vy_temp  VARCHAR2(1);
v_cnt    NUMBER(5);

v_day    NUMBER(3);    
v_rt1    FLOAT;
v_rt2    FLOAT;

-------------------------------------------------------------------------
BEGIN
   SELECT AGREE_DATE
     INTO v_adt
     FROM HD_RENT_RENT_AGREE
    WHERE CUST_CODE    = as_cust
      AND SEQ          = TO_NUMBER(as_seq)
      AND TERM_CHG_SEQ = TO_NUMBER(as_term) 
      AND COUNTS       = as_counts;

   SELECT NVL(FIXRATE_DAY, 0), NVL(FIXRATE, 0), NVL(FIXRATE2, 0)
     INTO v_day,               v_rt1,           v_rt2
     FROM HD_RENT_MASTER
    WHERE CUST_CODE = as_cust
      AND SEQ       = TO_NUMBER(as_seq);

   /* ********************************************************************* 1:   */
   v_cnt := 0;
   SELECT COUNT(*)
     INTO v_cnt
     FROM HD_RENT_MASTER A,
          HD_REFER_HOLIDAY B
    WHERE A.DEPT_CODE = B.DEPT_CODE
      AND A.HOUSETAG  = B.HOUSETAG
      AND A.CUST_CODE = as_cust
      AND A.SEQ       = TO_NUMBER(as_seq)
      AND B.RATE_TAG  = '1'
      AND B.AD_TAG    = '2'
      AND v_adt BETWEEN HOLIDAY AND TO_CHAR(TO_DATE(HOLIDAY, 'YYYYMMDD') + GONG_DAYS, 'YYYYMMDD');

   IF v_cnt < 1 THEN
      v_temp := v_adt;
   ELSE
      SELECT MAX(TO_CHAR(TO_DATE(HOLIDAY, 'YYYYMMDD') + GONG_DAYS, 'YYYYMMDD'))
        INTO v_temp
        FROM HD_RENT_MASTER A,
             HD_REFER_HOLIDAY B
       WHERE A.DEPT_CODE = B.DEPT_CODE
         AND A.HOUSETAG  = B.HOUSETAG
         AND A.CUST_CODE = as_cust
         AND A.SEQ       = TO_NUMBER(as_seq)
         AND B.RATE_TAG  = '1'
         AND B.AD_TAG    = '2'
         AND v_adt BETWEEN HOLIDAY AND TO_CHAR(TO_DATE(HOLIDAY, 'YYYYMMDD') + GONG_DAYS, 'YYYYMMDD');
   END IF;

   vd_temp := TO_DATE(v_temp, 'YYYYMMDD');
   vy_temp := TO_CHAR(vd_temp, 'D');
   IF vy_temp = '7' THEN
      v_temp := TO_CHAR(vd_temp + 2, 'YYYYMMDD');
   ELSIF vy_temp = '1' THEN
      v_temp := TO_CHAR(vd_temp + 1, 'YYYYMMDD');
   ELSE
      v_temp := TO_CHAR(vd_temp, 'YYYYMMDD');
   END IF;

   IF as_dt <= v_temp THEN
      RETURN 0; /* ..  0 */
   END IF;

   /* ********************************************************************* 2:   */
   v_adt := TO_CHAR(TO_DATE(v_adt, 'YYYYMMDD') + v_day, 'YYYYMMDD');
   v_cnt := 0;
   SELECT COUNT(*)
     INTO v_cnt
     FROM HD_RENT_MASTER A,
          HD_REFER_HOLIDAY B
    WHERE A.DEPT_CODE = B.DEPT_CODE
      AND A.HOUSETAG  = B.HOUSETAG
      AND A.CUST_CODE = as_cust
      AND A.SEQ       = TO_NUMBER(as_seq)
      AND B.RATE_TAG  = '1'
      AND B.AD_TAG    = '2'
      AND v_adt BETWEEN HOLIDAY AND TO_CHAR(TO_DATE(HOLIDAY, 'YYYYMMDD') + GONG_DAYS, 'YYYYMMDD');

   IF v_cnt < 1 THEN
      v_temp := v_adt;
   ELSE
      SELECT MAX(TO_CHAR(TO_DATE(HOLIDAY, 'YYYYMMDD') + GONG_DAYS, 'YYYYMMDD'))
        INTO v_temp
        FROM HD_RENT_MASTER A,
             HD_REFER_HOLIDAY B
       WHERE A.DEPT_CODE = B.DEPT_CODE
         AND A.HOUSETAG  = B.HOUSETAG
         AND A.CUST_CODE = as_cust
         AND A.SEQ       = TO_NUMBER(as_seq)
         AND B.RATE_TAG  = '1'
         AND B.AD_TAG    = '2'
         AND v_adt BETWEEN HOLIDAY AND TO_CHAR(TO_DATE(HOLIDAY, 'YYYYMMDD') + GONG_DAYS, 'YYYYMMDD');
   END IF;

   vd_temp := TO_DATE(v_temp, 'YYYYMMDD');
   vy_temp := TO_CHAR(vd_temp, 'D');
   IF vy_temp = '7' THEN
      v_temp := TO_CHAR(vd_temp + 2, 'YYYYMMDD');
   ELSIF vy_temp = '1' THEN
      v_temp := TO_CHAR(vd_temp + 1, 'YYYYMMDD');
   ELSE
      v_temp := TO_CHAR(vd_temp, 'YYYYMMDD');
   END IF;

   IF as_dt <= v_temp THEN
      RETURN v_rt1; /*  */
   END IF;

   /* ********************************************************************* 3:  */
   RETURN v_rt2;
END;








/





CREATE  OR REPLACE  FUNCTION F_HD_GET_RENT_GURT_DELAY ( 

  AS_CUST           IN VARCHAR2,   -- 
  AS_SEQ            IN VARCHAR2,   -- 
  AS_TERM           IN VARCHAR2,   -- 
  AS_COUNTS         IN VARCHAR2,   -- 
  AS_BASE_DATE      IN VARCHAR2    -- 
) RETURN NUMBER IS

CURSOR DETAIL_CUR (a_dt VARCHAR2, a_mon INTEGER )IS
   SELECT DELAYRATE, DELAYCUT, DELAYUNIT, STARTDATE, ENDDATE
     FROM HD_RENT_RATE_DELAY
    WHERE CUST_CODE   = AS_CUST
      AND SEQ         = TO_NUMBER(AS_SEQ)
      AND ENDDATE    >= a_dt
      AND STARTDATE  <= AS_BASE_DATE
      AND RATE_TAG    = '2' /*2  3*/
      AND ((END_TAG   = '1' AND END_DAYS   >= a_mon) OR
           (END_TAG   = '2' AND END_DAYS    > a_mon))
      AND ((START_TAG = '1' AND START_DAYS <= a_mon) OR
           (START_TAG = '2' AND START_DAYS  < a_mon));

-------------------------------------------------------------
-- 
-------------------------------------------------------------
--  
   C_DEPT_CODE         VARCHAR2(12);  -- 
   C_HOUSETAG          VARCHAR2(1);   -- 
   C_DT_BASE_DATE      DATE;          --  
   C_DT_AGREEDATE      DATE;          --  
   C_CNT               NUMBER;        --
   C_MONTHS            NUMBER(10,5);   -- 
   C_DAYS              NUMBER(10,5);   --
   C_DELAY_DAY         NUMBER(10,5);   -- 
   C_DELAY_AMT         NUMBER(30,9);   -- 
   C_BUNAMT            NUMBER(30,9);   -- 
   C_AGREEDATE         VARCHAR2(8);    -- 
   C_DELAY_YN          VARCHAR2(1);    -- 
   C_RECEIPTAMT        NUMBER(30,9);   -- 
   C_WORK_AMT          NUMBER(30,9);   -- 
   C_TEMP_RATE         NUMBER;         -- 
   C_TEMP_CNT          NUMBER(10,5);   -- 

   C_DELAYRATE         NUMBER(30,9);
   C_DELAYCUT          VARCHAR2(2);
   C_DELAYUNIT         VARCHAR2(2);
   C_STARTDATE         VARCHAR2(8);
   C_ENDDATE           VARCHAR2(8);

   C_COMP_UNIT         INTEGER;
   C_TEMP_DAYS         NUMBER(10,5);   --
   C_DAYMONTH          VARCHAR2(1); --

   C_TEMPDT            VARCHAR(8);

BEGIN
   BEGIN
      C_DELAY_AMT := 0;
      C_DT_BASE_DATE := TO_DATE(AS_BASE_DATE, 'YYYYMMDD'); --Date
      -----------------------------------------------------
      -- ,  .
      SELECT DEPT_CODE,   HOUSETAG,   DAYMONTH_TAG
        INTO C_DEPT_CODE, C_HOUSETAG, C_DAYMONTH
        FROM HD_RENT_MASTER
       WHERE CUST_CODE = AS_CUST
         AND SEQ       = TO_NUMBER(AS_SEQ);

      -- ,, 
      SELECT NVL((TO_DATE(AGREE_DATE, 'YYYYMMDD') - TO_DATE(AS_BASE_DATE, 'YYYYMMDD')) * -1,0),
             NVL(AGREE_AMT,0), AGREE_DATE,  DELAY_YN
        INTO C_DAYS, C_BUNAMT, C_AGREEDATE, C_DELAY_YN
        FROM HD_RENT_GURT_AGREE
       WHERE CUST_CODE    = AS_CUST
         AND SEQ          = TO_NUMBER(AS_SEQ)
         AND TERM_CHG_SEQ = TO_NUMBER(AS_TERM)
         AND COUNTS       = AS_COUNTS;

      IF C_DAYS > 0 THEN --  
         --  .
         C_TEMPDT := F_HD_GET_HOLIDAY(C_DEPT_CODE, C_HOUSETAG, C_AGREEDATE, 'N');
         IF C_TEMPDT >= AS_BASE_DATE THEN
            C_DAYS := 0;
         END IF;
      END IF;

      IF C_DAYS <= 0 OR C_DELAY_YN = 'N' THEN
         RETURN 0;
      END IF;

      --  .
      SELECT NVL(SUM(RECEIPT_AMT), 0)
        INTO C_RECEIPTAMT
        FROM HD_RENT_GURT_INCOME
       WHERE CUST_CODE    = AS_CUST
         AND SEQ          = TO_NUMBER(AS_SEQ)
         AND TERM_CHG_SEQ = TO_NUMBER(AS_TERM)
         AND COUNTS       = AS_COUNTS;
      --   ().
      C_WORK_AMT := C_BUNAMT - C_RECEIPTAMT;

      IF C_WORK_AMT = 0 THEN
         RETURN 0;
      END IF;

      ---------------------------------------------------------------------
      C_DELAY_AMT := 0;
      C_DELAY_DAY := C_DAYS;
      C_TEMP_RATE := 0;
      -- 

      C_DT_AGREEDATE := TO_DATE(C_AGREEDATE, 'YYYYMMDD') + 1;

      IF C_DAYMONTH = '2' THEN
         C_MONTHS := MONTHS_BETWEEN(C_DT_BASE_DATE, C_DT_AGREEDATE);
      ELSE
         C_MONTHS := C_DT_BASE_DATE - C_DT_AGREEDATE;
      END IF;

      OPEN DETAIL_CUR(C_AGREEDATE, C_MONTHS);
      LOOP
         FETCH DETAIL_CUR INTO C_DELAYRATE, C_DELAYCUT, C_DELAYUNIT, C_STARTDATE, C_ENDDATE;
         EXIT WHEN DETAIL_CUR%NOTFOUND;
         C_COMP_UNIT := CASE C_DELAYUNIT
                             WHEN '1' THEN 1
                             WHEN '2' THEN 10
                             WHEN '3' THEN 100
                             WHEN '4' THEN 1000
                             WHEN '5' THEN 10000
                             WHEN '6' THEN 100000
                             ELSE 1
                        END;


         IF C_AGREEDATE >= C_STARTDATE AND AS_BASE_DATE <= C_ENDDATE THEN
            C_TEMP_RATE := ( C_DELAY_DAY / 365 ) * ( C_DELAYRATE / 100 ) ;
            IF C_DELAYCUT = '1' THEN
               C_DELAY_AMT := TRUNC((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
            ELSE
               IF C_DELAYCUT = '2' THEN
                  C_DELAY_AMT := TRUNC((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT + 0.9,0) * C_COMP_UNIT;
               ELSE
                  C_DELAY_AMT := ROUND((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
               END IF;
            END IF;
            EXIT;
         END IF;

         IF C_AGREEDATE >= C_STARTDATE THEN
            C_TEMP_CNT := NVL(TO_DATE(C_ENDDATE, 'YYYYMMDD') - TO_DATE(C_AGREEDATE, 'YYYYMMDD') ,0);
         ELSE
            IF AS_BASE_DATE <= C_ENDDATE THEN
               C_TEMP_CNT := NVL(TO_DATE(AS_BASE_DATE, 'YYYYMMDD') - TO_DATE(C_STARTDATE, 'YYYYMMDD') + 1,0);
            ELSE
               C_TEMP_CNT := NVL(TO_DATE(C_ENDDATE, 'YYYYMMDD') - TO_DATE(C_STARTDATE, 'YYYYMMDD') + 1,0);
            END IF;
         END IF;

         C_TEMP_RATE := (C_TEMP_CNT / 365) * (C_DELAYRATE / 100);
         IF C_DELAYCUT = '1' THEN
            C_DELAY_AMT := C_DELAY_AMT + TRUNC((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
         ELSE
            IF C_DELAYCUT = '2' THEN
               C_DELAY_AMT := C_DELAY_AMT + TRUNC((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT + 0.9,0) * C_COMP_UNIT;
            ELSE
               C_DELAY_AMT := C_DELAY_AMT + ROUND((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
            END IF;
         END IF;
      END LOOP;
      CLOSE DETAIL_CUR;
   END;

   RETURN C_DELAY_AMT;
END;


/





CREATE  OR REPLACE  FUNCTION F_HD_GET_RENT_GURT_DELAYALL (

   as_cust VARCHAR2,
   as_seq  VARCHAR2,
   as_dt   VARCHAR2
)
RETURN NUMBER IS

/* ****************************************************************** */
/*    
/* ****************************************************************** */

-------------------------------------------------------------------VALUES
ll_damt  NUMBER;

---------------------------------------------------------------CUR VALUES
c_term   NUMBER(3);
c_counts VARCHAR2(2);

---------------------------------------------------------------------
CURSOR CURD IS
SELECT TERM_CHG_SEQ, COUNTS
  FROM HD_RENT_GURT_AGREE
 WHERE CUST_CODE    = as_cust
   AND SEQ          = TO_NUMBER(as_seq)
   AND TERM_CHG_SEQ <> 99
 ORDER BY TERM_CHG_SEQ, COUNTS;

-------------------------------------------------------------------------
BEGIN
   ll_damt := 0;

   OPEN CURD;
   LOOP
      FETCH CURD INTO c_term, c_counts;
         EXIT WHEN CURD%NOTFOUND;
      ll_damt := ll_damt + NVL(F_HD_GET_RENT_GURT_DELAY(as_cust, as_seq, c_term, c_counts, as_dt), 0);
   END LOOP;
   CLOSE CURD;
   RETURN ll_damt;
END;

/





CREATE  OR REPLACE  FUNCTION F_HD_GET_RENT_GURT_DISCNT ( 

  as_custcode       IN VARCHAR2,   -- 
  ai_seq            IN INTEGER,    -- 
  as_counts         IN VARCHAR2,   -- 
  as_base_date      IN VARCHAR2    -- 
) return NUMBER IS
CURSOR DETAIL_CUR (V_AGREEDATE VARCHAR2 )IS
  SELECT discntrate,discntcut,discntunit,startdate,enddate
    FROM hd_hous_rate_discount
    WHERE cust_code  = as_custcode
      AND seq        = ai_seq
      AND enddate >= as_base_date
      AND startdate <= V_AGREEDATE;
-------------------------------------------------------------
-- 
-------------------------------------------------------------
--  
   C_DEPT_CODE         VARCHAR2(12);  -- 
   C_HOUSETAG          VARCHAR2(1);   -- 
   C_CNT               NUMBER;   --
   C_DAYS              NUMBER(10,5);   --
   C_TEMP_DAYS         NUMBER(10,5);   --
   C_DISCOUNT_DAY      NUMBER(10,5);   -- 
   C_DISCOUNT_AMT      NUMBER(30,9);   -- 
   C_BUNAMT            NUMBER(30,9);   -- 
   C_AGREEDATE         VARCHAR2(8);    -- 
   C_RECEIPTAMT        NUMBER(30,9);   -- 
   C_WORK_AMT          NUMBER(30,9);   -- 
   C_TEMP_RATE         NUMBER(30,9);   -- 
   C_TEMP_CNT          NUMBER(10,5);   -- 
   C_STARTDATE         VARCHAR2(8);
   C_ENDDATE           VARCHAR2(8);
   C_DISCNTRATE        NUMBER(30,9);
   C_DISCNTCUT         VARCHAR2(1);
   C_DISCNTUNIT        VARCHAR2(1);
   C_COMP_UNIT         INTEGER;
   C_DC_YN             VARCHAR2(1);
   C_AC_YN             VARCHAR2(1);
   C_MOVEINENDDATE     VARCHAR2(8);
   C_DAYMONTH          VARCHAR2(1); --

BEGIN
   BEGIN
      -----------------------------------------------------
      -- , ,  .
      select dept_code, housetag, moveinenddate, daymonth_tag
        into C_DEPT_CODE,C_HOUSETAG,C_MOVEINENDDATE, C_DAYMONTH
        from hd_hous_sell
        where cust_code = as_custcode
          and seq = ai_seq;

      -- ,, ,  
      select nvl((to_date(agreedate, 'YYYYMMDD') - to_date(as_base_date, 'YYYYMMDD')) * -1,0),nvl(bunamt,0),agreedate,dc_yn,ac_yn
        into C_DAYS,C_BUNAMT,C_AGREEDATE,C_DC_YN,C_AC_YN
        from hd_hous_selldetail
        where cust_code = as_custcode
          and seq = ai_seq
          and counts = as_counts;

      --   
      if as_counts = '90' then
         if nvl(C_MOVEINENDDATE, 'X') <> 'X' then
            C_TEMP_DAYS := nvl((to_date(C_AGREEDATE, 'YYYYMMDD') - to_date(C_MOVEINENDDATE, 'YYYYMMDD')) * -1,0);
            if C_DAYS <= C_TEMP_DAYS then
               C_DAYS := 0;
            else 
               C_AGREEDATE := C_MOVEINENDDATE;
               C_DAYS := nvl((to_date(C_AGREEDATE, 'YYYYMMDD') - to_date(as_base_date, 'YYYYMMDD')) * -1,0);
            end if;
         end if;
      end if;

      --  .
      if C_DAYS < 0 THEN --  
         select count(*),nvl(max(gong_days),0) into C_CNT,C_TEMP_CNT
           from hd_refer_holiday
           where dept_code = C_DEPT_CODE
             and housetag = C_HOUSETAG
             and ad_tag = '2'
             and holiday = C_AGREEDATE;
         if C_CNT > 0 then
            C_CNT := C_DAYS * -1;
            if C_CNT <= C_TEMP_CNT then
               C_DAYS := 0;
            end if;
         end if;
      end if;

      --  .
      select nvl(sum(receiptamt),0)
        into C_RECEIPTAMT
        from hd_hous_income
        where cust_code = as_custcode
          and seq = ai_seq
          and counts = as_counts;
      --   ().
      C_WORK_AMT := C_BUNAMT - C_RECEIPTAMT;

      if C_DAYS < 0 THEN --  
         ------------------------------------------------------------
         --  
         ------------------------------------------------------------
         C_DISCOUNT_DAY := 0;
         C_DISCOUNT_AMT := 0;
         if C_DC_YN = 'Y' THEN  -- 
            C_DISCOUNT_DAY   := C_DAYS * -1;
            C_TEMP_RATE := 0;
            OPEN DETAIL_CUR(C_AGREEDATE);
            LOOP
               FETCH DETAIL_CUR INTO C_DISCNTRATE,C_DISCNTCUT,C_DISCNTUNIT,C_STARTDATE,C_ENDDATE;
                 EXIT WHEN DETAIL_CUR%NOTFOUND;
               C_COMP_UNIT :=
                  CASE C_DISCNTUNIT
                     WHEN '1' THEN 1
                     WHEN '2' THEN 10
                     WHEN '3' THEN 100
                     WHEN '4' THEN 1000
                     WHEN '5' THEN 10000
                     WHEN '6' THEN 100000
                  ELSE 1
                  END;
               if C_AGREEDATE <= C_ENDDATE and as_base_date >= C_STARTDATE then
--@@                  C_TEMP_RATE := 1 - ( C_DISCOUNT_DAY / 365 ) * ( C_DISCNTRATE / 100 ) ;
                  C_TEMP_RATE := ( C_DISCOUNT_DAY / 365 ) * ( C_DISCNTRATE / 100 ) ;
                  if C_DISCNTCUT = '1' then
--@@                     C_DISCOUNT_AMT := trunc((C_WORK_AMT - (C_WORK_AMT * C_TEMP_RATE)) / C_COMP_UNIT,0) * C_COMP_UNIT;
                     C_DISCOUNT_AMT := trunc((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
                  else
                     if C_DISCNTCUT = '2' then
--@@                        C_DISCOUNT_AMT := trunc((C_WORK_AMT - (C_WORK_AMT * C_TEMP_RATE)) / C_COMP_UNIT + 0.9,0) * C_COMP_UNIT;
                        C_DISCOUNT_AMT := trunc((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT + 0.9,0) * C_COMP_UNIT;
                     else
--@@                        C_DISCOUNT_AMT := round((C_WORK_AMT - (C_WORK_AMT * C_TEMP_RATE)) / C_COMP_UNIT,0) * C_COMP_UNIT;
                        C_DISCOUNT_AMT := round((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
                     end if;
                  end if;
                  EXIT;
               end if;
               if as_base_date >= C_STARTDATE then
                  C_TEMP_CNT := nvl(to_date(C_ENDDATE, 'YYYYMMDD') - to_date(as_base_date, 'YYYYMMDD') ,0);
               else
                  if C_AGREEDATE <= C_ENDDATE then
                     C_TEMP_CNT := nvl(to_date(C_AGREEDATE, 'YYYYMMDD') - to_date(C_STARTDATE, 'YYYYMMDD') + 1,0);
                  else
                     C_TEMP_CNT := nvl(to_date(C_ENDDATE, 'YYYYMMDD') - to_date(C_STARTDATE, 'YYYYMMDD') + 1,0);
                  end if;
               end if;
--@@               C_TEMP_RATE := 1 - (C_TEMP_CNT / 365) * (C_DISCNTRATE / 100);
               C_TEMP_RATE := (C_TEMP_CNT / 365) * (C_DISCNTRATE / 100);
               if C_DISCNTCUT = '1' then
--@@                  C_DISCOUNT_AMT := C_DISCOUNT_AMT + trunc((C_WORK_AMT - (C_WORK_AMT * C_TEMP_RATE)) / C_COMP_UNIT,0) * C_COMP_UNIT;
                  C_DISCOUNT_AMT := C_DISCOUNT_AMT + trunc((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
               else
                  if C_DISCNTCUT = '2' then
--@@                     C_DISCOUNT_AMT := C_DISCOUNT_AMT + trunc((C_WORK_AMT - (C_WORK_AMT * C_TEMP_RATE)) / C_COMP_UNIT + 0.9,0) * C_COMP_UNIT;
                     C_DISCOUNT_AMT := C_DISCOUNT_AMT + trunc((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT + 0.9,0) * C_COMP_UNIT;
                  else
--@@                     C_DISCOUNT_AMT := C_DISCOUNT_AMT + round((C_WORK_AMT - (C_WORK_AMT * C_TEMP_RATE)) / C_COMP_UNIT,0) * C_COMP_UNIT;
                     C_DISCOUNT_AMT := C_DISCOUNT_AMT + round((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT,0) * C_COMP_UNIT;
                  end if;
               end if;
            END LOOP;
            CLOSE DETAIL_CUR;
         else
            C_DISCOUNT_AMT := 0;
         end if;
      else
         C_DISCOUNT_AMT := 0;
      end if;
   END;
   return C_DISCOUNT_AMT; 
END;

/





CREATE OR REPLACE FUNCTION "F_HR_GET_DECHULLIMIT" (

   as_emp IN VARCHAR2,   -- 
   as_dt  IN VARCHAR2,   -- 
   as_tp  IN VARCHAR2,   -- 
   as_cb  IN VARCHAR2    -- 
 ) return NUMBER IS

 -------------------------------------------------------------
 -- TEMP VALUE
    t_cnt     NUMBER;
    t_lamt    NUMBER;
    t_bamt    NUMBER;
    t_tamt    NUMBER;

 -- LOCAL VALUE
    l_marr    VARCHAR2(1); -- 0 1
    l_jmno    VARCHAR2(8); --
    l_jmnop   VARCHAR2(1); -- 1
    l_jdt     VARCHAR2(8); --
    l_rdt     VARCHAR2(8); --
    l_lcd     VARCHAR2(2); --
    l_gdt     VARCHAR2(8); --
 -- RETURN VALUE
    v_return  NUMBER;

 -------------------------------------------------------------
 /* ERR CODE

   -1:     
   -2:     
   -3:  
   -4:   
 -  -5:  1  
 -  -6:    3  
 -  -7:   3  30   
 -  -8:  ,   
 - -51:    
 - -52:   
 - -53:     .
 */
 -------------------------------------------------------------

 BEGIN
    t_cnt := 0; v_return := 0;

    -- -------------     
    SELECT NVL(COUNT(*), 0)
      INTO t_cnt
      FROM HR_LOAN_INTEREST_RATE
     WHERE LOAN_KIND_CODE = as_tp
       AND as_dt BETWEEN APPLY_SDATE AND APPLY_EDATE;
    IF t_cnt <> 1 THEN RETURN -1; END IF;

    t_cnt := 0;
    SELECT NVL(COUNT(*), 0)

      INTO t_cnt
      FROM HR_LOAN_MASTER
     WHERE EMP_NO         = as_emp
       AND LOAN_KIND_CODE = as_tp
       AND LOAN_DATE      = as_dt;
    IF t_cnt > 0 THEN RETURN -2; END IF;

    BEGIN
       SELECT B.MARRIED_YN, B.RRN_PRE, SUBSTR(B.RRN_POST, 1, 1), B.JOIN_DATE, DECODE(NVL(B.RETIRE_DATE, '0'), '', '0', B.RETIRE_DATE), A.LEVEL_CODE, B.GROUP_JOIN_DATE
         INTO l_marr,       l_jmno,    l_jmnop,                  l_jdt,       l_rdt,                                                   l_lcd,        l_gdt
         FROM HR_ORDE_MASTER A,
              HR_PERS_MASTER B
        WHERE A.EMP_NO = B.EMP_NO

          AND A.EMP_NO = as_emp
          AND APPLY_ORDER_DATE || TO_CHAR(SEQ) = (SELECT MAX(APPLY_ORDER_DATE || TO_CHAR(SEQ))
                                                    FROM HR_ORDE_MASTER
                                                   WHERE EMP_NO = A.EMP_NO
                                                     AND APPLY_ORDER_DATE <= as_dt);
       EXCEPTION WHEN no_data_found THEN RETURN -3;
    END;

    -- ------------- 
    IF l_rdt <= as_dt THEN RETURN -4; END IF; --

 /*
    IF LENGTH(l_gdt) = 8 THEN BEGIN

       IF TO_DATE(as_dt, 'YYYYMMDD') < ADD_MONTHS(TO_DATE(l_gdt, 'YYYYMMDD'), 12) THEN RETURN -5; END IF; -- 1
    END; ELSE BEGIN
       IF TO_DATE(as_dt, 'YYYYMMDD') < ADD_MONTHS(TO_DATE(l_jdt, 'YYYYMMDD'), 12) THEN RETURN -5; END IF; -- 1
    END; END IF;

    -- ------------- 
    IF as_cb = '40' AND l_lcd > 'BD' THEN
       IF TO_DATE(as_dt, 'YYYYMMDD') < ADD_MONTHS(TO_DATE(l_jdt, 'YYYYMMDD'), 36) THEN RETURN -6; END IF; -- 3
    END IF;

    -- -------------  ()
    IF as_tp = '10' AND l_marr = '0' THEN
       IF l_jmnop IN ('1', '2') THEN BEGIN

          l_jmno := '19' || l_jmno;
       END; ELSE BEGIN
          l_jmno := '20' || l_jmno;
       END; END IF;

       IF NOT (TO_DATE(as_dt, 'YYYYMMDD') >= ADD_MONTHS(TO_DATE(l_jdt, 'YYYYMMDD'), 36) OR TO_DATE(as_dt, 'YYYYMMDD') >= ADD_MONTHS(TO_DATE(l_jmno, 'YYYYMMDD'), 12 * 30)) THEN
          RETURN -7;
       END IF;
    END IF;

    -- ------------- ,   (   )
    IF as_tp IN ('10', '20') THEN
       t_cnt := 0;

       SELECT NVL(COUNT(*), 0)
         INTO t_cnt
         FROM HR_LOAN_MASTER
        WHERE EMP_NO = as_emp
          AND LOAN_KIND_CODE IN ('10', '20')
          AND NVL(FINISH_TAG, 'N') = 'N';
       IF t_cnt > 0 THEN RETURN -8; END IF;
    END IF;

    -- ==================  ====================================
    --   
    SELECT MAX(TO_NUMBER(NVL(REF_NAME, 0)))
      INTO t_lamt

      FROM HR_CODE_REF
     WHERE REF_GBN_CODE = 'S4'
       AND as_tp || l_lcd BETWEEN SUBSTR(REF_CODE, 1, 4) AND SUBSTR(REF_CODE, 5, 4);

    --   
    SELECT SUM(A.LAMT) - SUM(A.RAMT) AS LAMT
      INTO t_bamt
      FROM (SELECT NVL(SUM(LOAN_AMT), 0) AS LAMT, 0 AS RAMT
              FROM HR_LOAN_MASTER
             WHERE EMP_NO = as_emp
               AND LOAN_KIND_CODE = as_tp
             UNION ALL
            SELECT 0 AS LAMT, NVL(SUM(RECEIPT_AMT), 0) AS RAMT

              FROM HR_LOAN_REPAYMENT
             WHERE EMP_NO = as_emp
               AND LOAN_KIND_CODE = as_tp
           ) A;
    IF t_lamt <= t_bamt THEN
       RETURN -51; --    
    ELSE
       v_return := t_lamt - t_bamt;
    END IF;

    -- >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>   
    IF as_cb = '40' THEN
       --  

       SELECT MAX(TO_NUMBER(NVL(REF_NAME, 0)))
         INTO t_lamt
         FROM HR_CODE_REF
        WHERE REF_GBN_CODE = 'S3'
          AND l_lcd BETWEEN SUBSTR(REF_CODE, 1, 2) AND SUBSTR(REF_CODE, 3, 2);

       --
       t_cnt := 0;
       SELECT COUNT(*)
         INTO t_cnt
         FROM HR_RETI_RESULT
        WHERE EMP_NO      = as_emp
          AND RETIRE_TAG  = '2'

          AND RETIRE_DATE > TRIM(TO_CHAR(TO_NUMBER(SUBSTR(as_dt, 1,4)) -1, '0000')) || '1231';
       IF t_cnt > 0 THEN
          --   
          t_bamt := 0;
       ELSE
          --  50%
          SELECT NVL(MAX(TRUNC(A.RETIRE_PAY_TOT / 2)), 0)
            INTO t_bamt
            FROM HR_RETI_ESTIMATE A
           WHERE A.EMP_NO = as_emp
             AND A.RETIRE_DATE = (SELECT MAX(RETIRE_DATE) FROM HR_RETI_ESTIMATE
                                   WHERE EMP_NO      = A.EMP_NO
                                     AND RETIRE_DATE < SUBSTR(as_dt, 1,4) || '0101');

       END IF;

       SELECT SUM(A.LAMT) - SUM(A.RAMT) AS LAMT
         INTO t_tamt
         FROM (SELECT NVL(SUM(LOAN_AMT3), 0) AS LAMT, 0 AS RAMT
                 FROM HR_LOAN_MASTER
                WHERE EMP_NO = as_emp
                UNION ALL
               SELECT 0 AS LAMT, NVL(SUM(RECEIPT_AMT3), 0) AS RAMT
                 FROM HR_LOAN_REPAYMENT
                WHERE EMP_NO = as_emp
              ) A;


       IF t_lamt <= t_bamt THEN t_lamt := t_bamt; END IF;

       IF t_lamt <= t_tamt THEN
          RETURN -52; --   
       ELSE
          v_return := t_lamt - t_tamt;
       END IF;
    END IF;

    -- >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

    -- 
    SELECT MAX(TO_NUMBER(NVL(REF_NAME, 0)))

      INTO t_lamt
      FROM HR_CODE_REF
     WHERE REF_GBN_CODE = 'S2'
       AND l_lcd BETWEEN SUBSTR(REF_CODE, 1, 2) AND SUBSTR(REF_CODE, 3, 2);

    --   
    SELECT SUM(A.LAMT) - SUM(A.RAMT) AS LAMT
      INTO t_bamt
      FROM (SELECT NVL(SUM(LOAN_AMT), 0) AS LAMT, 0 AS RAMT
              FROM HR_LOAN_MASTER
             WHERE EMP_NO = as_emp
             UNION ALL
            SELECT 0 AS LAMT, NVL(SUM(RECEIPT_AMT), 0) AS RAMT

              FROM HR_LOAN_REPAYMENT
             WHERE EMP_NO = as_emp
           ) A;
    t_lamt := t_lamt - t_bamt;

    IF t_lamt = 0 THEN RETURN -53; END IF; --     .

    IF v_return <= t_lamt THEN
       RETURN v_return;
    ELSE
       RETURN t_lamt;
    END IF;
 */

  RETURN 0;
 END;

/





CREATE  OR REPLACE  FUNCTION F_HR_GET_DECHULTOTLIMIT (

   as_emp IN VARCHAR2,   -- 
   as_dt  IN VARCHAR2   -- 
 ) return NUMBER IS

 -------------------------------------------------------------
 -- TEMP VALUE
    t_lamt    NUMBER;
    t_bamt    NUMBER;

 -- LOCAL VALUE
    l_lcd     VARCHAR2(2); --



 -------------------------------------------------------------
 /* ERR CODE
   -1:     
   -2:     
   -3:  
   -4:   
 -  -5:  1  
 -  -6:    3  
 -  -7:   3  30   
 -  -8:  ,   
 - -51:    
 - -52:   

 - -53:     .

 */
 -------------------------------------------------------------
 BEGIN
    BEGIN
       SELECT A.LEVEL_CODE
         INTO l_lcd
         FROM HR_ORDE_MASTER A,
              HR_PERS_MASTER B
        WHERE A.EMP_NO = B.EMP_NO
          AND A.EMP_NO = as_emp
          AND APPLY_ORDER_DATE || TO_CHAR(SEQ) = (SELECT MAX(APPLY_ORDER_DATE || TO_CHAR(SEQ))

                                                    FROM HR_ORDE_MASTER
                                                   WHERE EMP_NO = A.EMP_NO

                                                     AND APPLY_ORDER_DATE <= as_dt);
       EXCEPTION WHEN no_data_found THEN RETURN -3;
    END;
 /*
    -- ==================  ====================================
    -- 
    SELECT MAX(TO_NUMBER(NVL(REF_NAME, 0)))
      INTO t_lamt
      FROM HR_CODE_REF
     WHERE REF_GBN_CODE = 'S2'

       AND l_lcd BETWEEN SUBSTR(REF_CODE, 1, 2) AND SUBSTR(REF_CODE, 3, 2);

    --   

    SELECT SUM(A.LAMT) - SUM(A.RAMT) AS LAMT
      INTO t_bamt
      FROM (SELECT NVL(SUM(LOAN_AMT), 0) AS LAMT, 0 AS RAMT
              FROM HR_LOAN_MASTER
             WHERE EMP_NO = as_emp
             UNION ALL
            SELECT 0 AS LAMT, NVL(SUM(RECEIPT_AMT), 0) AS RAMT
              FROM HR_LOAN_REPAYMENT
             WHERE EMP_NO = as_emp

           ) A;
    RETURN t_lamt - t_bamt;
 */
   RETURN 0;
 END;

/





CREATE OR REPLACE FUNCTION "F_HR_GET_DEPTAUTH" (

   as_empno  varchar2, --emp_no
   as_div    varchar2  --'1':   Value, '2':   Value
   ) RETURN VARCHAR2
 AS

   ls_dept    hr_pers_master.dept_code%TYPE;
   ls_query   hr_code_dept.query_auth_code%TYPE;
   ls_head    hr_code_dept.headquater_code%TYPE;
   ls_query_title   hr_code_title.query_auth_yn%TYPE;

   ls_value1  varchar2(20);
   ls_value2  varchar2(20);

 BEGIN

   begin
     select a.dept_code, b.query_auth_code, b.headquater_code, nvl(c.query_auth_yn,'N')
       into ls_dept, ls_query, ls_head, ls_query_title
       from hr_pers_master a,
            hr_code_dept   b,
            hr_code_title  c
      where a.emp_no = as_empno
        and a.dept_code  = b.dept_code(+)
        and a.title_code = c.title_code(+);
   exception
     when NO_DATA_FOUND then
       null;
   end;

   if as_empno = '%' then
     ls_value1 := '%';
     ls_value2 := '%';
   else
     if ls_query_title = 'Y' then
       if ls_query = '%' then
         ls_value1 := '%';
         ls_value2 := '%';
       else
         ls_value1 := ls_query;
         ls_value2 := case ls_query
                        when 'H' then ls_head
                        when 'D' then ls_dept
                      end;
       end if;
     else
        ls_value1 := 'E';
        ls_value2 := as_empno;
     end if;
   end if;

   if as_div = '1' then
     RETURN(ls_value1);
   else
     RETURN(ls_value2);
   end if;
 END;

/





CREATE  OR REPLACE  FUNCTION F_HR_GET_DOCIN_RECDEPT(

	AS_WORK_YEAR    VARCHAR2,
	AS_DEPT_CODE 	VARCHAR2,
	AS_SEQ					 NUMBER
) RETURN VARCHAR2 IS

    --   ,  RETURN
    LS_DEPT_NAME  VARCHAR2(200);
 	LS_RETURN     VARCHAR2(4000);

 	CURSOR CUR_DEPT IS
		SELECT B.DEPT_NAME
		  FROM HR_GAFF_DOC_IN_DEPT A,
		  	   		HR_CODE_DEPT B
		 WHERE A.REC_DEPT_CODE = B.DEPT_CODE AND
		 	   A.WORK_YEAR = AS_WORK_YEAR AND
			   A.DEPT_CODE = AS_DEPT_CODE AND
			   A.SEQ = AS_SEQ
	  ORDER BY A.DEPT_CODE
	   ;
BEGIN
 	LS_RETURN := '';

	OPEN CUR_DEPT;
	LOOP
		FETCH CUR_DEPT INTO LS_DEPT_NAME;
		EXIT WHEN CUR_DEPT%NOTFOUND;

		LS_RETURN := LS_RETURN || ', ' || LS_DEPT_NAME;

	END LOOP;
	CLOSE CUR_DEPT;

	IF LS_RETURN = '' THEN
	   RETURN LS_RETURN;
	ELSE
       RETURN SUBSTR(LS_RETURN, 3);
	END IF;

EXCEPTION
	WHEN NO_DATA_FOUND THEN
		 NULL;
	WHEN OTHERS THEN
		 -- Consider logging the error and then re-raise
		 RAISE;
END F_Hr_Get_Docin_Recdept;

/





CREATE  OR REPLACE  FUNCTION F_HR_AGE (an_year number, as_rrnpre varchar2, as_rrnpost varchar2)RETURN NUMBER AS

  ls_num varchar2(2);
BEGIN
  ls_num := case substr(as_rrnpost,1,1)
              when '3' then '20'
              when '4' then '20'
              else '19'
            end;
  
  RETURN an_year - to_number(ls_num||substr(as_rrnpre,1,2))  + 1;
END F_HR_AGE;

/





CREATE  OR REPLACE  FUNCTION F_AM_GET_AVGREMAINDER_TERMTO

( Av_AcntCode VARCHAR2, 
  Av_CompCode VARCHAR2, 
  as_dept varchar2,
  Adt_TermDate DATE,
  Adt_ToDate   DATE
 )
 
RETURN NUMBER IS
n_TermCnt     NUMBER;
n_Loop        NUMBER;
n_DailyRemain NUMBER;
n_CumRemain   NUMBER;
n_Remainder   NUMBER;
BEGIN
   --   .(,, )
   IF Av_AcntCode < '4' THEN
      SELECT nvl(SUM(a.dr_balance+a.cr_balance),0) INTO n_CumRemain
        FROM am_endx_dept A
       WHERE A.end_Date   < Adt_TermDate
         AND A.Acnt_Code  = Av_AcntCode
         AND A.Company_Code LIKE Av_CompCode
         and a.dept_code like as_dept ;
   ELSE
      n_CumRemain := 0;
   END IF;
   --     .
   n_TermCnt := Adt_ToDate - Adt_TermDate + 1;
   --      .
   n_Remainder := 0;
   FOR n_Loop IN 1..n_TermCnt LOOP
      SELECT NVL(SUM(dr_balance+cr_balance), 0) INTO n_DailyRemain
        FROM am_endx_dept
       WHERE end_year = TO_CHAR(Adt_TermDate + n_Loop - 1, 'YYYY')
	     AND end_Date  = TO_CHAR(Adt_TermDate + n_Loop - 1, 'YYYYMMDD')
         AND Acnt_Code = Av_AcntCode
         AND Company_Code LIKE Av_CompCode
         and dept_code like as_dept  ;
      n_CumRemain := n_CumRemain + n_DailyRemain;
      n_Remainder := n_Remainder + n_CumRemain;
   END LOOP;
   --  
   n_Remainder := TRUNC(n_Remainder / n_TermCnt, 0);
   RETURN n_Remainder;
END;

/





CREATE OR REPLACE FUNCTION "F_HR_GET_MONTHENG" (as_yyyymmdd varchar2, as_div varchar2) RETURN VARCHAR2

 AS

 ls_engname varchar2(3);
 li_month   integer;
 BEGIN

   li_month := to_number(substr(as_yyyymmdd,5,2));

   if li_month = 1 then
     ls_engname := 'Jan';
   elsif li_month = 2 then
     ls_engname := 'Feb';


   elsif li_month = 3 then
     ls_engname := 'Mar';
   elsif li_month = 4 then
     ls_engname := 'Apr';
   elsif li_month = 5 then
     ls_engname := 'May';
   elsif li_month = 6 then
     ls_engname := 'Jun';
   elsif li_month = 7 then
     ls_engname := 'Jul';
   elsif li_month = 8 then
     ls_engname := 'Aug';

   elsif li_month = 9 then

     ls_engname := 'Sep';
   elsif li_month = 10 then
     ls_engname := 'Oct';
   elsif li_month = 11 then
     ls_engname := 'Nov';
   elsif li_month = 12 then
     ls_engname := 'Dec';
   end if;

   if as_yyyymmdd is null or length(as_yyyymmdd) = 0 then
     RETURN null;

   end if;
   if as_div = '1' then

     RETURN(ls_engname||'.'||substr(as_yyyymmdd,0,4));
   elsif as_div = '2' then
     RETURN(ls_engname||'.'||substr(as_yyyymmdd,7,2)||'.'||substr(as_yyyymmdd,0,4));
   end if;

 END;

/





CREATE OR REPLACE FUNCTION "F_HR_GET_SINLIMIT" (

   as_emp IN VARCHAR2,   -- 
   as_dt  IN VARCHAR2    -- 
 ) return NUMBER IS

 -------------------------------------------------------------
 -- TEMP VALUE
    t_cnt     NUMBER;
    t_lamt    NUMBER;
    t_bamt    NUMBER;
    t_tamt    NUMBER;
 -- LOCAL VALUE
    l_marr    VARCHAR2(1); -- 0 1

    l_jmno    VARCHAR2(8); --
    l_jmnop   VARCHAR2(1); -- 1
    l_jdt     VARCHAR2(8); --
    l_rdt     VARCHAR2(8); --
    l_lcd     VARCHAR2(2); --
    l_gdt     VARCHAR2(8); --
 -- RETURN VALUE
    v_return  NUMBER;

 -------------------------------------------------------------
 /* ERR CODE
   -1:     
   -2:     

   -3:  
   -4:   
   -5:  1  
   -6:    3  
   -7:   3  30   
   -8:  ,   
  -51:    
  -52:   
  -53:     .
 */
 -------------------------------------------------------------
 BEGIN
    t_cnt := 0; v_return := 0;


    BEGIN
       SELECT B.MARRIED_YN, B.RRN_PRE, SUBSTR(B.RRN_POST, 1, 1), B.JOIN_DATE, DECODE(NVL(B.RETIRE_DATE, '0'), '', '0', B.RETIRE_DATE), A.LEVEL_CODE, TRIM(B.GROUP_JOIN_DATE)
         INTO l_marr,       l_jmno,    l_jmnop,                  l_jdt,       l_rdt,                                                   l_lcd,        l_gdt
         FROM HR_ORDE_MASTER A,
              HR_PERS_MASTER B
        WHERE A.EMP_NO = B.EMP_NO
          AND A.EMP_NO = as_emp
          AND APPLY_ORDER_DATE || TO_CHAR(SEQ) = (SELECT MAX(APPLY_ORDER_DATE || TO_CHAR(SEQ))
                                                    FROM HR_ORDE_MASTER
                                                   WHERE EMP_NO = A.EMP_NO
                                                     AND APPLY_ORDER_DATE <= as_dt);
       EXCEPTION WHEN no_data_found THEN RETURN -3;

    END;

    -- ------------- 
    IF l_rdt <= as_dt THEN RETURN -4; END IF; --

    IF LENGTH(l_gdt) = 8 THEN
    	  BEGIN
       	   IF TO_DATE(as_dt, 'YYYYMMDD') < ADD_MONTHS(TO_DATE(l_gdt, 'YYYYMMDD'), 12) THEN RETURN -5; END IF; -- 1
 	  EXCEPTION WHEN OTHERS THEN RETURN -3;
    	  END;
    ELSE
       BEGIN
            IF TO_DATE(as_dt, 'YYYYMMDD') < ADD_MONTHS(TO_DATE(l_jdt, 'YYYYMMDD'), 12) THEN RETURN -5; END IF; -- 1

 	  EXCEPTION WHEN OTHERS THEN RETURN -3;
       END;
     END IF;

    IF l_lcd > 'BD' THEN BEGIN
    	  BEGIN
       	   IF TO_DATE(as_dt, 'YYYYMMDD') < ADD_MONTHS(TO_DATE(l_jdt, 'YYYYMMDD'), 36) THEN RETURN -6; END IF; -- 3
 	  EXCEPTION WHEN OTHERS THEN RETURN -3;
       END;
    END; END IF;

    -- -------------  ()
    IF l_marr = '0' THEN

       IF l_jmnop IN ('1', '2') THEN BEGIN
          l_jmno := '19' || l_jmno;
       END; ELSE BEGIN
          l_jmno := '20' || l_jmno;
       END; END IF;

       IF NOT (TO_DATE(as_dt, 'YYYYMMDD') >= ADD_MONTHS(TO_DATE(l_jdt, 'YYYYMMDD'), 36) OR TO_DATE(as_dt, 'YYYYMMDD') >= ADD_MONTHS(TO_DATE(l_jmno, 'YYYYMMDD'), 12 * 30)) THEN
          RETURN -7;
       END IF;
    END IF;

    --  
    SELECT MAX(TO_NUMBER(NVL(REF_NAME, 0)))

      INTO t_lamt
      FROM HR_CODE_REF
     WHERE REF_GBN_CODE = 'S3'
       AND l_lcd BETWEEN SUBSTR(REF_CODE, 1, 2) AND SUBSTR(REF_CODE, 3, 2);

    --
    t_cnt := 0;
    SELECT COUNT(*)
      INTO t_cnt
      FROM HR_RETI_RESULT
     WHERE EMP_NO      = as_emp
       AND RETIRE_TAG  = '2'
       AND RETIRE_DATE > TRIM(TO_CHAR(TO_NUMBER(SUBSTR(as_dt, 1,4)) -1, '0000')) || '1231';

    IF t_cnt > 0 THEN
       --   
       t_bamt := 0;
    ELSE
       --  50%
       SELECT NVL(MAX(TRUNC(A.RETIRE_PAY_TOT / 2)), 0)
         INTO t_bamt
         FROM HR_RETI_ESTIMATE A
        WHERE A.EMP_NO = as_emp
          AND A.RETIRE_DATE = (SELECT MAX(RETIRE_DATE) FROM HR_RETI_ESTIMATE
                                WHERE EMP_NO      = A.EMP_NO
                                  AND RETIRE_DATE < SUBSTR(as_dt, 1,4) || '0101');
    END IF;


    IF t_lamt > t_bamt THEN RETURN t_lamt; END IF;
    RETURN t_bamt;
 END;

/





CREATE OR REPLACE FUNCTION "F_HR_JOB_INTERVAL" (ai_job integer, ai_num integer) RETURN DATE

 AS
   ld_date date;
   ln_time number;
 BEGIN

   ln_time := case ai_num
                when 1 then 9.1/24
                when 2 then 11.5/24
              end;

   select trunc(next_date + 1) + ln_time
     into ld_date

     from user_jobs where job = ai_job;

   return ld_date;
 END;

/





CREATE  OR REPLACE  FUNCTION F_HR_MONTHSAFTER_STR 

( ad_sdate  date, 
  ad_edate  date ) 
return string is 
--     
li_months integer; 
li_years  integer; 
lv_return varchar2(50); 
begin 
 li_months := trunc(months_between(ad_edate, ad_sdate - 1), 0); 
 li_years := trunc(li_months / 12, 0); 
 li_months := mod(li_months, 12); 
 if li_years > 0 then 
  lv_return := to_char(li_years, '99') || ' '; 
 else 
  lv_return := '     '; 
 end if; 
 if li_months > 0 then 
  lv_return := lv_return || ' ' || to_char(li_months, '99') || ' '; 
 else 
  lv_return := lv_return || '        '; 
 end if; 
 return lv_return; 
end;

/





CREATE  OR REPLACE  FUNCTION F_HR_MONTHSAFTER_STR_STND 

( ad_join    date, 
  ad_retire  date,
  ad_stnd    date) 
return string is 
  ld_date   date;
  li_months integer; 
  li_years  integer; 
  lv_return varchar2(50); 
begin 
 
 if ad_retire is null then
   ld_date := ad_stnd;
 else
   ld_date := ad_retire;
 end if;

 if ld_date > ad_stnd then
   ld_date := ad_stnd;
 end if;
 
 if ld_date > sysdate then
   ld_date := sysdate;
 end if;
 
 li_months := trunc(months_between(ld_date, ad_join - 1), 0); 
 li_years  := trunc(li_months / 12, 0); 
 li_months := mod(li_months, 12); 
 if li_years > 0 then 
   lv_return := trim(to_char(li_years, '99') || ''); 
 end if; 
 if li_months > 0 then 
  lv_return := lv_return || ' ' || trim(to_char(li_months, '99') || ''); 
 end if; 
 return lv_return; 
end;

/





CREATE  OR REPLACE  FUNCTION F_HD_GET_MAGAM

(
   as_dept  VARCHAR2,
   as_htag  VARCHAR2,
   as_dt    VARCHAR2
)
RETURN NUMBER IS

/* ****************************************************************** */
/*    
/* ****************************************************************** */

-------------------------------------------------------------------VALUES
v_cnt  NUMBER(10);

-------------------------------------------------------------------------
BEGIN
   v_cnt := 0;
   SELECT COUNT(*)
     INTO v_cnt
     FROM HD_HOUS_MAGAM
    WHERE DEPT_CODE  = as_dept
      AND HOUSETAG   = as_htag
      AND MAGAMDATE >= as_dt;
   IF v_cnt > 0 THEN RETURN -1; END IF; --

   v_cnt := 0;
   SELECT COUNT(*)
     INTO v_cnt
     FROM HD_CODE_DEPT
    WHERE DEPT_CODE = as_dept
      AND DEPT_TYPE_CODE IN ('01', '02');
   IF v_cnt < 1 THEN RETURN 0; END IF; --      .

   v_cnt := 0;
   SELECT COUNT(*)
     INTO v_cnt
     FROM TM_ENDX_HIS_DAY A,
          HD_CODE_DEPT B
    WHERE A.COMPANY_CODE = B.COMPANY_CODE
      AND B.DEPT_CODE    = as_dept
      AND A.END_DAY      = as_dt
      AND A.END_YN       = 'Y';
   IF v_cnt > 0 THEN RETURN -2; END IF; --

   RETURN 0;
END;

/





CREATE  OR REPLACE  FUNCTION F_HD_GET_HOLIDAY

(
   as_dept   VARCHAR2,   --
   as_htag   VARCHAR2,   --
   as_dt     VARCHAR2,   --
   as_hdyn   VARCHAR2    --Y: N:  --   
)
RETURN VARCHAR2 IS

-------------------------------------------------------------------VALUES
v_tmp   VARCHAR2(8);
v_tdt   VARCHAR2(8);
v_day   VARCHAR2(1);

-------------------------------------------------------------------------
BEGIN
   v_tdt := as_dt;

   LOOP
      SELECT NVL(MAX(TO_CHAR(TO_DATE(HOLIDAY, 'YYYYMMDD') + NVL(GONG_DAYS, 0), 'YYYYMMDD')), 'X')
        INTO v_tmp
        FROM HD_REFER_HOLIDAY
       WHERE DEPT_CODE = as_dept
         AND HOUSETAG  = as_htag
         AND AD_TAG    = '1' --
/*         AND RATE_TAG  = (CASE WHEN as_hdyn = 'Y' THEN '1' ELSE '2' END)*/
         AND RATE_TAG  = '1' --  /  
         AND v_tdt BETWEEN HOLIDAY AND TO_CHAR(TO_DATE(HOLIDAY, 'YYYYMMDD') + NVL(GONG_DAYS, 0) -1, 'YYYYMMDD');
      IF v_tmp <> 'X' THEN
         v_tdt := v_tmp;
      ELSE
         v_day := TO_CHAR(TO_DATE(v_tdt, 'YYYYMMDD'), 'D');
         IF v_day = '1' THEN
            v_tdt := TO_CHAR(TO_DATE(v_tdt, 'YYYYMMDD') + 1, 'YYYYMMDD');
         ELSIF v_day = '7' THEN
            v_tdt := TO_CHAR(TO_DATE(v_tdt, 'YYYYMMDD') + 2, 'YYYYMMDD');
         ELSE
            RETURN v_tdt;
            EXIT;
         END IF;
      END IF;
   END LOOP;
END;


/





CREATE  OR REPLACE  FUNCTION F_HD_GET_RENTAMT (

   as_cust VARCHAR2,
   as_seq  VARCHAR2,
   as_fr   VARCHAR2,
   as_to   VARCHAR2,
   as_tp   VARCHAR2,
   as_day  VARCHAR2   -- 
)
RETURN NUMBER IS
/* ****************************************************************** */
/*        
/* ****************************************************************** */

-------------------------------------------------------------------VALUES
ll_amt  NUMBER;

-------------------------------------------------------------------------
-------------------------------------------------------------------------
BEGIN
/*   SELECT SUM(TRUNC(DECODE(NVL(TDAY, 0), 0, 0, SDAY / TDAY * AMT))) */

   SELECT SUM(TRUNC(DECODE(NVL(TDAY, 0), 0, 0, SDAY / TO_NUMBER(as_day) * AMT)))
     INTO ll_amt
     FROM (SELECT TO_DATE(TODT, 'YYYYMMDD') - TO_DATE(FRDT, 'YYYYMMDD') + 1 AS SDAY,
                  TO_DATE(as_to, 'YYYYMMDD') - TO_DATE(as_fr, 'YYYYMMDD') + 1 AS TDAY,
                  AMT
             FROM (SELECT CASE WHEN FRDT <= as_fr THEN as_fr ELSE FRDT END FRDT,
                          CASE WHEN TODT >= as_to THEN as_to ELSE TODT END TODT,
                          AMT
                     FROM (SELECT A.APPLY_YYMM AS FRDT,
                                  TO_CHAR(TO_DATE((SELECT NVL(MIN(B.APPLY_YYMM), '99991231')
                                                     FROM HD_RENT_DETAIL_RENT B
                                                    WHERE B.CUST_CODE = A.CUST_CODE
                                                      AND B.SEQ       = A.SEQ
                                                      AND B.APPLY_YYMM > A.APPLY_YYMM
                                                  ), 'YYYYMMDD') - 1, 'YYYYMMDD') AS TODT,
                                  DECODE(as_tp, '1', A.RENT_SUPPLY,
                                                '2', A.RENT_VAT,
                                                '3', A.RENT_INS,
                                                A.RENT_SUPPLY + A.RENT_VAT + A.RENT_INS
                                        ) AS AMT
                             FROM HD_RENT_DETAIL_RENT A
                            WHERE A.CUST_CODE = as_cust
                              AND A.SEQ       = TO_NUMBER(as_seq)
                          )
                    WHERE ((as_fr BETWEEN FRDT AND TODT)  OR
                           (as_to BETWEEN FRDT AND TODT))
                  )
          );

   RETURN ll_amt;
END;

/





CREATE OR REPLACE FUNCTION "F_HR_PAYX_YLY_CNT" (as_empno       varchar2,

  as_rdate       varchar2)
 RETURN VARCHAR2
 AS
  ls_workymd    varchar2(8);
  ln_tot        number :=0; -- 
  ls_chk_date   varchar2(8);
  ls_stnd_date  varchar2(8);
  ln_cnt        number :=0; --    
  ln_remcnt     number :=0; --   
 BEGIN

   begin
     select stnd_date
       into ls_chk_date
       from hr_time_base_holidays
      where work_year = substr(as_rdate,1,4)
        and emp_no = as_empno;
   end;

   begin
     select work_year||'1231'
          , yearly_holidays
          , stnd_date
       into ls_workymd
          , ln_tot
          , ls_stnd_date
       from hr_time_base_holidays
      where work_year = (
                          select max(work_year)
                            from hr_time_base_holidays
                           where emp_no = as_empno
                             and stnd_date <= as_rdate
                        )
        and emp_no = as_empno;
   end;

   if ls_chk_date > as_rdate then
     begin
       select nvl(count(*),0)
         into ln_cnt
         from hr_time_absence
        where emp_no = as_empno
          and absence_code = '5I'
          and check_date between ls_stnd_date and to_char(to_date(ls_stnd_date) + 365, 'yyyymmdd')
        group by emp_no;
     exception
       when no_data_found then
         ln_cnt := 0;
     end;
     
     ln_remcnt := (ln_tot - (to_date(ls_workymd) - to_date(ls_stnd_date) + 1)) + ln_cnt;
     
     if ln_remcnt <= 0 then
       ln_remcnt := 0;
     end if;
     
     --
     ln_remcnt := ln_remcnt * -1;
     
   else
     begin
       select count(*)
         into ln_cnt
         from hr_time_absence
        where emp_no = as_empno
          and absence_code = '5I'
          and check_date between ls_stnd_date and as_rdate
        group by emp_no;
     exception
       when no_data_found then
         ln_cnt := 0;
     end;
     
     ln_remcnt := ln_tot - ln_cnt;
   end if;

   RETURN ln_remcnt;

 EXCEPTION
   WHEN OTHERS THEN
     RAISE_APPLICATION_ERROR(-20001, 'F_HR_PAYX_YLY_CNT '||TO_CHAR(SQLCODE)||SQLERRM);
 END;

/





CREATE  OR REPLACE  FUNCTION F_MM_GET_CONTCUSTNAME(

	AS_CONTRACT_CODE    VARCHAR2,
	AS_CUSTOMER_CLASS 	VARCHAR2
) RETURN VARCHAR2 IS

    --   ,  RETURN
    LS_CUST_NAME  VARCHAR2(200);
 	LS_RETURN     VARCHAR2(4000);
 
 	CURSOR CUR_CUST IS
		SELECT CUST_NAME
		  FROM MM_COMM_CUSTOMER
		 WHERE CONTRACT_CODE = AS_CONTRACT_CODE AND
		 	   CUSTOMER_CLASS = AS_CUSTOMER_CLASS
	  ORDER BY RELATION_PRIOR DESC, -- 
	  		   CUST_CODE
	   ;
BEGIN
 	LS_RETURN := '';

	OPEN CUR_CUST;
	LOOP
		FETCH CUR_CUST INTO LS_CUST_NAME;
		EXIT WHEN CUR_CUST%NOTFOUND;
		
		LS_RETURN := LS_RETURN || ', ' || LS_CUST_NAME;
		
	END LOOP;
	CLOSE CUR_CUST;

	IF LS_RETURN = '' THEN
	   RETURN LS_RETURN;
	ELSE
       RETURN SUBSTR(LS_RETURN, 3);
	END IF;
	
EXCEPTION
	WHEN NO_DATA_FOUND THEN
		 NULL;
	WHEN OTHERS THEN
		 -- Consider logging the error and then re-raise
		 RAISE;
END F_MM_GET_CONTCUSTNAME;

/





CREATE OR REPLACE FUNCTION "F_MM_NUMTOKOR"(

    AN_NUM VARCHAR
)
RETURN VARCHAR2 IS
    vNum	  NUMBER;
    vReturn   VARCHAR2(60);
BEGIN
 	vNum := TO_NUMBER(AN_NUM);
	
    vReturn := F_SM_NUMTOKOR(vNum);
	
    RETURN vReturn;
	
EXCEPTION
	  WHEN OTHERS THEN
	    -- Consider logging the error and then re-raise
	    RETURN '';
END;

/





CREATE OR REPLACE FUNCTION          "F_AM_GET_SLIP_NO" (

   AS_COMP VARCHAR2
 , AS_DATE VARCHAR2
 , AN_NO   NUMBER
 )
 Return VARCHAR2 Is
    vReturn VARCHAR2(40);
    vNumber VARCHAR2(10);
 Begin
    If (AS_DATE Is NULL Or AS_DATE = '') Then Return ''; End If;
    vNumber := LTRIM(RTRIM(To_Char(AN_NO, '0000')));
    vReturn := AS_DATE || '-' || vNumber;
    Return vReturn;

 End;

/





CREATE OR REPLACE FUNCTION           "F_SM_NUMTOKOR" (

    AN_NUM NUMBER
 )
 Return VARCHAR2 Is
    vHanNum   VARCHAR2(18);
    vHanUnit  VARCHAR2(6);
    vHanUnit4 VARCHAR2(8);
    vNum      VARCHAR2(1);
    vNumber   VARCHAR2(20);
    vReturn   VARCHAR2(60);
    vLen      NUMBER;
    vMod      NUMBER;
    vDiv      NUMBER;

    vLoop     NUMBER;
 Begin
    If AN_NUM = 0 Then return ''; End If;

    vReturn := '';
    If (AN_NUM < 0) Then
       vReturn := ' ';
       vNumber := To_Char(AN_NUM * -1);
    Else
       vReturn := '';
       vNumber := To_Char(AN_NUM);
    End If;


    vHanNum := '';
    vHanUnit := '';
    vHanUnit4 := '';

    vLen := Length(vNumber);
    vLoop := 1;

    While vLoop <= vLen Loop
       vNum := SubStr(vNumber, vLoop, 1);
       vDiv := Trunc((vLen - vLoop) / 4);
       vMod := Mod(vLen - vLoop, 4);
       If vNum = '0' Then
          If vMod = 0 Then

             If vDiv > 0 And SubStr(vNumber, vLoop - 3, 3) <> '000' Then vReturn := vReturn || SubStr(vHanUnit4, vDiv, 1); End If;
          End If;
       Else
          vReturn := vReturn || SubStr(vHanNum, To_Number(vNum), 1);
          If vMod = 0 Then
             If vDiv <> 0 Then vReturn := vReturn || SubStr(vHanUnit4, vDiv, 1); End If;
          Else
             vReturn := vReturn || SubStr(vHanUnit, vMod, 1);
          End If;
       End If;
       vLoop := vLoop + 1;
    End Loop;
    Return vReturn;

 End;

/





CREATE OR REPLACE FUNCTION "F_HR_PAYX_STND_AMT" (as_empno       varchar2,

  as_yymm       varchar2)
 RETURN NUMBER
 AS
   ln_stnd_amt     number :=0;
 BEGIN

  begin
    select nvl(sum(allow_amt),0)
      into ln_stnd_amt
      from hr_payx_result_detail a
         , hr_code_allow         b
     where a.work_yymm  = as_yymm
       and a.pay_kind   = 'P'
       and a.emp_no     = as_empno
       and b.ordinary_pay_yn = 'Y'
       and a.allow_code = b.allow_code
       and b.pay_div    = '0';
  exception
    when no_data_found then
      ln_stnd_amt := 0;
  end;
  
   RETURN(ln_stnd_amt);
 END;

/





CREATE OR REPLACE FUNCTION "F_HR_TIME_BASE_YEARLYDAYS" (as_yyyy varchar2, as_date varchar2) RETURN NUMBER

 AS

  ls_year_days  number;
  ls_month_days number;
  ls_sum_days   number;

 BEGIN

  --  
  if as_yyyy = substr(as_date,1,4) then
    ls_sum_days := 0;
  else
    select base_year_days
      into ls_year_days
      from hr_time_yearly_chart
     where work_year = as_yyyy
       and yearly_no = trunc((to_date(as_yyyy||'1231') - to_date(as_date) + 1) / 365);
    ls_sum_days := ls_year_days;
  end if;

    RETURN(ls_sum_days);

 exception
     when NO_DATA_FOUND then
         return('99991231');
 END;

/





CREATE OR REPLACE FUNCTION "F_HR_TERM_CALC" (

 as_sdate varchar2,
 as_edate varchar2,
 as_div   varchar2 default null
 ) RETURN VARCHAR2
 AS
     ls_sdate varchar2(8);
     ls_edate varchar2(8);
     li_year_sdate  integer;
     li_month_sdate integer;
     li_days_sdate  integer;
     li_year_edate  integer;
     li_month_edate integer;
     li_days_edate  integer;


     li_basic_days  integer;
     li_years       integer;
     li_months      integer;
     li_days        integer;
     li_total_days  integer;
     --, 
     li_calc_year   integer;
     li_calc_months integer;
     --
     li_months_tot  integer;
     
     ls_return varchar2(100);
     
 BEGIN
     -- 
     ls_sdate := as_sdate;
     ls_edate := trim(to_char(to_date(as_edate) + 1, 'yyyymmdd')); -- .

     li_months_tot  := ceil(months_between(ls_edate, ls_sdate));
     li_year_sdate  := to_number(substr(ls_sdate,1,4));

     li_month_sdate := to_number(substr(ls_sdate,5,2));
     li_days_sdate  := to_number(substr(ls_sdate,7,2));
     li_year_edate  := to_number(substr(ls_edate,1,4));
     li_month_edate := to_number(substr(ls_edate,5,2));
     li_days_edate  := to_number(substr(ls_edate,7,2));
 --    li_days := li_days_edate - li_days_sdate + 1;
     li_days := li_days_edate - li_days_sdate;
     --  '-'    ,  1 .
     IF li_days < 0 THEN
       --
       li_basic_days  := to_number(to_char(last_day(add_months(to_date(ls_sdate), -1)),'dd'));
       li_days        := li_days + li_basic_days;
       li_month_edate := li_month_edate - 1;
       if li_days <= 0 then
         li_days := 0;
       end if;         
     END IF;
     li_months := li_month_edate - li_month_sdate;
     -- '-'  12 ,  1 .
     IF li_months < 0 THEN
       li_months     := li_months + 12;
       li_year_edate := li_year_edate - 1;
     END IF;
     li_years      := li_year_edate - li_year_sdate;
     li_total_days := to_date(ls_edate) - to_date(ls_sdate);
     --    :   1 , 12 1 

     IF li_days > 0 THEN
         li_calc_months := li_months + 1;
     ELSE
         li_calc_months := li_months;
     END IF;
     IF li_calc_months >= 12 THEN
       li_calc_months := 0;
       li_calc_year   := li_years + 1;
     ELSE
       li_calc_year   := li_years;
     END IF;
     li_years       := nvl(li_years,0);

     li_months      := nvl(li_months,0);
     li_days        := nvl(li_days,0);
     li_total_days  := nvl(li_total_days,0);
     li_calc_year   := nvl(li_calc_year,0);

     li_calc_months := nvl(li_calc_months,0);
     
   -- 1., 2., 3., 4., 5., 6., 7.
     ls_return := case as_div
                    when '1'  then to_char(li_years)
                    when '2'  then to_char(li_months)
                    when '3'  then to_char(li_days)
                    when '4'  then to_char(li_total_days)
                    when '5'  then to_char(li_calc_year)
                    when '6'  then to_char(li_calc_months)
                    when '7'  then to_char(li_months_tot)
                  end;
                  
     if ls_return is null then
       return (to_char(li_years)||'-'||to_char(li_months)||'-'||to_char(li_days)||'-'||to_char(li_total_days)||'-'||to_char(li_calc_year)||'-'||to_char(li_calc_months)||'-'||to_char(li_months_tot));
     else
       return ls_return;
     end if;
 END;

/





CREATE OR REPLACE FUNCTION "F_HR_SPACE" (

 ai_num number
 ) RETURN VARCHAR2
 AS
   ls_space varchar2(730);
   li_index integer;
 BEGIN
   ls_space := '';
   FOR li_index in 1..ai_num LOOP
     ls_space := ls_space || ' ';
   END LOOP;
   RETURN(ls_space);
 END;

/





CREATE  OR REPLACE  FUNCTION F_HR_COLUMN_STRCHK (as_str varchar2, ai_num number) RETURN VARCHAR2

 AS
     --       . : 
   ls_str varchar2(100);
 BEGIN
     ls_str := as_str;
     ls_str := nvl(ls_str, F_HR_SPACE(ai_num));
     IF lengthb(ls_str) > ai_num THEN
       ls_str := substr(ls_str,1,ai_num);
     ELSE
       ls_str := ls_str || F_HR_SPACE(ai_num - lengthb(ls_str));
     END IF;
     --dbms_output.put_line(to_char(length(ls_str)));


   RETURN(ls_str);
 END;

/





CREATE  OR REPLACE  FUNCTION F_HR_COLUMN_NUMCHK (an_amt number, ai_num number) RETURN VARCHAR2

 AS
 --       . : 
   ln_amt      number;
   li_index    integer;
   ls_numspace varchar2(100);
   ls_str      varchar2(100);
 BEGIN
     ls_numspace := '';
     ln_amt      := nvl(an_amt, 0);
     FOR li_index in 1..ai_num LOOP
       ls_numspace := ls_numspace || '0';
     END LOOP;


     ls_str := trim(to_char(ln_amt, ls_numspace));
   RETURN(ls_str);
 END;

/





CREATE OR REPLACE FUNCTION "F_HR_MONTHSAFTER" ( ad_sdate  date,

   ad_edate  date ) return number
 AS
 --    
 li_months integer;
 li_years  integer;
 begin
  li_months := trunc(months_between(ad_edate, ad_sdate - 1), 0);
  li_years := trunc(li_months / 12, 0);
  li_months := mod(li_months, 12);
  return li_years + li_months / 100;
 END;

/





CREATE OR REPLACE FUNCTION "F_HR_GET_REFCOLUMN" (

   as_gbn  varchar2, --ref_gbn_code
   as_code varchar2, --ref_code
   as_div  varchar2  --'1':ref_name, '2':ref_name2
   ) RETURN VARCHAR2
 AS

   ref_rec   hr_code_ref%ROWTYPE;
   ls_return varchar2(100);

 BEGIN

   select *
     into ref_rec
     from hr_code_ref
    where ref_gbn_code = as_gbn
      and ref_code     = as_code;

   IF as_div = '1' THEN
     ls_return := trim(ref_rec.ref_name);
   ELSIF as_div = '2' THEN
     ls_return := trim(ref_rec.ref_name2);
   END IF;

   RETURN(ls_return);

 END;

/





CREATE  OR REPLACE  FUNCTION F_HR_PAYX_SLIP_YN (

 	as_comp 	varchar2,
 	as_workyymm varchar2,
 	as_kind 	varchar2
 ) RETURN VARCHAR2
 AS
   ls_endyn 		varchar2(1);
   ls_work_date	varchar2(8);
   ln_work_no	number;
   ln_work_seq	number;
 BEGIN
 	BEGIN
 		--  


 		SELECT distinct work_date, nvl(work_no,0)
 		INTO	ls_work_date,	ln_work_no
 		FROM 	hr_payx_slip_trans
 		WHERE	company_code 	= as_comp
 		and		work_yymm		= as_workyymm
 		and		work_div		= as_kind ;
 		--
 		EXCEPTION
 			WHEN NO_DATA_FOUND THEN
 		    	NULL;
 	END;
 	-- 

 	IF ls_work_date IS NOT NULL AND ln_work_no IS NOT NULL THEN
 		ls_endyn := 'Y';
 	ELSE
 		ls_endyn := 'N';
 	END IF;
 	RETURN(ls_endyn);
 END;

/





CREATE  OR REPLACE  FUNCTION F_HD_GET_VALIDCODE

(
   as_code   VARCHAR2,   --
   as_tp     VARCHAR2    -- 1: 2:
)
RETURN NUMBER IS -- 1: 0:

-------------------------------------------------------------------VALUES
v_code       VARCHAR2(13);
v_sum        NUMBER(10);
v_chk        NUMBER(10);
v_nchk       NUMBER(10);

-------------------------------------------------------------------------
BEGIN
   v_code := TRIM(REPLACE(as_code, '-', ''));
   v_sum  := 0;

   --    --
   IF as_tp = '1' THEN
      IF LENGTH(NVL(v_code, 'X')) <> 10 THEN
         RETURN 0;
      END IF;

      v_sum := v_sum + TO_NUMBER(SUBSTR(v_code,  1, 1)) * 1;
      v_sum := v_sum + TO_NUMBER(SUBSTR(v_code,  2, 1)) * 3;
      v_sum := v_sum + TO_NUMBER(SUBSTR(v_code,  3, 1)) * 7;
      v_sum := v_sum + TO_NUMBER(SUBSTR(v_code,  4, 1)) * 1;
      v_sum := v_sum + TO_NUMBER(SUBSTR(v_code,  5, 1)) * 3;
      v_sum := v_sum + TO_NUMBER(SUBSTR(v_code,  6, 1)) * 7;
      v_sum := v_sum + TO_NUMBER(SUBSTR(v_code,  7, 1)) * 1;
      v_sum := v_sum + TO_NUMBER(SUBSTR(v_code,  8, 1)) * 3;
      v_nchk := TO_NUMBER(SUBSTR(v_code,  9, 1)) * 5;
      v_chk  := TO_NUMBER(SUBSTR(v_code, 10, 1));

      v_sum := v_sum + TRUNC(v_nchk / 10);
      v_sum := v_sum + MOD(v_nchk, 10);
      v_sum := MOD(v_sum, 10);
      v_sum := 10 - v_sum;
      
      IF (v_sum = 10) THEN
         v_sum := 0;
      END IF;

      IF (v_sum = v_chk) THEN
         RETURN 1;
      ELSE
         RETURN 0;
      END IF;
   END IF;

   --   --
   IF as_tp = '2' THEN
      IF LENGTH(NVL(v_code, 'X')) <> 13 THEN
         RETURN 0;
      END IF;

      v_sum := v_sum +  TO_NUMBER(SUBSTR(v_code,  1, 1)) * 2;
      v_sum := v_sum +  TO_NUMBER(SUBSTR(v_code,  2, 1)) * 3;
      v_sum := v_sum +  TO_NUMBER(SUBSTR(v_code,  3, 1)) * 4;
      v_sum := v_sum +  TO_NUMBER(SUBSTR(v_code,  4, 1)) * 5;
      v_sum := v_sum +  TO_NUMBER(SUBSTR(v_code,  5, 1)) * 6;
      v_sum := v_sum +  TO_NUMBER(SUBSTR(v_code,  6, 1)) * 7;
      v_sum := v_sum +  TO_NUMBER(SUBSTR(v_code,  7, 1)) * 8;
      v_sum := v_sum +  TO_NUMBER(SUBSTR(v_code,  8, 1)) * 9;
      v_sum := v_sum +  TO_NUMBER(SUBSTR(v_code,  9, 1)) * 2;
      v_sum := v_sum +  TO_NUMBER(SUBSTR(v_code, 10, 1)) * 3;
      v_sum := v_sum +  TO_NUMBER(SUBSTR(v_code, 11, 1)) * 4;
      v_sum := v_sum +  TO_NUMBER(SUBSTR(v_code, 12, 1)) * 5;
      v_chk := TO_NUMBER(SUBSTR(v_code, 13, 1));

      v_sum := 11 - MOD(v_sum, 11);
      IF v_sum = 10 THEN
         v_sum := 0;
      ELSIF v_sum = 11 THEN
         v_sum := 1;
      END IF;
      
      IF v_sum = v_chk THEN
         RETURN 1;
      ELSE
         RETURN 0;
      END IF;
   END IF;
   
   RETURN 0;
END;


/





CREATE OR REPLACE FUNCTION "F_AM_GET_DEPOSIT_CALCSUM"  

( av_deposit varchar2
 , av_date varchar2
 , av_enddate varchar2
 , av_holiday_yn varchar2
 )
 return integer is
    lv_nexdate   varchar2(8);
	lv_lastdate   varchar2(8);
	lv_days    integer;
	lv_amt    integer;
	lv_holday integer;
 begin
    
	select (case when expire_date < av_enddate and  expire_date > av_date then expire_date
	                                    else av_enddate  end) INTO lv_lastdate
	from am_code_deposit
	where deposit_no = av_deposit 
	;						 
	
	
	select  min(a.end_date)  into lv_nexdate
	 from am_endx_deposit a,
		  am_code_calc_acnt acnt
	  where a.acnt_code = acnt.acnt_code
	   and  a.end_date > av_date 
	   and   a.end_date <= lv_lastdate
	   and  acnt.calc_kind_code=  '000'
	   and acnt.calc_list_code = 'Depo0001'
	   and a.deposit_no = av_deposit ;
		
    if lv_nexdate is null then 
	   lv_nexdate := to_char(to_date(lv_lastdate) + 1,'yyyymmdd');
	end if;
	
	if av_holiday_yn = 'N' then  /*   */
		select sum(decode(to_char(to_date(work_date),'d'),1,1,7,1,decode(holiday_yn,'Y',1,0))) into lv_holday
		from sm_code_calendar
		where work_date between av_date  and lv_nexdate
		;
	else
	   lv_holday := 0;
	end if;
	
	if lv_nexdate = av_enddate then 
	   lv_nexdate := to_char(to_date(lv_nexdate) + 1,'yyyymmdd');
	end if;
	
	lv_days := (to_date(lv_nexdate) - to_date(av_date ))  - lv_holday ;
	--lv_amt  := av_amt *  lv_days;
	
    return lv_days;
 end;

/





CREATE OR REPLACE FUNCTION "F_HR_PERS_COUNT"(as_yymm varchar2, as_kind varchar2) RETURN number

 AS
   ln_cnt  number :=0;
 BEGIN
  if as_kind = 'total'  then  /**/
 	  select count(distinct emp_no)
 	    into ln_cnt
 	    from hr_payx_result_mst
 	   where work_yymm= as_yymm;
   else   /* cnt*/
        select count(distinct emp_no)
 	    into ln_cnt
 	    from hr_payx_result_detail

 	   where work_yymm= as_yymm
 	    and allow_code = 'AA'; /**/
    end if ;
    return ln_cnt;
 END;

/





CREATE OR REPLACE FUNCTION             "F_AM_SET_VATAMT" ( ag_amt number

 , ag_len number
 )
 return varchar2 is
    ag_amt_st varchar2(20);
    ag_alpha varchar2(20);
 begin
    if abs(ag_amt  / trunc(ag_amt)) > 1 then
       select lpad(trunc(abs(ag_amt),0),ag_len - 2,'0') ||to_char((abs(ag_amt) - trunc(abs(ag_amt),0))  * 100)
         into ag_amt_st
         from dual
       ;


       if substr(ag_amt_st,ag_len -2 ,1) = '0' then
          ag_alpha := '}';
       elsif substr(ag_amt_st,ag_len -2,1) = '1' then
          ag_alpha := 'J';
       elsif substr(ag_amt_st,ag_len -2,1) = '2' then
          ag_alpha := 'K';
       elsif substr(ag_amt_st,ag_len -2,1) = '3' then
          ag_alpha := 'L';
       elsif substr(ag_amt_st,ag_len -2,1) = '4' then
          ag_alpha := 'M';
       elsif substr(ag_amt_st,ag_len -2,1) = '5' then
          ag_alpha := 'N';
       elsif substr(ag_amt_st,ag_len -2,1) = '6' then

          ag_alpha := 'O';
       elsif substr(ag_amt_st,ag_len -2,1) = '7' then
          ag_alpha := 'P' ;
       elsif substr(ag_amt_st,ag_len -2,1) = '8' then
          ag_alpha := 'Q';
       elsif substr(ag_amt_st,ag_len -2,1) = '9' then
          ag_alpha := 'R';
       end if;

       select substr(ag_amt_st,1,ag_len -3) ||ag_alpha||substr(ag_amt_st,ag_len -1,2)
         into ag_amt_st
         from dual
       ;

    else
       select lpad(trim(to_char(abs(ag_amt ))),ag_len,'0')
         into ag_amt_st
         from dual
       ;

       if substr(ag_amt_st,ag_len  ,1) = '0' then
          ag_alpha :='}' ;
       elsif substr(ag_amt_st,ag_len ,1) = '1' then
          ag_alpha :='J';
       elsif substr(ag_amt_st,ag_len ,1) = '2' then
          ag_alpha :='K';
       elsif substr(ag_amt_st,ag_len ,1) = '3' then

          ag_alpha :='L';
       elsif substr(ag_amt_st,ag_len ,1) = '4' then
          ag_alpha :='M';
       elsif substr(ag_amt_st,ag_len ,1) = '5' then
          ag_alpha :='N';
       elsif substr(ag_amt_st,ag_len ,1) = '6' then
          ag_alpha :='O';
       elsif substr(ag_amt_st,ag_len ,1) = '7' then
          ag_alpha :='P' ;
       elsif substr(ag_amt_st,ag_len ,1) = '8' then
          ag_alpha :='Q';
       elsif substr(ag_amt_st,ag_len ,1) = '9' then
          ag_alpha :='R';

       end if ;

       select substr(ag_amt_st,1,ag_len -1) ||ag_alpha
         into ag_amt_st
         from dual
       ;
    end if;
    return ag_amt_st;
 end;

/





CREATE  OR REPLACE  FUNCTION F_HR_PERS_LUNAR_TO_SOLAR ( as_lunar IN CHAR )

     RETURN VARCHAR2
     IS
        Out_Of_Range exception;
        ls_return VARCHAR2(100);
        LunerY  NUMBER(5) := 0 ;
        LunerM  NUMBER(5) := 0 ;
        LunerD  NUMBER(5) := 0 ;
        i  NUMBER(5) := 0 ;
        j NUMBER(5) := 0 ;

         -- 1921  
        ll_FromYear                  NUMBER(10) := 0 ;


        ls_YunMon    VARCHAR2(500);     --
        ls_YunLen     VARCHAR2(500);    -- (29 OR 30)

 	--    
         --( 12 byte  * (30  1 )  )
        ls_MonLen     VARCHAR2(500) 	;
        ls_lYearDay    VARCHAR2(500);   --  (29 OR 30)
        ls_SolarMon    VARCHAR2(39) ;

         --0000-00-00  
        ll_DaySum        NUMBER(10);


        li_M NUMBER(5) := 0 ;

        MM NUMBER(5) := 0 ;
        MK NUMBER(5):=0 ;

        v_loop NUMBER(5) :=0;

        li_PrevYear NUMBER(5):=0;
        li_OneYearDay  NUMBER(5):=0;
        NA NUMBER(5):=0;
        YD NUMBER(5):=0;
        KA NUMBER(5):=0;
        SolarY NUMBER(5):=0 ;

        SolarM NUMBER(5):=0 ;
        SolarD NUMBER(5):=0;

 BEGIN
     LunerY := TO_NUMBER(SUBSTR( as_lunar,1,4)) + 2333;
     LunerM := TO_NUMBER(SUBSTR( as_lunar,5,2));
     LunerD := TO_NUMBER(SUBSTR( as_lunar,7,2));

     -- 1921-2030 , 1-12 , 1-31    .
     IF (SUBSTR(as_lunar,1,4) < '1921' OR SUBSTR(as_lunar,1,4) > '2030')
        OR
        (SUBSTR(as_lunar,5,2) < '01' OR SUBSTR(as_lunar,5,2) > '12')
        OR

        (SUBSTR(as_lunar,7,2) < '01' OR SUBSTR(as_lunar,7,2) > '31')
        THEN
        raise Out_Of_Range;

     END IF ;

    --1921 - 2030
    ls_YunMon := ' 0 5 0 0 4 0 0 2 0 6'||
 		' 0 0 5 0 0 3 0 7 0 0'||
 		' 6 0 0 4 0 0 2 0 7 0'||
 		' 0 5 0 0 3 0 8 0 0 6'||
 		' 0 0 4 0 0 3 0 7 0 0'||
 		' 5 0 0 4 0 8 0 0 6 0'||

 		' 0 4 010 0 0 6 0 0 5'||
 		' 0 0 3 0 8 0 0 5 0 0'||
 		' 4 0 0 2 0 7 0 0 5 0'||
 		' 0 3 0 9 0 0 5 0 0 4'||

 		' 0 0 2 0 6 0 0 5 0 0';
    --1921 - 2030
    ls_YunLen := ' 029 0 029 0 029 029'||
 		' 0 030 0 030 030 0 0'||
 		'30 0 030 0 029 029 0'||
 		' 030 0 030 029 0 029'||
 		' 0 029 0 029 029 0 0'||
 		'29 0 029 029 0 030 0'||

 	 	' 029 029 0 029 0 029'||
 		' 0 029 029 0 029 0 0'||
 		'29 0 029 029 0 029 0'||
 		' 030 029 0 029 0 029'||
 		' 0 029 029 0 029 0 0';


    --1921 - 2030
    ls_lYearDay :=
 		' 354 384 354 354 385 354 355 384 354 383'||
 		' 354 355 384 355 354 384 354 384 354 354'||
                 ' 384 355 355 384 354 354 384 354 384 354'||
 		' 355 384 355 354 384 354 384 354 354 384'||

                 ' 355 354 384 355 353 384 355 384 354 355'||
 		' 384 354 354 384 354 384 354 355 384 355'||
                 ' 354 384 354 384 354 354 385 354 355 384'||
 		' 354 354 383 355 384 355 354 384 354 354'||
 		' 384 354 355 384 355 384 354 354 384 354'||
 		' 354 384 355 384 355 354 384 354 354 384'||

 		' 354 355 384 354 384 355 354 383 355 354';

 	--1921 - 2030
    ls_MonLen :=
 		'26352891170527722997 6942395133511751622'||
 		'3658374917051461 69422222350321332213402'||

                 '346629211389 603 60523493371270934132890'||
 		'290113651243 603213513232715168517062794'||
       	        '2741120627342647131838783477171713862477'||
 		'1245119826383405336534132900343423942395'||
       	        '1179271526352855170117482901 69423951207'||
 		'117516111866374917531453 694241423503222'||
 		'37333402349318771389 699 605234932432709'||

 		'28902890290113731211 6032391132327092965'||
 		'1706277317171206267026471319170234751450';
    ll_DaySum := 701303  ; --1920 

    --1921      

    ll_FromYear := LunerY - 4254  ;
    FOR  i IN 1..ll_FromYear LOOP
         ll_DaySum := ll_DaySum + TO_NUMBER( SubStr( ls_lYearDay, i*4-3, 4 ) );
    END LOOP;

    --  
    IF LunerM <> 1  THEN --1   -> 
          li_M := 2048;

          ll_FromYear := ll_FromYear + 1;

          MM := TO_NUMBER( SUBSTR( ls_MonLen, ll_FromYear*4-3,4 ) );


          FOR  j IN 1..LunerM - 1 LOOP
             --  .
             ll_DaySum := ll_DaySum + 29 + TRUNC(MM / li_M);

             MM := MM - TRUNC(MM / li_M) * li_M;
             li_M := TRUNC(li_M / 2);

             IF  j = TO_NUMBER( SUBSTR( ls_YunMon,ll_FromYear*2-1,2 ) )  THEN
                 -- 

                 ll_DaySum := ll_DaySum +
                       TO_NUMBER( SUBSTR( ls_YunLen, ll_FromYear*2-1,2 ) );
             END IF;

          END LOOP ;
    END IF;

    --   
    ll_DaySum := ll_DaySum + LunerD;

    ------------------------------------------------------
    --1921     .
    ------------------------------------------------------
    li_PrevYear := TRUNC(ll_DaySum/365) - 1    ;

    NA := TRUNC(ll_DaySum - li_PrevYear*365)    ;
    YD := TRUNC(li_PrevYear/4)

          - TRUNC(li_PrevYear/100)
          + TRUNC(li_PrevYear/400) ;
    KA := NA - YD  ;

    IF KA < 0 THEN
         li_PrevYear := li_PrevYear - 1;
         NA := ll_DaySum - TRUNC(li_PrevYear*365);
         YD := TRUNC(li_PrevYear/4) - TRUNC(li_PrevYear/100 )
               + TRUNC(li_PrevYear/400);
         NA := NA - YD;
    ELSE

         NA := KA;

    END IF;

    --   .
    SolarY := li_PrevYear + 1;
    IF   SolarY = TRUNC(SolarY/4)*4  AND  SolarY<>TRUNC(SolarY/100)*100 THEN
         ls_SolarMon := '  0 31 29 31 30 31 30 31 31 30 31 30 31';
         li_OneYearDay := 366;

    ELSIF  SolarY = TRUNC(SolarY/400)*400 THEN
         ls_SolarMon := '  0 31 29 31 30 31 30 31 31 30 31 30 31';
         li_OneYearDay := 366;



    ELSE
 	ls_SolarMon := '  0 31 28 31 30 31 30 31 31 30 31 30 31';
         li_OneYearDay := 365;

    END IF;

    IF NA = 0 THEN
          NA := li_OneYearDay;
          SolarY := SolarY - 1;
    END IF;

    FOR  I IN 1..13 LOOP
         v_loop := I;


         IF  NA > TO_NUMBER( SUBSTR( ls_SolarMon,I*3-2,3 ) ) THEN
             NA := NA - TO_NUMBER( SUBSTR( ls_SolarMon,I*3-2,3 ) );
         ELSE
             EXIT;
         END IF;
    END LOOP;

    SolarM := v_loop - 1;
    SolarD := NA;
    ls_return := LPAD(SolarY,4,'0') ||
                 LPAD(SolarM,2,'0') ||
                 LPAD(SolarD,2,'0');

    Return ls_return;


    exception
      WHEN DUP_VAL_ON_INDEX then
           ls_return := 'DUP_VAL_ON_INDEX .';
           Return ls_return;
      WHEN INVALID_NUMBER then
           ls_return := 'INVALID_NUMBER .';
           Return ls_return;
      WHEN LOGIN_DENIED then
           ls_return := 'Login Denied.';
           Return ls_return;

      WHEN NOT_LOGGED_ON then
           ls_return := 'Not Logged On.';

           Return ls_return;
      WHEN PROGRAM_ERROR then
           ls_return := 'Program Error.';
           Return ls_return;
      WHEN STORAGE_ERROR then
           ls_return := 'Storage Error.';
           Return ls_return;
      WHEN TIMEOUT_ON_RESOURCE then
           ls_return := 'Timeout on resource.';
           Return ls_return;

      WHEN VALUE_ERROR then
           ls_return := 'VALUE_ERROR . ';
           Return ls_return;

      WHEN ZERO_DIVIDE then
           ls_return := 'Zero Divide .';
           Return ls_return;
      WHEN Out_Of_Range then
           ls_return := '(1921.01.01-2030.11.28) .';
           Return ls_return;
      WHEN others then
           ls_return := SUBSTR(SQLERRM, 1, 100 );
           Return ls_return;

 END;

/





CREATE OR REPLACE FUNCTION           "F_FM_SET_VATAMT" ( ag_amt number

 , ag_len number
 )
 return varchar2 is
    ag_amt_st varchar2(20);
    ag_alpha varchar2(20);
 begin
    if abs(ag_amt  / trunc(ag_amt)) > 1 then
       select lpad(trunc(abs(ag_amt),0),ag_len - 2,'0') ||to_char((abs(ag_amt) - trunc(abs(ag_amt),0))  * 100)
         into ag_amt_st
         from dual
       ;


       if substr(ag_amt_st,ag_len -2 ,1) = '0' then
          ag_alpha := '}';
       elsif substr(ag_amt_st,ag_len -2,1) = '1' then
          ag_alpha := 'J';
       elsif substr(ag_amt_st,ag_len -2,1) = '2' then
          ag_alpha := 'K';
       elsif substr(ag_amt_st,ag_len -2,1) = '3' then
          ag_alpha := 'L';
       elsif substr(ag_amt_st,ag_len -2,1) = '4' then
          ag_alpha := 'M';
       elsif substr(ag_amt_st,ag_len -2,1) = '5' then
          ag_alpha := 'N';
       elsif substr(ag_amt_st,ag_len -2,1) = '6' then

          ag_alpha := 'O';
       elsif substr(ag_amt_st,ag_len -2,1) = '7' then
          ag_alpha := 'P' ;
       elsif substr(ag_amt_st,ag_len -2,1) = '8' then
          ag_alpha := 'Q';
       elsif substr(ag_amt_st,ag_len -2,1) = '9' then
          ag_alpha := 'R';
       end if;

       select substr(ag_amt_st,1,ag_len -3) ||ag_alpha||substr(ag_amt_st,ag_len -1,2)
         into ag_amt_st
         from dual
       ;

    else
       select lpad(trim(to_char(abs(ag_amt ))),ag_len,'0')
         into ag_amt_st
         from dual
       ;

       if substr(ag_amt_st,ag_len  ,1) = '0' then
          ag_alpha :='}' ;
       elsif substr(ag_amt_st,ag_len ,1) = '1' then
          ag_alpha :='J';
       elsif substr(ag_amt_st,ag_len ,1) = '2' then
          ag_alpha :='K';
       elsif substr(ag_amt_st,ag_len ,1) = '3' then

          ag_alpha :='L';
       elsif substr(ag_amt_st,ag_len ,1) = '4' then
          ag_alpha :='M';
       elsif substr(ag_amt_st,ag_len ,1) = '5' then
          ag_alpha :='N';
       elsif substr(ag_amt_st,ag_len ,1) = '6' then
          ag_alpha :='O';
       elsif substr(ag_amt_st,ag_len ,1) = '7' then
          ag_alpha :='P' ;
       elsif substr(ag_amt_st,ag_len ,1) = '8' then
          ag_alpha :='Q';
       elsif substr(ag_amt_st,ag_len ,1) = '9' then
          ag_alpha :='R';

       end if ;

       select substr(ag_amt_st,1,ag_len -1) ||ag_alpha
         into ag_amt_st
         from dual
       ;
    end if;
    return ag_amt_st;
 end;

/





CREATE  OR REPLACE  FUNCTION F_HR_PAYX_CNT (

    as_yymm VARCHAR2
 )
 RETURN NUMBER IS
 vCnt NUMBER;
 /*********************************************************/
 /*           */
 /*********************************************************/
 BEGIN
 SELECT COUNT(DISTINCT EMP_NO)
  INTO vCnt
 FROM (
 		SELECT  EMP_NO


 		  FROM HR_PAYX_RESULT_MST
 		 WHERE WORK_YYMM = as_yymm
 		UNION ALL
 		SELECT  EMP_NO
 		  FROM HR_YETA_RESULT
 		 WHERE WORK_YEAR = substr(as_yymm,0,4)
 		   AND '12' = SUBSTR(AS_YYMM,5,2)
 );
 RETURN vCnt;
 END F_HR_PAYX_CNT;


/





CREATE  OR REPLACE  FUNCTION F_HR_PAYX_END_YN (

 	as_comp varchar2,
 	as_workyymm varchar2,
 	as_kind varchar2
 ) RETURN VARCHAR2
 AS
   ls_endyn varchar2(1);
 BEGIN
   select nvl(max(end_yn), 'N')
     into ls_endyn
     from hr_payx_end
    where company_code = as_comp
      and work_yymm    = as_workyymm


      and pay_kind     = as_kind;
   RETURN(ls_endyn);
 END;

/





CREATE OR REPLACE FUNCTION       "F_HR_PAYX_STND_ALLOW" (

   V_B2_11 NUMBER,
   V_B2_12 NUMBER,
   V_B2_14 NUMBER,
   V_B2_15 NUMBER,
   V_B2_17 NUMBER
  )
 RETURN NUMBER
 AS
   V_B2_13 NUMBER := 0;
 BEGIN

   --   : ( +  +  +  + ) * 0.1

   V_B2_13 := trunc((V_B2_11 + V_B2_12 + V_B2_14 + V_B2_15 + V_B2_17) * 0.1, -1); --   trunc 

   RETURN(V_B2_13);
 END;

/





CREATE OR REPLACE FUNCTION       "F_HR_RETI_SLIP_DATE" (as_comp varchar2, as_rdate varchar2, as_empno varchar2) RETURN VARCHAR2

 AS
     ls_date varchar2(8);
 BEGIN

     select slip_date
       into ls_date
       from am_slip_master
      where (work_comp, work_date, work_no) in
                                               (
                                                 select company_code, work_date, work_no
                                                   from hr_payx_slip_trans
                                                  where company_code   = as_comp

                                                    and work_yymm      = as_rdate
                                                    and work_div       = as_empno
                                                    and slip_kind_code = 'HR4'
                                                 group by company_code, work_date, work_no
                                               )
        and check_status = '2';
   RETURN(ls_date);

 exception
     when NO_DATA_FOUND then
         return('99991231');
 END;

/





CREATE OR REPLACE FUNCTION "F_HR_RETI_SLIP_YN" (as_comp varchar2, as_rdate varchar2, as_empno varchar2, as_div varchar2) RETURN VARCHAR2

 AS
  /*
    :               .

   as_comp  - ('100')
   as_rdate - ('20060101')
   as_empno - ('00064')
   as_div   - ('1':, '2':)

  */
   ls_summ_yn  varchar2(1) := 'Y';
   ls_slip_yn  varchar2(1);


 BEGIN

   begin
     select decode(work_date, null, 'N', 'Y')
       into ls_slip_yn
       from hr_payx_slip_trans
      where company_code = as_comp
        and work_yymm    = as_rdate
        and work_div     = as_empno
      group by work_date;
   exception
     when NO_DATA_FOUND then

       ls_summ_yn := 'N';

       ls_slip_yn := 'N';
   end;

   if as_div = '1' then
     RETURN(ls_summ_yn);
   else
     RETURN(ls_slip_yn);
   end if;

 END;

/





CREATE OR REPLACE FUNCTION "F_HR_RETI_TRUST_AMT" (

  as_year varchar2,
  as_empno varchar2
 ) RETURN VARCHAR2
 AS
   ldec_pnret_amt    number;
   ldec_account_amt  number;
 BEGIN
     -- 
     select nvl(sum(pnret_amt),0)
       into ldec_pnret_amt
       from hr_reti_transfer_amt
      where emp_no = as_empno


        and (end_yn is null or end_yn = 'N');

 	--
     select nvl(sum(account_amt),0)
       into ldec_account_amt
       from hr_reti_trust
      where work_yyyy = as_year
        and emp_no    = as_empno;
   RETURN(trim(to_char(ldec_pnret_amt)) ||'|'||trim(to_char(ldec_account_amt)));
 END;

/





CREATE OR REPLACE FUNCTION           "F_HR_ROWTOCOL" (

 p_slct IN VARCHAR2, p_dlmtr IN VARCHAR2 DEFAULT ',', p_opt IN VARCHAR2 DEFAULT 'N' 
)
return VARCHAR2
as
     TYPE c_refcur IS REF CURSOR;
     lc_str VARCHAR2(4000);
     lc_colval VARCHAR2(4000);
     c_dummy c_refcur;
     l number;
begin
     OPEN c_dummy FOR p_slct;
     LOOP
       FETCH c_dummy INTO lc_colval;


       EXIT WHEN c_dummy%NOTFOUND;
       lc_str := lc_str || p_dlmtr || lc_colval;
     END LOOP;
     CLOSE c_dummy;

     IF p_opt = 'Y' THEN
      RETURN SUBSTR(lc_str,1);
     ELSE
      RETURN SUBSTR(lc_str,2);
     END IF;

 EXCEPTION
     WHEN OTHERS THEN
     lc_str := SQLERRM;
     IF c_dummy%ISOPEN THEN
       CLOSE c_dummy;
     END IF;

     RETURN lc_str;
end;

/





CREATE  OR REPLACE  FUNCTION F_HR_TIME_END_YN (

 	as_date varchar2
 ) RETURN VARCHAR2
 AS
   ls_endyn varchar2(1);
 BEGIN

   select nvl(max(magam_tag), 'N')
     into ls_endyn
     from hr_time_magam
    where magam_date   = as_date;

   RETURN(ls_endyn);

 END;

/





CREATE OR REPLACE FUNCTION "F_HR_YETA_DEDUCT_CHK" (as_year varchar2, as_rrn varchar2)

 RETURN VARCHAR2
 AS

 ls_mandiv   varchar2(1);
 ls_yearrrn  varchar2(4);
 ll_age      integer;

 ls_basicyn      varchar2(1) := 'N';
 ls_childyn      varchar2(1) := 'N';
 ls_respectyn    varchar2(1) := 'N';
 ls_respect70yn  varchar2(1) := 'N';



 BEGIN
   ls_mandiv  := substr(as_rrn,7,1);
   ls_yearrrn := '';

   if (ls_mandiv = '1' or ls_mandiv = '2' or ls_mandiv = '5' or ls_mandiv = '6') then
     ls_yearrrn := '19' || substr(as_rrn,1,2);
   else
     ls_yearrrn := '20' || substr(as_rrn,1,2);
   end if;

   ll_age := to_number(as_year) - to_number(ls_yearrrn);


   --(20)

   if (ll_age <= 20) then
     ls_basicyn := 'Y';
     if (ll_age <= 6) then
       ls_childyn := 'Y';
     end if;

   --(:60, :55) (65-69) (70)
   elsif (ll_age >= 55) then
     if (ls_mandiv = '1') then
       if (ll_age >= 60) then
         ls_basicyn := 'Y';

       end if;
       if (ll_age >= 65 and ll_age <= 69) then

         ls_respectyn := 'Y';
       elsif (ll_age >= 70) then
         ls_respect70yn := 'Y';
       end if;
     elsif (ls_mandiv = '2') then
       if (ll_age >= 55) then
         ls_basicyn := 'Y';
       end if;
       if (ll_age >= 65 and ll_age <= 69) then
         ls_respectyn := 'Y';

       elsif (ll_age >= 70) then
         ls_respect70yn := 'Y';
       end if;

     end if;
   end if;

   RETURN(ls_basicyn || ls_childyn || ls_respectyn || ls_respect70yn);
 END;

/





CREATE  OR REPLACE  FUNCTION F_HR_YETA_END_YN (

 	as_comp varchar2,
 	as_year varchar2
 ) RETURN VARCHAR2
 AS
   ls_endyn varchar2(1);
 BEGIN
   -- .
   select nvl(max(end_yn), 'N')
     into ls_endyn
     from hr_yeta_end
    where company_code = as_comp
      and work_year    = as_year;

   RETURN(ls_endyn);
 END;

/





CREATE OR REPLACE FUNCTION "F_MM_CHARTONUMYN"(

    AN_NUM VARCHAR
)
RETURN VARCHAR2 IS
    vNum	  NUMBER;
BEGIN
 	vNum := TO_NUMBER(AN_NUM);

    RETURN 'Y';

EXCEPTION
	  WHEN OTHERS THEN
	    -- Consider logging the error and then re-raise
	    RETURN 'N';
END;

/





CREATE OR REPLACE FUNCTION "F_MM_CONTPAPER_CHANGE" ( vSrc VARCHAR2, vA1 VARCHAR2, vA2 VARCHAR2, vA3 VARCHAR2 )

RETURN VARCHAR2 IS
   vReturn VARCHAR2(2000);
BEGIN
   vReturn := REPLACE(REPLACE(REPLACE(vSrc, ':A1', vA1), ':A2', vA2), ':A3', vA3);
   RETURN vReturn;
END;

/





CREATE  OR REPLACE  FUNCTION F_MM_GET_CUSTFORMAT(

 	AS_CUST_CODE    VARCHAR2
 ) RETURN VARCHAR2 IS

	LS_CUST_CODE VARCHAR2(20);
	LN_CUST_CODE NUMBER(20);
 BEGIN

  	LS_CUST_CODE := TRIM(REPLACE(AS_CUST_CODE, '-', ''));

	BEGIN
		LN_CUST_CODE := TO_NUMBER(AS_CUST_CODE);
	EXCEPTION WHEN OTHERS THEN
		RETURN AS_CUST_CODE;
	END;

	IF LENGTH(LS_CUST_CODE) = 10 THEN
	   LS_CUST_CODE := TRIM(TO_CHAR(LN_CUST_CODE, '999,99,99999'));
	END IF;

	IF LENGTH(LS_CUST_CODE) = 13 THEN
	   LS_CUST_CODE := TRIM(TO_CHAR(LN_CUST_CODE, '999999,9999999'));
	END IF;

	LS_CUST_CODE := REPLACE(LS_CUST_CODE, ',', '-');

	RETURN LS_CUST_CODE;

 EXCEPTION
 	WHEN NO_DATA_FOUND THEN
 		 NULL;

 	WHEN OTHERS THEN
 		 -- Consider logging the error and then re-raise
 		 RAISE;
 END F_MM_GET_CUSTFORMAT;

/





CREATE  OR REPLACE  FUNCTION F_MM_GET_BONDCUST(

 	AS_CONTRACT_CODE    VARCHAR2,
 	AS_BOND_SERIAL 		VARCHAR2,
	AS_CUST_DIV			VARCHAR2,
	AS_TAG				VARCHAR2
 ) RETURN VARCHAR2 IS

    LS_REAL_CUST_CODE VARCHAR2(20);
	LS_CUST_CODE VARCHAR2(20);
    LS_CUST_NAME VARCHAR2(200);
	LS_TAG VARCHAR2(1);
	LS_ADDR VARCHAR2(150);
  	LS_RETURN VARCHAR2(2000);

	-- :     
  	CURSOR CUR_BOND IS
		SELECT '1' TAG,
			   A.BOND_CLIENT_NUM AS REAL_CUST_CODE,
			   DECODE(TRIM(B.CUST_LEGAL_NO), NULL, A.BOND_CLIENT_NUM, B.CUST_LEGAL_NO) AS CUST_CODE,
			   A.BOND_CLIENT_NAME AS CUST_NAME
		  FROM MM_COMM_BOND A,
		  	   SM_CODE_CUST B
		 WHERE A.BOND_CLIENT_NUM = B.CUST_CODE(+) AND
		 	   A.CONTRACT_CODE = AS_CONTRACT_CODE AND
 		 	   A.BOND_SERIAL = TO_NUMBER(AS_BOND_SERIAL) AND
			   AS_CUST_DIV = 'W'
		UNION ALL
		SELECT '1' TAG,
			   A.DEBTOR_NUM AS REAL_CUST_CODE,
			   DECODE(TRIM(B.CUST_LEGAL_NO), NULL, A.DEBTOR_NUM, B.CUST_LEGAL_NO) AS CUST_CODE,
			   A.DEBTOR_NAME AS CUST_NAME
		  FROM MM_COMM_BOND A,
		  	   SM_CODE_CUST B
		 WHERE A.DEBTOR_NUM = B.CUST_CODE(+) AND
		 	   	A.CONTRACT_CODE = AS_CONTRACT_CODE AND
 		 	   A.BOND_SERIAL = TO_NUMBER(AS_BOND_SERIAL) AND
			   AS_CUST_DIV = 'C'
		UNION ALL
 		SELECT '2' TAG,
			   A.CUST_CODE AS REAL_CUST_CODE,
			   DECODE(TRIM(B.CUST_LEGAL_NO), NULL, A.CUST_CODE, B.CUST_LEGAL_NO),
			   A.CUST_NAME
 		  FROM MM_COMM_BOND_PERSON A,
		  	   SM_CODE_CUST B
 		 WHERE A.CUST_CODE = B.CUST_CODE(+) AND
		 	   A.CONTRACT_CODE = AS_CONTRACT_CODE AND
 		 	   A.BOND_SERIAL = TO_NUMBER(AS_BOND_SERIAL) AND
			   A.CUST_DIV = AS_CUST_DIV
 	  ORDER BY TAG, CUST_CODE
 	   ;
 BEGIN

  	LS_RETURN := '';

 	OPEN CUR_BOND;
 	LOOP
 		FETCH CUR_BOND INTO LS_TAG, LS_REAL_CUST_CODE, LS_CUST_CODE, LS_CUST_NAME;
 		EXIT WHEN CUR_BOND%NOTFOUND;

		IF AS_TAG = '1' THEN
 		   LS_RETURN := LS_RETURN || ', ' || F_Mm_Get_Custformat(LS_CUST_CODE);
		END IF;

		IF AS_TAG = '2' THEN
		   LS_RETURN := LS_RETURN || ', ' || LS_CUST_NAME;
		END IF;

		IF AS_TAG = '3' THEN
		   BEGIN
		      SELECT ADDR1 || ' ' || ADDR2
			    INTO LS_ADDR
			    FROM SM_CODE_CUST
			   WHERE CUST_CODE = LS_REAL_CUST_CODE;
		   EXCEPTION WHEN NO_DATA_FOUND THEN
		      LS_ADDR := '';
		   END;
		   LS_RETURN := LS_RETURN || ', ' || LS_ADDR;
		   EXIT;
		END IF;

 	END LOOP;
 	CLOSE CUR_BOND;

 	IF LS_RETURN = '' THEN
 	   RETURN LS_RETURN;
 	ELSE
       RETURN SUBSTR(LS_RETURN, 3);
 	END IF;

 EXCEPTION
 	WHEN NO_DATA_FOUND THEN
 		 NULL;

 	WHEN OTHERS THEN
 		 -- Consider logging the error and then re-raise
 		 RAISE;
 END F_Mm_Get_Bondcust;

/





CREATE  OR REPLACE  FUNCTION F_MM_GET_BONDPRIOR(

 	AS_CONTRACT_CODE    VARCHAR2,
	AS_BOND_SERIAL		VARCHAR2,
 	AS_RANK				VARCHAR2,
	AS_ROW_NUM			VARCHAR2,
	AS_TAG				VARCHAR2
 ) RETURN VARCHAR2 IS

    LN_RANK NUMBER(3);

	LN_ROW_NUM NUMBER(3);
	AS_SEP_TAG VARCHAR2(1);
	LS_CUST_CODE VARCHAR2(20);
    LS_CUST_NAME VARCHAR2(200);
	LS_PRIOR_AMT VARCHAR2(30);
	LN_BENE_RANK NUMBER(3);

  	LS_RETURN VARCHAR2(200);

  	CURSOR CUR_BOND IS
		SELECT ROW_NUMBER() OVER (ORDER BY PRIOR_BENE_RANK, BOND_BENE_NUM) AS ROW_NUM,
			   BOND_BENE_NUM,
			   BOND_BENE_NAME,
			   PRIOR_AMT,
			   PRIOR_BENE_RANK
		  FROM MM_COMM_BOND
		 WHERE CONTRACT_CODE = AS_CONTRACT_CODE AND
			   PRIOR_BENE_RANK <= TO_NUMBER(AS_RANK) AND
			   ISSUE_TAG = '01' AND
			   BOND_SERIAL <> TO_NUMBER(AS_BOND_SERIAL)
	  ORDER BY PRIOR_BENE_RANK,
	  		   BOND_BENE_NUM
 	   ;
 BEGIN

 	BEGIN
	   SELECT PRIOR_SEP_PAPER_TAG
	     INTO AS_SEP_TAG
		 FROM MM_COMM_BOND
		WHERE CONTRACT_CODE = AS_CONTRACT_CODE AND
			  BOND_SERIAL = TO_NUMBER(AS_BOND_SERIAL);
	EXCEPTION WHEN NO_DATA_FOUND THEN
	   RETURN '';
	END;

	IF AS_SEP_TAG = 'Y' THEN
	   RETURN '';
	END IF;

  	LS_RETURN := '';

 	OPEN CUR_BOND;
 	LOOP
 		FETCH CUR_BOND INTO LN_ROW_NUM, LS_CUST_CODE, LS_CUST_NAME, LS_PRIOR_AMT, LN_BENE_RANK;
 		EXIT WHEN CUR_BOND%NOTFOUND;

		IF LN_ROW_NUM = TO_NUMBER(AS_ROW_NUM) THEN
			IF AS_TAG = '1' THEN
	 		   LS_RETURN := F_MM_GET_CUSTFORMAT(LS_CUST_CODE);
			END IF;

			IF AS_TAG = '2' THEN
			   LS_RETURN := LS_CUST_NAME;
			END IF;

			IF AS_TAG = '3' THEN
			   LS_RETURN := NVL(TRIM(LS_PRIOR_AMT), '-');
			END IF;

			IF AS_TAG = '4' THEN
			   LS_RETURN := '' || TO_CHAR(LN_BENE_RANK);
			END IF;
		END IF;

		EXIT WHEN LN_ROW_NUM = AS_ROW_NUM;
 	END LOOP;
 	CLOSE CUR_BOND;

 	RETURN LS_RETURN;

 EXCEPTION
 	WHEN NO_DATA_FOUND THEN
 		 NULL;

 	WHEN OTHERS THEN
 		 -- Consider logging the error and then re-raise
 		 RAISE;
 END F_MM_GET_BONDPRIOR;

/





CREATE  OR REPLACE  FUNCTION F_MM_GET_BONDTHING(

 	AS_CONTRACT_CODE    VARCHAR2,
 	AS_BOND_SERIAL 		VARCHAR2,
	AS_ROW_NUM			VARCHAR2,
	AS_TAG				VARCHAR2
 ) RETURN VARCHAR2 IS

	LS_SEP_TAG VARCHAR2(1);
	LN_ROW_NUM NUMBER(3);
    LS_ADDR  VARCHAR2(400);
	LS_CLASS1 VARCHAR2(10);
	LS_AREA1 NUMBER(12,4);
	LS_CLASS2 VARCHAR2(10);
	LS_AREA2 NUMBER(12,4);

  	LS_RETURN VARCHAR2(4000);

  	CURSOR CUR_THING IS
 		SELECT ROW_NUMBER() OVER (ORDER BY SEQ) AS ROW_NUM,
			   ADDR1 || ' ' || ADDR2,
			   THING_CLASS1,
			   THING_AREA1_M2,
			   THING_CLASS2,
			   THING_AREA2_M2
 		  FROM MM_COMM_BOND_THING
 		 WHERE CONTRACT_CODE = AS_CONTRACT_CODE AND
 		 	   BOND_SERIAL = TO_NUMBER(AS_BOND_SERIAL)
 	  ORDER BY SEQ
 	   ;
 BEGIN
	BEGIN
		SELECT THING_SEP_PAPER_TAG
		  INTO LS_SEP_TAG
		  FROM MM_COMM_BOND
		 WHERE CONTRACT_CODE = AS_CONTRACT_CODE AND
		 	   BOND_SERIAL = TO_NUMBER(AS_BOND_SERIAL);
	EXCEPTION WHEN NO_DATA_FOUND THEN
		RETURN '';
	END;
	--
	IF LS_SEP_TAG = 'Y' THEN
	   RETURN '';
	END IF;

	LS_RETURN := '';

 	OPEN CUR_THING;
 	LOOP
 		FETCH CUR_THING INTO LN_ROW_NUM, LS_ADDR, LS_CLASS1, LS_AREA1, LS_CLASS2, LS_AREA2;
 		EXIT WHEN CUR_THING%NOTFOUND;

		IF LN_ROW_NUM = TO_NUMBER(AS_ROW_NUM) THEN
			IF AS_TAG = '1' THEN
	 		   LS_RETURN := LS_ADDR;
			END IF;

			IF AS_TAG = '2' THEN
			   LS_RETURN := LS_CLASS1;
			END IF;

			IF AS_TAG = '3' THEN
			   LS_RETURN := TRIM(TO_CHAR(LS_AREA1, '99,999,999.99'));
			END IF;

			IF AS_TAG = '4' THEN
			   LS_RETURN := LS_CLASS2;
			END IF;

			IF AS_TAG = '5' THEN
			   LS_RETURN := TRIM(TO_CHAR(LS_AREA2, '99,999,999.99'));
			END IF;
		END IF;

		EXIT WHEN LN_ROW_NUM = AS_ROW_NUM;
 	END LOOP;
 	CLOSE CUR_THING;

 	RETURN LS_RETURN;

 EXCEPTION
 	WHEN NO_DATA_FOUND THEN
 		 NULL;

 	WHEN OTHERS THEN
 		 -- Consider logging the error and then re-raise
 		 RAISE;
 END F_Mm_Get_Bondthing;

/





CREATE OR REPLACE FUNCTION "F_MM_GET_DEPTAUTHYN" (

    AS_CONTRACT_CODE VARCHAR2
  , AS_USER_ID VARCHAR2
  )
RETURN VARCHAR2 IS
   vCnt NUMBER;
   vMasterYn VARCHAR2(1);
   vGroupCode VARCHAR2(12);
BEGIN
   -- 
   --RETURN 'Y';

   SELECT PROJ_USER_DIV, GROUP_CODE
     INTO vMasterYn, vGroupCode
	 FROM SM_AUTH_USER
	WHERE USER_ID = AS_USER_ID;

   IF vMasterYn = 'Y' THEN
      RETURN 'Y';
   ELSE
      SELECT COUNT(*)
	    INTO vCnt
	    FROM SM_AUTH_PROJECT A
	   WHERE GROUP_CODE = vGroupCode AND
	   		 PROJ_CODE = ( SELECT PROJ_CODE FROM MM_COMM_CONTRACT WHERE CONTRACT_CODE = AS_CONTRACT_CODE );

      IF vCnt > 0 THEN
	     RETURN 'Y';
	  ELSE
	     RETURN 'N';
	  END IF;
   END IF;

   RETURN 'Y';
END;

/





CREATE OR REPLACE FUNCTION "F_MM_GET_RECEVIDENCENO"(

    AS_WORK_COMP VARCHAR2,
	AS_WORK_DATE VARCHAR2,
	AS_WORK_NO VARCHAR2,
	AS_CUST_CODE VARCHAR2
)
RETURN VARCHAR2 IS
    vReturn   VARCHAR2(60);
BEGIN
    IF AS_WORK_COMP IS NULL OR AS_WORK_DATE IS NULL OR AS_WORK_NO IS NULL OR AS_CUST_CODE IS NULL THEN
	    RETURN NULL;
    END IF;
	
	BEGIN
 	   SELECT SUBSTR(B.YYMM, 1, 4) || '-' ||TRIM(TO_CHAR(B.SEQ, '0000'))
	      INTO vReturn
		  FROM AM_SLIP_DETAIL A,
		  	   		AM_TAXA_EVID B
	    WHERE A.WORK_COMP = B.COMPANY_CODE AND
			  		A.EVIDENCE_NO = B.EVIDENCE_NO AND
					A.WORK_COMP = AS_WORK_COMP AND
			  		A.WORK_DATE = AS_WORK_DATE AND
					A.WORK_NO = AS_WORK_NO AND
					A.CUST_CODE = AS_CUST_CODE AND
					A.EVIDENCE_NO IS NOT NULL;
	EXCEPTION WHEN NO_DATA_FOUND THEN
	    vReturn := NULL;
	END;

    RETURN vReturn;

EXCEPTION
	  WHEN OTHERS THEN
	    -- Consider logging the error and then re-raise
	    RETURN '';
END;

/





CREATE OR REPLACE FUNCTION "F_MM_NUMFORMAT"(

     AN_NUM VARCHAR
 )
 RETURN VARCHAR2 IS
     vNum	  NUMBER;
     vReturn   VARCHAR2(60);
 BEGIN
  	vNum := TO_NUMBER(AN_NUM);

     vReturn := TRIM(TO_CHAR(vNum, '999,999,999,999,999,999,999,999,999,990'));

     RETURN vReturn;


 EXCEPTION
 	  WHEN OTHERS THEN
 	    -- Consider logging the error and then re-raise
 	    RETURN AN_NUM;
 END;

/





CREATE  OR REPLACE  FUNCTION F_MM_P_EXPR_CALC

(
vexpr   VARCHAR2
)
RETURN NUMBER AS
/*///////////////////////////////////////////////////////////////////
//
//    *** Error Code ***
//
//    - Error 1 :   .
//    - Error 2 :      .
//    - Error 3 :    .
//    - Error 4 : 0  .
//
///////////////////////////////////////////////////////////////////*/
TYPE expr_order_table IS TABLE OF MM_PROJ_PROJECT_CAL.REMARK%TYPE
INDEX BY BINARY_INTEGER;
expr_order  expr_order_table ;
k BINARY_INTEGER;

TYPE expr_parse_table IS TABLE OF MM_PROJ_PROJECT_CAL.REMARK%TYPE
INDEX BY BINARY_INTEGER;
expr_parse  expr_parse_table ;
l BINARY_INTEGER;

i              NUMBER := 1 ;
j              NUMBER;
expr_len       NUMBER;
order_level    NUMBER;
order_max      NUMBER;
calc_order     NUMBER;
array_max      NUMBER := 1;
is_operator    NUMBER := 0;
expr_result    NUMBER;
expr_char      VARCHAR2(100);
ref_msg        VARCHAR2(20);
--
BEGIN

expr_len := LENGTHB(vexpr);

expr_parse(1) := '';
expr_order(1) := 0;
order_level   := 0;

FOR i IN 1..expr_len LOOP
   expr_char := SUBSTR(vexpr, i, 1);
   IF expr_char <> ' ' THEN

      IF expr_char = '(' THEN
         order_level := order_level + 4;
      ELSIF expr_char = ')' THEN
         order_level := order_level - 4;
      ELSIF expr_char = '+' THEN
         IF is_operator <> 0 THEN
            ref_msg := 'error 1';
            RETURN 0;
         END IF;
         array_max := array_max + 1;
         expr_parse(array_max) := expr_char;
         expr_order(array_max) := order_level + 1;
         is_operator := 1;
      ELSIF expr_char = '-' THEN
         IF is_operator = -1 THEN
            ref_msg := 'error 1';
            RETURN 0;
         ELSIF is_operator = 0 THEN
            array_max := array_max +1;
            expr_parse(array_max) := expr_char;
            expr_order(array_max) := order_level + 1;
            is_operator := 1;
         ELSE
            array_max := array_max +1;
            expr_parse(array_max) := '';
            expr_parse(array_max) := expr_parse(array_max) || expr_char;
            is_operator := -1;
         END IF;
      ELSIF expr_char = '*' OR expr_char =  '/' THEN
         IF is_operator <> 0 THEN
            ref_msg := 'error 1';
            RETURN 0;
         END IF;
         array_max := array_max +1;
         expr_parse(array_max) := expr_char;
         expr_order(array_max) := order_level + 2;
         is_operator := 1;
      ELSIF expr_char =  '^' THEN
         IF is_operator <> 0 THEN
            ref_msg := 'error 1';
            RETURN 0;
         END IF;
         array_max := array_max +1;
         expr_parse(array_max) := expr_char;
         expr_order(array_max) := order_level + 3;
         is_operator := 1;
      ELSIF expr_char ='0' OR expr_char = '1' OR expr_char = '2' OR expr_char = '3' OR expr_char = '4' OR expr_char = '5'
            OR expr_char = '6' OR expr_char = '7' OR expr_char = '8' OR expr_char = '9' OR expr_char = '.' THEN
         IF is_operator > 0 THEN
            array_max := array_max +1;
            expr_parse(array_max) := '';
            expr_order(array_max) := 0;
         END IF;
         expr_parse(array_max) := expr_parse(array_max) || expr_char;
         is_operator := 0;
      ELSE
         ref_msg := 'error 2';
         RETURN 0;
      END IF;

   END IF;

END LOOP;


IF is_operator <> 0 THEN
   ref_msg := 'error 1';
   RETURN 0;
END IF;

IF order_level <> 0 THEN
   ref_msg := 'error 3';
   RETURN 0;
END IF;


expr_result := TO_NUMBER(expr_parse(1));


i := 2 ;
LOOP
   EXIT WHEN i > array_max - 1 ;

   order_max := 0;

   j := 2 ;
   LOOP
      EXIT WHEN j > array_max - 1 ;
      IF expr_order(j) > order_max THEN
         order_max := expr_order(j);
         calc_order := j;
      END IF;
      j := j + 2;
   END LOOP;


   IF expr_parse(calc_order) = '*' THEN
      expr_result := TO_NUMBER(expr_parse(calc_order - 1)) * TO_NUMBER(expr_parse(calc_order + 1));
   ELSIF  expr_parse(calc_order) = '/' THEN
      IF TO_NUMBER(expr_parse(calc_order + 1)) = 0 THEN
         ref_msg := 'error 4';
         RETURN 0;
      END IF;
      expr_result := TO_NUMBER(expr_parse(calc_order - 1)) / TO_NUMBER(expr_parse(calc_order + 1));
   ELSIF  expr_parse(calc_order) = '+' THEN
      expr_result := TO_NUMBER(expr_parse(calc_order - 1)) + TO_NUMBER(expr_parse(calc_order + 1));
   ELSIF  expr_parse(calc_order) = '-' THEN
      expr_result := TO_NUMBER(expr_parse(calc_order - 1)) - TO_NUMBER(expr_parse(calc_order + 1));
   END IF;


   IF i < array_max - 1 THEN
      expr_order(calc_order) := 0;

      j := calc_order;
      LOOP
         j := j - 1;
         EXIT WHEN j = 1 ;
         EXIT WHEN expr_order(j - 1) <> 0 ;
      END LOOP;
      expr_parse(j) := TO_CHAR(expr_result) ;

      j := calc_order;
      LOOP
         j := j + 1;
         EXIT WHEN j = array_max ;
         EXIT WHEN expr_order(j + 1) <> 0 ;
      END LOOP;
      expr_parse(j) := TO_CHAR(expr_result) ;

   END IF;


   i := i + 2 ;


END LOOP;


ref_msg := 'success';

RETURN expr_result;

END ;

/





CREATE  OR REPLACE  FUNCTION F_PM_WORKDAY

 (
    as_date varchar2
 )

 RETURN NUMBER IS WORKDAY NUMBER;

 --    1  0 
 --     

 BEGIN
 --   SELECT NVL(SUM(DECODE((DECODE(NVL(SATURDAY_YN, 'N'), 'Y', 1, 0) +
 --                          DECODE(NVL(SUNDAY_YN,   'N'), 'Y', 1, 0) +

 --                          DECODE(NVL(HOLIDAY_YN,  'N'), 'Y', 1, 0) +
 --                          DECODE(NVL(WORK_YN,     'N'), 'Y', 1, 0) +
 --                          DECODE(SUBSTR(TO_CHAR(TO_DATE(WORK_DATE), 'DAY'), 1, 1), '', 1,
 --                                                                                   '', 1,
 --                                                                                         0)), 0, 1, 0)), 0) AS TP1
 --     INTO WORKDAY
 --     FROM SM_CODE_CALENDAR
 --    WHERE WORK_DATE LIKE as_date || '%';

    SELECT SUM(CASE WHEN NVL(SATURDAY_YN, 'N') = 'Y' OR
                         NVL(SUNDAY_YN,   'N') = 'Y' OR
                         NVL(HOLIDAY_YN,  'N') = 'Y' OR
                         NVL(WORK_YN,     'Y') = 'N' OR

                         CASE WHEN SUBSTR(TO_CHAR(TO_DATE(WORK_DATE), 'DAY'), 1, 1) IN ('', '')
                              THEN 'Y'
                              ELSE 'N'
                         END = 'Y'
                    THEN 0
                    ELSE 1
               END
           )
      INTO WORKDAY
      FROM SM_CODE_CALENDAR
     WHERE WORK_DATE LIKE as_date || '%';

     RETURN( WORKDAY );

 END F_PM_WORKDAY;

/





CREATE OR REPLACE FUNCTION        "F_SM_ENTER_CHANGE" ( vSrc varchar2 )

return varchar2 is
   vReturn varchar2(2000);
begin
   vReturn := Replace(vSrc, chr(13) || chr(10), '');
   return vReturn;
end;

/





CREATE OR REPLACE FUNCTION          "F_SM_USBLOCK" (

    sUser VARCHAR2
 ,  SLock VARCHAR2
 )
 Return VARCHAR2 Is
    vState  VARCHAR2(1);
    vUser   VARCHAR2(12);
    vDate   VARCHAR2(8);
    vUse    VARCHAR2(1);
    vRows   NUMBER;
 Begin
    If (sLock = '') Then return 'O'; End If;


    Select min(state_div)
         , min(user_id)
         , min(valid_date)
         , min(use_div)
         , count(state_div)
      Into vState
         , vUser
         , vDate
         , vUse
         , vRows
      From SM_AUTH_USB
     Where usb_no = sLock
    ;


    If (vRows <= 0) Then return 'N'; End If;
    If (vState <> 'O') Then return vState; End If;
    If (SysDate > To_Date(vDate || '235959', 'yyyymmddhh24miss')) Then return 'V'; End If;
    If (vUse = 'A') Then return vState; End If;
    If (vUser <> sUser) Then return 'U'; End If;

    Return vState;
 End;

/





CREATE OR REPLACE FUNCTION          "F_TM_GET_BASEDATE"   ( av_comp varchar2 )

 return varchar2 is
    lv_base_date varchar2(8);
 begin
    --   .
    select am_s_date
      into lv_base_date
      from sm_code_company
     where company_code = av_comp
    ;
    return lv_base_date;
 end;

/





CREATE OR REPLACE FUNCTION          "F_TM_GET_BASEMONTH"   ( av_comp varchar2

 , av_date varchar2
 )
 return varchar2 is
    lv_date   varchar2(8);
    lv_base_m varchar2(2);
    lv_base_y varchar2(4);
 begin
    --  .
    select am_start_month
      into lv_base_m
      from sm_code_company
     where company_code = av_comp

    ;
    lv_date := substr(av_date || '0101', 1, 8);
    lv_base_y := substr(lv_date, 1, 4);
    if (lv_date < lv_base_y || lv_base_m || '01') then
       lv_base_y := to_char(lv_base_y - 1);
    end if;
    return lv_base_y || lv_base_m;
 end;

/





CREATE OR REPLACE FUNCTION          "F_TM_GET_BASEMONTHTO"   ( av_comp varchar2

 , av_date varchar2
 )
 return varchar2 is
    lv_date   varchar2(8);
    lv_base_m varchar2(2);
    lv_base_y varchar2(4);
 begin
    --  .
    select am_start_month
      into lv_base_m
      from sm_code_company
     where company_code = av_comp

    ;
    lv_date := substr(av_date || '0101', 1, 8);
    lv_base_y := substr(lv_date, 1, 4);
    if (lv_date < lv_base_y || lv_base_m || '01') then
       lv_base_y := to_char(lv_base_y - 1);
    end if;
    return To_Char(Add_Months(To_Date(lv_base_y || lv_base_m || '01'), 11), 'yyyymmdd');
 end;

/





CREATE OR REPLACE FUNCTION          "F_TM_GET_BASEYEAR"    ( av_comp varchar2

 , av_date varchar2
 )
 return varchar2 is
    lv_date   varchar2(8);
    lv_base_m varchar2(2);
    lv_base_y varchar2(4);
 begin
    --  .
    select am_start_month
      into lv_base_m
      from sm_code_company
     where company_code = av_comp

    ;
    lv_date := substr(av_date || '0101', 1, 8);
    lv_base_y := substr(lv_date, 1, 4);
    if (lv_date < lv_base_y || lv_base_m || '01') then
       lv_base_y := to_char(lv_base_y - 1);
    end if;
    return lv_base_y;
 end;

/





CREATE OR REPLACE FUNCTION          "F_TM_GET_SLIPITEM_NO" (

   AS_COMP VARCHAR2
 , AS_DATE VARCHAR2
 , AN_NO   NUMBER
 , AN_SEQ  NUMBER
 )
 Return VARCHAR2 Is
    vReturn VARCHAR2(40);
    vNumber VARCHAR2(10);
 Begin
    If AS_DATE Is NULL Then Return ''; End If;
    vNumber := LTRIM(RTRIM(To_Char(AN_NO, '0000'))) || '-' || LTRIM(RTRIM(To_Char(AN_SEQ, '000')));
    vReturn := AS_DATE || '-' || vNumber;

    Return vReturn;
 End;

/





CREATE OR REPLACE FUNCTION           "F_TM_GET_ESTABLISH_SLIPNO" ( av_comp varchar2

 , ad_date varchar2
 , an_no number
 , an_seq number
 )
 --  =  +  + 
 return varchar2 is
    cursor c_cur1_sql is
       select b.slip_date
            , b.slip_no
            , b.work_seq_scr
         from tm_slip_dc a
            , tm_slip_detail b

        where a.work_comp = b.work_comp
          and a.set_work_date = b.work_date
          and a.set_work_no = b.work_no
          and a.set_work_seq = b.work_seq
          and a.slip_yyyy = substr(ad_date,1,4)
          and a.work_comp = av_comp
          and a.work_date = ad_date
          and a.work_no = an_no
          and a.work_seq = an_seq
    ;
    c_cur1_val c_cur1_sql%ROWTYPE;
    lv_return varchar2(2000);
 begin

    lv_return := '';

    OPEN c_cur1_sql;
    loop
       fetch c_cur1_sql into c_cur1_val;
       exit when c_cur1_sql%notfound;

       if( c_cur1_val.slip_date <> '' or c_cur1_val.slip_date is not null ) then
          if ( lv_return = '' or lv_return is null) then
                lv_return := f_tm_get_slipitem_no(av_comp, c_cur1_val.slip_date, c_cur1_val.slip_no, c_cur1_val.work_seq_scr);
          else
             lv_return := lv_return || ',' ||  f_tm_get_slipitem_no(av_comp, c_cur1_val.slip_date, c_cur1_val.slip_no, c_cur1_val.work_seq_scr);
          end if;

       end if;
    end loop;
    close c_cur1_sql;

    return lv_return;
 end;

/





CREATE OR REPLACE FUNCTION "F_TM_GET_SLIPMNG" ( av_comp varchar2

 , ad_date varchar2
 , an_no number
 , an_seq number
 )
 return varchar2 is
    cursor c_cur1_sql is
       select decode( workd.dr_amt ,0 ,'2', '1') as SLIP_DRCR                              --
            , acnt.BOND_YN                                                                 --
            , acnt.MONTH_COST_YN                                                           --
            , acnt.ADJUSTED_DRCR                                                           --
            , nvl(workd.BANK_CODE,'') as BANK_CODE                                         --
            , nvl(bank.BANK_NAME, workd.BANK_CODE ) as BANK_NAME                           --

            , nvl(workd.DEPOSIT_NO, '') as DEPOSIT_NO                                      --
            , nvl(workd.CHECK_NO, '') as CHECK_NO                                          --
            , nvl(workd.BILL_NO, '') as BILL_NO                                            --
            , nvl(workd.BILL_R_NO, '') as BILL_R_NO                                        --
            , nvl(workd.LOAN_NO, '') as LOAN_NO                                            --
            , nvl(workd.STCK_CODE, '') as STCK_CODE                                        --
            , '' as FA_NO                                                                  --
            , '' as FA_NAME                                                                --
            , nvl(workd.CD_CARD_NO,'') as CD_CARD_NO                                       --
            , nvl(workd.USER_ID,'') as  USER_ID                                            --
            , nvl(pers.USER_NAME, workd.USER_ID) as EMP_NAME                               --
            , nvl(workd.INCOME_CODE, '') as INCOME_CODE                                    --
            , nvl(incm.INCOME_NAME, workd.INCOME_CODE ) as   INCOME_NAME                   --

            , nvl(workd.PHONE, '') as PHONE                                                --
            , nvl(workd.SALES_DIV, '') as SALES_DIV                                        --
            , nvl(val44.VALID_VALUE_NAME, workd.SALES_DIV ) as  SALES_NAME                 --
            , nvl(workd.EVIDENCE_CODE, '') as EVIDENCE_CODE                                --
            , nvl(evid.EVIDENCE_NAME, workd.EVIDENCE_CODE ) as EVIDENCE_NAME               -- 
            , decode( workd.DR_VAT ,0 ,workd.CR_VAT, workd.DR_VAT) as VAT_AMT              --
            , decode( workd.DR_SUPPLY ,0 ,workd.CR_SUPPLY,workd.DR_SUPPLY) as SUPPLY_AMT   --
            , acnt.QTY1_NAME
            , decode(decode(acnt.QTY1_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.QTY1,0), 0) as QTY1
            , acnt.QTY2_NAME
            , decode(decode(acnt.QTY2_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.QTY2,0), 0) as QTY2
            , acnt.QTY3_NAME
            , decode(decode(acnt.QTY3_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.QTY3,0), 0) as QTY3

            , acnt.AMT1_NAME
            , decode(decode(acnt.AMT1_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT1,0), 0) as AMT1
            , acnt.AMT2_NAME
            , decode(decode(acnt.AMT2_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT2,0), 0) as AMT2
            , acnt.AMT3_NAME
            , decode(decode(acnt.AMT3_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT3,0), 0) as AMT3
            , acnt.AMT4_NAME
            , decode(decode(acnt.AMT4_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT4,0), 0) as AMT4
            , acnt.AMT5_NAME
            , decode(decode(acnt.AMT5_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT5,0), 0) as AMT5
            , acnt.AMT6_NAME
            , decode(decode(acnt.AMT6_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT6,0), 0) as AMT6
            , acnt.RATE1_NAME

            , decode(decode(acnt.RATE1_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.RATE1,0), 0) as RATE1
            , acnt.RATE2_NAME
            , decode(decode(acnt.RATE2_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.RATE2,0), 0) as RATE2
            , acnt.RATE3_NAME
            , decode(decode(acnt.RATE3_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.RATE3,0), 0) as RATE3
            , acnt.DATE1_NAME
            , decode(decode(acnt.DATE1_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DATE1,''), '') AS DATE1
            , acnt.DATE2_NAME
            , decode(decode(acnt.DATE2_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DATE2,''), '') AS DATE2
            , acnt.DATE3_NAME
            , decode(decode(acnt.DATE3_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DATE3,''), '') AS DATE3
            , acnt.DATE4_NAME
            , decode(decode(acnt.DATE4_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DATE4,''), '') AS DATE4

            , acnt.DESC1_NAME
            , decode(decode(acnt.DESC1_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DESC1,''), '') as DESC1
            , acnt.DESC2_NAME
            , decode(decode(acnt.DESC2_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DESC2,''), '') as DESC2
            , acnt.DESC3_NAME
            , decode(decode(acnt.DESC3_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DESC3,''), '') as DESC3
            , acnt.DESC4_NAME
            , decode(decode(acnt.DESC4_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DESC4,''), '') as DESC4
            , acnt.DESC5_NAME
            , decode(decode(acnt.DESC5_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DESC5,''), '') as DESC5
         from tm_slip_detail workd
            , tm_code_acnt acnt
            , TM_CODE_BANK bank

            , SM_AUTH_USER pers
            , TM_CODE_INCOME incm
            , TM_CODE_VALIDATION val44
            , tm_code_evidence evid
        where workd.acnt_code = acnt.acnt_code
          and workd.BANK_CODE = bank.BANK_CODE (+)
          and workd.USER_ID = pers.USER_ID (+)
          and workd.INCOME_CODE = incm.INCOME_CODE (+)
          and val44.VALIDATION_CODE (+)= '44'
          and workd.SALES_DIV = val44.VALID_VALUE_CODE (+)
          and workd.EVIDENCE_CODE = evid.EVIDENCE_CODE (+)
          and workd.WORK_COMP = av_comp
          and workd.WORK_DATE = ad_date

          and workd.WORK_NO = an_no
          and workd.WORK_SEQ = an_seq
    ;
    c_cur1_val c_cur1_sql%ROWTYPE ;
    --ls_give_name varchar2(30);
    --ls_give_depositor varchar2(100);
    vComYN varchar2(1);
    vComCnt number(2);
    vComName varchar2(60);
    ls_work_return_data varchar2(2000);
 begin
    open c_cur1_sql;
    loop

       fetch c_cur1_sql into c_cur1_val;
       exit when c_cur1_sql%notfound;

       --  
       if ( c_cur1_val.BOND_YN = 'Y' ) THEN
          --  /  
          if ( c_cur1_val.SLIP_DRCR <> c_cur1_val.ADJUSTED_DRCR ) then
             ls_work_return_data := F_TM_GET_ESTABLISH_SLIPNO(av_comp, ad_date, an_no, an_seq  );
             if (ls_work_return_data is not null) then
                ls_work_return_data := ':' || ls_work_return_data ;
             end if;
 /*         else
                begin

                select
                   valam.valid_value_name
                   , F_TM_GET_SLIP_BANKDESC(supp.work_comp, supp.work_date, supp.work_no, supp.work_seq, supp.supply_seq) as give_deposit
                into
                   ls_give_name
                   , ls_give_depositor
                from
                   tm_slip_supply supp
                   , tm_code_validation valam
                   , (
                      select
                         work_date
                         , work_no

                         , work_seq
                         , min(supply_seq) as supply_seq
                      from
                         tm_slip_supply
                      where
                            work_comp = av_comp
                         and work_date = ad_date
                         and work_no = an_no
                         and work_seq = an_seq
                      group by
                         work_date
                         , work_no
                         , work_seq

                      ) mins
                where
                   supp.work_date = mins.work_date
                   and supp.work_no = mins.work_no
                   and supp.work_seq = mins.work_seq
                   and supp.supply_seq = mins.supply_seq
                   and supp.acnt_code = valam.valid_value_level
                   and valam.validation_code = '39'
                ;
             --
             exception
                when no_data_found then ls_give_name := null ;
             end;

             --
             if (ls_give_name is not null) then
                ls_work_return_data := ':'||'['||ls_give_name||']' ;
                --
                if ls_give_depositor is not null then
                   ls_work_return_data := ls_work_return_data ||'=> '||ls_give_depositor ;
                end if ;
             end if ;
 */         end if;
       end if;

       --
       if (c_cur1_val.BANK_CODE is not null) then

          ls_work_return_data := ls_work_return_data ||':'|| c_cur1_val.BANK_NAME ;
       end if;

       --
       if (c_cur1_val.DEPOSIT_NO is not null) then
          ls_work_return_data := ls_work_return_data ||':'|| c_cur1_val.DEPOSIT_NO;
          select d.com_yn, sum(decode(c.com_seq, null, 0, 1))-1 com_cnt, max(nvl(c.com_name,'')) com_name
            into vComYN, vComCnt, vComName
            from tm_code_deposit d
               , tm_code_deposit_etccom c
           where d.deposit_no = c_cur1_val.DEPOSIT_NO
             and c.deposit_no (+)= d.deposit_no
           group by d.com_yn

          ;
          if (vComYN = 'Y') then
             ls_work_return_data := ls_work_return_data ||':'|| vComName;
             if (vComCnt > 0) then ls_work_return_data := ls_work_return_data ||'  '||to_char(vComCnt); end if;
          end if;
       end if;

       --
       if (c_cur1_val.CHECK_NO is not null ) then
          ls_work_return_data := ls_work_return_data ||':'|| c_cur1_val.CHECK_NO;
       end if ;

       --

       if (c_cur1_val.BILL_NO is not null ) then
          ls_work_return_data := ls_work_return_data ||':'|| c_cur1_val.BILL_NO;
       end if ;
       --
       --
       if (c_cur1_val.BILL_R_NO is not null ) then
          ls_work_return_data := ls_work_return_data ||':'|| c_cur1_val.BILL_R_NO;
       end if ;

       --
       if (c_cur1_val.LOAN_NO is not null) then
          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.LOAN_NO;
       end if ;

       --
       --
       if (c_cur1_val.STCK_CODE is not null ) then
          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.STCK_CODE;
       end if ;

       --
       if (c_cur1_val.FA_NO is not null) then
          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.FA_NAME;
       end if ;

       --
       if (c_cur1_val.CD_CARD_NO is not null) then

          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.CD_CARD_NO;
       end if ;

       --
       if (c_cur1_val.USER_ID is not null) then
          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.EMP_NAME;
       end if ;

       --
       if (c_cur1_val.INCOME_CODE is not null) then
          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.INCOME_NAME;
       end if ;


       --
       if (c_cur1_val.PHONE is not null) then
          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.PHONE;
       end if ;

       --
       --if (c_cur1_val.SALES_DIV is not null) then
       --   ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.SALES_NAME;
       --end if;

       --
       if (c_cur1_val.EVIDENCE_CODE is not null) then
          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.EVIDENCE_NAME||'('||c_cur1_val.EVIDENCE_CODE||')';

          ls_work_return_data := ls_work_return_data ||':'||ltrim(rtrim(to_char(c_cur1_val.SUPPLY_AMT,'999,999,999,999')));
          ls_work_return_data := ls_work_return_data ||':'||ltrim(rtrim(to_char(c_cur1_val.VAT_AMT,'999,999,999,999')));
       end if;

       --, , ( )

       --1
       if ( c_cur1_val.QTY1 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.QTY1_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.QTY1,'999,999,999.999')));
       end if ;

       --2
       if ( c_cur1_val.QTY2 <> 0 ) then

             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.QTY2_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.QTY2,'999,999,999.999')));
       end if ;

       --3
       if ( c_cur1_val.QTY3 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.QTY3_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.QTY3,'999,999,999.999')));
       end if ;

       --1
       if ( c_cur1_val.AMT1 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT1_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT1,'999,999,999,999,999')));
       end if ;


       --2
       if ( c_cur1_val.AMT2 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT2_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT2,'999,999,999,999,999')));
       end if ;

       --3
       if ( c_cur1_val.AMT3 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT3_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT3,'999,999,999,999,999')));
       end if ;

       --4
       if ( c_cur1_val.AMT4 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT4_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT4,'999,999,999,999,999')));

       end if ;

       --5
       if ( c_cur1_val.AMT5 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT5_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT5,'999,999,999,999,999')));
       end if ;

       --6
       if ( c_cur1_val.AMT6 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT6_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT6,'999,999,999,999,999')));
       end if ;

       --1

       if ( c_cur1_val.RATE1 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.RATE1_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.RATE1,'999,999.99')));
       end if ;

       --2
       if ( c_cur1_val.RATE2 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.RATE2_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.RATE2,'999,999.99')));
       end if ;

       --3
       if ( c_cur1_val.RATE3 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.RATE3_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.RATE3,'999,999.99')));
       end if ;


       --1
       if (c_cur1_val.DATE1 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DATE1_NAME||':'||ltrim(rtrim(to_char(to_date(c_cur1_val.DATE1),'yyyy-mm-dd')));
       end if ;

       --2
       if (c_cur1_val.DATE2 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DATE2_NAME||':'||ltrim(rtrim(to_char(to_date(c_cur1_val.DATE2),'yyyy-mm-dd')));
       end if ;

       --3
       if (c_cur1_val.DATE3 is not null) then

             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DATE3_NAME||':'||ltrim(rtrim(to_char(to_date(c_cur1_val.DATE3),'yyyy-mm-dd')));
       end if ;

       --4
       if (c_cur1_val.DATE4 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DATE4_NAME||':'||ltrim(rtrim(to_char(to_date(c_cur1_val.DATE4),'yyyy-mm-dd')));
       end if ;

       --1
       if (c_cur1_val.DESC1 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DESC1_NAME||':'||c_cur1_val.DESC1;
       end if ;


       --2
       if (c_cur1_val.DESC2 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DESC2_NAME||':'||c_cur1_val.DESC2;
       end if ;

       --3
       if (c_cur1_val.DESC3 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DESC3_NAME||':'||c_cur1_val.DESC3;
       end if ;

       --4
       if (c_cur1_val.DESC4 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DESC4_NAME||':'||c_cur1_val.DESC4;

       end if ;

       --5
       if (c_cur1_val.DESC5 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DESC5_NAME||':'||c_cur1_val.DESC5;
       end if ;

    end loop;
    close c_cur1_sql;

    return ls_work_return_data ;
 end;

/





CREATE OR REPLACE FUNCTION          "F_TM_GET_SLIP_NO" (

   AS_COMP VARCHAR2
 , AS_DATE VARCHAR2
 , AN_NO   NUMBER
 )
 Return VARCHAR2 Is
    vReturn VARCHAR2(40);
    vNumber VARCHAR2(10);
 Begin
    If (AS_DATE Is NULL Or AS_DATE = '') Then Return ''; End If;
    vNumber := LTRIM(RTRIM(To_Char(AN_NO, '0000')));
    vReturn := AS_DATE || '-' || vNumber;
    Return vReturn;

 End;

/





CREATE OR REPLACE FUNCTION          "F_TM_GET_WORKITEM_NO" (

   AS_COMP VARCHAR2
 , AS_DATE VARCHAR2
 , AS_DEPT VARCHAR2
 , AN_NO   NUMBER
 , AN_SEQ  NUMBER
 )
 Return VARCHAR2 Is
    vReturn VARCHAR2(40);
    vNumber VARCHAR2(10);
 Begin
    If (AS_DATE Is NULL Or AS_DATE = '') Then Return ''; End If;
    vNumber := LTRIM(RTRIM(To_Char(AN_NO, '0000'))) || '-' || LTRIM(RTRIM(To_Char(AN_SEQ, '000')));

    vReturn := AS_DATE || '-' || LTRIM(RTRIM(AS_DEPT)) || '-' || vNumber;
    Return vReturn;
 End;

/





CREATE OR REPLACE FUNCTION          "F_TM_GET_WORK_NO" (

   AS_COMP VARCHAR2
 , AS_DATE VARCHAR2
 , AS_DEPT VARCHAR2
 , AN_NO   NUMBER
 )
 Return VARCHAR2 Is
    vReturn VARCHAR2(40);
    vNumber VARCHAR2(10);
 Begin
    If (AS_DATE Is NULL Or AS_DATE = '') Then Return ''; End If;
    vNumber := LTRIM(RTRIM(To_Char(AN_NO, '0000')));
    vReturn := AS_DATE || '-' || LTRIM(RTRIM(AS_DEPT)) || '-' || vNumber;

    Return vReturn;
 End;

/





CREATE OR REPLACE FUNCTION             "F_TM_SET_VATAMT" ( ag_amt number

 , ag_len number
 )
 return varchar2 is
    ag_amt_st varchar2(20);
    ag_alpha varchar2(20);
 begin
    if abs(ag_amt  / trunc(ag_amt)) > 1 then
       select lpad(trunc(abs(ag_amt),0),ag_len - 2,'0') ||to_char((abs(ag_amt) - trunc(abs(ag_amt),0))  * 100)
         into ag_amt_st
         from dual
       ;


       if substr(ag_amt_st,ag_len -2 ,1) = '0' then
          ag_alpha := '}';
       elsif substr(ag_amt_st,ag_len -2,1) = '1' then
          ag_alpha := 'J';
       elsif substr(ag_amt_st,ag_len -2,1) = '2' then
          ag_alpha := 'K';
       elsif substr(ag_amt_st,ag_len -2,1) = '3' then
          ag_alpha := 'L';
       elsif substr(ag_amt_st,ag_len -2,1) = '4' then
          ag_alpha := 'M';
       elsif substr(ag_amt_st,ag_len -2,1) = '5' then
          ag_alpha := 'N';
       elsif substr(ag_amt_st,ag_len -2,1) = '6' then

          ag_alpha := 'O';
       elsif substr(ag_amt_st,ag_len -2,1) = '7' then
          ag_alpha := 'P' ;
       elsif substr(ag_amt_st,ag_len -2,1) = '8' then
          ag_alpha := 'Q';
       elsif substr(ag_amt_st,ag_len -2,1) = '9' then
          ag_alpha := 'R';
       end if;

       select substr(ag_amt_st,1,ag_len -3) ||ag_alpha||substr(ag_amt_st,ag_len -1,2)
         into ag_amt_st
         from dual
       ;

    else
       select lpad(trim(to_char(abs(ag_amt ))),ag_len,'0')
         into ag_amt_st
         from dual
       ;

       if substr(ag_amt_st,ag_len  ,1) = '0' then
          ag_alpha :='}' ;
       elsif substr(ag_amt_st,ag_len ,1) = '1' then
          ag_alpha :='J';
       elsif substr(ag_amt_st,ag_len ,1) = '2' then
          ag_alpha :='K';
       elsif substr(ag_amt_st,ag_len ,1) = '3' then

          ag_alpha :='L';
       elsif substr(ag_amt_st,ag_len ,1) = '4' then
          ag_alpha :='M';
       elsif substr(ag_amt_st,ag_len ,1) = '5' then
          ag_alpha :='N';
       elsif substr(ag_amt_st,ag_len ,1) = '6' then
          ag_alpha :='O';
       elsif substr(ag_amt_st,ag_len ,1) = '7' then
          ag_alpha :='P' ;
       elsif substr(ag_amt_st,ag_len ,1) = '8' then
          ag_alpha :='Q';
       elsif substr(ag_amt_st,ag_len ,1) = '9' then
          ag_alpha :='R';

       end if ;

       select substr(ag_amt_st,1,ag_len -1) ||ag_alpha
         into ag_amt_st
         from dual
       ;
    end if;
    return ag_amt_st;
 end;

/





CREATE OR REPLACE FUNCTION          "F_AM_GET_BASEDATE"  ( av_comp varchar2 )

 return varchar2 is
    lv_base_date varchar2(8);
 begin
    --   .
    select am_s_date
      into lv_base_date
      from sm_code_company
     where company_code = av_comp
    ;
    return lv_base_date;
 end;

/





CREATE OR REPLACE FUNCTION          "F_AM_GET_BASEMONTH"  ( av_comp varchar2

 , av_date varchar2
 )
 return varchar2 is
    lv_date   varchar2(8);
    lv_base_m varchar2(2);
    lv_base_y varchar2(4);
 begin
    --  .
    select am_start_month
      into lv_base_m
      from sm_code_company
     where company_code = av_comp

    ;
    lv_date := substr(av_date || '0101', 1, 8);
    lv_base_y := substr(lv_date, 1, 4);
    if (lv_date < lv_base_y || lv_base_m || '01') then
       lv_base_y := to_char(lv_base_y - 1);
    end if;
    return lv_base_y || lv_base_m;
 end;

/





CREATE OR REPLACE FUNCTION          "F_AM_GET_BASEMONTHTO"  ( av_comp varchar2

 , av_date varchar2
 )
 return varchar2 is
    lv_date   varchar2(8);
    lv_base_m varchar2(2);
    lv_base_y varchar2(4);
 begin
    --  .
    select am_start_month
      into lv_base_m
      from sm_code_company
     where company_code = av_comp

    ;
    lv_date := substr(av_date || '0101', 1, 8);
    lv_base_y := substr(lv_date, 1, 4);
    if (lv_date < lv_base_y || lv_base_m || '01') then
       lv_base_y := to_char(lv_base_y - 1);
    end if;
    return To_Char(Add_Months(To_Date(lv_base_y || lv_base_m || '01'), 11), 'yyyymmdd');
 end;

/





CREATE OR REPLACE FUNCTION          "F_AM_GET_BASEYEAR"   ( av_comp varchar2

 , av_date varchar2
 )
 return varchar2 is
    lv_date   varchar2(8);
    lv_base_m varchar2(2);
    lv_base_y varchar2(4);
 begin
    --  .
    select am_start_month
      into lv_base_m
      from sm_code_company
     where company_code = av_comp

    ;
    lv_date := substr(av_date || '0101', 1, 8);
    lv_base_y := substr(lv_date, 1, 4);
    if (lv_date < lv_base_y || lv_base_m || '01') then
       lv_base_y := to_char(lv_base_y - 1);
    end if;
    return lv_base_y;
 end;

/





CREATE OR REPLACE FUNCTION "F_AM_GET_COMMI_FIRSTDELAYDATE"

 	   ( av_date VARCHAR2,          --
 	     av_contract_code VARCHAR2, --
 		 av_comp_code VARCHAR2,     --
 		 av_dept_code VARCHAR2,     --
 		 an_change_order NUMBER,    --
 		 av_acnt_code VARCHAR2 )    --
 RETURN VARCHAR2 IS
    ln_remain_amt NUMBER;
    lv_date VARCHAR2(9);
 BEGIN
    --      .


    SELECT SUM(b.dr_amt) - SUM(b.cr_amt)
      INTO ln_remain_amt
      FROM am_slip_detail a,
 	 	  ( SELECT a.work_comp,
 		  		   a.set_work_date,
 				   a.set_work_no,
 				   a.set_work_seq,
 				   a.dr_amt,
 				   a.cr_amt
 			  FROM am_slip_dc a,
 			  	   am_slip_detail b
 			 WHERE a.work_comp = b.work_comp AND
 			 	   a.work_date = b.work_date AND

 				   a.work_no = b.work_no AND
 				   a.work_seq = b.work_seq AND
 				   b.slip_date <= av_date AND
 				   a.slip_yyyy = SUBSTR(av_date, 1, 4)) b
 	WHERE a.work_comp = b.work_comp AND
 		  a.work_date = b.set_work_date AND
 		  a.work_no = b.set_work_no AND
 		  a.work_seq = b.set_work_seq AND
 		  a.work_comp = av_comp_code AND
 		  a.proj_code = av_dept_code AND
 		  a.desc1 = av_acnt_code AND
 		  a.slip_date <= av_date AND
 		  a.acnt_code IN (SELECT acnt_code

 		  			  	    FROM am_code_calc_acnt
 						   WHERE calc_kind_code = '000' AND
 						   		 calc_list_code = '10110102');

    IF NVL(ln_remain_amt, 0) > 0 THEN --     
    	  SELECT MAX(agree_date)
 	    INTO lv_date
  	    FROM ( SELECT a.agree_date,
 			   		  a.agree_amt,
 					  SUM(b.agree_amt) cum_agree_amount
 			     FROM MM_COMM_AGREEMENT a,
 	 			 	  MM_COMM_AGREEMENT b
 			    WHERE a.contract_code = av_contract_code AND

 	  				  a.change_order = an_change_order AND
 	  				  a.contract_code = b.contract_code AND
 					  a.change_order = b.change_order AND
 	  				  a.agree_date <= b.agree_date AND
 					  a.agree_date <= av_date
 			 GROUP BY a.agree_date, a.agree_amt)
 	   WHERE cum_agree_amount >= ln_remain_amt;
    ELSE --     
    	  SELECT MIN(agree_date)
 	    INTO lv_date
 	    FROM ( SELECT a.agree_order,
 			   		  a.agree_date,
 					  a.agree_amt - NVL(SUM(CASE WHEN b.slip_date <= av_date THEN receipt_amt ELSE 0 END), 0)

 			     FROM MM_COMM_AGREEMENT a,
 	 			 	  MM_COMM_RECEIPT b
 				WHERE a.contract_code = b.contract_code(+) AND
 	  				  a.change_order = b.change_order(+) AND
 	  				  a.agree_order = b.agree_order(+) AND
 	  				  a.contract_code = av_contract_code AND
 	  				  a.change_order = an_change_order AND
 					  a.agree_date <= av_date
 			 GROUP BY a.agree_order,
 			 	   	  a.agree_date,
 					  a.agree_amt
 			   HAVING a.agree_amt - NVL(SUM(CASE WHEN b.slip_date <= av_date THEN receipt_amt ELSE 0 END), 0) > 0 );
    END IF;


    RETURN TO_CHAR(lv_date);
 END;

/





CREATE OR REPLACE FUNCTION "F_AM_GET_DECISION_STATUS" (

   AS_Check VARCHAR2
 , AS_Appr  VARCHAR2
 , AS_Decision   VARCHAR2
 )
 Return VARCHAR2 Is
    
 Begin
 
    if (AS_Check = '0') then return '01'; end if;
	if (AS_Check = '1' ) then 
	  if (AS_appr is null or  AS_appr = '9') then return '02'; end if;
	  if (AS_appr = 'Y' and  (AS_Decision  is null or AS_Decision = '9')) then return '03'; end if;
	  if (AS_appr = 'N' and  (AS_Decision  is null or AS_Decision = '9')) then return '04'; end if;
	  if (AS_appr = 'Z' and  (AS_Decision  is null or AS_Decision = '9')) then return '07'; end if;
	  if (AS_appr = 'Y' and  ( AS_Decision = 'N')) then return '09'; end if;
	elsif (AS_Check = '2' ) then 
      if (AS_appr = 'Y' and  (AS_Decision  is null or AS_Decision = '9')) then return '05'; end if;
	  if (AS_appr = 'Y' and  ( AS_Decision = 'Y')) then return '08'; end if;
	  return '05';  
	end if;
	return '01';  
 End;

/





CREATE OR REPLACE FUNCTION "F_AM_GET_DEPOSIT_ETCCOM"   ( av_deposit_no varchar2, av_seq number, av_com_yn varchar2 )

 return varchar2 is
    lv_com_name  varchar2(60);
 begin
    --
    if av_com_yn = 'N' then
    	  return '';
    end if;

    select com_name
      into lv_com_name
      from ( select com_name,
 	 	  		   rownum as row_num

 	 	  	  from tm_code_deposit_etccom
 			 where deposit_no = av_deposit_no
 		  order by com_name) a
     where row_num = av_seq
    ;

    return lv_com_name;
 end;

/





CREATE OR REPLACE FUNCTION          "F_AM_GET_SLIPITEM_NO" (

   AS_COMP VARCHAR2
 , AS_DATE VARCHAR2
 , AN_NO   NUMBER
 , AN_SEQ  NUMBER
 )
 Return VARCHAR2 Is
    vReturn VARCHAR2(40);
    vNumber VARCHAR2(10);
 Begin
    If (AS_DATE Is NULL Or AS_DATE = '') Then Return ''; End If;
    vNumber := LTRIM(RTRIM(To_Char(AN_NO, '0000'))) || '-' || LTRIM(RTRIM(To_Char(AN_SEQ, '000')));
    vReturn := AS_DATE || '-' || vNumber;

    Return vReturn;
 End;

/





CREATE OR REPLACE FUNCTION           "F_AM_GET_ESTABLISH_SLIPNO" ( av_comp varchar2

 , ad_date varchar2
 , an_no number
 , an_seq number
 )
 --  =  +  + 
 return varchar2 is
    cursor c_cur1_sql is
       select b.slip_date
            , b.slip_no
            , b.work_seq_scr
         from am_slip_dc a
            , am_slip_detail b

        where a.slip_yyyy = substr(ad_date,1,4)
          and a.work_comp = av_comp
          and a.work_date = ad_date
          and a.work_no = an_no
          and a.work_seq = an_seq
          and a.work_comp = b.work_comp
          and b.work_date = a.set_work_date
          and b.work_no = a.set_work_no
          and b.work_seq = a.set_work_seq
    ;
    c_cur1_val c_cur1_sql%ROWTYPE;
    lv_return varchar2(2000);
 begin

    lv_return := '';

    OPEN c_cur1_sql;
    loop
       fetch c_cur1_sql into c_cur1_val;
       exit when c_cur1_sql%notfound;

       if( c_cur1_val.slip_date <> '' or c_cur1_val.slip_date is not null ) then
          if ( lv_return = '' or lv_return is null) then
             lv_return := f_am_get_slipitem_no(av_comp, c_cur1_val.slip_date, c_cur1_val.slip_no, c_cur1_val.work_seq_scr);
          else
             lv_return := lv_return || ',' ||  f_am_get_slipitem_no(av_comp, c_cur1_val.slip_date, c_cur1_val.slip_no, c_cur1_val.work_seq_scr);
          end if;

       end if;
    end loop;
    close c_cur1_sql;

    return lv_return;
 end;

/





CREATE OR REPLACE FUNCTION "F_AM_GET_SLIPMNG" ( av_comp varchar2

 , ad_date varchar2
 , an_no number
 , an_seq number
 )
 return varchar2 is
    cursor c_cur1_sql is
       select decode( workd.dr_amt ,0 ,'2', '1') as SLIP_DRCR                              --
            , acnt.BOND_YN                                                                 --
            , acnt.MONTH_COST_YN                                                           --
            , acnt.ADJUSTED_DRCR                                                           --
            , nvl(workd.BANK_CODE,'') as BANK_CODE                                         --
            , nvl(bank.BANK_NAME, workd.BANK_CODE ) as BANK_NAME                           --

            , nvl(workd.DEPOSIT_NO, '') as DEPOSIT_NO                                      --
            , nvl(workd.CHECK_NO, '') as CHECK_NO                                          --
            , nvl(workd.BILL_NO, '') as BILL_NO                                            --
            , nvl(workd.BILL_R_NO, '') as BILL_R_NO                                        --
            , nvl(workd.LOAN_NO, '') as LOAN_NO                                            --
            , nvl(workd.STCK_CODE, '') as STCK_CODE                                        --
            , nvl(workd.FA_NO,'') as FA_NO                                                 --
            , nvl(asst.FA_NAME, workd.FA_NO) as FA_NAME                                    --
            , nvl(workd.CD_CARD_NO,'') as CD_CARD_NO                                       --
            , decode(decode(acnt.emp_no_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.USER_ID,''), '') as  USER_ID                                            --
            , decode(decode(acnt.emp_no_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(pers.USER_NAME, workd.USER_ID), '') as EMP_NAME                                --
            , nvl(workd.INCOME_CODE, '') as INCOME_CODE                                    --
            , nvl(incm.INCOME_NAME, workd.INCOME_CODE ) as   INCOME_NAME                   --

            , nvl(workd.PHONE, '') as PHONE                                                --
            , nvl(workd.SALES_DIV, '') as SALES_DIV                                        --
            , nvl(val44.VALID_VALUE_NAME, workd.SALES_DIV ) as  SALES_NAME                 --
            , nvl(workd.EVIDENCE_CODE, '') as EVIDENCE_CODE                                --
            , nvl(evid.EVIDENCE_NAME, workd.EVIDENCE_CODE ) as EVIDENCE_NAME               --
            , decode( workd.DR_VAT ,0 ,workd.CR_VAT, workd.DR_VAT) as VAT_AMT              --
            , decode( workd.DR_SUPPLY ,0 ,workd.CR_SUPPLY,workd.DR_SUPPLY) as SUPPLY_AMT   --
            , acnt.QTY1_NAME
            , decode(decode(acnt.QTY1_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.QTY1,0), 0) as QTY1
            , acnt.QTY2_NAME
            , decode(decode(acnt.QTY2_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.QTY2,0), 0) as QTY2
            , acnt.QTY3_NAME
            , decode(decode(acnt.QTY3_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.QTY3,0), 0) as QTY3

            , acnt.AMT1_NAME
            , decode(decode(acnt.AMT1_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT1,0), 0) as AMT1
            , acnt.AMT2_NAME
            , decode(decode(acnt.AMT2_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT2,0), 0) as AMT2
            , acnt.AMT3_NAME
            , decode(decode(acnt.AMT3_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT3,0), 0) as AMT3
            , acnt.AMT4_NAME
            , decode(decode(acnt.AMT4_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT4,0), 0) as AMT4
            , acnt.AMT5_NAME
            , decode(decode(acnt.AMT5_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT5,0), 0) as AMT5
            , acnt.AMT6_NAME
            , decode(decode(acnt.AMT6_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.AMT6,0), 0) as AMT6
            , acnt.RATE1_NAME

            , decode(decode(acnt.RATE1_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.RATE1,0), 0) as RATE1
            , acnt.RATE2_NAME
            , decode(decode(acnt.RATE2_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.RATE2,0), 0) as RATE2
            , acnt.RATE3_NAME
            , decode(decode(acnt.RATE3_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.RATE3,0), 0) as RATE3
            , acnt.DATE1_NAME
            , decode(decode(acnt.DATE1_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DATE1,''), '') AS DATE1
            , acnt.DATE2_NAME
            , decode(decode(acnt.DATE2_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DATE2,''), '') AS DATE2
            , acnt.DATE3_NAME
            , decode(decode(acnt.DATE3_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DATE3,''), '') AS DATE3
            , acnt.DATE4_NAME
            , decode(decode(acnt.DATE4_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DATE4,''), '') AS DATE4

            , acnt.DESC1_NAME
            , decode(decode(acnt.DESC1_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DESC1,''), '') as DESC1
            , acnt.DESC2_NAME
            , decode(decode(acnt.DESC2_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DESC2,''), '') as DESC2
            , acnt.DESC3_NAME
            , decode(decode(acnt.DESC3_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DESC3,''), '') as DESC3
            , acnt.DESC4_NAME
            , decode(decode(acnt.DESC4_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DESC4,''), '') as DESC4
            , acnt.DESC5_NAME
            , decode(decode(acnt.DESC5_drcr, null, 'N', '0', 'Y', '1', decode(workd.dr_amt, 0, 'N', 'Y'), '2', decode(workd.cr_amt, 0, 'N', 'Y'), 'N'), 'Y', nvl(workd.DESC5,''), '') as DESC5
			, decode(acnt.PROJ_YN, NULL,'',workd.proj_code)  AS PROJ_CODE
			, proj.proj_name  AS PROJ_NAME
         from am_slip_detail workd
            , am_code_acnt acnt
            , AM_CODE_BANK bank
            , sm_code_project proj
            , am_asst_master asst
            , SM_AUTH_USER pers
            , AM_CODE_INCOME incm
            , AM_CODE_VALIDATION val44
            , am_code_evidence evid
        where workd.acnt_code = acnt.acnt_code
          and workd.BANK_CODE = bank.BANK_CODE (+)
          and workd.COMPANY_CODE = asst.COMPANY_CODE (+)
          and workd.FA_NO = asst.FA_NO (+)
          and workd.USER_ID = pers.USER_ID (+)
          and workd.INCOME_CODE = incm.INCOME_CODE (+)
          and val44.VALIDATION_CODE (+)= '44'
          and workd.SALES_DIV = val44.VALID_VALUE_CODE (+)
          and workd.EVIDENCE_CODE = evid.EVIDENCE_CODE (+)
		  and workd.PROJ_CODE = proj.proj_code(+)
          and workd.WORK_COMP = av_comp
          and workd.WORK_DATE = ad_date
          and workd.WORK_NO = an_no
          and workd.WORK_SEQ = an_seq
    ;
    c_cur1_val c_cur1_sql%ROWTYPE ;
    ls_give_name varchar2(30);
    ls_give_depositor varchar2(100);
    ls_work_return_data varchar2(2000);
 begin
    open c_cur1_sql;
    loop

       fetch c_cur1_sql into c_cur1_val;
       exit when c_cur1_sql%notfound;

       --  
       if ( c_cur1_val.BOND_YN = 'Y' ) THEN
          --  /  
          if ( c_cur1_val.SLIP_DRCR <> c_cur1_val.ADJUSTED_DRCR ) then
             ls_work_return_data := F_AM_GET_ESTABLISH_SLIPNO(av_comp, ad_date, an_no, an_seq  );
             if (ls_work_return_data is not null) then
                ls_work_return_data := ':' || ls_work_return_data ;
             end if;
 /*         else
                begin

                select
                   valam.valid_value_name
                   , F_AM_GET_SLIP_BANKDESC(supp.work_comp, supp.work_date, supp.work_no, supp.work_seq, supp.supply_seq) as give_deposit
                into
                   ls_give_name
                   , ls_give_depositor
                from
                   am_slip_supply supp
                   , am_code_validation valam
                   , (
                      select
                         work_date
                         , work_no

                         , work_seq
                         , min(supply_seq) as supply_seq
                      from
                         am_slip_supply
                      where
                            work_comp = av_comp
                         and work_date = ad_date
                         and work_no = an_no
                         and work_seq = an_seq
                      group by
                         work_date
                         , work_no
                         , work_seq

                      ) mins
                where
                   supp.work_date = mins.work_date
                   and supp.work_no = mins.work_no
                   and supp.work_seq = mins.work_seq
                   and supp.supply_seq = mins.supply_seq
                   and supp.acnt_code = valam.valid_value_level
                   and valam.validation_code = '39'
                ;
             --
             exception
                when no_data_found then ls_give_name := null ;
             end;

             --
             if (ls_give_name is not null) then
                ls_work_return_data := ':'||'['||ls_give_name||']' ;
                --
                if ls_give_depositor is not null then
                   ls_work_return_data := ls_work_return_data ||'=> '||ls_give_depositor ;
                end if ;
             end if ;
 */         end if;
       end if;

       --
       if (c_cur1_val.BANK_CODE is not null) then

          ls_work_return_data := ls_work_return_data ||':'|| c_cur1_val.BANK_NAME ;
       end if;

       --
       if (c_cur1_val.DEPOSIT_NO is not null) then
          ls_work_return_data := ls_work_return_data ||':'|| c_cur1_val.DEPOSIT_NO;
       end if;

       --
       if (c_cur1_val.CHECK_NO is not null ) then
          ls_work_return_data := ls_work_return_data ||':'|| c_cur1_val.CHECK_NO;
       end if ;


       --
       if (c_cur1_val.BILL_NO is not null ) then
          ls_work_return_data := ls_work_return_data ||':'|| c_cur1_val.BILL_NO;
       end if ;
       --
       --
       if (c_cur1_val.BILL_R_NO is not null ) then
          ls_work_return_data := ls_work_return_data ||':'|| c_cur1_val.BILL_R_NO;
       end if ;

       --
       if (c_cur1_val.LOAN_NO is not null) then
          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.LOAN_NO;

       end if ;
       --
       --
       if (c_cur1_val.STCK_CODE is not null ) then
          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.STCK_CODE;
       end if ;

       --
       if (c_cur1_val.FA_NO is not null) then
          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.FA_NAME;
       end if ;

       --

       if (c_cur1_val.CD_CARD_NO is not null) then
          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.CD_CARD_NO;
       end if ;

       --
       if (c_cur1_val.USER_ID is not null) then
          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.EMP_NAME;
       end if ;

       --
       if (c_cur1_val.INCOME_CODE is not null) then
          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.INCOME_NAME;
       end if ;


       --
       if (c_cur1_val.PHONE is not null) then
          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.PHONE;
       end if ;

       --
       --if (c_cur1_val.SALES_DIV is not null) then
       --   ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.SALES_NAME;
       --end if;

       --
       if (c_cur1_val.EVIDENCE_CODE is not null) then

          ls_work_return_data := ls_work_return_data ||':'||c_cur1_val.EVIDENCE_NAME||'('||c_cur1_val.EVIDENCE_CODE||')';
          ls_work_return_data := ls_work_return_data ||':'||ltrim(rtrim(to_char(c_cur1_val.SUPPLY_AMT,'999,999,999,999')));
          ls_work_return_data := ls_work_return_data ||':'||ltrim(rtrim(to_char(c_cur1_val.VAT_AMT,'999,999,999,999')));
       end if;

       --, , ( )

       --1
       if ( c_cur1_val.QTY1 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.QTY1_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.QTY1,'999,999,999.999')));
       end if ;

       --2

       if ( c_cur1_val.QTY2 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.QTY2_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.QTY2,'999,999,999.999')));
       end if ;

       --3
       if ( c_cur1_val.QTY3 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.QTY3_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.QTY3,'999,999,999.999')));
       end if ;

       --1
       if ( c_cur1_val.AMT1 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT1_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT1,'999,999,999,999,999')));
       end if ;


       --2
       if ( c_cur1_val.AMT2 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT2_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT2,'999,999,999,999,999')));
       end if ;

       --3
       if ( c_cur1_val.AMT3 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT3_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT3,'999,999,999,999,999')));
       end if ;

       --4
       if ( c_cur1_val.AMT4 <> 0 ) then

             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT4_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT4,'999,999,999,999,999')));
       end if ;

       --5
       if ( c_cur1_val.AMT5 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT5_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT5,'999,999,999,999,999')));
       end if ;

       --6
       if ( c_cur1_val.AMT6 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.AMT6_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.AMT6,'999,999,999,999,999')));
       end if ;


       --1
       if ( c_cur1_val.RATE1 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.RATE1_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.RATE1,'999,999.99')));
       end if ;

       --2
       if ( c_cur1_val.RATE2 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.RATE2_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.RATE2,'999,999.99')));
       end if ;

       --3
       if ( c_cur1_val.RATE3 <> 0 ) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.RATE3_NAME||':'||ltrim(rtrim(to_char(c_cur1_val.RATE3,'999,999.99')));

       end if ;

       --1
       if (c_cur1_val.DATE1 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DATE1_NAME||':'||ltrim(rtrim(to_char(to_date(c_cur1_val.DATE1),'yyyy-mm-dd')));
       end if ;

       --2
       if (c_cur1_val.DATE2 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DATE2_NAME||':'||ltrim(rtrim(to_char(to_date(c_cur1_val.DATE2),'yyyy-mm-dd')));
       end if ;

       --3

       if (c_cur1_val.DATE3 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DATE3_NAME||':'||ltrim(rtrim(to_char(to_date(c_cur1_val.DATE3),'yyyy-mm-dd')));
       end if ;

       --4
       if (c_cur1_val.DATE4 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DATE4_NAME||':'||ltrim(rtrim(to_char(to_date(c_cur1_val.DATE4),'yyyy-mm-dd')));
       end if ;

       --1
       if (c_cur1_val.DESC1 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DESC1_NAME||':'||c_cur1_val.DESC1;
       end if ;


       --2
       if (c_cur1_val.DESC2 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DESC2_NAME||':'||c_cur1_val.DESC2;
       end if ;

       --3
       if (c_cur1_val.DESC3 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DESC3_NAME||':'||c_cur1_val.DESC3;
       end if ;

       --4
       if (c_cur1_val.DESC4 is not null) then

             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DESC4_NAME||':'||c_cur1_val.DESC4;
       end if ;

       --5
       if (c_cur1_val.DESC5 is not null) then
             ls_work_return_data := ls_work_return_data ||''||c_cur1_val.DESC5_NAME||':'||c_cur1_val.DESC5;
       end if ;
	   
	   if (c_cur1_val.PROJ_CODE is not null) then
             ls_work_return_data := ls_work_return_data ||':('||c_cur1_val.PROJ_CODE||')'||c_cur1_val.PROJ_NAME;
       end if ;

    end loop;
    close c_cur1_sql;

    return ls_work_return_data ;
 end;

/





CREATE  OR REPLACE  FUNCTION F_HR_YETA_CHANGE_YN (as_comp varchar2, as_year varchar2, as_emp varchar2) RETURN VARCHAR2 IS

  ln_cnt integer := 0;
BEGIN
  begin
    select nvl(count(emp_no),0)
      into ln_cnt
      from (
             select emp_no, relation_code, name, rrn, basic_yn, respect70_yn, rubber_yn, woman_yn, child_yn, delivery_yn
               from hr_yeta_self
              where company_code like as_comp
                and work_year    = trim(as_year||'01')
                and mta_yn       = 'N'
                and item_code    like 'AA%'
                and relation_code is not null
                and emp_no       = as_emp
             minus
             select emp_no,  relation_code, name, rrn, basic_yn, respect70_yn, rubber_yn, woman_yn, child_yn, delivery_yn
               from hr_yeta_self
              where company_code like as_comp
                and work_year    = trim(to_char(to_number(as_year) - 1)||'01')
                and mta_yn       = 'N'
                and item_code    like 'AA%'
                and relation_code is not null
                and emp_no       = as_emp
           )
    group by emp_no;
  exception
    when no_data_found then
      ln_cnt := 0;
  end;

  if ln_cnt > 0 then
    return 'Y';
  else
    return 'N';
  end if;
  
EXCEPTION
 WHEN others THEN
   RETURN 'N';   
END;

/





CREATE OR REPLACE FUNCTION "F_SLIP_SERVE_EMPJOIN" (

AS_COMP   VARCHAR2,
AS_DATE   VARCHAR2,
AS_NO     NUMBER,
AS_SEQ     NUMBER,
AS_USER   VARCHAR2,
AS_DEPT  VARCHAR2
)
--  
RETURN VARCHAR2 IS

CURSOR c_cur IS
    SELECT    b.user_name   
      From am_slip_serve_user a,
           sm_auth_user b
        where a.user_id = b.user_id
         and a.work_comp = AS_COMP
         and a.work_date = AS_DATE
         and a.work_no= AS_NO
         and a.work_seq = AS_SEQ
         and exists (select *
                   from  am_slip_serve_user f,
                          sm_auth_user g
                    where f.user_id = g.user_id
                      and f.work_comp =AS_COMP
                      and f.work_date = AS_DATE
                      and f.work_no= AS_NO
                      and f.work_seq = AS_SEQ
                      and f.user_id  like As_user
                      and g.dept_code like As_dept)
          ORDER BY B.USER_ID;                      
                      
c_cur_val c_cur%ROWTYPE ;

ls_return  VARCHAR2(200);

BEGIN
  
    ls_return := '';
  
   
     OPEN c_cur;
     LOOP
         FETCH c_cur INTO c_cur_val;
         EXIT WHEN c_cur%NOTFOUND;
 
         IF ( ls_return = '' OR ls_return IS NULL) THEN
             ls_return := c_cur_val.user_name;
         ELSE
             ls_return := ls_return || '/' ||c_cur_val.user_name;
         END IF;
     END LOOP;
     CLOSE c_cur;
  
    RETURN(ls_return) ;
END;

/





CREATE OR REPLACE FUNCTION           "F_SM_NUMTOKOR" (

    AN_NUM NUMBER
 )
 Return VARCHAR2 Is
    vHanNum   VARCHAR2(18);
    vHanUnit  VARCHAR2(6);
    vHanUnit4 VARCHAR2(8);
    vNum      VARCHAR2(1);
    vNumber   VARCHAR2(20);
    vReturn   VARCHAR2(60);
    vLen      NUMBER;
    vMod      NUMBER;
    vDiv      NUMBER;

    vLoop     NUMBER;
 Begin
    If AN_NUM = 0 Then return ''; End If;

    vReturn := '';
    If (AN_NUM < 0) Then
       vReturn := ' ';
       vNumber := To_Char(AN_NUM * -1);
    Else
       vReturn := '';
       vNumber := To_Char(AN_NUM);
    End If;


    vHanNum := '';
    vHanUnit := '';
    vHanUnit4 := '';

    vLen := Length(vNumber);
    vLoop := 1;

    While vLoop <= vLen Loop
       vNum := SubStr(vNumber, vLoop, 1);
       vDiv := Trunc((vLen - vLoop) / 4);
       vMod := Mod(vLen - vLoop, 4);
       If vNum = '0' Then
          If vMod = 0 Then

             If vDiv > 0 And SubStr(vNumber, vLoop - 3, 3) <> '000' Then vReturn := vReturn || SubStr(vHanUnit4, vDiv, 1); End If;
          End If;
       Else
          vReturn := vReturn || SubStr(vHanNum, To_Number(vNum), 1);
          If vMod = 0 Then
             If vDiv <> 0 Then vReturn := vReturn || SubStr(vHanUnit4, vDiv, 1); End If;
          Else
             vReturn := vReturn || SubStr(vHanUnit, vMod, 1);
          End If;
       End If;
       vLoop := vLoop + 1;
    End Loop;
    Return vReturn;

 End;

/





CREATE  OR REPLACE  FUNCTION F_HR_GET_DOCIN_RECDEPT(

	AS_WORK_YEAR    VARCHAR2,
	AS_DEPT_CODE 	VARCHAR2,
	AS_SEQ					 NUMBER
) RETURN VARCHAR2 IS

    --   ,  RETURN
    LS_DEPT_NAME  VARCHAR2(200);
 	LS_RETURN     VARCHAR2(4000);

 	CURSOR CUR_DEPT IS
		SELECT B.DEPT_NAME
		  FROM HR_GAFF_DOC_IN_DEPT A,
		  	   		HR_CODE_DEPT B
		 WHERE A.REC_DEPT_CODE = B.DEPT_CODE AND
		 	   A.WORK_YEAR = AS_WORK_YEAR AND
			   A.DEPT_CODE = AS_DEPT_CODE AND
			   A.SEQ = AS_SEQ
	  ORDER BY A.DEPT_CODE
	   ;
BEGIN
 	LS_RETURN := '';

	OPEN CUR_DEPT;
	LOOP
		FETCH CUR_DEPT INTO LS_DEPT_NAME;
		EXIT WHEN CUR_DEPT%NOTFOUND;

		LS_RETURN := LS_RETURN || ', ' || LS_DEPT_NAME;

	END LOOP;
	CLOSE CUR_DEPT;

	IF LS_RETURN = '' THEN
	   RETURN LS_RETURN;
	ELSE
       RETURN SUBSTR(LS_RETURN, 3);
	END IF;

EXCEPTION
	WHEN NO_DATA_FOUND THEN
		 NULL;
	WHEN OTHERS THEN
		 -- Consider logging the error and then re-raise
		 RAISE;
END F_Hr_Get_Docin_Recdept;

/





CREATE OR REPLACE FUNCTION           "KAIT_GW.F_HR_ROWTOCOL" (

 p_slct IN VARCHAR2, p_dlmtr IN VARCHAR2 DEFAULT ',', p_opt IN VARCHAR2 DEFAULT 'N' 
)
return VARCHAR2
as
     TYPE c_refcur IS REF CURSOR;
     lc_str VARCHAR2(4000);
     lc_colval VARCHAR2(4000);
     c_dummy c_refcur;
     l number;
begin
     OPEN c_dummy FOR p_slct;
     LOOP
       FETCH c_dummy INTO lc_colval;


       EXIT WHEN c_dummy%NOTFOUND;
       lc_str := lc_str || p_dlmtr || lc_colval;
     END LOOP;
     CLOSE c_dummy;

     IF p_opt = 'Y' THEN
      RETURN SUBSTR(lc_str,1);
     ELSE
      RETURN SUBSTR(lc_str,2);
     END IF;

 EXCEPTION
     WHEN OTHERS THEN
     lc_str := SQLERRM;
     IF c_dummy%ISOPEN THEN
       CLOSE c_dummy;
     END IF;

     RETURN lc_str;
end;

/





CREATE OR REPLACE FUNCTION      "F_MM_GET_CONFIRMDATE"  ( av_code varchar2, av_order varchar2 )

 return varchar2 is
    lv_confirm_date varchar2(8);
 begin

   select confirm_date
    into lv_confirm_date
    from
    (
        select confirm_date 
        from mm_comm_commission where   
        contract_code = av_code and change_order = av_order
    )
    ;

    return lv_confirm_date;
 end; 

/





CREATE  OR REPLACE  FUNCTION F_SM_RESEARCH_MULTITEM

(
   as_resseq       varchar2,
   as_qryseq       varchar2,
   as_mid          varchar2   
     
) RETURN VARCHAR2
 AS

   lv_qryret  varchar2(100);
   ln_retlen  number;
   ln_data    varchar2(100);
   lv_itmnam  varchar2(100);
   ln_itmcnt  number;
   lv_itmnams varchar2(100);
   ls_return  varchar2(100);
   n          number;
   m          number;

 BEGIN
   select qry_ret, to_number(length(qry_ret)) into lv_qryret, ln_retlen from sm_research_ans where res_seq = as_resseq and qry_seq = as_qryseq and res_mid = as_mid;
   n := 0;  
   FOR i IN 1..9 LOOP
    select to_number(nvl(CASE WHEN substr(lv_qryret,i,1) = ','  THEN 1 ELSE 0 END, 0)) into ln_itmcnt from dual;
    IF ln_itmcnt > 0 THEN n := n + ln_itmcnt; END IF;
   END LOOP;
   
   
   FOR i IN 0..n LOOP
            ln_data := substr(lv_qryret,1+(2*i) ,1);
            select item_content into lv_itmnam from sm_research_item where res_seq = as_resseq and qry_seq = as_qryseq and item_seq = ln_data;
            IF lv_itmnams is null THEN
                    lv_itmnams := lv_itmnams || lv_itmnam;
            ELSE
                    lv_itmnams := lv_itmnams || ', ' || lv_itmnam;
            END IF;
   END LOOP;
   
   ls_return := trim(lv_itmnams);
   RETURN(ls_return);

 END; 

/





CREATE OR REPLACE FUNCTION      "F_MM_GUBUN_COMMISSION"  ( av_code varchar2, av_date varchar2, av_order float )

 return varchar2 is
    lv_apply_yn varchar2(1);
 begin

   select CASE WHEN ((trust_commission > 0) or (av_code = 'T20100188') or (av_code = 'T20120228')) THEN 'N' ELSE 'Y' END as apply_yn
    into lv_apply_yn
    from
    (
    select contract_code, fee_class, sum(trust_commission) as trust_commission 
    from mm_comm_commission where   
    
    (change_date between SUBSTR(av_date, 1,4) || '0101' and av_date and fee_class in ('09','71','99') and
    contract_code = av_code and change_order = av_order)  or (contract_code = av_code and av_code = 'T20100188')
    
    group by contract_code, fee_class
    )
    ;

    return lv_apply_yn;
 end; 

/





CREATE OR REPLACE FUNCTION "F_AM_GET_DOCU_ACNT"  ( av_acnt varchar2, av_list  varchar2 )

 return varchar2 is
    
    lv_cnt  number;
     lv_useyn  varchar2(1);
 begin
    --   .
           select  count(*) into  lv_cnt
        from AM_CODE_CALC_acnt
        where calc_kind_code = '000'
        and calc_list_code like  av_list
        and acnt_code  = av_acnt
          ;
    
    if  lv_cnt >  0 then
       lv_useyn := 'Y';
    else 
       lv_useyn := 'N';
    end if;
    
    return lv_useyn;
 end;

/





CREATE OR REPLACE FUNCTION      "F_MM_GET_CONTPAPER_YN"  (av_code varchar2)

 return varchar2 is
    lv_file_yn varchar2(500);

 begin

    WITH tmp AS
         (
            select distinct ccode col1, file_yn col2, vcode col3 from (
            select av_code as ccode, vcode,
            CASE WHEN vcode = pcode 
                 THEN 
                    CASE WHEN dseq > 0 and 
                            (select count(contract_code) 
                                from mm_comm_contpaper_file 
                                where contract_code = av_code and document_seq = dseq) > 0 
                         THEN '' ELSE 'N' END 
                 ELSE 'N' END as file_yn
            from
            (select substr(value_code,1,2) as vcode from sm_code_validation where sys_id = 'MM' and valid_code = 'CQ') a,
            (select document_seq as dseq, substr(paper_kind2,1,2) as pcode from mm_comm_contpaper where contract_code = av_code) b
            where a.vcode = b.pcode(+) 
            )
            order by vcode
         )
         
    SELECT  
            min(decode(r,1,col2)) ||
            min(decode(r,2,col2)) ||
            min(decode(r,3,col2)) ||
            min(decode(r,4,col2)) ||
            min(decode(r,5,col2)) ||
            min(decode(r,6,col2)) ||
            min(decode(r,7,col2)) ||
            min(decode(r,8,col2)) ||
            min(decode(r,9,col2)) ||
            min(decode(r,10,col2)) ||
            min(decode(r,11,col2)) ||
            min(decode(r,12,col2)) ||
            min(decode(r,13,col2)) ||
            min(decode(r,14,col2)) ||
            min(decode(r,15,col2)) ||
            min(decode(r,16,col2)) ||
            min(decode(r,17,col2)) ||
            min(decode(r,18,col2)) ||
            min(decode(r,19,col2)) ||
            min(decode(r,20,col2)) ||
            min(decode(r,21,col2)) ||
            min(decode(r,22,col2)) ||
            min(decode(r,23,col2)) ||
            min(decode(r,24,col2)) ||
            min(decode(r,25,col2)) ||
            min(decode(r,26,col2)) ||
            min(decode(r,27,col2)) ||
            min(decode(r,28,col2)) ||
            min(decode(r,29,col2)) ||
            min(decode(r,30,col2)) ||
            min(decode(r,31,col2)) ||
            min(decode(r,32,col2)) ||
            min(decode(r,33,col2)) ||
            min(decode(r,34,col2)) ||
            min(decode(r,35,col2)) ||
            min(decode(r,36,col2)) ||
            min(decode(r,37,col2)) ||
            min(decode(r,38,col2)) ||
            min(decode(r,39,col2)) ||
            min(decode(r,40,col2)) as file_yn
    INTO lv_file_yn
    FROM (SELECT col1, col2, ROW_NUMBER () OVER (PARTITION BY col1 ORDER BY col3) r FROM tmp)
    group by col1
    order by col1;   

    return lv_file_yn;
 end; 

/





CREATE OR REPLACE FUNCTION      "F_MM_GET_BRFOREDEPT"  ( av_code varchar2)

 return varchar2 is
    lv_dept varchar2(5);

 begin

    select contract_dept 
    into lv_dept
    from mm_comm_contract_manage_change a,
    (
        select contract_code, max(apply_limit) apply_limit
        from mm_comm_contract_manage_change 
        where contract_code = av_code and apply_limit <> '29991231'
        group by contract_code
    ) b
    where a.contract_code = b.contract_code and a.apply_limit = b.apply_limit 
    ;

    return lv_dept;
 end; 

/





CREATE OR REPLACE FUNCTION      "F_MM_GET_BRFOREUSER"  ( av_code varchar2)

 return varchar2 is
    lv_user varchar2(6);

 begin

    select contract_user_id 
    into lv_user
    from mm_comm_contract_manage_change a,
    (
        select contract_code, max(apply_limit) apply_limit
        from mm_comm_contract_manage_change 
        where contract_code = av_code and apply_limit <> '29991231'
        group by contract_code
    ) b
    where a.contract_code = b.contract_code and a.apply_limit = b.apply_limit 
    ;

    return lv_user;
 end; 

/





CREATE OR REPLACE FUNCTION "F_MM_VALIDNUMYN"(

    AN_NUM VARCHAR
)
RETURN VARCHAR2 IS
    vNum   NUMBER;
    vReturn   VARCHAR2(60);
BEGIN
  vNum := TO_NUMBER(AN_NUM);

    vReturn := 'Y';

    RETURN vReturn;

EXCEPTION
   WHEN OTHERS THEN
     -- Consider logging the error and then re-raise
     RETURN 'N';
END;

/





CREATE OR REPLACE FUNCTION "F_SM_DATEFORMAT"

( aDate varchar2
, aDiv varchar2
)
return varchar2 is
   vLen number;
   vReturn varchar2(30);
begin
   vLen := length(aDate);
   if (vLen = 4) then
      vReturn := aDate;
      if (aDiv = '') then vReturn := vReturn || ''; end if;
   elsif (vLen = 6) then
      vReturn := substr(aDate, 1, 4) || aDiv || substr(aDate, 5, 2);
      if (aDiv = '') then vReturn := vReturn || ''; end if;
   elsif (vLen = 8) then
      vReturn := substr(aDate, 1, 4) || aDiv || substr(aDate, 5, 2);
      if (aDiv = '') then vReturn := vReturn || '' || substr(aDate, 7, 2) || '';  else vReturn := vReturn || aDiv || substr(aDate, 7, 2); end if;
   elsif (vLen = 14) then
      vReturn := substr(aDate, 1, 4) || aDiv || substr(aDate, 5, 2);
      if (aDiv = '') then vReturn := vReturn || '' || substr(aDate, 7, 2) || '';  else vReturn := vReturn || aDiv || substr(aDate, 7, 2); end if;
      vReturn := ' ' || substr(aDate, 9, 2) || ':' || substr(aDate, 11, 2) || ':' || substr(aDate, 13, 2);
   else
      vReturn := aDate;
   end if;
   return vReturn;
exception
   when others then return aDate;
end;

/





CREATE  OR REPLACE  FUNCTION F_HD_GET_DELAYRANGE_BAK ( 

  as_custcode       IN VARCHAR2,   -- 
  as_seq            IN VARCHAR2,   -- 
  as_counts         IN VARCHAR2,   -- 
  as_base_date      IN VARCHAR2    -- 
) return NUMBER IS
CURSOR DELAY_CUR (V_AGREEDATE VARCHAR2, V_MONTHS INTEGER )IS
  SELECT delayrate,delaycut, NVL(TO_NUMBER(RPAD('1', DELAYUNIT, '0')), 1), startdate,enddate
    FROM hd_hous_rate_delay
    WHERE cust_code  = as_custcode
      AND seq        = TO_NUMBER(as_seq)
      AND enddate   >= V_AGREEDATE
      AND startdate  <= as_base_date
      AND ((end_tag = '1' and end_days >= V_MONTHS) or (end_tag = '2' and end_days > V_MONTHS))
      AND ((start_tag = '1' and start_days <= V_MONTHS) or (start_tag = '2' and start_days < V_MONTHS));

-------------------------------------------------------------
-- 
-------------------------------------------------------------
--  
   C_DEPT_CODE         VARCHAR2(12);  -- 
   C_HOUSETAG          VARCHAR2(1);   -- 
   C_DELAYBLOCK        VARCHAR2(1);   -- 1: 2:

   C_DT_BASE_DATE      DATE;     --  
   C_DT_AGREEDATE      DATE;     --  
   C_CNT               NUMBER;   --
   C_MONTHS            NUMBER(10,5);   -- 
   C_DAYS              NUMBER(10,5);   --
   C_DELAY_DAY         NUMBER(10,5);   -- 
   C_DELAY_AMT         NUMBER(30,9);   -- 
   C_BUNAMT            NUMBER(30,9);   -- 
   C_AGREEDATE         VARCHAR2(8);    -- 
   C_RECEIPTAMT        NUMBER(30,9);   -- 
   C_WORK_AMT          NUMBER(30,9);   -- 
   C_TEMP_RATE         NUMBER(30,9);   -- 
   C_TEMP_CNT          NUMBER(10,5);   -- 
   C_DELAYRATE         NUMBER(30,9);
   C_DELAYCUT          VARCHAR2(2);
   C_STARTDATE         VARCHAR2(8);
   C_ENDDATE           VARCHAR2(8);
   C_COMP_UNIT         INTEGER;
   C_DC_YN             VARCHAR2(1);
   C_AC_YN             VARCHAR2(1);
   C_TEMP_DAYS         NUMBER(10,5);   --
   C_MOVEINENDDATE     VARCHAR2(8);
   C_DAYMONTH          VARCHAR2(1); --

   C_TEMPDT            VARCHAR2(8);
   C_BLOCKDT           VARCHAR2(8);

BEGIN
   BEGIN
      C_DELAY_AMT := 0;
      C_DT_BASE_DATE := TO_DATE(as_base_date, 'YYYYMMDD'); --Date
      -----------------------------------------------------
      -- ,  .
-- 2014-07-01  :      TRIM         
      select dept_code, housetag, TRIM(moveinenddate), daymonth_tag
        INTO C_DEPT_CODE, C_HOUSETAG, C_MOVEINENDDATE, C_DAYMONTH
        FROM hd_hous_sell
       WHERE cust_code = as_custcode
         AND seq       = TO_NUMBER(as_seq);

      SELECT NVL(DELAY_BLOCK, '1')
        INTO C_DELAYBLOCK
        FROM HD_CODE_HOUSE
       WHERE DEPT_CODE = C_DEPT_CODE
         AND HOUSETAG  = C_HOUSETAG;

      -- ,, ,  
      select NVL((TO_DATE(agreedate, 'YYYYMMDD') - TO_DATE(as_base_date, 'YYYYMMDD')) * -1, 0), NVL(bunamt, 0), agreedate, dc_yn, ac_yn
        into C_DAYS,C_BUNAMT,C_AGREEDATE,C_DC_YN,C_AC_YN
        from hd_hous_selldetail
       where cust_code = as_custcode
         and seq       = TO_NUMBER(as_seq)
         and counts    = as_counts;

      --   
      IF C_DAYS > 0 THEN --  
         IF as_counts = '90' THEN
            IF NVL(C_MOVEINENDDATE, 'X') <> 'X' AND C_AGREEDATE < C_MOVEINENDDATE THEN
               C_TEMP_DAYS := NVL((TO_DATE(C_AGREEDATE, 'YYYYMMDD') - TO_DATE(C_MOVEINENDDATE, 'YYYYMMDD')) * -1,0);
               IF C_DAYS <= C_TEMP_DAYS THEN
                  C_DAYS := 0;
               ELSE
                  C_AGREEDATE := C_MOVEINENDDATE;
                  C_DAYS := NVL((TO_DATE(C_AGREEDATE, 'YYYYMMDD') - TO_DATE(as_base_date, 'YYYYMMDD')) * -1,0);
               END IF;
            END IF;
         END IF;

         --  .
         C_TEMPDT := F_HD_GET_HOLIDAY(C_DEPT_CODE, C_HOUSETAG, C_AGREEDATE, 'Y');
         IF C_TEMPDT >= as_base_date THEN
            C_DAYS := 0;
         END IF;
      ELSE
         C_DAYS := 0;
      END IF;

      --  .
      select NVL(sum(receiptamt),0)
        into C_RECEIPTAMT
        from hd_hous_income
        where cust_code = as_custcode
          and seq = TO_NUMBER(as_seq)
          and counts = as_counts;

      --   ().
      C_WORK_AMT := C_BUNAMT - C_RECEIPTAMT;

      ---------------------------------------------------------------------
      IF C_DAYS > 0 THEN 
         C_DELAY_DAY := 0;
         C_DELAY_AMT := 0;

         IF C_AC_YN = 'Y' THEN
            C_DELAY_DAY := C_DAYS;
            C_TEMP_RATE := 0;
            -- 

--    + 1   ...  2013-01-17  
            IF (as_counts = '90' AND C_MOVEINENDDATE IS NOT NULL AND C_AGREEDATE < C_MOVEINENDDATE) THEN
               C_DT_AGREEDATE := TO_DATE(C_MOVEINENDDATE, 'YYYYMMDD');
               C_BLOCKDT      := C_MOVEINENDDATE;
            ELSE
               C_DT_AGREEDATE := TO_DATE(C_AGREEDATE, 'YYYYMMDD');
               C_BLOCKDT      := C_AGREEDATE;
            END IF;                    

            IF C_DAYMONTH = '2' THEN
               C_MONTHS := MONTHS_BETWEEN(C_DT_BASE_DATE, C_DT_AGREEDATE);
            ELSE
               C_MONTHS := C_DT_BASE_DATE - C_DT_AGREEDATE;
            END IF;

            IF C_DELAYBLOCK = '1' THEN -- 
               OPEN DELAY_CUR(C_AGREEDATE,C_MONTHS);
               LOOP
                  FETCH DELAY_CUR INTO C_DELAYRATE,C_DELAYCUT,C_COMP_UNIT,C_STARTDATE,C_ENDDATE;
                  EXIT WHEN DELAY_CUR%NOTFOUND;
                  IF C_AGREEDATE >= C_STARTDATE and as_base_date <= C_ENDDATE THEN
                     C_TEMP_RATE := ( C_DELAY_DAY / 365 ) * ( C_DELAYRATE / 100 );
                     IF C_DELAYCUT = '1' THEN
                        C_DELAY_AMT := TRUNC((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT, 0) * C_COMP_UNIT;
                     ELSIF C_DELAYCUT = '2' THEN
                        C_DELAY_AMT := TRUNC((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT + 0.9, 0) * C_COMP_UNIT;
                     ELSE
                        C_DELAY_AMT := ROUND((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT, 0) * C_COMP_UNIT;
                     END IF;
                     EXIT;
                  END IF;
                  IF C_AGREEDATE >= C_STARTDATE THEN
                     C_TEMP_CNT := NVL(TO_DATE(C_ENDDATE, 'YYYYMMDD') - TO_DATE(C_AGREEDATE, 'YYYYMMDD'), 0);
                  ELSIF as_base_date <= C_ENDDATE THEN
                     C_TEMP_CNT := NVL(TO_DATE(as_base_date, 'YYYYMMDD') - TO_DATE(C_STARTDATE, 'YYYYMMDD') + 1, 0);
                  ELSE
                     C_TEMP_CNT := NVL(TO_DATE(C_ENDDATE, 'YYYYMMDD') - TO_DATE(C_STARTDATE, 'YYYYMMDD') + 1, 0);
                  END IF;
                  C_TEMP_RATE := (C_TEMP_CNT / 365) * (C_DELAYRATE / 100);
                  IF C_DELAYCUT = '1' THEN
                     C_DELAY_AMT := C_DELAY_AMT + TRUNC((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT, 0) * C_COMP_UNIT;
                  ELSIF C_DELAYCUT = '2' THEN
                     C_DELAY_AMT := C_DELAY_AMT + TRUNC((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT + 0.9, 0) * C_COMP_UNIT;
                  ELSE
                     C_DELAY_AMT := C_DELAY_AMT + ROUND((C_WORK_AMT * C_TEMP_RATE) / C_COMP_UNIT, 0) * C_COMP_UNIT;
                  END IF;
               END LOOP;
               CLOSE DELAY_CUR;
            ELSE --   
-- *********************************************************************************************************
-- *********************************************************************************************************
   select sum(case delaycut when '1' then trunc(amt / dunit) when '2' then trunc((amt / dunit) + 0.9) else round(amt / dunit) end * dunit) delayamt
     into c_delay_amt
     from ( select (a.delayrate / 36500) * (f_hd_diffday(greatest(a.startdate, b.frdt), least(a.enddate, b.todt)) + 1) * c_work_amt amt
        , a.delayrate, a.delaycut, a.delayunit dunit
     from hd_hous_rate_delay a
        , ( select to_char(to_date(c_blockdt, 'yyyymmdd') + df, 'yyyymmdd') frdt
        , least(as_base_date, to_char(to_date(c_blockdt, 'yyyymmdd') + dt, 'yyyymmdd')) todt
        , df
     from ( select 1 df, 30 dt from dual union all select 31, 90 from dual union all select 91, 180 from dual union all select 181, 99999 from dual ) a
        , ( select c_blockdt adt
        , as_base_date idt
        , f_hd_diffday(c_blockdt, as_base_date) tot
     from dual ) b
    where a.df <= b.tot ) b
    where a.cust_code = as_custcode
      and a.seq       = to_number(as_seq)
      and ((a.startdate <= b.todt and a.enddate <= b.frdt) or (a.enddate >= b.frdt and a.startdate <= b.todt)) 
      and start_days = b.df );
-- *********************************************************************************************************
-- *********************************************************************************************************
            END IF;
         ELSE
            C_DELAY_AMT := 0;
         END IF;
      ELSE
         C_DELAY_AMT := 0;
      END IF;
   END;

   RETURN C_DELAY_AMT;
END;

/





CREATE  OR REPLACE  FUNCTION F_HD_GET_DELAY_BLOCK ( 

  as_cust           IN VARCHAR2,   -- 
  as_seq            IN VARCHAR2,   -- 
  as_adate          IN VARCHAR2,   -- ()
  as_rdate          IN VARCHAR2,   -- ()
  as_amt            IN VARCHAR2,   -- 
  as_tp             IN VARCHAR2 DEFAULT 'AMT'
) return NUMBER IS

   a_seq            NUMBER(10);
   a_amt            NUMBER(30, 9);
   a_month          NUMBER(10, 5);
   V_DELAY          NUMBER(30, 9);
   V_RATE           NUMBER(30, 9);

BEGIN
   a_seq       := TO_NUMBER(as_seq);
   a_amt       := TO_NUMBER(as_amt);
   a_month     := F_HD_DIFFDAY(as_adate, as_rdate); --TO_NUMBER(as_month);
   V_DELAY     := 0;
   V_RATE      := 0;

/*--->>
   SELECT NVL(SUM(CASE DELAYCUT WHEN '1' THEN TRUNC((a_amt * (DELAYRATE / 100) * (DAYS / 365)) / DELAYUNIT)
                                WHEN '2' THEN TRUNC(((a_amt * (DELAYRATE / 100) * (DAYS / 365)) / DELAYUNIT) + 0.9)
                                ELSE ROUND((a_amt * (DELAYRATE / 100) * (DAYS / 365)) / DELAYUNIT)
                  END * DELAYUNIT), 0) AS RAMT,
          NVL(SUM((DAYS / 365) * (DELAYRATE / 100) * (DAYS / MONS)), 0)
     INTO V_DELAY, V_RATE
     FROM (SELECT CASE WHEN A.DAYS + A.SUM_DAYS <= B.MONS
                       THEN A.DAYS
                       ELSE B.MONS - A.SUM_DAYS
                  END AS DAYS,
                  B.MONS, A.DELAYRATE, A.DELAYCUT, A.DELAYUNIT, A.START_TAG, A.END_TAG
             FROM (SELECT DAYS,
                          NVL(SUM(NVL(DAYS, 0)) OVER (ORDER BY RK, ROWNUM ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING), 0) AS SUM_DAYS,
                          DELAYRATE, DELAYCUT, DELAYUNIT, START_TAG, END_TAG
                     FROM (SELECT CASE WHEN F_HD_ADDDAY(SDT, END_DAYS) <= EDT
                                       THEN END_DAYS - START_DAYS + 1
                                       ELSE F_HD_DIFFDAY(SDT, EDT)
                                  END AS DAYS,
                                  RK, DELAYRATE, DELAYCUT, DELAYUNIT, START_TAG, END_TAG
                             FROM (SELECT DENSE_RANK() OVER(ORDER BY STARTDATE, ENDDATE, START_DAYS, END_DAYS) AS RK,
                                          GREATEST(STARTDATE, as_adate) AS SDT,
                                          LEAST(ENDDATE, as_rdate) AS EDT,
                                          START_DAYS, END_DAYS, DELAYRATE, DELAYCUT, DELAYUNIT, START_TAG, END_TAG
                                     FROM HD_HOUS_RATE_DELAY
                                    WHERE CUST_CODE = as_cust
                                      AND SEQ       = a_seq
                                      AND (as_adate BETWEEN STARTDATE AND ENDDATE OR as_rdate BETWEEN STARTDATE AND ENDDATE)
                                  )
                          )
                  ) A,
                  (SELECT F_HD_DIFFDAY(as_adate, as_rdate) AS MONS
                     FROM DUAL
                  ) B
            WHERE A.SUM_DAYS < B.MONS
          );
>>----*/

   SELECT NVL(SUM(CASE DELAYCUT WHEN '1' THEN TRUNC((a_amt * (DELAYRATE / 100) * (NEWDD / 365)) / DELAYUNIT)
                                WHEN '2' THEN TRUNC(((a_amt * (DELAYRATE / 100) * (NEWDD / 365)) / DELAYUNIT) + 0.9)
                                ELSE ROUND((a_amt * (DELAYRATE / 100) * (NEWDD / 365)) / DELAYUNIT)
                  END * DELAYUNIT), 0),
          NVL(SUM((NEWDD / 365) * (DELAYRATE / 100) * (NEWDD / a_month)), 0)
     INTO V_DELAY, V_RATE
     FROM (SELECT CASE WHEN SUM_DD > a_month
                       THEN a_month - PRE_SUMDD
                       ELSE DD
                  END NEWDD,
                  DD, SUM_DD, START_DAYS, END_DAYS, STARTDATE, ENDDATE, DELAYRATE, DELAYCUT, DELAYUNIT, START_TAG, END_TAG
             FROM (SELECT NVL(SUM(NVL(SUM_DD, 0)) OVER (ORDER BY RK, ROWNUM ROWS BETWEEN 1 PRECEDING AND 1 PRECEDING), 0) AS PRE_SUMDD,
                          DD, SUM_DD, START_DAYS, END_DAYS, STARTDATE, ENDDATE, DELAYRATE, DELAYCUT, DELAYUNIT, START_TAG, END_TAG
                     FROM (SELECT DD,
                                  NVL(SUM(NVL(DD, 0)) OVER (ORDER BY RK, ROWNUM ROWS BETWEEN UNBOUNDED PRECEDING AND 0 PRECEDING), 0) AS SUM_DD,
                                  RK, START_DAYS, END_DAYS, STARTDATE, ENDDATE, DELAYRATE, DELAYCUT, DELAYUNIT, START_TAG, END_TAG
                             FROM (SELECT CASE WHEN CDAYS - START_DAYS + 1 > 0
                                          THEN CDAYS - START_DAYS + 1
                                          ELSE 0
                                          END AS DD,
                                          RK, START_DAYS, END_DAYS, STARTDATE, ENDDATE, DELAYRATE, DELAYCUT, DELAYUNIT, START_TAG, END_TAG
                                     FROM (SELECT CASE WHEN F_HD_ADDDAY(SDT, END_DAYS) <= EDT
                                                       THEN END_DAYS
                                                       ELSE F_HD_DIFFDAY(SDT, EDT)
                                                  END AS CDAYS,
                                                  RK, START_DAYS, END_DAYS, STARTDATE, ENDDATE, DELAYRATE, DELAYCUT, DELAYUNIT, START_TAG, END_TAG
                                             FROM (SELECT DENSE_RANK() OVER(ORDER BY STARTDATE, ENDDATE, START_DAYS, END_DAYS) AS RK,
                                                          GREATEST(STARTDATE, as_adate) AS SDT,
                                                          LEAST(ENDDATE, as_rdate) AS EDT,
                                                          START_DAYS, END_DAYS, STARTDATE, ENDDATE, DELAYRATE, DELAYCUT, DELAYUNIT, START_TAG, END_TAG
                                                     FROM HD_HOUS_RATE_DELAY
                                                    WHERE CUST_CODE = as_cust
                                                      AND SEQ       = a_seq
                                                  )
                                          )
                                  )
                            WHERE DD > 0
                          )
                  )
          );
   IF as_tp = 'AMT' THEN
      RETURN V_DELAY;
   ELSE
      RETURN V_RATE;
   END IF;
END;

/





CREATE  OR REPLACE  FUNCTION F_HD_GET_DELAYRANGE (

  as_custcode       IN VARCHAR2,   -- 
  as_seq            IN VARCHAR2,   -- 
  as_adate          IN VARCHAR2,   -- ()
  as_rdate          IN VARCHAR2,   -- ()
  as_amt            IN VARCHAR2,
  as_tp             IN VARCHAR2 DEFAULT 'AMT'
) return NUMBER IS

   C_DELAY_AMT      NUMBER(30,9);   -- 
   C_RATE           NUMBER;

BEGIN
   select nvl(sum(case delaycut when '1' then trunc(amt / dunit) when '2' then trunc((amt / dunit) + 0.9) else round(amt / dunit) end * dunit), 0) delayamt,
            nvl(sum(rate), 0)
     into c_delay_amt, c_rate
     from ( select (a.delayrate / 36500) * (f_hd_diffday(greatest(a.startdate, b.frdt), least(a.enddate, b.todt)) + 1) * to_number(as_amt) amt
           , (a.delayrate / 36500) * (f_hd_diffday(greatest(a.startdate, b.frdt), least(a.enddate, b.todt)) + 1)  rate
           , a.delayrate, a.delaycut, a.delayunit dunit
   from hd_hous_rate_delay a
        , ( select to_char(to_date(as_adate, 'yyyymmdd') + df, 'yyyymmdd') frdt
                    , least(as_rdate, to_char(to_date(as_adate, 'yyyymmdd') + dt, 'yyyymmdd')) todt
                    , df
            from ( select start_days df, end_days dt
                        from hd_hous_rate_delay
                      where cust_code = as_custcode
                          and seq = to_number(as_seq)
                          and startdate = ( select max(startdate)
                                                      from hd_hous_rate_delay
                                                    where cust_code = as_custcode
                                                        and seq = to_number(as_seq) ) ) a
                  , ( select as_adate adt
                              , as_rdate idt
                              , f_hd_diffday(as_adate, as_rdate) tot
                       from dual ) b
             where a.df <= b.tot 
             ) b
    where a.cust_code = as_custcode
      and a.seq       = to_number(as_seq)
      and (( b.frdt between a.startdate and a.enddate ) or ( b.todt between a.startdate and a.enddate ))
      and start_days = b.df 
      );

   IF as_tp = 'AMT' THEN
      RETURN C_DELAY_AMT;
   ELSE
      RETURN C_RATE;
   END IF;
  
END;

/





CREATE OR REPLACE FUNCTION      "F_SM_ENTER_CHANGE_4000" ( vSrc varchar2 )

return varchar2 is
   vReturn varchar2(4000);
begin
   vReturn := Replace(vSrc, chr(13) || chr(10), '');
   return vReturn;
end; 

/





CREATE OR REPLACE FUNCTION "F_SM_CUSTCOPYN" (

    AS_CUST VARCHAR
 )
 Return VARCHAR2 Is -- 
 vReturn VARCHAR2(1);
 
 Begin
  vReturn := 'N';
  IF LENGTH(AS_CUST) = 10 AND SUBSTR(AS_CUST, 4, 2) BETWEEN '81' AND '88' THEN
    vReturn := 'Y';
 END IF;
    Return vReturn;

 End;

/





CREATE  OR REPLACE  FUNCTION KAIT_VARIFICATION_FUNCTION (

username VARCHAR2,
password VARCHAR2,
old_password VARCHAR2)
RETURN BOOLEAN AS
begin
if length(password) < 8 THEN
return false;
else
return true;
end if;
end kait_varification_function; 

/





CREATE  OR REPLACE  FUNCTION F_HR_PERS_LUNAR_TO_SOLAR_OLD ( as_lunar IN CHAR )

     RETURN VARCHAR2
     IS
        Out_Of_Range exception;
        ls_return VARCHAR2(100);
        LunerY  NUMBER(5) := 0 ;
        LunerM  NUMBER(5) := 0 ;
        LunerD  NUMBER(5) := 0 ;
        i  NUMBER(5) := 0 ;
        j NUMBER(5) := 0 ;

         -- 1921  
        ll_FromYear                  NUMBER(10) := 0 ;


        ls_YunMon    VARCHAR2(500);     --
        ls_YunLen     VARCHAR2(500);    -- (29 OR 30)

  --    
         --( 12 byte  * (30  1 )  )
        ls_MonLen     VARCHAR2(500)  ;
        ls_lYearDay    VARCHAR2(500);   --  (29 OR 30)
        ls_SolarMon    VARCHAR2(39) ;

         --0000-00-00  
        ll_DaySum        NUMBER(10);


        li_M NUMBER(5) := 0 ;

        MM NUMBER(5) := 0 ;
        MK NUMBER(5):=0 ;

        v_loop NUMBER(5) :=0;

        li_PrevYear NUMBER(5):=0;
        li_OneYearDay  NUMBER(5):=0;
        NA NUMBER(5):=0;
        YD NUMBER(5):=0;
        KA NUMBER(5):=0;
        SolarY NUMBER(5):=0 ;

        SolarM NUMBER(5):=0 ;
        SolarD NUMBER(5):=0;

 BEGIN
     LunerY := TO_NUMBER(SUBSTR( as_lunar,1,4)) + 2333;
     LunerM := TO_NUMBER(SUBSTR( as_lunar,5,2));
     LunerD := TO_NUMBER(SUBSTR( as_lunar,7,2));

     -- 1921-2030 , 1-12 , 1-31    .
     IF (SUBSTR(as_lunar,1,4) < '1921' OR SUBSTR(as_lunar,1,4) > '2030')
        OR
        (SUBSTR(as_lunar,5,2) < '01' OR SUBSTR(as_lunar,5,2) > '12')
        OR

        (SUBSTR(as_lunar,7,2) < '01' OR SUBSTR(as_lunar,7,2) > '31')
        THEN
        raise Out_Of_Range;

     END IF ;

    --1921 - 2030
    ls_YunMon := ' 0 5 0 0 4 0 0 2 0 6'||
   ' 0 0 5 0 0 3 0 7 0 0'||
   ' 6 0 0 4 0 0 2 0 7 0'||
   ' 0 5 0 0 3 0 8 0 0 6'||
   ' 0 0 4 0 0 3 0 7 0 0'||
   ' 5 0 0 4 0 8 0 0 6 0'||

   ' 0 4 010 0 0 6 0 0 5'||
   ' 0 0 3 0 8 0 0 5 0 0'||
   ' 4 0 0 2 0 7 0 0 5 0'||
   ' 0 3 0 9 0 0 5 0 0 4'||

   ' 0 0 2 0 6 0 0 5 0 0';
    --1921 - 2030
    ls_YunLen := ' 029 0 029 0 029 029'||
   ' 0 030 0 030 030 0 0'||
   '30 0 030 0 029 029 0'||
   ' 030 0 030 029 0 029'||
   ' 0 029 0 029 029 0 0'||
   '29 0 029 029 0 030 0'||

    ' 029 029 0 029 0 029'||
   ' 0 029 029 0 029 0 0'||
   '29 0 029 029 0 029 0'||
   ' 030 029 0 029 0 029'||
   ' 0 029 029 0 029 0 0';


    --1921 - 2030
    ls_lYearDay :=
   ' 354 384 354 354 385 354 355 384 354 383'||
   ' 354 355 384 355 354 384 354 384 354 354'||
   ' 384 355 355 384 354 354 384 354 384 354'||
   ' 355 384 355 354 384 354 384 354 354 384'||
   ' 355 354 384 355 353 384 355 384 354 355'||
   ' 384 354 354 384 354 384 354 355 384 355'||
   ' 354 384 354 384 354 354 385 354 355 384'||
   ' 354 354 383 355 384 355 354 384 354 354'||
   ' 384 354 355 384 355 384 354 354 384 354'||
   ' 354 384 355 384 354 355 384 354 354 384'||
   ' 354 355 384 354 384 355 354 383 355 354';

  --1921 - 2030
    ls_MonLen :=
   '26352891170527722997 6942395133511751622'||
   '3658374917051461 69422222350321332213402'||
   '346629211389 603 60523493371270934132890'||
   '290113651243 603213513232715168517062794'||
   '2741120627342647131838783477171713862477'||
   '1245119826383405336534132900343423942395'||
   '1179271526352855170117482901 69423951207'||
   '117516111866374917531453 694241423503222'||
   '37333402349318771389 699 605234932432709'||
   '28902890290113731211 6032391132327092965'||
   '1706277317171206267026471319170234751450';
    ll_DaySum := 701303  ; --1920 

    --1921      

    ll_FromYear := LunerY - 4254  ;
    FOR  i IN 1..ll_FromYear LOOP
         ll_DaySum := ll_DaySum + TO_NUMBER( SubStr( ls_lYearDay, i*4-3, 4 ) );
    END LOOP;

    --  
    IF LunerM <> 1  THEN --1   -> 
          li_M := 2048;

          ll_FromYear := ll_FromYear + 1;

          MM := TO_NUMBER( SUBSTR( ls_MonLen, ll_FromYear*4-3,4 ) );


          FOR  j IN 1..LunerM - 1 LOOP
             --  .
             ll_DaySum := ll_DaySum + 29 + TRUNC(MM / li_M);

             MM := MM - TRUNC(MM / li_M) * li_M;
             li_M := TRUNC(li_M / 2);

             IF  j = TO_NUMBER( SUBSTR( ls_YunMon,ll_FromYear*2-1,2 ) )  THEN
                 -- 

                 ll_DaySum := ll_DaySum +
                       TO_NUMBER( SUBSTR( ls_YunLen, ll_FromYear*2-1,2 ) );
             END IF;

          END LOOP ;
    END IF;

    --   
    ll_DaySum := ll_DaySum + LunerD;

    ------------------------------------------------------
    --1921     .
    ------------------------------------------------------
    li_PrevYear := TRUNC(ll_DaySum/365) - 1    ;

    NA := TRUNC(ll_DaySum - li_PrevYear*365)    ;
    YD := TRUNC(li_PrevYear/4)

          - TRUNC(li_PrevYear/100)
          + TRUNC(li_PrevYear/400) ;
    KA := NA - YD  ;

    IF KA < 0 THEN
         li_PrevYear := li_PrevYear - 1;
         NA := ll_DaySum - TRUNC(li_PrevYear*365);
         YD := TRUNC(li_PrevYear/4) - TRUNC(li_PrevYear/100 )
               + TRUNC(li_PrevYear/400);
         NA := NA - YD;
    ELSE

         NA := KA;

    END IF;

    --   .
    SolarY := li_PrevYear + 1;
    IF   SolarY = TRUNC(SolarY/4)*4  AND  SolarY<>TRUNC(SolarY/100)*100 THEN
         ls_SolarMon := '  0 31 29 31 30 31 30 31 31 30 31 30 31';
         li_OneYearDay := 366;

    ELSIF  SolarY = TRUNC(SolarY/400)*400 THEN
         ls_SolarMon := '  0 31 29 31 30 31 30 31 31 30 31 30 31';
         li_OneYearDay := 366;



    ELSE
  ls_SolarMon := '  0 31 28 31 30 31 30 31 31 30 31 30 31';
         li_OneYearDay := 365;

    END IF;

    IF NA = 0 THEN
          NA := li_OneYearDay;
          SolarY := SolarY - 1;
    END IF;

    FOR  I IN 1..13 LOOP
         v_loop := I;


         IF  NA > TO_NUMBER( SUBSTR( ls_SolarMon,I*3-2,3 ) ) THEN
             NA := NA - TO_NUMBER( SUBSTR( ls_SolarMon,I*3-2,3 ) );
         ELSE
             EXIT;
         END IF;
    END LOOP;

    SolarM := v_loop - 1;
    SolarD := NA;
    ls_return := LPAD(SolarY,4,'0') ||
                 LPAD(SolarM,2,'0') ||
                 LPAD(SolarD,2,'0');

    Return ls_return;


    exception
      WHEN DUP_VAL_ON_INDEX then
           ls_return := 'DUP_VAL_ON_INDEX .';
           Return ls_return;
      WHEN INVALID_NUMBER then
           ls_return := 'INVALID_NUMBER .';
           Return ls_return;
      WHEN LOGIN_DENIED then
           ls_return := 'Login Denied.';
           Return ls_return;

      WHEN NOT_LOGGED_ON then
           ls_return := 'Not Logged On.';

           Return ls_return;
      WHEN PROGRAM_ERROR then
           ls_return := 'Program Error.';
           Return ls_return;
      WHEN STORAGE_ERROR then
           ls_return := 'Storage Error.';
           Return ls_return;
      WHEN TIMEOUT_ON_RESOURCE then
           ls_return := 'Timeout on resource.';
           Return ls_return;

      WHEN VALUE_ERROR then
           ls_return := 'VALUE_ERROR . ';
           Return ls_return;

      WHEN ZERO_DIVIDE then
           ls_return := 'Zero Divide .';
           Return ls_return;
      WHEN Out_Of_Range then
           ls_return := '(1921.01.01-2030.11.28) .';
           Return ls_return;
      WHEN others then
           ls_return := SUBSTR(SQLERRM, 1, 100 );
           Return ls_return;

 END;

/






CREATE  OR REPLACE  TRIGGER TH_HD_CODE_DEPT
 AFTER DELETE OR UPDATE
 ON HD_CODE_DEPT
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE
/******************************************/
/***** HIST  DATA INSERT ************/
/******************************************/
   vTag VARCHAR2(1);
BEGIN

   IF UPDATING THEN
      vTag := 'U';
   ELSE
      vTag := 'D';
   END IF;

   INSERT INTO HD_CODE_DEPT_HIST
   ( HIST_DATE,
     DEPT_CODE,
     DEPT_NAME,
     TEL,
     ZIP,
     ADDR1,
     ADDR2,
     LISTTAG,
     JOBTAG,
     COMPANY_CODE,
     AMIS_DEPTCODE,
     TAX_TAG,
     SIHANG_VENDOR,
     SIHANG_NAME,
     SIHANG_DEPYO,
     SIHANG_UPTE,
     SIHANG_UPJONG,
     SIHANG_ZIP,
     SIHANG_ADDR1,
     SIHANG_ADDR2,
     SIGONG_NAME,
     SIGONG_DEPYO,
     SIGONG_CHARGE,
     SIGONG_TEL,
     MODEL_ZIP,
     MODEL_ADDR1,
     MODEL_ADDR2,
     MODEL_TEL,
     DEPT_TYPE_CODE,
     REMARK,
     INPUT_DUTY_ID,
     INPUT_DATE,
     CHG_DUTY_ID,
     CHG_DATE,
     SMS_NAME,
     SMS_TEL,
     OLD_DEPTCODE,
     ZIP_ORG,
     ADDR1_ORG,
     ADDR2_ORG,
     ADDR_TAG,
     SIHANG_ZIP_ORG,
     SIHANG_ADDR1_ORG,
     SIHANG_ADDR2_ORG,
     SIHANG_ADDR_TAG,
     MODEL_ZIP_ORG,
     MODEL_ADDR1_ORG,
     MODEL_ADDR2_ORG,
     MODEL_ADDR_TAG,
     TRI_TAG )
   VALUES
   (  SYSTIMESTAMP  ,
       :OLD.DEPT_CODE,
       :OLD.DEPT_NAME,
       :OLD.TEL,
       :OLD.ZIP,
       :OLD.ADDR1,
       :OLD.ADDR2,
       :OLD.LISTTAG,
       :OLD.JOBTAG,
       :OLD.COMPANY_CODE,
       :OLD.AMIS_DEPTCODE,
       :OLD.TAX_TAG,
       :OLD.SIHANG_VENDOR,
       :OLD.SIHANG_NAME,
       :OLD.SIHANG_DEPYO,
       :OLD.SIHANG_UPTE,
       :OLD.SIHANG_UPJONG,
       :OLD.SIHANG_ZIP,
       :OLD.SIHANG_ADDR1,
       :OLD.SIHANG_ADDR2,
       :OLD.SIGONG_NAME,
       :OLD.SIGONG_DEPYO,
       :OLD.SIGONG_CHARGE,
       :OLD.SIGONG_TEL,
       :OLD.MODEL_ZIP,
       :OLD.MODEL_ADDR1,
       :OLD.MODEL_ADDR2,
       :OLD.MODEL_TEL,
       :OLD.DEPT_TYPE_CODE,
       :OLD.REMARK,
       :OLD.INPUT_DUTY_ID,
       :OLD.INPUT_DATE,
       :OLD.CHG_DUTY_ID,
       :OLD.CHG_DATE,
       :OLD.SMS_NAME,
       :OLD.SMS_TEL,
       :OLD.OLD_DEPTCODE,
       :OLD.ZIP_ORG,
       :OLD.ADDR1_ORG,
       :OLD.ADDR2_ORG,
       :OLD.ADDR_TAG,
       :OLD.SIHANG_ZIP_ORG,
       :OLD.SIHANG_ADDR1_ORG,
       :OLD.SIHANG_ADDR2_ORG,
       :OLD.SIHANG_ADDR_TAG,
       :OLD.MODEL_ZIP_ORG,
       :OLD.MODEL_ADDR1_ORG,
       :OLD.MODEL_ADDR2_ORG,
       :OLD.MODEL_ADDR_TAG,
       vTag );
END;

/





ALTER TRIGGER TH_HD_CODE_DEPT
	ENABLE;




CREATE  OR REPLACE  TRIGGER TDA_HD_CODE_HOUSE
 AFTER DELETE
 ON HD_CODE_HOUSE
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
declare numrows INTEGER;
begin
   INSERT INTO HD_CODE_HOUSE_HIST
   (    HIST_DATE         ,
        DEPT_CODE         ,
        HOUSETAG          ,
        HOUSEDATE         ,
        COMPLETIONDATE    ,
        HOUSE_CNT         ,
        MOVEINSTARTDATE   ,
        MOVEINENDDATE     ,
        PENALTYRATE       ,
        HIC_TAG           ,
        TIRM_RATE         ,
        SODUK_RATE        ,
        JUMIN_RATE        ,
        DAMDANG           ,
        DAMDANG_TEL       ,
        PRINT_CNT         ,
        RESELL_TAG        ,
        VIRDEPOSIT_YN     ,
        VIRBANK_CODE      ,
        DEPT_ADDR_USE_YN  ,
        CONT_PBL_NAME     ,
        CONT_DW_NAME      ,
        REMARK            ,
        INPUT_DUTY_ID     ,
        INPUT_DATE        ,
        CHG_DUTY_ID       ,
        CHG_DATE          ,
        CONT_PBL_NAME2    ,
        CONT_DW_NAME2     ,
        CONT_PBL_NAME3    ,
        CONT_DW_NAME3     ,
        SLIPGROUP         ,
        TRI_TAG           ,
        APPLY_CHECK_YN    ,
        ANNE1A_PBL        ,
        ANNE1A_DW         ,
        ANNE1B_PBL        ,
        ANNE1B_DW         ,
        ANNE2A_PBL        ,
        ANNE2A_DW         ,
        ANNE2B_PBL        ,
        ANNE2B_DW         ,
        ANNE3_PBL         ,
        ANNE3_DW          ,
        ANNE4_PBL         ,
        ANNE4_DW          ,
        DELAYDAY          ,
        DELAYRATE         ,
        AGREE_TAG         ,
        INDEMINITY_TAG    ,
        INDEMINITY_FRDT   ,
        INDEMINITY_TODT   ,
        SEALTYPE          ,
        JIRO_TAG          ,
        JIRO_SN           ,
        HD_DAYMONTH_TAG   ,
        RT_DAYMONTH_TAG   ,
        RT_FIXRATE_TAG    ,
        PREDIS_TAG        ,
        PROXY_TAG         ,
        TRUST_TAG         ,
        PRINT_YN          ,
        RT_FIXRATE_DAY    ,
        RT_FIXRATE        ,
        VIRDEPOSIT2_YN    ,
        VIRBANK2_CODE     ,
        RT_FIXRATE2       ,
        RT_EXTRATE        ,
        RT_GURTYN         ,
        RT_RENTYN         ,
        ONCESALERATE      ,
        DELAY_BLOCK
   )
   VALUES
   (    SYSDATE                ,
        :OLD.DEPT_CODE         ,
        :OLD.HOUSETAG          ,
        :OLD.HOUSEDATE         ,
        :OLD.COMPLETIONDATE    ,
        :OLD.HOUSE_CNT         ,
        :OLD.MOVEINSTARTDATE   ,
        :OLD.MOVEINENDDATE     ,
        :OLD.PENALTYRATE       ,
        :OLD.HIC_TAG           ,
        :OLD.TIRM_RATE         ,
        :OLD.SODUK_RATE        ,
        :OLD.JUMIN_RATE        ,
        :OLD.DAMDANG           ,
        :OLD.DAMDANG_TEL       ,
        :OLD.PRINT_CNT         ,
        :OLD.RESELL_TAG        ,
        :OLD.VIRDEPOSIT_YN     ,
        :OLD.VIRBANK_CODE      ,
        :OLD.DEPT_ADDR_USE_YN  ,
        :OLD.CONT_PBL_NAME     ,
        :OLD.CONT_DW_NAME      ,
        :OLD.REMARK            ,
        :OLD.INPUT_DUTY_ID     ,
        :OLD.INPUT_DATE        ,
        :OLD.CHG_DUTY_ID       ,
        :OLD.CHG_DATE          ,
        :OLD.CONT_PBL_NAME2    ,
        :OLD.CONT_DW_NAME2     ,
        :OLD.CONT_PBL_NAME3    ,
        :OLD.CONT_DW_NAME3     ,
        :OLD.SLIPGROUP         ,
        'D'                    ,
        :OLD.APPLY_CHECK_YN    ,
        :OLD.ANNE1A_PBL        ,
        :OLD.ANNE1A_DW         ,
        :OLD.ANNE1B_PBL        ,
        :OLD.ANNE1B_DW         ,
        :OLD.ANNE2A_PBL        ,
        :OLD.ANNE2A_DW         ,
        :OLD.ANNE2B_PBL        ,
        :OLD.ANNE2B_DW         ,
        :OLD.ANNE3_PBL         ,
        :OLD.ANNE3_DW          ,
        :OLD.ANNE4_PBL         ,
        :OLD.ANNE4_DW          ,
        :OLD.DELAYDAY          ,
        :OLD.DELAYRATE         ,
        :OLD.AGREE_TAG         ,
        :OLD.INDEMINITY_TAG    ,
        :OLD.INDEMINITY_FRDT   ,
        :OLD.INDEMINITY_TODT   ,
        :OLD.SEALTYPE          ,
        :OLD.JIRO_TAG          ,
        :OLD.JIRO_SN           ,
        :OLD.HD_DAYMONTH_TAG   ,
        :OLD.RT_DAYMONTH_TAG   ,
        :OLD.RT_FIXRATE_TAG    ,
        :OLD.PREDIS_TAG        ,
        :OLD.PROXY_TAG         ,
        :OLD.TRUST_TAG         ,
        :OLD.PRINT_YN          ,
        :OLD.RT_FIXRATE_DAY    ,
        :OLD.RT_FIXRATE        ,
        :OLD.VIRDEPOSIT2_YN    ,
        :OLD.VIRBANK2_CODE     ,
        :OLD.RT_FIXRATE2       ,
        :OLD.RT_EXTRATE        ,
        :OLD.RT_GURTYN         ,
        :OLD.RT_RENTYN         ,
        :OLD.ONCESALERATE      ,
        :OLD.DELAY_BLOCK
   );
end; 

/





ALTER TRIGGER TDA_HD_CODE_HOUSE
	ENABLE;




CREATE  OR REPLACE  TRIGGER TUA_HD_CODE_HOUSE
 AFTER UPDATE
 ON HD_CODE_HOUSE
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
declare numrows INTEGER;
begin
   INSERT INTO HD_CODE_HOUSE_HIST
   (    HIST_DATE         ,
        DEPT_CODE         ,
        HOUSETAG          ,
        HOUSEDATE         ,
        COMPLETIONDATE    ,
        HOUSE_CNT         ,
        MOVEINSTARTDATE   ,
        MOVEINENDDATE     ,
        PENALTYRATE       ,
        HIC_TAG           ,
        TIRM_RATE         ,
        SODUK_RATE        ,
        JUMIN_RATE        ,
        DAMDANG           ,
        DAMDANG_TEL       ,
        PRINT_CNT         ,
        RESELL_TAG        ,
        VIRDEPOSIT_YN     ,
        VIRBANK_CODE      ,
        DEPT_ADDR_USE_YN  ,
        CONT_PBL_NAME     ,
        CONT_DW_NAME      ,
        REMARK            ,
        INPUT_DUTY_ID     ,
        INPUT_DATE        ,
        CHG_DUTY_ID       ,
        CHG_DATE          ,
        CONT_PBL_NAME2    ,
        CONT_DW_NAME2     ,
        CONT_PBL_NAME3    ,
        CONT_DW_NAME3     ,
        SLIPGROUP         ,
        TRI_TAG           ,
        APPLY_CHECK_YN    ,
        ANNE1A_PBL        ,
        ANNE1A_DW         ,
        ANNE1B_PBL        ,
        ANNE1B_DW         ,
        ANNE2A_PBL        ,
        ANNE2A_DW         ,
        ANNE2B_PBL        ,
        ANNE2B_DW         ,
        ANNE3_PBL         ,
        ANNE3_DW          ,
        ANNE4_PBL         ,
        ANNE4_DW          ,
        DELAYDAY          ,
        DELAYRATE         ,
        AGREE_TAG         ,
        INDEMINITY_TAG    ,
        INDEMINITY_FRDT   ,
        INDEMINITY_TODT   ,
        SEALTYPE          ,
        JIRO_TAG          ,
        JIRO_SN           ,
        HD_DAYMONTH_TAG   ,
        RT_DAYMONTH_TAG   ,
        RT_FIXRATE_TAG    ,
        PREDIS_TAG        ,
        PROXY_TAG         ,
        TRUST_TAG         ,
        PRINT_YN          ,
        RT_FIXRATE_DAY    ,
        RT_FIXRATE        ,
        VIRDEPOSIT2_YN    ,
        VIRBANK2_CODE     ,
        RT_FIXRATE2       ,
        RT_EXTRATE        ,
        RT_GURTYN         ,
        RT_RENTYN         ,
        ONCESALERATE      ,
        DELAY_BLOCK
   )
   VALUES
   (    SYSDATE                ,
        :OLD.DEPT_CODE         ,
        :OLD.HOUSETAG          ,
        :OLD.HOUSEDATE         ,
        :OLD.COMPLETIONDATE    ,
        :OLD.HOUSE_CNT         ,
        :OLD.MOVEINSTARTDATE   ,
        :OLD.MOVEINENDDATE     ,
        :OLD.PENALTYRATE       ,
        :OLD.HIC_TAG           ,
        :OLD.TIRM_RATE         ,
        :OLD.SODUK_RATE        ,
        :OLD.JUMIN_RATE        ,
        :OLD.DAMDANG           ,
        :OLD.DAMDANG_TEL       ,
        :OLD.PRINT_CNT         ,
        :OLD.RESELL_TAG        ,
        :OLD.VIRDEPOSIT_YN     ,
        :OLD.VIRBANK_CODE      ,
        :OLD.DEPT_ADDR_USE_YN  ,
        :OLD.CONT_PBL_NAME     ,
        :OLD.CONT_DW_NAME      ,
        :OLD.REMARK            ,
        :OLD.INPUT_DUTY_ID     ,
        :OLD.INPUT_DATE        ,
        :OLD.CHG_DUTY_ID       ,
        :OLD.CHG_DATE          ,
        :OLD.CONT_PBL_NAME2    ,
        :OLD.CONT_DW_NAME2     ,
        :OLD.CONT_PBL_NAME3    ,
        :OLD.CONT_DW_NAME3     ,
        :OLD.SLIPGROUP         ,
        'U'                    ,
        :OLD.APPLY_CHECK_YN    ,
        :OLD.ANNE1A_PBL        ,
        :OLD.ANNE1A_DW         ,
        :OLD.ANNE1B_PBL        ,
        :OLD.ANNE1B_DW         ,
        :OLD.ANNE2A_PBL        ,
        :OLD.ANNE2A_DW         ,
        :OLD.ANNE2B_PBL        ,
        :OLD.ANNE2B_DW         ,
        :OLD.ANNE3_PBL         ,
        :OLD.ANNE3_DW          ,
        :OLD.ANNE4_PBL         ,
        :OLD.ANNE4_DW          ,
        :OLD.DELAYDAY          ,
        :OLD.DELAYRATE         ,
        :OLD.AGREE_TAG         ,
        :OLD.INDEMINITY_TAG    ,
        :OLD.INDEMINITY_FRDT   ,
        :OLD.INDEMINITY_TODT   ,
        :OLD.SEALTYPE          ,
        :OLD.JIRO_TAG          ,
        :OLD.JIRO_SN           ,
        :OLD.HD_DAYMONTH_TAG   ,
        :OLD.RT_DAYMONTH_TAG   ,
        :OLD.RT_FIXRATE_TAG    ,
        :OLD.PREDIS_TAG        ,
        :OLD.PROXY_TAG         ,
        :OLD.TRUST_TAG         ,
        :OLD.PRINT_YN          ,
        :OLD.RT_FIXRATE_DAY    ,
        :OLD.RT_FIXRATE        ,
        :OLD.VIRDEPOSIT2_YN    ,
        :OLD.VIRBANK2_CODE     ,
        :OLD.RT_FIXRATE2       ,
        :OLD.RT_EXTRATE        ,
        :OLD.RT_GURTYN         ,
        :OLD.RT_RENTYN         ,
        :OLD.ONCESALERATE      ,
        :OLD.DELAY_BLOCK
   );     
end; 

/





ALTER TRIGGER TUA_HD_CODE_HOUSE
	ENABLE;




CREATE  OR REPLACE  TRIGGER TDA_HD_CODE_HOUSE
 AFTER DELETE
 ON HD_CODE_HOUSE
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
declare numrows INTEGER;
begin
   INSERT INTO HD_CODE_HOUSE_HIST
   (    HIST_DATE         ,
        DEPT_CODE         ,
        HOUSETAG          ,
        HOUSEDATE         ,
        COMPLETIONDATE    ,
        HOUSE_CNT         ,
        MOVEINSTARTDATE   ,
        MOVEINENDDATE     ,
        PENALTYRATE       ,
        HIC_TAG           ,
        TIRM_RATE         ,
        SODUK_RATE        ,
        JUMIN_RATE        ,
        DAMDANG           ,
        DAMDANG_TEL       ,
        PRINT_CNT         ,
        RESELL_TAG        ,
        VIRDEPOSIT_YN     ,
        VIRBANK_CODE      ,
        DEPT_ADDR_USE_YN  ,
        CONT_PBL_NAME     ,
        CONT_DW_NAME      ,
        REMARK            ,
        INPUT_DUTY_ID     ,
        INPUT_DATE        ,
        CHG_DUTY_ID       ,
        CHG_DATE          ,
        CONT_PBL_NAME2    ,
        CONT_DW_NAME2     ,
        CONT_PBL_NAME3    ,
        CONT_DW_NAME3     ,
        SLIPGROUP         ,
        TRI_TAG           ,
		APPLY_CHECK_YN    ,
        ANNE1A_PBL        ,
        ANNE1A_DW         ,
        ANNE1B_PBL        ,
        ANNE1B_DW         ,
        ANNE2A_PBL        ,
        ANNE2A_DW         ,
        ANNE2B_PBL        ,
        ANNE2B_DW         ,
        ANNE3_PBL         ,
        ANNE3_DW          ,
        ANNE4_PBL         ,
        ANNE4_DW          ,
        DELAYDAY          ,
        DELAYRATE         ,
        AGREE_TAG         ,
        INDEMINITY_TAG    ,
        INDEMINITY_FRDT   ,
        INDEMINITY_TODT   ,
        SEALTYPE          ,
        JIRO_TAG          ,
        JIRO_SN           ,
        HD_DAYMONTH_TAG   ,
        RT_DAYMONTH_TAG   ,
        RT_FIXRATE_TAG    ,
        PREDIS_TAG        ,
        PROXY_TAG         ,
        TRUST_TAG         ,
        PRINT_YN          ,
        RT_FIXRATE_DAY    ,
        RT_FIXRATE        ,
        VIRDEPOSIT2_YN    ,
        VIRBANK2_CODE     ,
        RT_FIXRATE2       ,
        RT_EXTRATE        ,
        RT_GURTYN         ,
        RT_RENTYN         ,
        ONCESALERATE
   )
   VALUES
   (    SYSDATE                ,
        :OLD.DEPT_CODE         ,
        :OLD.HOUSETAG          ,
        :OLD.HOUSEDATE         ,
        :OLD.COMPLETIONDATE    ,
        :OLD.HOUSE_CNT         ,
        :OLD.MOVEINSTARTDATE   ,
        :OLD.MOVEINENDDATE     ,
        :OLD.PENALTYRATE       ,
        :OLD.HIC_TAG           ,
        :OLD.TIRM_RATE         ,
        :OLD.SODUK_RATE        ,
        :OLD.JUMIN_RATE        ,
        :OLD.DAMDANG           ,
        :OLD.DAMDANG_TEL       ,
        :OLD.PRINT_CNT         ,
        :OLD.RESELL_TAG        ,
        :OLD.VIRDEPOSIT_YN     ,
        :OLD.VIRBANK_CODE      ,
        :OLD.DEPT_ADDR_USE_YN  ,
        :OLD.CONT_PBL_NAME     ,
        :OLD.CONT_DW_NAME      ,
        :OLD.REMARK            ,
        :OLD.INPUT_DUTY_ID     ,
        :OLD.INPUT_DATE        ,
        :OLD.CHG_DUTY_ID       ,
        :OLD.CHG_DATE          ,
        :OLD.CONT_PBL_NAME2    ,
        :OLD.CONT_DW_NAME2     ,
        :OLD.CONT_PBL_NAME3    ,
        :OLD.CONT_DW_NAME3     ,
        :OLD.SLIPGROUP         ,
        'D'                    ,
		:OLD.APPLY_CHECK_YN    ,
        :OLD.ANNE1A_PBL        ,
        :OLD.ANNE1A_DW         ,
        :OLD.ANNE1B_PBL        ,
        :OLD.ANNE1B_DW         ,
        :OLD.ANNE2A_PBL        ,
        :OLD.ANNE2A_DW         ,
        :OLD.ANNE2B_PBL        ,
        :OLD.ANNE2B_DW         ,
        :OLD.ANNE3_PBL         ,
        :OLD.ANNE3_DW          ,
        :OLD.ANNE4_PBL         ,
        :OLD.ANNE4_DW          ,
        :OLD.DELAYDAY          ,
        :OLD.DELAYRATE         ,
        :OLD.AGREE_TAG         ,
        :OLD.INDEMINITY_TAG    ,
        :OLD.INDEMINITY_FRDT   ,
        :OLD.INDEMINITY_TODT   ,
        :OLD.SEALTYPE          ,
        :OLD.JIRO_TAG          ,
        :OLD.JIRO_SN           ,
        :OLD.HD_DAYMONTH_TAG   ,
        :OLD.RT_DAYMONTH_TAG   ,
        :OLD.RT_FIXRATE_TAG    ,
        :OLD.PREDIS_TAG        ,
        :OLD.PROXY_TAG         ,
        :OLD.TRUST_TAG         ,
        :OLD.PRINT_YN          ,
        :OLD.RT_FIXRATE_DAY    ,
        :OLD.RT_FIXRATE        ,
        :OLD.VIRDEPOSIT2_YN    ,
        :OLD.VIRBANK2_CODE     ,
        :OLD.RT_FIXRATE2       ,
        :OLD.RT_EXTRATE        ,
        :OLD.RT_GURTYN         ,
        :OLD.RT_RENTYN         ,
        :OLD.ONCESALERATE
   );
end;


/





ALTER TRIGGER TDA_HD_CODE_HOUSE
	ENABLE;




CREATE  OR REPLACE  TRIGGER TUA_HD_CODE_HOUSE
 AFTER UPDATE
 ON HD_CODE_HOUSE
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
declare numrows INTEGER;
begin
   INSERT INTO HD_CODE_HOUSE_HIST
   (    HIST_DATE         ,
        DEPT_CODE         ,
        HOUSETAG          ,
        HOUSEDATE         ,
        COMPLETIONDATE    ,
        HOUSE_CNT         ,
        MOVEINSTARTDATE   ,
        MOVEINENDDATE     ,
        PENALTYRATE       ,
        HIC_TAG           ,
        TIRM_RATE         ,
        SODUK_RATE        ,
        JUMIN_RATE        ,
        DAMDANG           ,
        DAMDANG_TEL       ,
        PRINT_CNT         ,
        RESELL_TAG        ,
        VIRDEPOSIT_YN     ,
        VIRBANK_CODE      ,
        DEPT_ADDR_USE_YN  ,
        CONT_PBL_NAME     ,
        CONT_DW_NAME      ,
        REMARK            ,
        INPUT_DUTY_ID     ,
        INPUT_DATE        ,
        CHG_DUTY_ID       ,
        CHG_DATE          ,
        CONT_PBL_NAME2    ,
        CONT_DW_NAME2     ,
        CONT_PBL_NAME3    ,
        CONT_DW_NAME3     ,
        SLIPGROUP         ,
        TRI_TAG           ,
		APPLY_CHECK_YN    ,
        ANNE1A_PBL        ,
        ANNE1A_DW         ,
        ANNE1B_PBL        ,
        ANNE1B_DW         ,
        ANNE2A_PBL        ,
        ANNE2A_DW         ,
        ANNE2B_PBL        ,
        ANNE2B_DW         ,
        ANNE3_PBL         ,
        ANNE3_DW          ,
        ANNE4_PBL         ,
        ANNE4_DW          ,
        DELAYDAY          ,
        DELAYRATE         ,
        AGREE_TAG         ,
        INDEMINITY_TAG    ,
        INDEMINITY_FRDT   ,
        INDEMINITY_TODT   ,
        SEALTYPE          ,
        JIRO_TAG          ,
        JIRO_SN           ,
        HD_DAYMONTH_TAG   ,
        RT_DAYMONTH_TAG   ,
        RT_FIXRATE_TAG    ,
        PREDIS_TAG        ,
        PROXY_TAG         ,
        TRUST_TAG         ,
        PRINT_YN          ,
        RT_FIXRATE_DAY    ,
        RT_FIXRATE        ,
        VIRDEPOSIT2_YN    ,
        VIRBANK2_CODE     ,
        RT_FIXRATE2       ,
        RT_EXTRATE        ,
        RT_GURTYN         ,
        RT_RENTYN         ,
        ONCESALERATE
   )
   VALUES
   (    SYSDATE                ,
        :OLD.DEPT_CODE         ,
        :OLD.HOUSETAG          ,
        :OLD.HOUSEDATE         ,
        :OLD.COMPLETIONDATE    ,
        :OLD.HOUSE_CNT         ,
        :OLD.MOVEINSTARTDATE   ,
        :OLD.MOVEINENDDATE     ,
        :OLD.PENALTYRATE       ,
        :OLD.HIC_TAG           ,
        :OLD.TIRM_RATE         ,
        :OLD.SODUK_RATE        ,
        :OLD.JUMIN_RATE        ,
        :OLD.DAMDANG           ,
        :OLD.DAMDANG_TEL       ,
        :OLD.PRINT_CNT         ,
        :OLD.RESELL_TAG        ,
        :OLD.VIRDEPOSIT_YN     ,
        :OLD.VIRBANK_CODE      ,
        :OLD.DEPT_ADDR_USE_YN  ,
        :OLD.CONT_PBL_NAME     ,
        :OLD.CONT_DW_NAME      ,
        :OLD.REMARK            ,
        :OLD.INPUT_DUTY_ID     ,
        :OLD.INPUT_DATE        ,
        :OLD.CHG_DUTY_ID       ,
        :OLD.CHG_DATE          ,
        :OLD.CONT_PBL_NAME2    ,
        :OLD.CONT_DW_NAME2     ,
        :OLD.CONT_PBL_NAME3    ,
        :OLD.CONT_DW_NAME3     ,
        :OLD.SLIPGROUP         ,
        'U'                    ,
		:OLD.APPLY_CHECK_YN    ,
		:OLD.ANNE1A_PBL        ,
		:OLD.ANNE1A_DW         ,
		:OLD.ANNE1B_PBL        ,
		:OLD.ANNE1B_DW         ,
		:OLD.ANNE2A_PBL        ,
		:OLD.ANNE2A_DW         ,
		:OLD.ANNE2B_PBL        ,
		:OLD.ANNE2B_DW         ,
		:OLD.ANNE3_PBL         ,
		:OLD.ANNE3_DW          ,
		:OLD.ANNE4_PBL         ,
		:OLD.ANNE4_DW          ,
		:OLD.DELAYDAY          ,
		:OLD.DELAYRATE         ,
		:OLD.AGREE_TAG         ,
		:OLD.INDEMINITY_TAG    ,
		:OLD.INDEMINITY_FRDT   ,
		:OLD.INDEMINITY_TODT   ,
		:OLD.SEALTYPE          ,
		:OLD.JIRO_TAG          ,
		:OLD.JIRO_SN           ,
		:OLD.HD_DAYMONTH_TAG   ,
		:OLD.RT_DAYMONTH_TAG   ,
		:OLD.RT_FIXRATE_TAG    ,
		:OLD.PREDIS_TAG        ,
        :OLD.PROXY_TAG         ,
        :OLD.TRUST_TAG         ,
        :OLD.PRINT_YN          ,
        :OLD.RT_FIXRATE_DAY    ,
        :OLD.RT_FIXRATE        ,
        :OLD.VIRDEPOSIT2_YN    ,
        :OLD.VIRBANK2_CODE     ,
        :OLD.RT_FIXRATE2       ,
        :OLD.RT_EXTRATE        ,
        :OLD.RT_GURTYN         ,
        :OLD.RT_RENTYN         ,
        :OLD.ONCESALERATE
   );     
end;


/





ALTER TRIGGER TUA_HD_CODE_HOUSE
	ENABLE;




CREATE  OR REPLACE  TRIGGER TH_HD_CODE_SIHANG
 AFTER DELETE OR UPDATE
 ON HD_CODE_SIHANG
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE
/******************************************/
/***** HIST  DATA INSERT ************/
/******************************************/
   vTag VARCHAR2(1);
BEGIN

   IF UPDATING THEN
      vTag := 'U';
   ELSE
      vTag := 'D';
   END IF;

   INSERT INTO HD_CODE_SIHANG_HIST
   ( HIST_DATE,
     DEPT_CODE,
     SEQ,
     SIHANG_VENDOR,
     SIHANG_DEPYO,
     SIHANG_UPTE,
     SIHANG_UPJONG,
     SIHANG_ZIP,
     SIHANG_ADDR1,
     SIHANG_ADDR2,
     INPUT_DUTY_ID,
     INPUT_DATE,
     CHG_DUTY_ID,
     SIHANG_NAME,
     CHG_DATE,
     SIHANG_ZIP_ORG,
     SIHANG_ADDR1_ORG,
     SIHANG_ADDR2_ORG,
     SIHANG_ADDR_TAG,
     TRI_TAG )
   VALUES
   (  SYSTIMESTAMP  ,
       :OLD.DEPT_CODE,
       :OLD.SEQ,
       :OLD.SIHANG_VENDOR,
       :OLD.SIHANG_DEPYO,
       :OLD.SIHANG_UPTE,
       :OLD.SIHANG_UPJONG,
       :OLD.SIHANG_ZIP,
       :OLD.SIHANG_ADDR1,
       :OLD.SIHANG_ADDR2,
       :OLD.INPUT_DUTY_ID,
       :OLD.INPUT_DATE,
       :OLD.CHG_DUTY_ID,
       :OLD.SIHANG_NAME,
       :OLD.CHG_DATE,
       :OLD.SIHANG_ZIP_ORG,
       :OLD.SIHANG_ADDR1_ORG,
       :OLD.SIHANG_ADDR2_ORG,
       :OLD.SIHANG_ADDR_TAG,
       vTag );
END;

/





ALTER TRIGGER TH_HD_CODE_SIHANG
	ENABLE;




CREATE  OR REPLACE  TRIGGER TDA_HD_HOUS_INCOME
 AFTER DELETE
 ON HD_HOUS_INCOME
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

BEGIN
   SELECT NVL(MAX(WRITESEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_INCOME_LOG
    WHERE CUST_CODE = :OLD.CUST_CODE
      AND SEQ       = :OLD.SEQ
      AND COUNTS    = :OLD.COUNTS
      AND TIMES     = :OLD.TIMES;

   INSERT INTO HD_HOUS_INCOME_LOG
             ( CUST_CODE,             SEQ,                COUNTS,              TIMES,
               WRITETAG,              WRITETIME,
               WRITESEQ,              DEPT_CODE,
               HOUSETAG,              BUILDNO,            HOUSENO,             DEPOSIT_NO,
               RECEIPTDATE,           RECEIPTAMT,         RECEIPTLANDAMT,      RECEIPTBUILDAMT,
               RECEIPTVATAMT,         DELAYDAYS,          DELAYAMT,            DISCNTDAYS,
               DISCNTAMT,             REALINCOMAMT,       REALLANDAMT,         REALBUILDAMT,
               REALVATAMT,            BANK_CODE,          BANK_NAME,           PAYTAG,
               INCOMTYPE,             MOD_YN,             REAL_PAY_TAG,        SLIPDT,
               SLIPSEQ,               TAXDATE,            TAXSEQ,              INSEQ,
               INPUT_DUTY_ID,         INPUT_DATE,         CHG_DUTY_ID,         CHG_DATE,
               SLIPTYPE,              VDEPOSIT_NO,        DETAILMOD_YN,        OUT_DT,
               OUT_TM,                OUT_SEQ,            OUT_BANK,            REMARK,
               RECEIPTMANAGEAMT,      REALMANAGEAMT,      CDNO,                CD_BANK,
               CD_EDATE,              CD_STYPE
            )
     VALUES ( :OLD.CUST_CODE,        :OLD.SEQ,           :OLD.COUNTS,         :OLD.TIMES,
              'D',                    TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),
               NEWSEQ,               :OLD.DEPT_CODE,
              :OLD.HOUSETAG,         :OLD.BUILDNO,       :OLD.HOUSENO,        :OLD.DEPOSIT_NO,
              :OLD.RECEIPTDATE,      :OLD.RECEIPTAMT,    :OLD.RECEIPTLANDAMT, :OLD.RECEIPTBUILDAMT,
              :OLD.RECEIPTVATAMT,    :OLD.DELAYDAYS,     :OLD.DELAYAMT,       :OLD.DISCNTDAYS,
              :OLD.DISCNTAMT,        :OLD.REALINCOMAMT,  :OLD.REALLANDAMT,    :OLD.REALBUILDAMT,
              :OLD.REALVATAMT,       :OLD.BANK_CODE,     :OLD.BANK_NAME,      :OLD.PAYTAG,
              :OLD.INCOMTYPE,        :OLD.MOD_YN,        :OLD.REAL_PAY_TAG,   :OLD.SLIPDT,
              :OLD.SLIPSEQ,          :OLD.TAXDATE,       :OLD.TAXSEQ,         :OLD.INSEQ,
              :OLD.INPUT_DUTY_ID,    :OLD.INPUT_DATE,    :OLD.CHG_DUTY_ID,    :OLD.CHG_DATE,
              :OLD.SLIPTYPE,         :OLD.VDEPOSIT_NO,   :OLD.DETAILMOD_YN,   :OLD.OUT_DT,
              :OLD.OUT_TM,           :OLD.OUT_SEQ,       :OLD.OUT_BANK,       :OLD.REMARK,
              :OLD.RECEIPTMANAGEAMT, :OLD.REALMANAGEAMT, :OLD.CDNO,           :OLD.CD_BANK,
              :OLD.CD_EDATE,         :OLD.CD_STYPE
            );
END;


/





ALTER TRIGGER TDA_HD_HOUS_INCOME
	ENABLE;




CREATE  OR REPLACE  TRIGGER TIA_HD_HOUS_INCOME
 AFTER INSERT
 ON HD_HOUS_INCOME
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

BEGIN
   SELECT NVL(MAX(WRITESEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_INCOME_LOG
    WHERE CUST_CODE = :NEW.CUST_CODE
      AND SEQ       = :NEW.SEQ
      AND COUNTS    = :NEW.COUNTS
      AND TIMES     = :NEW.TIMES;

   INSERT INTO HD_HOUS_INCOME_LOG
             ( CUST_CODE,             SEQ,                COUNTS,              TIMES,
               WRITETAG,              WRITETIME,
               WRITESEQ,              DEPT_CODE,
               HOUSETAG,              BUILDNO,            HOUSENO,             DEPOSIT_NO,
               RECEIPTDATE,           RECEIPTAMT,         RECEIPTLANDAMT,      RECEIPTBUILDAMT,
               RECEIPTVATAMT,         DELAYDAYS,          DELAYAMT,            DISCNTDAYS,
               DISCNTAMT,             REALINCOMAMT,       REALLANDAMT,         REALBUILDAMT,
               REALVATAMT,            BANK_CODE,          BANK_NAME,           PAYTAG,
               INCOMTYPE,             MOD_YN,             REAL_PAY_TAG,        SLIPDT,
               SLIPSEQ,               TAXDATE,            TAXSEQ,              INSEQ,
               INPUT_DUTY_ID,         INPUT_DATE,         CHG_DUTY_ID,         CHG_DATE,
               SLIPTYPE,              VDEPOSIT_NO,        DETAILMOD_YN,        OUT_DT,
               OUT_TM,                OUT_SEQ,            OUT_BANK,            REMARK,
               RECEIPTMANAGEAMT,      REALMANAGEAMT,      CDNO,                CD_BANK,
               CD_EDATE,              CD_STYPE
            )
     VALUES ( :NEW.CUST_CODE,        :NEW.SEQ,           :NEW.COUNTS,         :NEW.TIMES,
              'I',                    TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),
               NEWSEQ,               :NEW.DEPT_CODE,
              :NEW.HOUSETAG,         :NEW.BUILDNO,       :NEW.HOUSENO,        :NEW.DEPOSIT_NO,
              :NEW.RECEIPTDATE,      :NEW.RECEIPTAMT,    :NEW.RECEIPTLANDAMT, :NEW.RECEIPTBUILDAMT,
              :NEW.RECEIPTVATAMT,    :NEW.DELAYDAYS,     :NEW.DELAYAMT,       :NEW.DISCNTDAYS,
              :NEW.DISCNTAMT,        :NEW.REALINCOMAMT,  :NEW.REALLANDAMT,    :NEW.REALBUILDAMT,
              :NEW.REALVATAMT,       :NEW.BANK_CODE,     :NEW.BANK_NAME,      :NEW.PAYTAG,
              :NEW.INCOMTYPE,        :NEW.MOD_YN,        :NEW.REAL_PAY_TAG,   :NEW.SLIPDT,
              :NEW.SLIPSEQ,          :NEW.TAXDATE,       :NEW.TAXSEQ,         :NEW.INSEQ,
              :NEW.INPUT_DUTY_ID,    :NEW.INPUT_DATE,    :NEW.CHG_DUTY_ID,    :NEW.CHG_DATE,
              :NEW.SLIPTYPE,         :NEW.VDEPOSIT_NO,   :NEW.DETAILMOD_YN,   :NEW.OUT_DT,
              :NEW.OUT_TM,           :NEW.OUT_SEQ,       :NEW.OUT_BANK,       :NEW.REMARK,
              :NEW.RECEIPTMANAGEAMT, :NEW.REALMANAGEAMT, :NEW.CDNO,           :NEW.CD_BANK,
              :NEW.CD_EDATE,         :NEW.CD_STYPE
             );
END;


/





ALTER TRIGGER TIA_HD_HOUS_INCOME
	ENABLE;




CREATE  OR REPLACE  TRIGGER TUA_HD_HOUS_INCOME
 AFTER UPDATE
 ON HD_HOUS_INCOME
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

BEGIN
   SELECT NVL(MAX(WRITESEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_INCOME_LOG
    WHERE CUST_CODE = :NEW.CUST_CODE
      AND SEQ       = :NEW.SEQ
      AND COUNTS    = :NEW.COUNTS
      AND TIMES     = :NEW.TIMES;

   INSERT INTO HD_HOUS_INCOME_LOG
             ( CUST_CODE,          SEQ,               COUNTS,              TIMES,
               WRITETAG,           WRITETIME,
               WRITESEQ,           DEPT_CODE,
               HOUSETAG,           BUILDNO,           HOUSENO,             DEPOSIT_NO,
               RECEIPTDATE,        RECEIPTAMT,        RECEIPTLANDAMT,      RECEIPTBUILDAMT,
               RECEIPTVATAMT,      DELAYDAYS,         DELAYAMT,            DISCNTDAYS,
               DISCNTAMT,          REALINCOMAMT,      REALLANDAMT,         REALBUILDAMT,
               REALVATAMT,         BANK_CODE,         BANK_NAME,           PAYTAG,
               INCOMTYPE,          MOD_YN,            REAL_PAY_TAG,        SLIPDT,
               SLIPSEQ,            TAXDATE,           TAXSEQ,              INSEQ,
               INPUT_DUTY_ID,      INPUT_DATE,        CHG_DUTY_ID,         CHG_DATE,
               SLIPTYPE,           VDEPOSIT_NO,       DETAILMOD_YN,        OUT_DT,
               OUT_TM,             OUT_SEQ,           OUT_BANK,            REMARK
            )
     VALUES ( :NEW.CUST_CODE,     :NEW.SEQ,          :NEW.COUNTS,         :NEW.TIMES,
              'U',                 TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),
               NEWSEQ,            :NEW.DEPT_CODE,
              :NEW.HOUSETAG,      :NEW.BUILDNO,      :NEW.HOUSENO,        :NEW.DEPOSIT_NO,
              :NEW.RECEIPTDATE,   :NEW.RECEIPTAMT,   :NEW.RECEIPTLANDAMT, :NEW.RECEIPTBUILDAMT,
              :NEW.RECEIPTVATAMT, :NEW.DELAYDAYS,    :NEW.DELAYAMT,       :NEW.DISCNTDAYS,
              :NEW.DISCNTAMT,     :NEW.REALINCOMAMT, :NEW.REALLANDAMT,    :NEW.REALBUILDAMT,
              :NEW.REALVATAMT,    :NEW.BANK_CODE,    :NEW.BANK_NAME,      :NEW.PAYTAG,
              :NEW.INCOMTYPE,     :NEW.MOD_YN,       :NEW.REAL_PAY_TAG,   :NEW.SLIPDT,
              :NEW.SLIPSEQ,       :NEW.TAXDATE,      :NEW.TAXSEQ,         :NEW.INSEQ,
              :NEW.INPUT_DUTY_ID, :NEW.INPUT_DATE,   :NEW.CHG_DUTY_ID,    :NEW.CHG_DATE,
              :NEW.SLIPTYPE,      :NEW.VDEPOSIT_NO,  :NEW.DETAILMOD_YN,   :NEW.OUT_DT,
              :NEW.OUT_TM,        :NEW.OUT_SEQ,      :NEW.OUT_BANK,       :NEW.REMARK
            );
END;


/





ALTER TRIGGER TUA_HD_HOUS_INCOME
	ENABLE;




CREATE  OR REPLACE  TRIGGER TDA_HD_HOUS_INCOME
 AFTER DELETE
 ON HD_HOUS_INCOME
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

BEGIN
   SELECT NVL(MAX(WRITESEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_INCOME_LOG
    WHERE CUST_CODE = :OLD.CUST_CODE
      AND SEQ       = :OLD.SEQ
      AND COUNTS    = :OLD.COUNTS
      AND TIMES     = :OLD.TIMES;

   INSERT INTO HD_HOUS_INCOME_LOG
             ( CUST_CODE,             SEQ,                COUNTS,              TIMES,
               WRITETAG,              WRITETIME,
               WRITESEQ,              DEPT_CODE,
               HOUSETAG,              BUILDNO,            HOUSENO,             DEPOSIT_NO,
               RECEIPTDATE,           RECEIPTAMT,         RECEIPTLANDAMT,      RECEIPTBUILDAMT,
               RECEIPTVATAMT,         DELAYDAYS,          DELAYAMT,            DISCNTDAYS,
               DISCNTAMT,             REALINCOMAMT,       REALLANDAMT,         REALBUILDAMT,
               REALVATAMT,            BANK_CODE,          BANK_NAME,           PAYTAG,
               INCOMTYPE,             MOD_YN,             REAL_PAY_TAG,        SLIPDT,
               SLIPSEQ,               TAXDATE,            TAXSEQ,              INSEQ,
               INPUT_DUTY_ID,         INPUT_DATE,         CHG_DUTY_ID,         CHG_DATE,
               SLIPTYPE,              VDEPOSIT_NO,        DETAILMOD_YN,        OUT_DT,
               OUT_TM,                OUT_SEQ,            OUT_BANK,            REMARK,
               RECEIPTMANAGEAMT,      REALMANAGEAMT,      CDNO,                CD_BANK,
               CD_EDATE,              CD_STYPE
            )
     VALUES ( :OLD.CUST_CODE,        :OLD.SEQ,           :OLD.COUNTS,         :OLD.TIMES,
              'D',                    TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),
               NEWSEQ,               :OLD.DEPT_CODE,
              :OLD.HOUSETAG,         :OLD.BUILDNO,       :OLD.HOUSENO,        :OLD.DEPOSIT_NO,
              :OLD.RECEIPTDATE,      :OLD.RECEIPTAMT,    :OLD.RECEIPTLANDAMT, :OLD.RECEIPTBUILDAMT,
              :OLD.RECEIPTVATAMT,    :OLD.DELAYDAYS,     :OLD.DELAYAMT,       :OLD.DISCNTDAYS,
              :OLD.DISCNTAMT,        :OLD.REALINCOMAMT,  :OLD.REALLANDAMT,    :OLD.REALBUILDAMT,
              :OLD.REALVATAMT,       :OLD.BANK_CODE,     :OLD.BANK_NAME,      :OLD.PAYTAG,
              :OLD.INCOMTYPE,        :OLD.MOD_YN,        :OLD.REAL_PAY_TAG,   :OLD.SLIPDT,
              :OLD.SLIPSEQ,          :OLD.TAXDATE,       :OLD.TAXSEQ,         :OLD.INSEQ,
              :OLD.INPUT_DUTY_ID,    :OLD.INPUT_DATE,    :OLD.CHG_DUTY_ID,    :OLD.CHG_DATE,
              :OLD.SLIPTYPE,         :OLD.VDEPOSIT_NO,   :OLD.DETAILMOD_YN,   :OLD.OUT_DT,
              :OLD.OUT_TM,           :OLD.OUT_SEQ,       :OLD.OUT_BANK,       :OLD.REMARK,
              :OLD.RECEIPTMANAGEAMT, :OLD.REALMANAGEAMT, :OLD.CDNO,           :OLD.CD_BANK,
              :OLD.CD_EDATE,         :OLD.CD_STYPE
            );
END;


/





ALTER TRIGGER TDA_HD_HOUS_INCOME
	ENABLE;




CREATE  OR REPLACE  TRIGGER TIA_HD_HOUS_INCOME
 AFTER INSERT
 ON HD_HOUS_INCOME
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

BEGIN
   SELECT NVL(MAX(WRITESEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_INCOME_LOG
    WHERE CUST_CODE = :NEW.CUST_CODE
      AND SEQ       = :NEW.SEQ
      AND COUNTS    = :NEW.COUNTS
      AND TIMES     = :NEW.TIMES;

   INSERT INTO HD_HOUS_INCOME_LOG
             ( CUST_CODE,             SEQ,                COUNTS,              TIMES,
               WRITETAG,              WRITETIME,
               WRITESEQ,              DEPT_CODE,
               HOUSETAG,              BUILDNO,            HOUSENO,             DEPOSIT_NO,
               RECEIPTDATE,           RECEIPTAMT,         RECEIPTLANDAMT,      RECEIPTBUILDAMT,
               RECEIPTVATAMT,         DELAYDAYS,          DELAYAMT,            DISCNTDAYS,
               DISCNTAMT,             REALINCOMAMT,       REALLANDAMT,         REALBUILDAMT,
               REALVATAMT,            BANK_CODE,          BANK_NAME,           PAYTAG,
               INCOMTYPE,             MOD_YN,             REAL_PAY_TAG,        SLIPDT,
               SLIPSEQ,               TAXDATE,            TAXSEQ,              INSEQ,
               INPUT_DUTY_ID,         INPUT_DATE,         CHG_DUTY_ID,         CHG_DATE,
               SLIPTYPE,              VDEPOSIT_NO,        DETAILMOD_YN,        OUT_DT,
               OUT_TM,                OUT_SEQ,            OUT_BANK,            REMARK,
               RECEIPTMANAGEAMT,      REALMANAGEAMT,      CDNO,                CD_BANK,
               CD_EDATE,              CD_STYPE
            )
     VALUES ( :NEW.CUST_CODE,        :NEW.SEQ,           :NEW.COUNTS,         :NEW.TIMES,
              'I',                    TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),
               NEWSEQ,               :NEW.DEPT_CODE,
              :NEW.HOUSETAG,         :NEW.BUILDNO,       :NEW.HOUSENO,        :NEW.DEPOSIT_NO,
              :NEW.RECEIPTDATE,      :NEW.RECEIPTAMT,    :NEW.RECEIPTLANDAMT, :NEW.RECEIPTBUILDAMT,
              :NEW.RECEIPTVATAMT,    :NEW.DELAYDAYS,     :NEW.DELAYAMT,       :NEW.DISCNTDAYS,
              :NEW.DISCNTAMT,        :NEW.REALINCOMAMT,  :NEW.REALLANDAMT,    :NEW.REALBUILDAMT,
              :NEW.REALVATAMT,       :NEW.BANK_CODE,     :NEW.BANK_NAME,      :NEW.PAYTAG,
              :NEW.INCOMTYPE,        :NEW.MOD_YN,        :NEW.REAL_PAY_TAG,   :NEW.SLIPDT,
              :NEW.SLIPSEQ,          :NEW.TAXDATE,       :NEW.TAXSEQ,         :NEW.INSEQ,
              :NEW.INPUT_DUTY_ID,    :NEW.INPUT_DATE,    :NEW.CHG_DUTY_ID,    :NEW.CHG_DATE,
              :NEW.SLIPTYPE,         :NEW.VDEPOSIT_NO,   :NEW.DETAILMOD_YN,   :NEW.OUT_DT,
              :NEW.OUT_TM,           :NEW.OUT_SEQ,       :NEW.OUT_BANK,       :NEW.REMARK,
              :NEW.RECEIPTMANAGEAMT, :NEW.REALMANAGEAMT, :NEW.CDNO,           :NEW.CD_BANK,
              :NEW.CD_EDATE,         :NEW.CD_STYPE
             );
END;


/





ALTER TRIGGER TIA_HD_HOUS_INCOME
	ENABLE;




CREATE  OR REPLACE  TRIGGER TUA_HD_HOUS_INCOME
 AFTER UPDATE
 ON HD_HOUS_INCOME
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

BEGIN
   SELECT NVL(MAX(WRITESEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_INCOME_LOG
    WHERE CUST_CODE = :NEW.CUST_CODE
      AND SEQ       = :NEW.SEQ
      AND COUNTS    = :NEW.COUNTS
      AND TIMES     = :NEW.TIMES;

   INSERT INTO HD_HOUS_INCOME_LOG
             ( CUST_CODE,          SEQ,               COUNTS,              TIMES,
               WRITETAG,           WRITETIME,
               WRITESEQ,           DEPT_CODE,
               HOUSETAG,           BUILDNO,           HOUSENO,             DEPOSIT_NO,
               RECEIPTDATE,        RECEIPTAMT,        RECEIPTLANDAMT,      RECEIPTBUILDAMT,
               RECEIPTVATAMT,      DELAYDAYS,         DELAYAMT,            DISCNTDAYS,
               DISCNTAMT,          REALINCOMAMT,      REALLANDAMT,         REALBUILDAMT,
               REALVATAMT,         BANK_CODE,         BANK_NAME,           PAYTAG,
               INCOMTYPE,          MOD_YN,            REAL_PAY_TAG,        SLIPDT,
               SLIPSEQ,            TAXDATE,           TAXSEQ,              INSEQ,
               INPUT_DUTY_ID,      INPUT_DATE,        CHG_DUTY_ID,         CHG_DATE,
               SLIPTYPE,           VDEPOSIT_NO,       DETAILMOD_YN,        OUT_DT,
               OUT_TM,             OUT_SEQ,           OUT_BANK,            REMARK
            )
     VALUES ( :NEW.CUST_CODE,     :NEW.SEQ,          :NEW.COUNTS,         :NEW.TIMES,
              'U',                 TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),
               NEWSEQ,            :NEW.DEPT_CODE,
              :NEW.HOUSETAG,      :NEW.BUILDNO,      :NEW.HOUSENO,        :NEW.DEPOSIT_NO,
              :NEW.RECEIPTDATE,   :NEW.RECEIPTAMT,   :NEW.RECEIPTLANDAMT, :NEW.RECEIPTBUILDAMT,
              :NEW.RECEIPTVATAMT, :NEW.DELAYDAYS,    :NEW.DELAYAMT,       :NEW.DISCNTDAYS,
              :NEW.DISCNTAMT,     :NEW.REALINCOMAMT, :NEW.REALLANDAMT,    :NEW.REALBUILDAMT,
              :NEW.REALVATAMT,    :NEW.BANK_CODE,    :NEW.BANK_NAME,      :NEW.PAYTAG,
              :NEW.INCOMTYPE,     :NEW.MOD_YN,       :NEW.REAL_PAY_TAG,   :NEW.SLIPDT,
              :NEW.SLIPSEQ,       :NEW.TAXDATE,      :NEW.TAXSEQ,         :NEW.INSEQ,
              :NEW.INPUT_DUTY_ID, :NEW.INPUT_DATE,   :NEW.CHG_DUTY_ID,    :NEW.CHG_DATE,
              :NEW.SLIPTYPE,      :NEW.VDEPOSIT_NO,  :NEW.DETAILMOD_YN,   :NEW.OUT_DT,
              :NEW.OUT_TM,        :NEW.OUT_SEQ,      :NEW.OUT_BANK,       :NEW.REMARK
            );
END;


/





ALTER TRIGGER TUA_HD_HOUS_INCOME
	ENABLE;




CREATE  OR REPLACE  TRIGGER TDA_HD_HOUS_RATE_DELAY
 AFTER DELETE
 ON HD_HOUS_RATE_DELAY
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

BEGIN
   SELECT NVL(MAX(WRITESEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_RATE_DELAY_LOG
    WHERE CUST_CODE  = :OLD.CUST_CODE
      AND SEQ        = :OLD.SEQ
      AND START_DAYS = :OLD.START_DAYS
      AND END_DAYS   = :OLD.END_DAYS
      AND STARTDATE  = :OLD.STARTDATE;

   INSERT INTO HD_HOUS_RATE_DELAY_LOG
             ( CUST_CODE,       SEQ,              START_DAYS,       END_DAYS,
               STARTDATE,       WRITETAG,         WRITETIME,
               WRITESEQ,        ENDDATE,          DELAYRATE,        DELAYCUT,
               DELAYUNIT,       START_TAG,        END_TAG,          INPUT_DUTY_ID,
               INPUT_DATE,      CHG_DUTY_ID,      CHG_DATE )
      VALUES (:OLD.CUST_CODE,  :OLD.SEQ,         :OLD.START_DAYS,  :OLD.END_DAYS,
              :OLD.STARTDATE,  'D',               TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),
               NEWSEQ,         :OLD.ENDDATE,     :OLD.DELAYRATE,   :OLD.DELAYCUT,
              :OLD.DELAYUNIT,  :OLD.START_TAG,   :OLD.END_TAG,     :OLD.INPUT_DUTY_ID,
              :OLD.INPUT_DATE, :OLD.CHG_DUTY_ID, :OLD.CHG_DATE);
END;


/





ALTER TRIGGER TDA_HD_HOUS_RATE_DELAY
	ENABLE;




CREATE  OR REPLACE  TRIGGER TIA_HD_HOUS_RATE_DELAY
 AFTER INSERT
 ON HD_HOUS_RATE_DELAY
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

BEGIN
   SELECT NVL(MAX(WRITESEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_RATE_DELAY_LOG
    WHERE CUST_CODE  = :NEW.CUST_CODE
      AND SEQ        = :NEW.SEQ
      AND START_DAYS = :NEW.START_DAYS
      AND END_DAYS   = :NEW.END_DAYS
      AND STARTDATE  = :NEW.STARTDATE;

   INSERT INTO HD_HOUS_RATE_DELAY_LOG
             ( CUST_CODE,       SEQ,              START_DAYS,      END_DAYS,
               STARTDATE,       WRITETAG,         WRITETIME,
               WRITESEQ,        ENDDATE,          DELAYRATE,       DELAYCUT,
               DELAYUNIT,       START_TAG,        END_TAG,         INPUT_DUTY_ID,
               INPUT_DATE,      CHG_DUTY_ID,      CHG_DATE )
      VALUES (:NEW.CUST_CODE,  :NEW.SEQ,         :NEW.START_DAYS, :NEW.END_DAYS,
              :NEW.STARTDATE,  'I',               TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),
               NEWSEQ,         :NEW.ENDDATE,     :NEW.DELAYRATE,  :NEW.DELAYCUT,
              :NEW.DELAYUNIT,  :NEW.START_TAG,   :NEW.END_TAG,    :NEW.INPUT_DUTY_ID,
              :NEW.INPUT_DATE, :NEW.CHG_DUTY_ID, :NEW.CHG_DATE);
END;


/





ALTER TRIGGER TIA_HD_HOUS_RATE_DELAY
	ENABLE;




CREATE  OR REPLACE  TRIGGER TUA_HD_HOUS_RATE_DELAY
 AFTER UPDATE
 ON HD_HOUS_RATE_DELAY
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

BEGIN
   SELECT NVL(MAX(WRITESEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_RATE_DELAY_LOG
    WHERE CUST_CODE  = :NEW.CUST_CODE
      AND SEQ        = :NEW.SEQ
      AND START_DAYS = :NEW.START_DAYS
      AND END_DAYS   = :NEW.END_DAYS
      AND STARTDATE  = :NEW.STARTDATE;

   INSERT INTO HD_HOUS_RATE_DELAY_LOG
             ( CUST_CODE,       SEQ,              START_DAYS,      END_DAYS,
               STARTDATE,       WRITETAG,         WRITETIME,
               WRITESEQ,        ENDDATE,          DELAYRATE,       DELAYCUT,
               DELAYUNIT,       START_TAG,        END_TAG,         INPUT_DUTY_ID,
               INPUT_DATE,      CHG_DUTY_ID,      CHG_DATE )
      VALUES (:NEW.CUST_CODE,  :NEW.SEQ,         :NEW.START_DAYS, :NEW.END_DAYS,
              :NEW.STARTDATE,  'U',               TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),
               NEWSEQ,         :NEW.ENDDATE,     :NEW.DELAYRATE,  :NEW.DELAYCUT,
              :NEW.DELAYUNIT,  :NEW.START_TAG,   :NEW.END_TAG,    :NEW.INPUT_DUTY_ID,
              :NEW.INPUT_DATE, :NEW.CHG_DUTY_ID, :NEW.CHG_DATE);
END;


/





ALTER TRIGGER TUA_HD_HOUS_RATE_DELAY
	ENABLE;




CREATE  OR REPLACE  TRIGGER TDA_HD_HOUS_RATE_DELAY
 AFTER DELETE
 ON HD_HOUS_RATE_DELAY
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

BEGIN
   SELECT NVL(MAX(WRITESEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_RATE_DELAY_LOG
    WHERE CUST_CODE  = :OLD.CUST_CODE
      AND SEQ        = :OLD.SEQ
      AND START_DAYS = :OLD.START_DAYS
      AND END_DAYS   = :OLD.END_DAYS
      AND STARTDATE  = :OLD.STARTDATE;

   INSERT INTO HD_HOUS_RATE_DELAY_LOG
             ( CUST_CODE,       SEQ,              START_DAYS,       END_DAYS,
               STARTDATE,       WRITETAG,         WRITETIME,
               WRITESEQ,        ENDDATE,          DELAYRATE,        DELAYCUT,
               DELAYUNIT,       START_TAG,        END_TAG,          INPUT_DUTY_ID,
               INPUT_DATE,      CHG_DUTY_ID,      CHG_DATE )
      VALUES (:OLD.CUST_CODE,  :OLD.SEQ,         :OLD.START_DAYS,  :OLD.END_DAYS,
              :OLD.STARTDATE,  'D',               TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),
               NEWSEQ,         :OLD.ENDDATE,     :OLD.DELAYRATE,   :OLD.DELAYCUT,
              :OLD.DELAYUNIT,  :OLD.START_TAG,   :OLD.END_TAG,     :OLD.INPUT_DUTY_ID,
              :OLD.INPUT_DATE, :OLD.CHG_DUTY_ID, :OLD.CHG_DATE);
END;


/





ALTER TRIGGER TDA_HD_HOUS_RATE_DELAY
	ENABLE;




CREATE  OR REPLACE  TRIGGER TIA_HD_HOUS_RATE_DELAY
 AFTER INSERT
 ON HD_HOUS_RATE_DELAY
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

BEGIN
   SELECT NVL(MAX(WRITESEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_RATE_DELAY_LOG
    WHERE CUST_CODE  = :NEW.CUST_CODE
      AND SEQ        = :NEW.SEQ
      AND START_DAYS = :NEW.START_DAYS
      AND END_DAYS   = :NEW.END_DAYS
      AND STARTDATE  = :NEW.STARTDATE;

   INSERT INTO HD_HOUS_RATE_DELAY_LOG
             ( CUST_CODE,       SEQ,              START_DAYS,      END_DAYS,
               STARTDATE,       WRITETAG,         WRITETIME,
               WRITESEQ,        ENDDATE,          DELAYRATE,       DELAYCUT,
               DELAYUNIT,       START_TAG,        END_TAG,         INPUT_DUTY_ID,
               INPUT_DATE,      CHG_DUTY_ID,      CHG_DATE )
      VALUES (:NEW.CUST_CODE,  :NEW.SEQ,         :NEW.START_DAYS, :NEW.END_DAYS,
              :NEW.STARTDATE,  'I',               TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),
               NEWSEQ,         :NEW.ENDDATE,     :NEW.DELAYRATE,  :NEW.DELAYCUT,
              :NEW.DELAYUNIT,  :NEW.START_TAG,   :NEW.END_TAG,    :NEW.INPUT_DUTY_ID,
              :NEW.INPUT_DATE, :NEW.CHG_DUTY_ID, :NEW.CHG_DATE);
END;


/





ALTER TRIGGER TIA_HD_HOUS_RATE_DELAY
	ENABLE;




CREATE  OR REPLACE  TRIGGER TUA_HD_HOUS_RATE_DELAY
 AFTER UPDATE
 ON HD_HOUS_RATE_DELAY
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

BEGIN
   SELECT NVL(MAX(WRITESEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_RATE_DELAY_LOG
    WHERE CUST_CODE  = :NEW.CUST_CODE
      AND SEQ        = :NEW.SEQ
      AND START_DAYS = :NEW.START_DAYS
      AND END_DAYS   = :NEW.END_DAYS
      AND STARTDATE  = :NEW.STARTDATE;

   INSERT INTO HD_HOUS_RATE_DELAY_LOG
             ( CUST_CODE,       SEQ,              START_DAYS,      END_DAYS,
               STARTDATE,       WRITETAG,         WRITETIME,
               WRITESEQ,        ENDDATE,          DELAYRATE,       DELAYCUT,
               DELAYUNIT,       START_TAG,        END_TAG,         INPUT_DUTY_ID,
               INPUT_DATE,      CHG_DUTY_ID,      CHG_DATE )
      VALUES (:NEW.CUST_CODE,  :NEW.SEQ,         :NEW.START_DAYS, :NEW.END_DAYS,
              :NEW.STARTDATE,  'U',               TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),
               NEWSEQ,         :NEW.ENDDATE,     :NEW.DELAYRATE,  :NEW.DELAYCUT,
              :NEW.DELAYUNIT,  :NEW.START_TAG,   :NEW.END_TAG,    :NEW.INPUT_DUTY_ID,
              :NEW.INPUT_DATE, :NEW.CHG_DUTY_ID, :NEW.CHG_DATE);
END;


/





ALTER TRIGGER TUA_HD_HOUS_RATE_DELAY
	ENABLE;




CREATE  OR REPLACE  TRIGGER TDA_HD_HOUS_RATE_DISCOUNT
 AFTER DELETE
 ON HD_HOUS_RATE_DISCOUNT
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

BEGIN
   SELECT NVL(MAX(WRITESEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_RATE_DISCOUNT_LOG
    WHERE CUST_CODE = :OLD.CUST_CODE
      AND SEQ       = :OLD.SEQ
      AND STARTDATE = :OLD.STARTDATE;

   INSERT INTO HD_HOUS_RATE_DISCOUNT_LOG
             ( CUST_CODE,       SEQ,                STARTDATE,       WRITETAG,
               WRITETIME,
               WRITESEQ,        ENDDATE,            DISCNTRATE,      DISCNTCUT,
               DISCNTUNIT,      INPUT_DUTY_ID,      INPUT_DATE,      CHG_DUTY_ID,
               CHG_DATE )
      VALUES (:OLD.CUST_CODE,  :OLD.SEQ,           :OLD.STARTDATE,  'D',
               TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),
               NEWSEQ,         :OLD.ENDDATE,       :OLD.DISCNTRATE, :OLD.DISCNTCUT,
              :OLD.DISCNTUNIT, :OLD.INPUT_DUTY_ID, :OLD.INPUT_DATE, :OLD.CHG_DUTY_ID,
              :OLD.CHG_DATE);
END;


/





ALTER TRIGGER TDA_HD_HOUS_RATE_DISCOUNT
	ENABLE;




CREATE  OR REPLACE  TRIGGER TIA_HD_HOUS_RATE_DISCOUNT
 AFTER INSERT
 ON HD_HOUS_RATE_DISCOUNT
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

BEGIN
   SELECT NVL(MAX(WRITESEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_RATE_DISCOUNT_LOG
    WHERE CUST_CODE = :NEW.CUST_CODE
      AND SEQ       = :NEW.SEQ
      AND STARTDATE = :NEW.STARTDATE;

   INSERT INTO HD_HOUS_RATE_DISCOUNT_LOG
             ( CUST_CODE,       SEQ,                STARTDATE,       WRITETAG,
               WRITETIME,
               WRITESEQ,        ENDDATE,            DISCNTRATE,      DISCNTCUT,
               DISCNTUNIT,      INPUT_DUTY_ID,      INPUT_DATE,      CHG_DUTY_ID,
               CHG_DATE )
      VALUES (:NEW.CUST_CODE,  :NEW.SEQ,           :NEW.STARTDATE,  'I',
               TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),
               NEWSEQ,         :NEW.ENDDATE,       :NEW.DISCNTRATE, :NEW.DISCNTCUT,
              :NEW.DISCNTUNIT, :NEW.INPUT_DUTY_ID, :NEW.INPUT_DATE, :NEW.CHG_DUTY_ID,
              :NEW.CHG_DATE);
END;


/





ALTER TRIGGER TIA_HD_HOUS_RATE_DISCOUNT
	ENABLE;




CREATE  OR REPLACE  TRIGGER TUA_HD_HOUS_RATE_DISCOUNT
 AFTER UPDATE
 ON HD_HOUS_RATE_DISCOUNT
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

BEGIN
   SELECT NVL(MAX(WRITESEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_RATE_DISCOUNT_LOG
    WHERE CUST_CODE = :NEW.CUST_CODE
      AND SEQ       = :NEW.SEQ
      AND STARTDATE = :NEW.STARTDATE;

   INSERT INTO HD_HOUS_RATE_DISCOUNT_LOG
             ( CUST_CODE,       SEQ,                STARTDATE,       WRITETAG,
               WRITETIME,
               WRITESEQ,        ENDDATE,            DISCNTRATE,      DISCNTCUT,
               DISCNTUNIT,      INPUT_DUTY_ID,      INPUT_DATE,      CHG_DUTY_ID,
               CHG_DATE )
      VALUES (:NEW.CUST_CODE,  :NEW.SEQ,           :NEW.STARTDATE,  'U',
               TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),
               NEWSEQ,         :NEW.ENDDATE,       :NEW.DISCNTRATE, :NEW.DISCNTCUT,
              :NEW.DISCNTUNIT, :NEW.INPUT_DUTY_ID, :NEW.INPUT_DATE, :NEW.CHG_DUTY_ID,
              :NEW.CHG_DATE);
END;


/





ALTER TRIGGER TUA_HD_HOUS_RATE_DISCOUNT
	ENABLE;




CREATE  OR REPLACE  TRIGGER TDA_HD_HOUS_RATE_DISCOUNT
 AFTER DELETE
 ON HD_HOUS_RATE_DISCOUNT
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

BEGIN
   SELECT NVL(MAX(WRITESEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_RATE_DISCOUNT_LOG
    WHERE CUST_CODE = :OLD.CUST_CODE
      AND SEQ       = :OLD.SEQ
      AND STARTDATE = :OLD.STARTDATE;

   INSERT INTO HD_HOUS_RATE_DISCOUNT_LOG
             ( CUST_CODE,       SEQ,                STARTDATE,       WRITETAG,
               WRITETIME,
               WRITESEQ,        ENDDATE,            DISCNTRATE,      DISCNTCUT,
               DISCNTUNIT,      INPUT_DUTY_ID,      INPUT_DATE,      CHG_DUTY_ID,
               CHG_DATE )
      VALUES (:OLD.CUST_CODE,  :OLD.SEQ,           :OLD.STARTDATE,  'D',
               TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),
               NEWSEQ,         :OLD.ENDDATE,       :OLD.DISCNTRATE, :OLD.DISCNTCUT,
              :OLD.DISCNTUNIT, :OLD.INPUT_DUTY_ID, :OLD.INPUT_DATE, :OLD.CHG_DUTY_ID,
              :OLD.CHG_DATE);
END;


/





ALTER TRIGGER TDA_HD_HOUS_RATE_DISCOUNT
	ENABLE;




CREATE  OR REPLACE  TRIGGER TIA_HD_HOUS_RATE_DISCOUNT
 AFTER INSERT
 ON HD_HOUS_RATE_DISCOUNT
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

BEGIN
   SELECT NVL(MAX(WRITESEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_RATE_DISCOUNT_LOG
    WHERE CUST_CODE = :NEW.CUST_CODE
      AND SEQ       = :NEW.SEQ
      AND STARTDATE = :NEW.STARTDATE;

   INSERT INTO HD_HOUS_RATE_DISCOUNT_LOG
             ( CUST_CODE,       SEQ,                STARTDATE,       WRITETAG,
               WRITETIME,
               WRITESEQ,        ENDDATE,            DISCNTRATE,      DISCNTCUT,
               DISCNTUNIT,      INPUT_DUTY_ID,      INPUT_DATE,      CHG_DUTY_ID,
               CHG_DATE )
      VALUES (:NEW.CUST_CODE,  :NEW.SEQ,           :NEW.STARTDATE,  'I',
               TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),
               NEWSEQ,         :NEW.ENDDATE,       :NEW.DISCNTRATE, :NEW.DISCNTCUT,
              :NEW.DISCNTUNIT, :NEW.INPUT_DUTY_ID, :NEW.INPUT_DATE, :NEW.CHG_DUTY_ID,
              :NEW.CHG_DATE);
END;


/





ALTER TRIGGER TIA_HD_HOUS_RATE_DISCOUNT
	ENABLE;




CREATE  OR REPLACE  TRIGGER TUA_HD_HOUS_RATE_DISCOUNT
 AFTER UPDATE
 ON HD_HOUS_RATE_DISCOUNT
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

BEGIN
   SELECT NVL(MAX(WRITESEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_RATE_DISCOUNT_LOG
    WHERE CUST_CODE = :NEW.CUST_CODE
      AND SEQ       = :NEW.SEQ
      AND STARTDATE = :NEW.STARTDATE;

   INSERT INTO HD_HOUS_RATE_DISCOUNT_LOG
             ( CUST_CODE,       SEQ,                STARTDATE,       WRITETAG,
               WRITETIME,
               WRITESEQ,        ENDDATE,            DISCNTRATE,      DISCNTCUT,
               DISCNTUNIT,      INPUT_DUTY_ID,      INPUT_DATE,      CHG_DUTY_ID,
               CHG_DATE )
      VALUES (:NEW.CUST_CODE,  :NEW.SEQ,           :NEW.STARTDATE,  'U',
               TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),
               NEWSEQ,         :NEW.ENDDATE,       :NEW.DISCNTRATE, :NEW.DISCNTCUT,
              :NEW.DISCNTUNIT, :NEW.INPUT_DUTY_ID, :NEW.INPUT_DATE, :NEW.CHG_DUTY_ID,
              :NEW.CHG_DATE);
END;


/





ALTER TRIGGER TUA_HD_HOUS_RATE_DISCOUNT
	ENABLE;




CREATE  OR REPLACE  TRIGGER TDA_HD_HOUS_SELL
 AFTER DELETE
 ON HD_HOUS_SELL
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

BEGIN
   SELECT NVL(MAX(WRITESEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_SELL_LOG
    WHERE CUST_CODE = :OLD.CUST_CODE
      AND SEQ       = :OLD.SEQ;

   INSERT INTO HD_HOUS_SELL_LOG
             ( CUST_CODE,           SEQ,                   WRITETAG,                WRITETIME,
               WRITESEQ,            DEPT_CODE,             HOUSETAG,                BUILDNO,
               HOUSENO,             DONGHO,                CUST_NAME,               SQUARE,
               TYPE,                CLASS,                 OPTIONCODE,              CONTRACTTAG,
               CONTRACTDATE,        CONTRACTNO,            LOAN_TAG,                LEASETAG,
               LASTCHANGEDATE,      CHANGETAG,             CHANGEDATE,              CANCEL_REASON,
               CHILD_BUILDNO,       CHILD_HOUSENO,         RELA_CUSTCODE,           RELA_SEQ,
               VATTAG,              EXCLUSIVEAREA,         COMMONAREA,              ETCCOMMONAREA,
               PARKINGAREA,         SERVICEAREA,           SITEAREA,                MOVEINSTARTDATE,
               MOVEINENDDATE,       UNION_CNT,             REMARK,                  REFUNDMENTDATE,
               REFUNDMENTAMT,       PENALTYAMT,            LOAN_INTEREST,           SODUK_TAX,
               JUMIN_TAX,           BANK_LOAN_ORGAMT,      BANK_LOAN_INTEREST,      LOANBANK,
               LOANDEPOSIT,         LOANUSER,              REFUND_DEPOSIT,          REFUND_BANK,
               COMP_LOANAMT,        BILL_RETURNAMT,        DELAY_INDEMINITY,        DEPOSIT_COUNT,
               CO_CUSTCODE,         CO_SANGHO,             CO_CONDITION,            CO_CATEGORY,
               CATEGORY_NAME,       SLIPDATE,              SLIPSEQ,                 INPUT_DUTY_ID,
               INPUT_DATE,          CHG_DUTY_ID,           CHG_DATE,                APPLY_YN,
               APPLY_EMPNO,         APPLY_DATE,            PRTSQUARE,               BANK_LOAN_INTEREST2,
               ETC_AMT,             RENTHD_YN,             RENTHD_SEQ,              BALCONY_TAG,
               BALCONYAREA,         DAYMONTH_TAG,          FLOOR,                   CONT_CONDITION,
               LAND_RETURN,         INT_CALC_DATE,         PREDISAMT,               PROXYAMT,
               INCONT_DATE,         TRUSTAMT,              PREDIS_TAG,              PROXY_TAG,
               TRUST_TAG,           VIR_YN,                VDEPOSIT,
               REP_LIMITDT,         REP_YN,                REP_DATE
             )
      VALUES (:OLD.CUST_CODE,      :OLD.SEQ,              'D',                      TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),
               NEWSEQ,             :OLD.DEPT_CODE,        :OLD.HOUSETAG,           :OLD.BUILDNO,
              :OLD.HOUSENO,        :OLD.DONGHO,           :OLD.CUST_NAME,          :OLD.SQUARE,
              :OLD.TYPE,           :OLD.CLASS,            :OLD.OPTIONCODE,         :OLD.CONTRACTTAG,
              :OLD.CONTRACTDATE,   :OLD.CONTRACTNO,       :OLD.LOAN_TAG,           :OLD.LEASETAG,
              :OLD.LASTCHANGEDATE, :OLD.CHANGETAG,        :OLD.CHANGEDATE,         :OLD.CANCEL_REASON,
              :OLD.CHILD_BUILDNO,  :OLD.CHILD_HOUSENO,    :OLD.RELA_CUSTCODE,      :OLD.RELA_SEQ,
              :OLD.VATTAG,         :OLD.EXCLUSIVEAREA,    :OLD.COMMONAREA,         :OLD.ETCCOMMONAREA,
              :OLD.PARKINGAREA,    :OLD.SERVICEAREA,      :OLD.SITEAREA,           :OLD.MOVEINSTARTDATE,
              :OLD.MOVEINENDDATE,  :OLD.UNION_CNT,        :OLD.REMARK,             :OLD.REFUNDMENTDATE,
              :OLD.REFUNDMENTAMT,  :OLD.PENALTYAMT,       :OLD.LOAN_INTEREST,      :OLD.SODUK_TAX,
              :OLD.JUMIN_TAX,      :OLD.BANK_LOAN_ORGAMT, :OLD.BANK_LOAN_INTEREST, :OLD.LOANBANK,
              :OLD.LOANDEPOSIT,    :OLD.LOANUSER,         :OLD.REFUND_DEPOSIT,     :OLD.REFUND_BANK,
              :OLD.COMP_LOANAMT,   :OLD.BILL_RETURNAMT,   :OLD.DELAY_INDEMINITY,   :OLD.DEPOSIT_COUNT,
              :OLD.CO_CUSTCODE,    :OLD.CO_SANGHO,        :OLD.CO_CONDITION,       :OLD.CO_CATEGORY,
              :OLD.CATEGORY_NAME,  :OLD.SLIPDATE,         :OLD.SLIPSEQ,            :OLD.INPUT_DUTY_ID,
              :OLD.INPUT_DATE,     :OLD.CHG_DUTY_ID,      :OLD.CHG_DATE,           :OLD.APPLY_YN,
              :OLD.APPLY_EMPNO,    :OLD.APPLY_DATE,       :OLD.PRTSQUARE,          :OLD.BANK_LOAN_INTEREST2,
              :OLD.ETC_AMT,        :OLD.RENTHD_YN,        :OLD.RENTHD_SEQ,         :OLD.BALCONY_TAG,
              :OLD.BALCONYAREA,    :OLD.DAYMONTH_TAG,     :OLD.FLOOR,              :OLD.CONT_CONDITION,
              :OLD.LAND_RETURN,    :OLD.INT_CALC_DATE,    :OLD.PREDISAMT,          :OLD.PROXYAMT,
              :OLD.INCONT_DATE,    :OLD.TRUSTAMT,         :OLD.PREDIS_TAG,         :OLD.PROXY_TAG,
              :OLD.TRUST_TAG,      :OLD.VIR_YN,           :OLD.VDEPOSIT,
              :OLD.REP_LIMITDT,    :OLD.REP_YN,           :OLD.REP_DATE
             );
END;

/





ALTER TRIGGER TDA_HD_HOUS_SELL
	ENABLE;




CREATE  OR REPLACE  TRIGGER TIA_HD_HOUS_SELL
 AFTER INSERT
 ON HD_HOUS_SELL
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

BEGIN
   SELECT NVL(MAX(WRITESEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_SELL_LOG
    WHERE CUST_CODE = :NEW.CUST_CODE
      AND SEQ       = :NEW.SEQ;

   INSERT INTO HD_HOUS_SELL_LOG
             ( CUST_CODE,           SEQ,                   WRITETAG,                WRITETIME,
               WRITESEQ,            DEPT_CODE,             HOUSETAG,                BUILDNO,
               HOUSENO,             DONGHO,                CUST_NAME,               SQUARE,
               TYPE,                CLASS,                 OPTIONCODE,              CONTRACTTAG,
               CONTRACTDATE,        CONTRACTNO,            LOAN_TAG,                LEASETAG,
               LASTCHANGEDATE,      CHANGETAG,             CHANGEDATE,              CANCEL_REASON,
               CHILD_BUILDNO,       CHILD_HOUSENO,         RELA_CUSTCODE,           RELA_SEQ,
               VATTAG,              EXCLUSIVEAREA,         COMMONAREA,              ETCCOMMONAREA,
               PARKINGAREA,         SERVICEAREA,           SITEAREA,                MOVEINSTARTDATE,
               MOVEINENDDATE,       UNION_CNT,             REMARK,                  REFUNDMENTDATE,
               REFUNDMENTAMT,       PENALTYAMT,            LOAN_INTEREST,           SODUK_TAX,
               JUMIN_TAX,           BANK_LOAN_ORGAMT,      BANK_LOAN_INTEREST,      LOANBANK,
               LOANDEPOSIT,         LOANUSER,              REFUND_DEPOSIT,          REFUND_BANK,
               COMP_LOANAMT,        BILL_RETURNAMT,        DELAY_INDEMINITY,        DEPOSIT_COUNT,
               CO_CUSTCODE,         CO_SANGHO,             CO_CONDITION,            CO_CATEGORY,
               CATEGORY_NAME,       SLIPDATE,              SLIPSEQ,                 INPUT_DUTY_ID,
               INPUT_DATE,          CHG_DUTY_ID,           CHG_DATE,                APPLY_YN,
               APPLY_EMPNO,         APPLY_DATE,            PRTSQUARE,               BANK_LOAN_INTEREST2,
               ETC_AMT,             RENTHD_YN,             RENTHD_SEQ,              BALCONY_TAG,
               BALCONYAREA,         DAYMONTH_TAG,          FLOOR,                   CONT_CONDITION,
               LAND_RETURN,         INT_CALC_DATE,         PREDISAMT,               PROXYAMT,
               INCONT_DATE,         TRUSTAMT,              PREDIS_TAG,              PROXY_TAG,
               TRUST_TAG,           VIR_YN,                VDEPOSIT,
               REP_LIMITDT,         REP_YN,                REP_DATE
             )
      VALUES (:NEW.CUST_CODE,      :NEW.SEQ,              'I',                      TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),
               NEWSEQ,             :NEW.DEPT_CODE,        :NEW.HOUSETAG,           :NEW.BUILDNO,
              :NEW.HOUSENO,        :NEW.DONGHO,           :NEW.CUST_NAME,          :NEW.SQUARE,
              :NEW.TYPE,           :NEW.CLASS,            :NEW.OPTIONCODE,         :NEW.CONTRACTTAG,
              :NEW.CONTRACTDATE,   :NEW.CONTRACTNO,       :NEW.LOAN_TAG,           :NEW.LEASETAG,
              :NEW.LASTCHANGEDATE, :NEW.CHANGETAG,        :NEW.CHANGEDATE,         :NEW.CANCEL_REASON,
              :NEW.CHILD_BUILDNO,  :NEW.CHILD_HOUSENO,    :NEW.RELA_CUSTCODE,      :NEW.RELA_SEQ,
              :NEW.VATTAG,         :NEW.EXCLUSIVEAREA,    :NEW.COMMONAREA,         :NEW.ETCCOMMONAREA,
              :NEW.PARKINGAREA,    :NEW.SERVICEAREA,      :NEW.SITEAREA,           :NEW.MOVEINSTARTDATE,
              :NEW.MOVEINENDDATE,  :NEW.UNION_CNT,        :NEW.REMARK,             :NEW.REFUNDMENTDATE,
              :NEW.REFUNDMENTAMT,  :NEW.PENALTYAMT,       :NEW.LOAN_INTEREST,      :NEW.SODUK_TAX,
              :NEW.JUMIN_TAX,      :NEW.BANK_LOAN_ORGAMT, :NEW.BANK_LOAN_INTEREST, :NEW.LOANBANK,
              :NEW.LOANDEPOSIT,    :NEW.LOANUSER,         :NEW.REFUND_DEPOSIT,     :NEW.REFUND_BANK,
              :NEW.COMP_LOANAMT,   :NEW.BILL_RETURNAMT,   :NEW.DELAY_INDEMINITY,   :NEW.DEPOSIT_COUNT,
              :NEW.CO_CUSTCODE,    :NEW.CO_SANGHO,        :NEW.CO_CONDITION,       :NEW.CO_CATEGORY,
              :NEW.CATEGORY_NAME,  :NEW.SLIPDATE,         :NEW.SLIPSEQ,            :NEW.INPUT_DUTY_ID,
              :NEW.INPUT_DATE,     :NEW.CHG_DUTY_ID,      :NEW.CHG_DATE,           :NEW.APPLY_YN,
              :NEW.APPLY_EMPNO,    :NEW.APPLY_DATE,       :NEW.PRTSQUARE,          :NEW.BANK_LOAN_INTEREST2,
              :NEW.ETC_AMT,        :NEW.RENTHD_YN,        :NEW.RENTHD_SEQ,         :NEW.BALCONY_TAG,
              :NEW.BALCONYAREA,    :NEW.DAYMONTH_TAG,     :NEW.FLOOR,              :NEW.CONT_CONDITION,
              :NEW.LAND_RETURN,    :NEW.INT_CALC_DATE,    :NEW.PREDISAMT,          :NEW.PROXYAMT,
              :NEW.INCONT_DATE,    :NEW.TRUSTAMT,         :NEW.PREDIS_TAG,         :NEW.PROXY_TAG,
              :NEW.TRUST_TAG,      :NEW.VIR_YN,           :NEW.VDEPOSIT,
              :NEW.REP_LIMITDT,    :NEW.REP_YN,           :NEW.REP_DATE
             );
END;

/





ALTER TRIGGER TIA_HD_HOUS_SELL
	ENABLE;




CREATE  OR REPLACE  TRIGGER TIB_HD_HOUS_SELL
 BEFORE INSERT
 ON HD_HOUS_SELL
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE CNT INTEGER;

BEGIN
   CNT := 0;
   IF :NEW.CHANGETAG = '1' THEN BEGIN
      SELECT COUNT(*)
        INTO CNT
        FROM HD_HOUS_SUPPLY
       WHERE DEPT_CODE     = :NEW.DEPT_CODE
         AND HOUSETAG      = :NEW.HOUSETAG
         AND BUILDNO       = :NEW.BUILDNO
         AND HOUSENO       = :NEW.HOUSENO
         AND CONTRACTYESNO = 'Y';
      IF CNT > 0 THEN BEGIN
         RAISE_APPLICATION_ERROR(-20111, '   ');
      END; END IF;
   END; END IF;

END;


/





ALTER TRIGGER TIB_HD_HOUS_SELL
	ENABLE;




CREATE  OR REPLACE  TRIGGER TUA_HD_HOUS_SELL
 AFTER UPDATE
 ON HD_HOUS_SELL
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

BEGIN
   SELECT NVL(MAX(WRITESEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_SELL_LOG
    WHERE CUST_CODE = :NEW.CUST_CODE
      AND SEQ       = :NEW.SEQ;

   INSERT INTO HD_HOUS_SELL_LOG
             ( CUST_CODE,           SEQ,                   WRITETAG,                WRITETIME,
               WRITESEQ,            DEPT_CODE,             HOUSETAG,                BUILDNO,
               HOUSENO,             DONGHO,                CUST_NAME,               SQUARE,
               TYPE,                CLASS,                 OPTIONCODE,              CONTRACTTAG,
               CONTRACTDATE,        CONTRACTNO,            LOAN_TAG,                LEASETAG,
               LASTCHANGEDATE,      CHANGETAG,             CHANGEDATE,              CANCEL_REASON,
               CHILD_BUILDNO,       CHILD_HOUSENO,         RELA_CUSTCODE,           RELA_SEQ,
               VATTAG,              EXCLUSIVEAREA,         COMMONAREA,              ETCCOMMONAREA,
               PARKINGAREA,         SERVICEAREA,           SITEAREA,                MOVEINSTARTDATE,
               MOVEINENDDATE,       UNION_CNT,             REMARK,                  REFUNDMENTDATE,
               REFUNDMENTAMT,       PENALTYAMT,            LOAN_INTEREST,           SODUK_TAX,
               JUMIN_TAX,           BANK_LOAN_ORGAMT,      BANK_LOAN_INTEREST,      LOANBANK,
               LOANDEPOSIT,         LOANUSER,              REFUND_DEPOSIT,          REFUND_BANK,
               COMP_LOANAMT,        BILL_RETURNAMT,        DELAY_INDEMINITY,        DEPOSIT_COUNT,
               CO_CUSTCODE,         CO_SANGHO,             CO_CONDITION,            CO_CATEGORY,
               CATEGORY_NAME,       SLIPDATE,              SLIPSEQ,                 INPUT_DUTY_ID,
               INPUT_DATE,          CHG_DUTY_ID,           CHG_DATE,                APPLY_YN,
               APPLY_EMPNO,         APPLY_DATE,            PRTSQUARE,               BANK_LOAN_INTEREST2,
               ETC_AMT,             RENTHD_YN,             RENTHD_SEQ,              BALCONY_TAG,
               BALCONYAREA,         DAYMONTH_TAG,          FLOOR,                   CONT_CONDITION,
               LAND_RETURN,         INT_CALC_DATE,         PREDISAMT,               PROXYAMT,
               INCONT_DATE,         TRUSTAMT,              PREDIS_TAG,              PROXY_TAG,
               TRUST_TAG,           VIR_YN,                VDEPOSIT,
               REP_LIMITDT,         REP_YN,                REP_DATE
             )
      VALUES (:NEW.CUST_CODE,      :NEW.SEQ,              'U',                      TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),
               NEWSEQ,             :NEW.DEPT_CODE,        :NEW.HOUSETAG,           :NEW.BUILDNO,
              :NEW.HOUSENO,        :NEW.DONGHO,           :NEW.CUST_NAME,          :NEW.SQUARE,
              :NEW.TYPE,           :NEW.CLASS,            :NEW.OPTIONCODE,         :NEW.CONTRACTTAG,
              :NEW.CONTRACTDATE,   :NEW.CONTRACTNO,       :NEW.LOAN_TAG,           :NEW.LEASETAG,
              :NEW.LASTCHANGEDATE, :NEW.CHANGETAG,        :NEW.CHANGEDATE,         :NEW.CANCEL_REASON,
              :NEW.CHILD_BUILDNO,  :NEW.CHILD_HOUSENO,    :NEW.RELA_CUSTCODE,      :NEW.RELA_SEQ,
              :NEW.VATTAG,         :NEW.EXCLUSIVEAREA,    :NEW.COMMONAREA,         :NEW.ETCCOMMONAREA,
              :NEW.PARKINGAREA,    :NEW.SERVICEAREA,      :NEW.SITEAREA,           :NEW.MOVEINSTARTDATE,
              :NEW.MOVEINENDDATE,  :NEW.UNION_CNT,        :NEW.REMARK,             :NEW.REFUNDMENTDATE,
              :NEW.REFUNDMENTAMT,  :NEW.PENALTYAMT,       :NEW.LOAN_INTEREST,      :NEW.SODUK_TAX,
              :NEW.JUMIN_TAX,      :NEW.BANK_LOAN_ORGAMT, :NEW.BANK_LOAN_INTEREST, :NEW.LOANBANK,
              :NEW.LOANDEPOSIT,    :NEW.LOANUSER,         :NEW.REFUND_DEPOSIT,     :NEW.REFUND_BANK,
              :NEW.COMP_LOANAMT,   :NEW.BILL_RETURNAMT,   :NEW.DELAY_INDEMINITY,   :NEW.DEPOSIT_COUNT,
              :NEW.CO_CUSTCODE,    :NEW.CO_SANGHO,        :NEW.CO_CONDITION,       :NEW.CO_CATEGORY,
              :NEW.CATEGORY_NAME,  :NEW.SLIPDATE,         :NEW.SLIPSEQ,            :NEW.INPUT_DUTY_ID,
              :NEW.INPUT_DATE,     :NEW.CHG_DUTY_ID,      :NEW.CHG_DATE,           :NEW.APPLY_YN,
              :NEW.APPLY_EMPNO,    :NEW.APPLY_DATE,       :NEW.PRTSQUARE,          :NEW.BANK_LOAN_INTEREST2,
              :NEW.ETC_AMT,        :NEW.RENTHD_YN,        :NEW.RENTHD_SEQ,         :NEW.BALCONY_TAG,
              :NEW.BALCONYAREA,    :NEW.DAYMONTH_TAG,     :NEW.FLOOR,              :NEW.CONT_CONDITION,
              :NEW.LAND_RETURN,    :NEW.INT_CALC_DATE,    :NEW.PREDISAMT,          :NEW.PROXYAMT,
              :NEW.INCONT_DATE,    :NEW.TRUSTAMT,         :NEW.PREDIS_TAG,         :NEW.PROXY_TAG,
              :NEW.TRUST_TAG,      :NEW.VIR_YN,           :NEW.VDEPOSIT,
              :NEW.REP_LIMITDT,    :NEW.REP_YN,           :NEW.REP_DATE
             );

  IF  NVL(:OLD.APPLY_YN, 'N') <> NVL(:NEW.APPLY_YN, 'N') THEN BEGIN
      SELECT NVL(MAX(SN),0) + 1
        INTO NEWSEQ
        FROM HD_HOUS_APPLY
       WHERE CUST_CODE = :NEW.CUST_CODE
         AND SEQ       = :NEW.SEQ;
      INSERT INTO HD_HOUS_APPLY
                ( CUST_CODE,      SEQ,              SN,
                  DEPT_CODE,      HOUSETAG,         BUILDNO,        HOUSENO,
                  APPLY_YN,       APPLY_EMPNO,      APPLY_DATE )
         VALUES (:NEW.CUST_CODE, :NEW.SEQ,          NEWSEQ,
                 :NEW.DEPT_CODE, :NEW.HOUSETAG,    :NEW.BUILDNO,   :NEW.HOUSENO,
                 :NEW.APPLY_YN,  :NEW.APPLY_EMPNO, :NEW.APPLY_DATE);

   END; END IF;
END;

/





ALTER TRIGGER TUA_HD_HOUS_SELL
	ENABLE;




CREATE  OR REPLACE  TRIGGER TDA_HD_HOUS_SELL
 AFTER DELETE
 ON HD_HOUS_SELL
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

BEGIN
   SELECT NVL(MAX(WRITESEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_SELL_LOG
    WHERE CUST_CODE = :OLD.CUST_CODE
      AND SEQ       = :OLD.SEQ;

   INSERT INTO HD_HOUS_SELL_LOG
             ( CUST_CODE,           SEQ,                   WRITETAG,                WRITETIME,
               WRITESEQ,            DEPT_CODE,             HOUSETAG,                BUILDNO,
               HOUSENO,             DONGHO,                CUST_NAME,               SQUARE,
               TYPE,                CLASS,                 OPTIONCODE,              CONTRACTTAG,
               CONTRACTDATE,        CONTRACTNO,            LOAN_TAG,                LEASETAG,
               LASTCHANGEDATE,      CHANGETAG,             CHANGEDATE,              CANCEL_REASON,
               CHILD_BUILDNO,       CHILD_HOUSENO,         RELA_CUSTCODE,           RELA_SEQ,
               VATTAG,              EXCLUSIVEAREA,         COMMONAREA,              ETCCOMMONAREA,
               PARKINGAREA,         SERVICEAREA,           SITEAREA,                MOVEINSTARTDATE,
               MOVEINENDDATE,       UNION_CNT,             REMARK,                  REFUNDMENTDATE,
               REFUNDMENTAMT,       PENALTYAMT,            LOAN_INTEREST,           SODUK_TAX,
               JUMIN_TAX,           BANK_LOAN_ORGAMT,      BANK_LOAN_INTEREST,      LOANBANK,
               LOANDEPOSIT,         LOANUSER,              REFUND_DEPOSIT,          REFUND_BANK,
               COMP_LOANAMT,        BILL_RETURNAMT,        DELAY_INDEMINITY,        DEPOSIT_COUNT,
               CO_CUSTCODE,         CO_SANGHO,             CO_CONDITION,            CO_CATEGORY,
               CATEGORY_NAME,       SLIPDATE,              SLIPSEQ,                 INPUT_DUTY_ID,
               INPUT_DATE,          CHG_DUTY_ID,           CHG_DATE,                APPLY_YN,
               APPLY_EMPNO,         APPLY_DATE,            PRTSQUARE,               BANK_LOAN_INTEREST2,
               ETC_AMT,             RENTHD_YN,             RENTHD_SEQ,              BALCONY_TAG,
               BALCONYAREA,         DAYMONTH_TAG,          FLOOR,                   CONT_CONDITION,
               LAND_RETURN,         INT_CALC_DATE,         PREDISAMT,               PROXYAMT,
               INCONT_DATE,         TRUSTAMT,              PREDIS_TAG,              PROXY_TAG,
               TRUST_TAG,           VIR_YN,                VDEPOSIT
             )
      VALUES (:OLD.CUST_CODE,      :OLD.SEQ,              'D',                      TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),
               NEWSEQ,             :OLD.DEPT_CODE,        :OLD.HOUSETAG,           :OLD.BUILDNO,
              :OLD.HOUSENO,        :OLD.DONGHO,           :OLD.CUST_NAME,          :OLD.SQUARE,
              :OLD.TYPE,           :OLD.CLASS,            :OLD.OPTIONCODE,         :OLD.CONTRACTTAG,
              :OLD.CONTRACTDATE,   :OLD.CONTRACTNO,       :OLD.LOAN_TAG,           :OLD.LEASETAG,
              :OLD.LASTCHANGEDATE, :OLD.CHANGETAG,        :OLD.CHANGEDATE,         :OLD.CANCEL_REASON,
              :OLD.CHILD_BUILDNO,  :OLD.CHILD_HOUSENO,    :OLD.RELA_CUSTCODE,      :OLD.RELA_SEQ,
              :OLD.VATTAG,         :OLD.EXCLUSIVEAREA,    :OLD.COMMONAREA,         :OLD.ETCCOMMONAREA,
              :OLD.PARKINGAREA,    :OLD.SERVICEAREA,      :OLD.SITEAREA,           :OLD.MOVEINSTARTDATE,
              :OLD.MOVEINENDDATE,  :OLD.UNION_CNT,        :OLD.REMARK,             :OLD.REFUNDMENTDATE,
              :OLD.REFUNDMENTAMT,  :OLD.PENALTYAMT,       :OLD.LOAN_INTEREST,      :OLD.SODUK_TAX,
              :OLD.JUMIN_TAX,      :OLD.BANK_LOAN_ORGAMT, :OLD.BANK_LOAN_INTEREST, :OLD.LOANBANK,
              :OLD.LOANDEPOSIT,    :OLD.LOANUSER,         :OLD.REFUND_DEPOSIT,     :OLD.REFUND_BANK,
              :OLD.COMP_LOANAMT,   :OLD.BILL_RETURNAMT,   :OLD.DELAY_INDEMINITY,   :OLD.DEPOSIT_COUNT,
              :OLD.CO_CUSTCODE,    :OLD.CO_SANGHO,        :OLD.CO_CONDITION,       :OLD.CO_CATEGORY,
              :OLD.CATEGORY_NAME,  :OLD.SLIPDATE,         :OLD.SLIPSEQ,            :OLD.INPUT_DUTY_ID,
              :OLD.INPUT_DATE,     :OLD.CHG_DUTY_ID,      :OLD.CHG_DATE,           :OLD.APPLY_YN,
              :OLD.APPLY_EMPNO,    :OLD.APPLY_DATE,       :OLD.PRTSQUARE,          :OLD.BANK_LOAN_INTEREST2,
              :OLD.ETC_AMT,        :OLD.RENTHD_YN,        :OLD.RENTHD_SEQ,         :OLD.BALCONY_TAG,
              :OLD.BALCONYAREA,    :OLD.DAYMONTH_TAG,     :OLD.FLOOR,              :OLD.CONT_CONDITION,
              :OLD.LAND_RETURN,    :OLD.INT_CALC_DATE,    :OLD.PREDISAMT,          :OLD.PROXYAMT,
              :OLD.INCONT_DATE,    :OLD.TRUSTAMT,         :OLD.PREDIS_TAG,         :OLD.PROXY_TAG,
              :OLD.TRUST_TAG,      :OLD.VIR_YN,           :OLD.VDEPOSIT
             );
END;


/





ALTER TRIGGER TDA_HD_HOUS_SELL
	ENABLE;




CREATE  OR REPLACE  TRIGGER TIA_HD_HOUS_SELL
 AFTER INSERT
 ON HD_HOUS_SELL
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

BEGIN
   SELECT NVL(MAX(WRITESEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_SELL_LOG
    WHERE CUST_CODE = :NEW.CUST_CODE
      AND SEQ       = :NEW.SEQ;

   INSERT INTO HD_HOUS_SELL_LOG
             ( CUST_CODE,           SEQ,                   WRITETAG,                WRITETIME,
               WRITESEQ,            DEPT_CODE,             HOUSETAG,                BUILDNO,
               HOUSENO,             DONGHO,                CUST_NAME,               SQUARE,
               TYPE,                CLASS,                 OPTIONCODE,              CONTRACTTAG,
               CONTRACTDATE,        CONTRACTNO,            LOAN_TAG,                LEASETAG,
               LASTCHANGEDATE,      CHANGETAG,             CHANGEDATE,              CANCEL_REASON,
               CHILD_BUILDNO,       CHILD_HOUSENO,         RELA_CUSTCODE,           RELA_SEQ,
               VATTAG,              EXCLUSIVEAREA,         COMMONAREA,              ETCCOMMONAREA,
               PARKINGAREA,         SERVICEAREA,           SITEAREA,                MOVEINSTARTDATE,
               MOVEINENDDATE,       UNION_CNT,             REMARK,                  REFUNDMENTDATE,
               REFUNDMENTAMT,       PENALTYAMT,            LOAN_INTEREST,           SODUK_TAX,
               JUMIN_TAX,           BANK_LOAN_ORGAMT,      BANK_LOAN_INTEREST,      LOANBANK,
               LOANDEPOSIT,         LOANUSER,              REFUND_DEPOSIT,          REFUND_BANK,
               COMP_LOANAMT,        BILL_RETURNAMT,        DELAY_INDEMINITY,        DEPOSIT_COUNT,
               CO_CUSTCODE,         CO_SANGHO,             CO_CONDITION,            CO_CATEGORY,
               CATEGORY_NAME,       SLIPDATE,              SLIPSEQ,                 INPUT_DUTY_ID,
               INPUT_DATE,          CHG_DUTY_ID,           CHG_DATE,                APPLY_YN,
               APPLY_EMPNO,         APPLY_DATE,            PRTSQUARE,               BANK_LOAN_INTEREST2,
               ETC_AMT,             RENTHD_YN,             RENTHD_SEQ,              BALCONY_TAG,
               BALCONYAREA,         DAYMONTH_TAG,          FLOOR,                   CONT_CONDITION,
               LAND_RETURN,         INT_CALC_DATE,         PREDISAMT,               PROXYAMT,
               INCONT_DATE,         TRUSTAMT,              PREDIS_TAG,              PROXY_TAG,
               TRUST_TAG,           VIR_YN,                VDEPOSIT
             )
      VALUES (:NEW.CUST_CODE,      :NEW.SEQ,              'I',                      TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),
               NEWSEQ,             :NEW.DEPT_CODE,        :NEW.HOUSETAG,           :NEW.BUILDNO,
              :NEW.HOUSENO,        :NEW.DONGHO,           :NEW.CUST_NAME,          :NEW.SQUARE,
              :NEW.TYPE,           :NEW.CLASS,            :NEW.OPTIONCODE,         :NEW.CONTRACTTAG,
              :NEW.CONTRACTDATE,   :NEW.CONTRACTNO,       :NEW.LOAN_TAG,           :NEW.LEASETAG,
              :NEW.LASTCHANGEDATE, :NEW.CHANGETAG,        :NEW.CHANGEDATE,         :NEW.CANCEL_REASON,
              :NEW.CHILD_BUILDNO,  :NEW.CHILD_HOUSENO,    :NEW.RELA_CUSTCODE,      :NEW.RELA_SEQ,
              :NEW.VATTAG,         :NEW.EXCLUSIVEAREA,    :NEW.COMMONAREA,         :NEW.ETCCOMMONAREA,
              :NEW.PARKINGAREA,    :NEW.SERVICEAREA,      :NEW.SITEAREA,           :NEW.MOVEINSTARTDATE,
              :NEW.MOVEINENDDATE,  :NEW.UNION_CNT,        :NEW.REMARK,             :NEW.REFUNDMENTDATE,
              :NEW.REFUNDMENTAMT,  :NEW.PENALTYAMT,       :NEW.LOAN_INTEREST,      :NEW.SODUK_TAX,
              :NEW.JUMIN_TAX,      :NEW.BANK_LOAN_ORGAMT, :NEW.BANK_LOAN_INTEREST, :NEW.LOANBANK,
              :NEW.LOANDEPOSIT,    :NEW.LOANUSER,         :NEW.REFUND_DEPOSIT,     :NEW.REFUND_BANK,
              :NEW.COMP_LOANAMT,   :NEW.BILL_RETURNAMT,   :NEW.DELAY_INDEMINITY,   :NEW.DEPOSIT_COUNT,
              :NEW.CO_CUSTCODE,    :NEW.CO_SANGHO,        :NEW.CO_CONDITION,       :NEW.CO_CATEGORY,
              :NEW.CATEGORY_NAME,  :NEW.SLIPDATE,         :NEW.SLIPSEQ,            :NEW.INPUT_DUTY_ID,
              :NEW.INPUT_DATE,     :NEW.CHG_DUTY_ID,      :NEW.CHG_DATE,           :NEW.APPLY_YN,
              :NEW.APPLY_EMPNO,    :NEW.APPLY_DATE,       :NEW.PRTSQUARE,          :NEW.BANK_LOAN_INTEREST2,
              :NEW.ETC_AMT,        :NEW.RENTHD_YN,        :NEW.RENTHD_SEQ,         :NEW.BALCONY_TAG,
              :NEW.BALCONYAREA,    :NEW.DAYMONTH_TAG,     :NEW.FLOOR,              :NEW.CONT_CONDITION,
              :NEW.LAND_RETURN,    :NEW.INT_CALC_DATE,    :NEW.PREDISAMT,          :NEW.PROXYAMT,
              :NEW.INCONT_DATE,    :NEW.TRUSTAMT,         :NEW.PREDIS_TAG,         :NEW.PROXY_TAG,
              :NEW.TRUST_TAG,      :NEW.VIR_YN,           :NEW.VDEPOSIT
             );
END;


/





ALTER TRIGGER TIA_HD_HOUS_SELL
	ENABLE;




CREATE  OR REPLACE  TRIGGER TIB_HD_HOUS_SELL
 BEFORE INSERT
 ON HD_HOUS_SELL
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE CNT INTEGER;

BEGIN
   CNT := 0;
   IF :NEW.CHANGETAG = '1' THEN BEGIN
      SELECT COUNT(*)
        INTO CNT
        FROM HD_HOUS_SUPPLY
       WHERE DEPT_CODE     = :NEW.DEPT_CODE
         AND HOUSETAG      = :NEW.HOUSETAG
         AND BUILDNO       = :NEW.BUILDNO
         AND HOUSENO       = :NEW.HOUSENO
         AND CONTRACTYESNO = 'Y';
      IF CNT > 0 THEN BEGIN
         RAISE_APPLICATION_ERROR(-20111, '   ');
      END; END IF;
   END; END IF;

END;


/





ALTER TRIGGER TIB_HD_HOUS_SELL
	ENABLE;




CREATE  OR REPLACE  TRIGGER TUA_HD_HOUS_SELL
 AFTER UPDATE
 ON HD_HOUS_SELL
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

BEGIN
   SELECT NVL(MAX(WRITESEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_SELL_LOG
    WHERE CUST_CODE = :NEW.CUST_CODE
      AND SEQ       = :NEW.SEQ;

   INSERT INTO HD_HOUS_SELL_LOG
             ( CUST_CODE,           SEQ,                   WRITETAG,                WRITETIME,
               WRITESEQ,            DEPT_CODE,             HOUSETAG,                BUILDNO,
               HOUSENO,             DONGHO,                CUST_NAME,               SQUARE,
               TYPE,                CLASS,                 OPTIONCODE,              CONTRACTTAG,
               CONTRACTDATE,        CONTRACTNO,            LOAN_TAG,                LEASETAG,
               LASTCHANGEDATE,      CHANGETAG,             CHANGEDATE,              CANCEL_REASON,
               CHILD_BUILDNO,       CHILD_HOUSENO,         RELA_CUSTCODE,           RELA_SEQ,
               VATTAG,              EXCLUSIVEAREA,         COMMONAREA,              ETCCOMMONAREA,
               PARKINGAREA,         SERVICEAREA,           SITEAREA,                MOVEINSTARTDATE,
               MOVEINENDDATE,       UNION_CNT,             REMARK,                  REFUNDMENTDATE,
               REFUNDMENTAMT,       PENALTYAMT,            LOAN_INTEREST,           SODUK_TAX,
               JUMIN_TAX,           BANK_LOAN_ORGAMT,      BANK_LOAN_INTEREST,      LOANBANK,
               LOANDEPOSIT,         LOANUSER,              REFUND_DEPOSIT,          REFUND_BANK,
               COMP_LOANAMT,        BILL_RETURNAMT,        DELAY_INDEMINITY,        DEPOSIT_COUNT,
               CO_CUSTCODE,         CO_SANGHO,             CO_CONDITION,            CO_CATEGORY,
               CATEGORY_NAME,       SLIPDATE,              SLIPSEQ,                 INPUT_DUTY_ID,
               INPUT_DATE,          CHG_DUTY_ID,           CHG_DATE,                APPLY_YN,
               APPLY_EMPNO,         APPLY_DATE,            PRTSQUARE,               BANK_LOAN_INTEREST2,
               ETC_AMT,             RENTHD_YN,             RENTHD_SEQ,              BALCONY_TAG,
               BALCONYAREA,         DAYMONTH_TAG,          FLOOR,                   CONT_CONDITION,
               LAND_RETURN,         INT_CALC_DATE,         PREDISAMT,               PROXYAMT,
               INCONT_DATE,         TRUSTAMT,              PREDIS_TAG,              PROXY_TAG,
               TRUST_TAG,           VIR_YN,                VDEPOSIT
             )
      VALUES (:NEW.CUST_CODE,      :NEW.SEQ,              'U',                      TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),
               NEWSEQ,             :NEW.DEPT_CODE,        :NEW.HOUSETAG,           :NEW.BUILDNO,
              :NEW.HOUSENO,        :NEW.DONGHO,           :NEW.CUST_NAME,          :NEW.SQUARE,
              :NEW.TYPE,           :NEW.CLASS,            :NEW.OPTIONCODE,         :NEW.CONTRACTTAG,
              :NEW.CONTRACTDATE,   :NEW.CONTRACTNO,       :NEW.LOAN_TAG,           :NEW.LEASETAG,
              :NEW.LASTCHANGEDATE, :NEW.CHANGETAG,        :NEW.CHANGEDATE,         :NEW.CANCEL_REASON,
              :NEW.CHILD_BUILDNO,  :NEW.CHILD_HOUSENO,    :NEW.RELA_CUSTCODE,      :NEW.RELA_SEQ,
              :NEW.VATTAG,         :NEW.EXCLUSIVEAREA,    :NEW.COMMONAREA,         :NEW.ETCCOMMONAREA,
              :NEW.PARKINGAREA,    :NEW.SERVICEAREA,      :NEW.SITEAREA,           :NEW.MOVEINSTARTDATE,
              :NEW.MOVEINENDDATE,  :NEW.UNION_CNT,        :NEW.REMARK,             :NEW.REFUNDMENTDATE,
              :NEW.REFUNDMENTAMT,  :NEW.PENALTYAMT,       :NEW.LOAN_INTEREST,      :NEW.SODUK_TAX,
              :NEW.JUMIN_TAX,      :NEW.BANK_LOAN_ORGAMT, :NEW.BANK_LOAN_INTEREST, :NEW.LOANBANK,
              :NEW.LOANDEPOSIT,    :NEW.LOANUSER,         :NEW.REFUND_DEPOSIT,     :NEW.REFUND_BANK,
              :NEW.COMP_LOANAMT,   :NEW.BILL_RETURNAMT,   :NEW.DELAY_INDEMINITY,   :NEW.DEPOSIT_COUNT,
              :NEW.CO_CUSTCODE,    :NEW.CO_SANGHO,        :NEW.CO_CONDITION,       :NEW.CO_CATEGORY,
              :NEW.CATEGORY_NAME,  :NEW.SLIPDATE,         :NEW.SLIPSEQ,            :NEW.INPUT_DUTY_ID,
              :NEW.INPUT_DATE,     :NEW.CHG_DUTY_ID,      :NEW.CHG_DATE,           :NEW.APPLY_YN,
              :NEW.APPLY_EMPNO,    :NEW.APPLY_DATE,       :NEW.PRTSQUARE,          :NEW.BANK_LOAN_INTEREST2,
              :NEW.ETC_AMT,        :NEW.RENTHD_YN,        :NEW.RENTHD_SEQ,         :NEW.BALCONY_TAG,
              :NEW.BALCONYAREA,    :NEW.DAYMONTH_TAG,     :NEW.FLOOR,              :NEW.CONT_CONDITION,
              :NEW.LAND_RETURN,    :NEW.INT_CALC_DATE,    :NEW.PREDISAMT,          :NEW.PROXYAMT,
              :NEW.INCONT_DATE,    :NEW.TRUSTAMT,         :NEW.PREDIS_TAG,         :NEW.PROXY_TAG,
              :NEW.TRUST_TAG,      :NEW.VIR_YN,           :NEW.VDEPOSIT
             );

  IF  NVL(:OLD.APPLY_YN, 'N') <> NVL(:NEW.APPLY_YN, 'N') THEN BEGIN
      SELECT NVL(MAX(SN),0) + 1
        INTO NEWSEQ
        FROM HD_HOUS_APPLY
       WHERE CUST_CODE = :NEW.CUST_CODE
         AND SEQ       = :NEW.SEQ;
      INSERT INTO HD_HOUS_APPLY
                ( CUST_CODE,      SEQ,              SN,
                  DEPT_CODE,      HOUSETAG,         BUILDNO,        HOUSENO,
                  APPLY_YN,       APPLY_EMPNO,      APPLY_DATE )
         VALUES (:NEW.CUST_CODE, :NEW.SEQ,          NEWSEQ,
                 :NEW.DEPT_CODE, :NEW.HOUSETAG,    :NEW.BUILDNO,   :NEW.HOUSENO,
                 :NEW.APPLY_YN,  :NEW.APPLY_EMPNO, :NEW.APPLY_DATE);

   END; END IF;
END;


/





ALTER TRIGGER TUA_HD_HOUS_SELL
	ENABLE;




CREATE  OR REPLACE  TRIGGER TDA_HD_HOUS_SELLDETAIL
 AFTER DELETE
 ON HD_HOUS_SELLDETAIL
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

BEGIN
   SELECT NVL(MAX(WRITESEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_SELLDETAIL_LOG
    WHERE CUST_CODE = :OLD.CUST_CODE
      AND SEQ       = :OLD.SEQ
      AND COUNTS    = :OLD.COUNTS;

   INSERT INTO HD_HOUS_SELLDETAIL_LOG
             ( CUST_CODE,       SEQ,                COUNTS,               WRITETAG,
               WRITETIME,
               WRITESEQ,        DEPT_CODE,          HOUSETAG,             BUILDNO,
               HOUSENO,         AGREEDATE,          LANDAMT,              BUILDAMT,
               VATAMT,          BUNAMT,             DC_YN,                AC_YN,
               PERPECTTAG,      RECEIPTAMT,         DISTRIBUTE_RATE,      SLIPDT,
               SLIPSEQ,         INPUT_DUTY_ID,      INPUT_DATE,           CHG_DUTY_ID,
               CHG_DATE,        MANAGEAMT )
      VALUES (:OLD.CUST_CODE,  :OLD.SEQ,           :OLD.COUNTS,          'D',
               TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),
               NEWSEQ,         :OLD.DEPT_CODE,     :OLD.HOUSETAG,        :OLD.BUILDNO,
              :OLD.HOUSENO,    :OLD.AGREEDATE,     :OLD.LANDAMT,         :OLD.BUILDAMT,
              :OLD.VATAMT,     :OLD.BUNAMT,        :OLD.DC_YN,           :OLD.AC_YN,
              :OLD.PERPECTTAG, :OLD.RECEIPTAMT,    :OLD.DISTRIBUTE_RATE, :OLD.SLIPDT,
              :OLD.SLIPSEQ,    :OLD.INPUT_DUTY_ID, :OLD.INPUT_DATE,      :OLD.CHG_DUTY_ID,
              :OLD.CHG_DATE,   :OLD.MANAGEAMT);
END;


/





ALTER TRIGGER TDA_HD_HOUS_SELLDETAIL
	ENABLE;




CREATE  OR REPLACE  TRIGGER TIA_HD_HOUS_SELLDETAIL
 AFTER INSERT
 ON HD_HOUS_SELLDETAIL
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

BEGIN
   SELECT NVL(MAX(WRITESEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_SELLDETAIL_LOG
    WHERE CUST_CODE = :NEW.CUST_CODE
      AND SEQ       = :NEW.SEQ
      AND COUNTS    = :NEW.COUNTS;

   INSERT INTO HD_HOUS_SELLDETAIL_LOG
             ( CUST_CODE,       SEQ,                COUNTS,               WRITETAG,
               WRITETIME,
               WRITESEQ,        DEPT_CODE,          HOUSETAG,             BUILDNO,
               HOUSENO,         AGREEDATE,          LANDAMT,              BUILDAMT,
               VATAMT,          BUNAMT,             DC_YN,                AC_YN,
               PERPECTTAG,      RECEIPTAMT,         DISTRIBUTE_RATE,      SLIPDT,
               SLIPSEQ,         INPUT_DUTY_ID,      INPUT_DATE,           CHG_DUTY_ID,
               CHG_DATE,        MANAGEAMT )
      VALUES (:NEW.CUST_CODE,  :NEW.SEQ,           :NEW.COUNTS,          'I',
               TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),
               NEWSEQ,         :NEW.DEPT_CODE,     :NEW.HOUSETAG,        :NEW.BUILDNO,
              :NEW.HOUSENO,    :NEW.AGREEDATE,     :NEW.LANDAMT,         :NEW.BUILDAMT,
              :NEW.VATAMT,     :NEW.BUNAMT,        :NEW.DC_YN,           :NEW.AC_YN,
              :NEW.PERPECTTAG, :NEW.RECEIPTAMT,    :NEW.DISTRIBUTE_RATE, :NEW.SLIPDT,
              :NEW.SLIPSEQ,    :NEW.INPUT_DUTY_ID, :NEW.INPUT_DATE,      :NEW.CHG_DUTY_ID,
              :NEW.CHG_DATE,   :NEW.MANAGEAMT );
END;


/





ALTER TRIGGER TIA_HD_HOUS_SELLDETAIL
	ENABLE;




CREATE  OR REPLACE  TRIGGER TUA_HD_HOUS_SELLDETAIL
 AFTER UPDATE
 ON HD_HOUS_SELLDETAIL
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

BEGIN
   SELECT NVL(MAX(WRITESEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_SELLDETAIL_LOG
    WHERE CUST_CODE = :NEW.CUST_CODE
      AND SEQ       = :NEW.SEQ
      AND COUNTS    = :NEW.COUNTS;

   INSERT INTO HD_HOUS_SELLDETAIL_LOG
             ( CUST_CODE,       SEQ,                COUNTS,               WRITETAG,
               WRITETIME,
               WRITESEQ,        DEPT_CODE,          HOUSETAG,             BUILDNO,
               HOUSENO,         AGREEDATE,          LANDAMT,              BUILDAMT,
               VATAMT,          BUNAMT,             DC_YN,                AC_YN,
               PERPECTTAG,      RECEIPTAMT,         DISTRIBUTE_RATE,      SLIPDT,
               SLIPSEQ,         INPUT_DUTY_ID,      INPUT_DATE,           CHG_DUTY_ID,
               CHG_DATE )
      VALUES (:NEW.CUST_CODE,  :NEW.SEQ,           :NEW.COUNTS,          'U',
               TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),
               NEWSEQ,         :NEW.DEPT_CODE,     :NEW.HOUSETAG,        :NEW.BUILDNO,
              :NEW.HOUSENO,    :NEW.AGREEDATE,     :NEW.LANDAMT,         :NEW.BUILDAMT,
              :NEW.VATAMT,     :NEW.BUNAMT,        :NEW.DC_YN,           :NEW.AC_YN,
              :NEW.PERPECTTAG, :NEW.RECEIPTAMT,    :NEW.DISTRIBUTE_RATE, :NEW.SLIPDT,
              :NEW.SLIPSEQ,    :NEW.INPUT_DUTY_ID, :NEW.INPUT_DATE,      :NEW.CHG_DUTY_ID,
              :NEW.CHG_DATE);
END;


/





ALTER TRIGGER TUA_HD_HOUS_SELLDETAIL
	ENABLE;




CREATE  OR REPLACE  TRIGGER TDA_HD_HOUS_SELLDETAIL
 AFTER DELETE
 ON HD_HOUS_SELLDETAIL
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

BEGIN
   SELECT NVL(MAX(WRITESEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_SELLDETAIL_LOG
    WHERE CUST_CODE = :OLD.CUST_CODE
      AND SEQ       = :OLD.SEQ
      AND COUNTS    = :OLD.COUNTS;

   INSERT INTO HD_HOUS_SELLDETAIL_LOG
             ( CUST_CODE,       SEQ,                COUNTS,               WRITETAG,
               WRITETIME,
               WRITESEQ,        DEPT_CODE,          HOUSETAG,             BUILDNO,
               HOUSENO,         AGREEDATE,          LANDAMT,              BUILDAMT,
               VATAMT,          BUNAMT,             DC_YN,                AC_YN,
               PERPECTTAG,      RECEIPTAMT,         DISTRIBUTE_RATE,      SLIPDT,
               SLIPSEQ,         INPUT_DUTY_ID,      INPUT_DATE,           CHG_DUTY_ID,
               CHG_DATE,        MANAGEAMT )
      VALUES (:OLD.CUST_CODE,  :OLD.SEQ,           :OLD.COUNTS,          'D',
               TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),
               NEWSEQ,         :OLD.DEPT_CODE,     :OLD.HOUSETAG,        :OLD.BUILDNO,
              :OLD.HOUSENO,    :OLD.AGREEDATE,     :OLD.LANDAMT,         :OLD.BUILDAMT,
              :OLD.VATAMT,     :OLD.BUNAMT,        :OLD.DC_YN,           :OLD.AC_YN,
              :OLD.PERPECTTAG, :OLD.RECEIPTAMT,    :OLD.DISTRIBUTE_RATE, :OLD.SLIPDT,
              :OLD.SLIPSEQ,    :OLD.INPUT_DUTY_ID, :OLD.INPUT_DATE,      :OLD.CHG_DUTY_ID,
              :OLD.CHG_DATE,   :OLD.MANAGEAMT);
END;


/





ALTER TRIGGER TDA_HD_HOUS_SELLDETAIL
	ENABLE;




CREATE  OR REPLACE  TRIGGER TIA_HD_HOUS_SELLDETAIL
 AFTER INSERT
 ON HD_HOUS_SELLDETAIL
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

BEGIN
   SELECT NVL(MAX(WRITESEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_SELLDETAIL_LOG
    WHERE CUST_CODE = :NEW.CUST_CODE
      AND SEQ       = :NEW.SEQ
      AND COUNTS    = :NEW.COUNTS;

   INSERT INTO HD_HOUS_SELLDETAIL_LOG
             ( CUST_CODE,       SEQ,                COUNTS,               WRITETAG,
               WRITETIME,
               WRITESEQ,        DEPT_CODE,          HOUSETAG,             BUILDNO,
               HOUSENO,         AGREEDATE,          LANDAMT,              BUILDAMT,
               VATAMT,          BUNAMT,             DC_YN,                AC_YN,
               PERPECTTAG,      RECEIPTAMT,         DISTRIBUTE_RATE,      SLIPDT,
               SLIPSEQ,         INPUT_DUTY_ID,      INPUT_DATE,           CHG_DUTY_ID,
               CHG_DATE,        MANAGEAMT )
      VALUES (:NEW.CUST_CODE,  :NEW.SEQ,           :NEW.COUNTS,          'I',
               TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),
               NEWSEQ,         :NEW.DEPT_CODE,     :NEW.HOUSETAG,        :NEW.BUILDNO,
              :NEW.HOUSENO,    :NEW.AGREEDATE,     :NEW.LANDAMT,         :NEW.BUILDAMT,
              :NEW.VATAMT,     :NEW.BUNAMT,        :NEW.DC_YN,           :NEW.AC_YN,
              :NEW.PERPECTTAG, :NEW.RECEIPTAMT,    :NEW.DISTRIBUTE_RATE, :NEW.SLIPDT,
              :NEW.SLIPSEQ,    :NEW.INPUT_DUTY_ID, :NEW.INPUT_DATE,      :NEW.CHG_DUTY_ID,
              :NEW.CHG_DATE,   :NEW.MANAGEAMT );
END;


/





ALTER TRIGGER TIA_HD_HOUS_SELLDETAIL
	ENABLE;




CREATE  OR REPLACE  TRIGGER TUA_HD_HOUS_SELLDETAIL
 AFTER UPDATE
 ON HD_HOUS_SELLDETAIL
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

BEGIN
   SELECT NVL(MAX(WRITESEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_SELLDETAIL_LOG
    WHERE CUST_CODE = :NEW.CUST_CODE
      AND SEQ       = :NEW.SEQ
      AND COUNTS    = :NEW.COUNTS;

   INSERT INTO HD_HOUS_SELLDETAIL_LOG
             ( CUST_CODE,       SEQ,                COUNTS,               WRITETAG,
               WRITETIME,
               WRITESEQ,        DEPT_CODE,          HOUSETAG,             BUILDNO,
               HOUSENO,         AGREEDATE,          LANDAMT,              BUILDAMT,
               VATAMT,          BUNAMT,             DC_YN,                AC_YN,
               PERPECTTAG,      RECEIPTAMT,         DISTRIBUTE_RATE,      SLIPDT,
               SLIPSEQ,         INPUT_DUTY_ID,      INPUT_DATE,           CHG_DUTY_ID,
               CHG_DATE )
      VALUES (:NEW.CUST_CODE,  :NEW.SEQ,           :NEW.COUNTS,          'U',
               TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),
               NEWSEQ,         :NEW.DEPT_CODE,     :NEW.HOUSETAG,        :NEW.BUILDNO,
              :NEW.HOUSENO,    :NEW.AGREEDATE,     :NEW.LANDAMT,         :NEW.BUILDAMT,
              :NEW.VATAMT,     :NEW.BUNAMT,        :NEW.DC_YN,           :NEW.AC_YN,
              :NEW.PERPECTTAG, :NEW.RECEIPTAMT,    :NEW.DISTRIBUTE_RATE, :NEW.SLIPDT,
              :NEW.SLIPSEQ,    :NEW.INPUT_DUTY_ID, :NEW.INPUT_DATE,      :NEW.CHG_DUTY_ID,
              :NEW.CHG_DATE);
END;


/





ALTER TRIGGER TUA_HD_HOUS_SELLDETAIL
	ENABLE;




CREATE  OR REPLACE  TRIGGER TDA_HD_HOUS_SUPPLY
 AFTER DELETE
 ON HD_HOUS_SUPPLY
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

begin
   SELECT NVL(MAX(SEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_SUPPLY_HIST
    WHERE DEPT_CODE = :OLD.DEPT_CODE
      AND HOUSETAG  = :OLD.HOUSETAG
      AND BUILDNO   = :OLD.BUILDNO
      AND HOUSENO   = :OLD.HOUSENO;

   INSERT INTO HD_HOUS_SUPPLY_HIST
   (    DEPT_CODE      ,
        HOUSETAG       ,
        BUILDNO        ,
        HOUSENO        ,
        HIST_DATE      ,
        SEQ            ,
        SQUARE         ,
        TYPE           ,
        CLASS          ,
        OPTIONCODE     ,
        VATTAG         ,
        EXCLUSIVEAREA  ,
        COMMONAREA     ,
        ETCCOMMONAREA  ,
        PARKINGAREA    ,
        SERVICEAREA    ,
        SITEAREA       ,
        FLOOR          ,
        GUBUN          ,
        CATEGORY_NAME  ,
        CONTRACTYESNO  ,
        VIRDEPOSIT     ,
        BANK_CODE      ,
        BANK_NAME      ,
        USE_YN         ,
        RENT_TAG       ,
        INPUT_DUTY_ID  ,
        INPUT_DATE     ,
        CHG_DUTY_ID    ,
        CHG_DATE       ,
        PRTSQUARE      ,
        PREDISAMT      ,
        TRI_TAG        ,
        VIRDEPOSIT2
   )
   VALUES
   (    :OLD.DEPT_CODE      ,
        :OLD.HOUSETAG       ,
        :OLD.BUILDNO        ,
        :OLD.HOUSENO        ,
        SYSDATE             ,
        NEWSEQ              ,
        :OLD.SQUARE         ,
        :OLD.TYPE           ,
        :OLD.CLASS          ,
        :OLD.OPTIONCODE     ,
        :OLD.VATTAG         ,
        :OLD.EXCLUSIVEAREA  ,
        :OLD.COMMONAREA     ,
        :OLD.ETCCOMMONAREA  ,
        :OLD.PARKINGAREA    ,
        :OLD.SERVICEAREA    ,
        :OLD.SITEAREA       ,
        :OLD.FLOOR          ,
        :OLD.GUBUN          ,
        :OLD.CATEGORY_NAME  ,
        :OLD.CONTRACTYESNO  ,
        :OLD.VIRDEPOSIT     ,
        :OLD.BANK_CODE      ,
        :OLD.BANK_NAME      ,
        :OLD.USE_YN         ,
        :OLD.RENT_TAG       ,
        :OLD.INPUT_DUTY_ID  ,
        :OLD.INPUT_DATE     ,
        :OLD.CHG_DUTY_ID    ,
        :OLD.CHG_DATE       ,
        :OLD.PRTSQUARE      ,
        :OLD.PREDISAMT      ,
        'D'                 ,
        :OLD.VIRDEPOSIT2
   );
end;


/





ALTER TRIGGER TDA_HD_HOUS_SUPPLY
	ENABLE;




CREATE  OR REPLACE  TRIGGER TDB_HD_HOUS_SUPPLY
 BEFORE DELETE
 ON HD_HOUS_SUPPLY
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
BEGIN
   DELETE HD_REFER_SELLDETAIL
    WHERE DEPT_CODE = :OLD.DEPT_CODE
      AND HOUSETAG  = :OLD.HOUSETAG
      AND BUILDNO   = :OLD.BUILDNO
      AND HOUSENO   = :OLD.HOUSENO;
END;


/





ALTER TRIGGER TDB_HD_HOUS_SUPPLY
	ENABLE;




CREATE  OR REPLACE  TRIGGER TUA_HD_HOUS_SUPPLY
 AFTER UPDATE
 ON HD_HOUS_SUPPLY
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

begin
   SELECT NVL(MAX(SEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_SUPPLY_HIST
    WHERE DEPT_CODE = :OLD.DEPT_CODE
      AND HOUSETAG  = :OLD.HOUSETAG
      AND BUILDNO   = :OLD.BUILDNO
      AND HOUSENO   = :OLD.HOUSENO;

   INSERT INTO HD_HOUS_SUPPLY_HIST
   (    DEPT_CODE      ,
        HOUSETAG       ,
        BUILDNO        ,
        HOUSENO        ,
        HIST_DATE      ,
        SEQ            ,
        SQUARE         ,
        TYPE           ,
        CLASS          ,
        OPTIONCODE     ,
        VATTAG         ,
        EXCLUSIVEAREA  ,
        COMMONAREA     ,
        ETCCOMMONAREA  ,
        PARKINGAREA    ,
        SERVICEAREA    ,
        SITEAREA       ,
        FLOOR          ,
        GUBUN          ,
        CATEGORY_NAME  ,
        CONTRACTYESNO  ,
        VIRDEPOSIT     ,
        BANK_CODE      ,
        BANK_NAME      ,
        USE_YN         ,
        RENT_TAG       ,
        INPUT_DUTY_ID  ,
        INPUT_DATE     ,
        CHG_DUTY_ID    ,
        CHG_DATE       ,
        PRTSQUARE      ,
        PREDISAMT      ,
        TRI_TAG        ,
        VIRDEPOSIT2
   )
   VALUES
   (    :OLD.DEPT_CODE      ,
        :OLD.HOUSETAG       ,
        :OLD.BUILDNO        ,
        :OLD.HOUSENO        ,
        SYSDATE             ,
        NEWSEQ              ,
        :OLD.SQUARE         ,
        :OLD.TYPE           ,
        :OLD.CLASS          ,
        :OLD.OPTIONCODE     ,
        :OLD.VATTAG         ,
        :OLD.EXCLUSIVEAREA  ,
        :OLD.COMMONAREA     ,
        :OLD.ETCCOMMONAREA  ,
        :OLD.PARKINGAREA    ,
        :OLD.SERVICEAREA    ,
        :OLD.SITEAREA       ,
        :OLD.FLOOR          ,
        :OLD.GUBUN          ,
        :OLD.CATEGORY_NAME  ,
        :OLD.CONTRACTYESNO  ,
        :OLD.VIRDEPOSIT     ,
        :OLD.BANK_CODE      ,
        :OLD.BANK_NAME      ,
        :OLD.USE_YN         ,
        :OLD.RENT_TAG       ,
        :OLD.INPUT_DUTY_ID  ,
        :OLD.INPUT_DATE     ,
        :OLD.CHG_DUTY_ID    ,
        :OLD.CHG_DATE       ,
        :OLD.PRTSQUARE      ,
        :OLD.PREDISAMT      ,
        'U'                 ,
        :OLD.VIRDEPOSIT2
   );
end;


/





ALTER TRIGGER TUA_HD_HOUS_SUPPLY
	ENABLE;




CREATE  OR REPLACE  TRIGGER TDA_HD_HOUS_SUPPLY
 AFTER DELETE
 ON HD_HOUS_SUPPLY
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

begin
   SELECT NVL(MAX(SEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_SUPPLY_HIST
    WHERE DEPT_CODE = :OLD.DEPT_CODE
      AND HOUSETAG  = :OLD.HOUSETAG
      AND BUILDNO   = :OLD.BUILDNO
      AND HOUSENO   = :OLD.HOUSENO;

   INSERT INTO HD_HOUS_SUPPLY_HIST
   (    DEPT_CODE      ,
        HOUSETAG       ,
        BUILDNO        ,
        HOUSENO        ,
        HIST_DATE      ,
        SEQ            ,
        SQUARE         ,
        TYPE           ,
        CLASS          ,
        OPTIONCODE     ,
        VATTAG         ,
        EXCLUSIVEAREA  ,
        COMMONAREA     ,
        ETCCOMMONAREA  ,
        PARKINGAREA    ,
        SERVICEAREA    ,
        SITEAREA       ,
        FLOOR          ,
        GUBUN          ,
        CATEGORY_NAME  ,
        CONTRACTYESNO  ,
        VIRDEPOSIT     ,
        BANK_CODE      ,
        BANK_NAME      ,
        USE_YN         ,
        RENT_TAG       ,
        INPUT_DUTY_ID  ,
        INPUT_DATE     ,
        CHG_DUTY_ID    ,
        CHG_DATE       ,
        PRTSQUARE      ,
        PREDISAMT      ,
        TRI_TAG        ,
        VIRDEPOSIT2
   )
   VALUES
   (    :OLD.DEPT_CODE      ,
        :OLD.HOUSETAG       ,
        :OLD.BUILDNO        ,
        :OLD.HOUSENO        ,
        SYSDATE             ,
        NEWSEQ              ,
        :OLD.SQUARE         ,
        :OLD.TYPE           ,
        :OLD.CLASS          ,
        :OLD.OPTIONCODE     ,
        :OLD.VATTAG         ,
        :OLD.EXCLUSIVEAREA  ,
        :OLD.COMMONAREA     ,
        :OLD.ETCCOMMONAREA  ,
        :OLD.PARKINGAREA    ,
        :OLD.SERVICEAREA    ,
        :OLD.SITEAREA       ,
        :OLD.FLOOR          ,
        :OLD.GUBUN          ,
        :OLD.CATEGORY_NAME  ,
        :OLD.CONTRACTYESNO  ,
        :OLD.VIRDEPOSIT     ,
        :OLD.BANK_CODE      ,
        :OLD.BANK_NAME      ,
        :OLD.USE_YN         ,
        :OLD.RENT_TAG       ,
        :OLD.INPUT_DUTY_ID  ,
        :OLD.INPUT_DATE     ,
        :OLD.CHG_DUTY_ID    ,
        :OLD.CHG_DATE       ,
        :OLD.PRTSQUARE      ,
        :OLD.PREDISAMT      ,
        'D'                 ,
        :OLD.VIRDEPOSIT2
   );
end;


/





ALTER TRIGGER TDA_HD_HOUS_SUPPLY
	ENABLE;




CREATE  OR REPLACE  TRIGGER TDB_HD_HOUS_SUPPLY
 BEFORE DELETE
 ON HD_HOUS_SUPPLY
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
BEGIN
   DELETE HD_REFER_SELLDETAIL
    WHERE DEPT_CODE = :OLD.DEPT_CODE
      AND HOUSETAG  = :OLD.HOUSETAG
      AND BUILDNO   = :OLD.BUILDNO
      AND HOUSENO   = :OLD.HOUSENO;
END;


/





ALTER TRIGGER TDB_HD_HOUS_SUPPLY
	ENABLE;




CREATE  OR REPLACE  TRIGGER TUA_HD_HOUS_SUPPLY
 AFTER UPDATE
 ON HD_HOUS_SUPPLY
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
DECLARE NEWSEQ INTEGER;

begin
   SELECT NVL(MAX(SEQ),0) + 1
     INTO NEWSEQ
     FROM HD_HOUS_SUPPLY_HIST
    WHERE DEPT_CODE = :OLD.DEPT_CODE
      AND HOUSETAG  = :OLD.HOUSETAG
      AND BUILDNO   = :OLD.BUILDNO
      AND HOUSENO   = :OLD.HOUSENO;

   INSERT INTO HD_HOUS_SUPPLY_HIST
   (    DEPT_CODE      ,
        HOUSETAG       ,
        BUILDNO        ,
        HOUSENO        ,
        HIST_DATE      ,
        SEQ            ,
        SQUARE         ,
        TYPE           ,
        CLASS          ,
        OPTIONCODE     ,
        VATTAG         ,
        EXCLUSIVEAREA  ,
        COMMONAREA     ,
        ETCCOMMONAREA  ,
        PARKINGAREA    ,
        SERVICEAREA    ,
        SITEAREA       ,
        FLOOR          ,
        GUBUN          ,
        CATEGORY_NAME  ,
        CONTRACTYESNO  ,
        VIRDEPOSIT     ,
        BANK_CODE      ,
        BANK_NAME      ,
        USE_YN         ,
        RENT_TAG       ,
        INPUT_DUTY_ID  ,
        INPUT_DATE     ,
        CHG_DUTY_ID    ,
        CHG_DATE       ,
        PRTSQUARE      ,
        PREDISAMT      ,
        TRI_TAG        ,
        VIRDEPOSIT2
   )
   VALUES
   (    :OLD.DEPT_CODE      ,
        :OLD.HOUSETAG       ,
        :OLD.BUILDNO        ,
        :OLD.HOUSENO        ,
        SYSDATE             ,
        NEWSEQ              ,
        :OLD.SQUARE         ,
        :OLD.TYPE           ,
        :OLD.CLASS          ,
        :OLD.OPTIONCODE     ,
        :OLD.VATTAG         ,
        :OLD.EXCLUSIVEAREA  ,
        :OLD.COMMONAREA     ,
        :OLD.ETCCOMMONAREA  ,
        :OLD.PARKINGAREA    ,
        :OLD.SERVICEAREA    ,
        :OLD.SITEAREA       ,
        :OLD.FLOOR          ,
        :OLD.GUBUN          ,
        :OLD.CATEGORY_NAME  ,
        :OLD.CONTRACTYESNO  ,
        :OLD.VIRDEPOSIT     ,
        :OLD.BANK_CODE      ,
        :OLD.BANK_NAME      ,
        :OLD.USE_YN         ,
        :OLD.RENT_TAG       ,
        :OLD.INPUT_DUTY_ID  ,
        :OLD.INPUT_DATE     ,
        :OLD.CHG_DUTY_ID    ,
        :OLD.CHG_DATE       ,
        :OLD.PRTSQUARE      ,
        :OLD.PREDISAMT      ,
        'U'                 ,
        :OLD.VIRDEPOSIT2
   );
end;


/





ALTER TRIGGER TUA_HD_HOUS_SUPPLY
	ENABLE;




CREATE  OR REPLACE  TRIGGER TDB_HD_REFER_SQUARE
 BEFORE DELETE
 ON HD_REFER_SQUARE
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
BEGIN
   DELETE HD_REFER_SQUAREDETAIL
    WHERE DEPT_CODE = :OLD.DEPT_CODE
      AND HOUSETAG  = :OLD.HOUSETAG
      AND SEQ       = :OLD.SEQ;
END;


/





ALTER TRIGGER TDB_HD_REFER_SQUARE
	ENABLE;




CREATE  OR REPLACE  TRIGGER TDB_HD_REFER_SQUARE
 BEFORE DELETE
 ON HD_REFER_SQUARE
 REFERENCING OLD AS OLD NEW AS NEW
 for each row
 
BEGIN
   DELETE HD_REFER_SQUAREDETAIL
    WHERE DEPT_CODE = :OLD.DEPT_CODE
      AND HOUSETAG  = :OLD.HOUSETAG
      AND SEQ       = :OLD.SEQ;
END;


/





ALTER TRIGGER TDB_HD_REFER_SQUARE
	ENABLE;


