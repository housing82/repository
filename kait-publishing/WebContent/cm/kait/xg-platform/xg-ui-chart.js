(function(){"use strict";!function(a,b){return"function"==typeof define&&define.amd?define("XgUIChart",["jquery","XgCommon","XgUICommon"],b):a.XgUIChart=b(a.jQuery,a.XgCommon,a.XgUICommon)}(window,function(a,b,c){var d,e,f="xg-ui-chart.js";return XgPlatform.XgLogger.info(function(){return f+" : load start"}),e=function(d,e,f){var g,h=d.data("xg-bind-option"),i={},j=d.data("xg-bind-data-set"),k=d.data("xg-bind-data-table");return c.setUUID(d),d.data("xg-bind-data-table-id",k.getId()),j.bindComponent(d,"jqxChart"),h||(h={bind:{type:"row",column:void 0}}),a.extend(!0,i,h,e),c.setBindColInfo(k,i),d.data("xg-bind-option",i),c.removeEvents(d,["xg-bind-event"]),f.source&&d.data("xg-ui-adapter",f.source),g=d.jqxChart("source"),"row"===i.bind.type&&(g.records=[{}],d.jqxChart({source:g})),d.on("xg-bind-event",function(f,h){var j,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=d.jqxChart("seriesGroups");if(a(this).data("xg-uuid")===h.uuid)return!1;if(k.getId()!==h.xgDataTableId)return!1;if("setRowPos"===h.eventName){if(v=k.getRow(k.getRowPos()),"row"===i.bind.type){for(z={},q=k.header,l=0,m=q.length;m>l;++l)j=q[l],n=j[b.constant.COLUMN.TYPE_OF_GAUCE],r=v[j[b.constant.COLUMN.INDEX]],z[j[b.constant.COLUMN.NAME]]=r,g.records.length&&(g.records[0][j[b.constant.COLUMN.NAME]]=r);g.records.length||(g.records=[z],d.jqxChart({source:g})),d.jqxChart("update")}}else if("setValue"===h.eventName){if("row"===i.bind.type&&k.getRowPos()===h.rowIdx){if(!g.records.length){for(v={},v["*xgRowStatus"]=b.constant.STATUS.INSERT,w=k.getRow(k.getRowPos()),q=k.header,l=0,m=q.length;m>l;++l)j=q[l],v[j[b.constant.COLUMN.NAME]]=w[j[b.constant.COLUMN.INDEX]];g.records.push(v)}g.records[0][h.bind.column]=h.value}if("column"===i.bind.type){for(t=g.records,o=0,p=t.length;p>o;++o)s=t[o],s["*xgRowIdx"]===h.rowIdx&&(g.records[o][h.bind.column]=h.value);if(g.xAxis&&g.records.sort(function(a,c){var d=c[g.xAxis],e=a[g.xAxis];return"string"==typeof e&&e.indexOf("-")>-1&&b.isValidDate(e)&&(e=new Date(e).getTime()),"string"==typeof d&&d.indexOf("-")>-1&&b.isValidDate(d)&&(d=new Date(d).getTime()),e-d}),B=D[0].type,1===D.length&&("pie"===B||"donut"===B)){for(u=!1,y=D[0].series,o=0,p=y.length;p>o;++o)if(x=y[o],x.dataField===h.bind.column){u=!0;break}return void(u&&d.jqxChart("refresh"))}}else"rows"===i.bind.type&&(g.records[h.rowIdx][h.bind.column]=h.value);d.jqxChart("update")}else if("addRow"===h.eventName)B=i.bind.type,("column"===B||"rows"===B)&&(C=d.jqxChart("xAxis"),A=c.createUIAdapter(k,"xgChart",C.dataField),g.records=A.records,d.jqxChart({source:g}),d.jqxChart("refresh"));else if("xgDataTableInit"===h.eventName)return e?"row"===i.bind.type?(g.records=[{}],d.jqxChart("update")):(C=d.jqxChart("xAxis"),A=c.createUIAdapter(k,"xgChart",C.dataField),g.records=A.records,d.jqxChart({source:g}),d.jqxChart("refresh")):d.jqxChart("refresh")}),d},a.fn.xgChart=function(){var d,g,h,i,j,k,l,m,n,o,p,q,r,s,t=arguments;if(a(this).attr("data-xg-chart",""),h=this.selector?this.selector:this,XgPlatform.XgLogger.debug(function(){return["XgUIChart",h,t]}),arguments[0]instanceof Object&&(n=arguments[0],p=n.width,i=n.height,null!==p&&void 0!==p&&("number"==typeof p&&(p+="px"),a(this).css("width",p)),null!==i&&void 0!==i&&("number"==typeof i&&(i+="px"),a(this).css("height",i)),b.deleteProperties(n,["width","height"]),n.xgInitOption)){if(l={},j=a(this).data("xg-init-option"),a.extend(!0,l,j,n.xgInitOption),a(this).data("xg-init-option",l),s=void 0,"string"==typeof n.xgInitOption.xgDataSet&&(n.xgInitOption.xgDataSet=b.getDataSet(n.xgInitOption.xgDataSet)),"string"==typeof n.xgInitOption.xgDataTable){if(!n.xgInitOption.xgDataSet)throw new b.Error("Require xgDataSet option property",f);s=n.xgInitOption.xgDataSet.getDataTable(n.xgInitOption.xgDataTable)}return"object"==typeof n.xgInitOption.xgDataTable&&(s=n.xgInitOption.xgDataTable),a(this).data("xg-bind-data-set",n.xgInitOption.xgDataSet),a(this).data("xg-bind-data-table",s),q=void 0,n.xAxis&&n.xAxis.dataField&&(q=n.xAxis.dataField),o=s.uiAdapter,n.xgBindOption?(k=c.createUIAdapter(s,"xgChart",q),k.xAxis=q,n.source=k,r=n.xgBindOption,b.deleteProperties(n,["xgInitOption","xgBindOption"]),d=a(this).jqxChart(n),e(d,r,n)):(b.deleteProperties(n,["xgInitOption"]),o?n.source=o:(s.uiAdapter=c.createUIAdapter(s,"xgGrid"),n.source=s.uiAdapter),d=a(this).jqxChart(n)),d}if(m=arguments[0],"string"==typeof m){if("width"===m||"height"===m)return g=a(this).data("xg-bind-option"),g?g[m]:void 0;if("xgInitOption"===m)return a(this).data("xg-init-option");if("xgBindOption"===m)return a(this).data("xg-bind-option")}return a.fn.jqxChart.apply(this,arguments)},d=function(){var b=Array.prototype.slice.call(arguments,0,1)[0],c=Array.prototype.slice.call(arguments,1)[0];return c||a(b).xgChart(),c&&a(b).xgChart(c),a(b)},a(document).ready(function(){var b,c,d,e,f,g=a("[data-xg-chart]"),h=[];for(e=0,f=g.length;f>e;++e)d=g[e],b=a(d),c=b.data("xg-option"),c&&b.xgChart(c),h.push(c?void 0:b.xgChart());return h}),XgPlatform.XgLogger.info(function(){return f+" : load end"}),d})}).call(this);