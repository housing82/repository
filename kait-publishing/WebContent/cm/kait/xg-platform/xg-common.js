(function(){"use strict";var a={}.hasOwnProperty;!function(a,b){return"function"==typeof define&&define.amd?define("XgCommon",[],b):a.XgCommon=b()}(window,function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;if(p="xg-common.js",b={},b.getIEVersion=function(){var a,b,c;return b=-1,"Microsoft Internet Explorer"===navigator.appName&&(c=navigator.userAgent,a=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),null!==a.exec(c)&&(b=parseFloat(RegExp.$1))),b},j=b.getIEVersion(),b.isOlderBrowser=function(){return-1!==j&&10>j?!0:!1},b.isIEBrowser=function(){return-1!==j?!0:!1},b.isOlderBrowser)for(m=["assert","assert","cd","clear","count","countReset","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","select","table","time","timeEnd","timeStamp","timeline","timelineEnd","trace","warn"],k=m.length,c=window.console=window.console||{},n=function(){};k--;)l=m[k],c[l]||(c[l]=n);if(10!==j||ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(a,b){var c,d,e;return void 0===a&&(a=0),void 0===b&&(b=this.byteLength),a=Math.floor(a),b=Math.floor(b),0>a&&(a+=this.byteLength),0>b&&(b+=this.byteLength),a=Math.min(Math.max(0,a),this.byteLength),b=Math.min(Math.max(0,b),this.byteLength),0>=b-a?new ArrayBuffer(0):(c=new ArrayBuffer(b-a),d=new Uint8Array(c),e=new Uint8Array(this,a,b-a),d.set(e),c)}),window.XgPlatform||(window.XgPlatform={XgLogger:{TRACE_LEVEL:1,DEBUG_LEVEL:2,INFO_LEVEL:3,WARN_LEVEL:4,ERROR_LEVEL:5,level:3,trace:function(a){return this.level===this.TRACE_LEVEL?c.trace(a()):void 0},debug:function(a){return this.level<=this.DEBUG_LEVEL?c.debug(a()):void 0},info:function(a){return this.level<=this.INFO_LEVEL?c.info(a()):void 0},warn:function(a){return this.level<=this.WARN_LEVEL?c.warn(a()):void 0},error:function(a){return this.level<=this.ERROR_LEVEL?c.error(a()):void 0}},XgDataSet:{},XgPath:"./xg-platform",XgDataType:"JSON"}),XgPlatform.XgLogger.info(function(){return p+" : load start"}),b.Pool=function(a){var c;return c=this,this.taskQueue=[],this.workerQueue=[],this.poolSize=a,this.addWorkerTask=function(a){var b;return c.workerQueue.length?(b=c.workerQueue.shift(),b.run(a)):c.taskQueue.push(a)},this.init=function(){var d,e,f,g;for(c.workerQueue=[],g=[],d=e=0,f=a-1;f>=0?f>=e:e>=f;d=f>=0?++e:--e)g.push(c.workerQueue.push(new b.WorkerThread(c)));return g},this.freeWorkerThread=function(b){var d;return c.taskQueue.length?(d=c.taskQueue.shift(),b.run(d),c.taskQueue.length||c.workerQueue.length?void 0:c.init(a)):c.taskQueue.push(b)},this},b.WorkerThread=function(a){var b,c;return c=this,this.parentPool=a,this.workerTask={},this.run=function(a){var d;return c.workerTask=a,a.script?(d=new Worker(a.script),d.addEventListener("message",b,!1),d.onerror=function(a){return XgPlatform.XgLogger.error(function(){return["XgCommon.WorkerThread",a]}),c.parentPool.freeWorkerThread(c)},d.postMessage([a.startMessage,a.data])):void 0},b=function(a){return c.workerTask.callback(a),a.data.step&&"close"===a.data.step?c.parentPool.freeWorkerThread(c):void 0},this},b.WorkerTask=function(a,b,c,d){return this.script=a,this.callback=b,this.startMessage=c,this.data=d,this},b.getThreadPoolSize=function(){var a;try{return a=localStorage.getItem("xg-pool-size"),null!==a&&void 0!==a&&a.length&&(a=parseInt(a)),a}catch(b){return 2}},b.setThreadPoolSize=function(a){a=a||4;try{return localStorage.setItem("xg-pool-size",a),this}catch(b){return this}},b.constant={COLUMN:{INDEX:0,NAME:1,TYPE:2,TYPE_OF_GAUCE:3,SIZE:4,CONSTRAINT:5},CONSTRAINT:{KEY:"key",NORMAL:"normal",NOTNULL:"notnull",SEQUENCE:"sequence"},CRUD:{CREATE:"C",READ:"R",UPDATE:"U",DELETE:"D"},STATUS:{UNKNOWN:0,NORMAL:1,INSERT:2,UPDATE:3,DELETE:4},DATATYPE_GAUCE:{string:1,"int":2,decimal:4,date:8,blob:9,url:10,"long":11,"char":12,bigint:13,datetime:16},DATATYPE:{int8:1,int16:2,int32:3,int64:4,uint8:5,uint16:6,uint32:7,uint64:8,string:9,"double":10,bit:11,bool:12,unknown:13,array:14,pvoid:18,variant:22},RANGE_OF_GAUCE:{INT:{MAX:2147483647,MIN:-2147483648},LONG:{MAX:0x8000000000000000,MIN:-0x8000000000000000},DECIMAL:{MAX:Number.MAX_VALUE,MIN:Number.MIN_VALUE},BIGINT:{MAX:Number.MAX_VALUE,MIN:Number.MIN_VALUE}},PACKET_SIZE:{PS:2,PD:15,PV:18,PT:2,PI:40,PC:1,PP:1,PR:40,PL:10},DATASET_SIZE:{DSNM:40,DSTP:4,DSCR:4,DSIU:4,DSIP:4,DSVM:4,DSVU:4,DSRP:4,DSRC:4,DSCC:4,DSCS:4},COLUMN_SIZE:{CNM:40,CVR:4,CVS:4,CTP:4,CPR:4,CSZ:4,CDS:4},ROW_SIZE:{RO:4,RS:4,RJ:4,RF:4},CONSTRAINT_NUM:{NORMAL:0,NOTNULL:1,KEY:3,SEQUENCE:7}},b.createUUID=function(){var a;return a=arguments,XgPlatform.XgLogger.debug(function(){return["XgCommon.createUUID",a]}),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b,c;return b=16*Math.random()|0,c="x"===a?b:3&b|8,c.toString(16)})},b.stringToXML=function(a){var c;if(c=void 0,window.DOMParser)c=function(a){return(new window.DOMParser).parseFromString(a,"text/xml")};else{if(!window.ActiveXObject)throw new b.Error("Can not find XML dom parser",p);c=function(a){var b;return b=new window.ActiveXObject("Microsoft.XMLDOM"),b.async=!1,b.loadXML(a),b}}return c(a)},b.getKeyByValue=function(a,c){var d,e,f,g,h,i;if(i=arguments,XgPlatform.XgLogger.debug(function(){return["XgCommon.getKeyByValue",i]}),"object"!=typeof a)throw new b.Error("First argument must be object",p);for(g=Object.keys(a),d=void 0,e=0,h=g.length;h>e;e++)if(f=g[e],a[f]===c){d=f;break}return d},b.isValidDate=function(a){var b,c;return c=arguments,XgPlatform.XgLogger.debug(function(){return["XgCommon.isValidDate",c]}),b=new Date(a),Object.prototype.toString.call("[object Date]"===b)?!isNaN(b.getTime()):!1},b.getGauceDateStr=function(a){var b,c,d,e;return d=arguments,XgPlatform.XgLogger.debug(function(){return["XgCommon.getGauceDateStr",d]}),e=a.getFullYear().toString(),c=(a.getMonth()+1).toString(),b=a.getDate().toString(),10>c&&(c="0"+c),10>b&&(b="0"+b),e+c+b},b.getDateStrFromGauceDate=function(a){var c,d;return d=arguments,XgPlatform.XgLogger.debug(function(){return["XgCommon.getDateStrFromGauceDate",d]}),c=a,null===a||void 0===a?"":("string"!=typeof a||b.isValidDate(a)||8!==a.length||(a=a.toString(),c=a.substring(0,4)+"-"+a.substring(4,6)+"-"+a.substring(6,8)),c)},b.deleteProperties=function(a,b){var c,d,e,f;if(f=arguments,XgPlatform.XgLogger.debug(function(){return["XgCommon.deleteProperties",f]}),"string"==typeof b&&delete a.properties,b instanceof Array)for(c=0,d=b.length;d>c;c++)e=b[c],delete a[e];return this},b.getDataSet=function(a){var b,c;return b=arguments,XgPlatform.XgLogger.debug(function(){return["XgCommon.getDataSet",b]}),c=window.XgPlatform.XgDataSet[a]},b.setDataSet=function(a){var c;if(c=arguments,XgPlatform.XgLogger.debug(function(){return["XgCommon.setDataSet",c]}),window.XgPlatform.XgDataSet[a.getId()])throw new b.Error("[ "+a.getId()+" ] xgDataSet already registered in XgPlatform",p);return window.XgPlatform.XgDataSet[a.getId()]=a,this},b.deepFreeze=function(c){var d,e;Object.freeze(c);for(d in c)a.call(c,d)&&(e=c[d],null!==e&&void 0!==e&&"object"==typeof e&&Object.isFrozen(e)!==!0&&b.deepFreeze(c[d]));return c},b.filterXSS=function(a){var b;return b=a,"string"==typeof a&&(b=a.replace(/</g,"&lt;").replace(/>/g,"&gt;")),b},b.Error=function(a,b,c){return Object.create||(this.prototype=Error.apply(null,arguments)),this.message="XgError : "+a,this.fileName=b,this.code=c,this},Object.create&&(b.Error.prototype=Object.create(Error),b.Error.prototype.constructor=b.Error),Object.freeze&&b.deepFreeze(b),window.XgPlatform.threadPool||(o=b.getThreadPoolSize(),o||(b.setThreadPoolSize(),o=b.getThreadPoolSize()),window.XgPlatform.threadPool=new b.Pool(o),window.XgPlatform.threadPool.init()),!DOMImplementation.prototype.createDocument){for(i=0,d=void 0,e=void 0,f=["MSXML6.DOMDocument","MSXML5.DOMDocument","MSXML4.DOMDocument","MSXML3.DOMDocument","MSXML2.DOMDocument.5.0","MSXML2.DOMDocument.4.0","MSXML2.DOMDocument.3.0","MSXML2.DOMDocument","MSXML.DomDocument","Microsoft.XmlDom"],g=f.length;g>i;){try{d=new ActiveXObject(f[i]),e=f[i];break}catch(q){h=q}i++}DOMImplementation.prototype.createDocument=function(a,b,c){var d,f,g,h;if(c)throw"This is not a complete shim for DOMImplementation.prototype.createDocument.";if(!e)throw"Could not create a DOM document object";return f=void 0,g=void 0,h="",d=new ActiveXObject(e),b&&(f=b.indexOf(":"),f>-1?(g=b.slice(0,f),h=" xmlns:"+g+'="'+a+'"'):a&&(h=' xmlns="'+a+'"'),d.loadXML("<"+b+h+"/>")),d}}return XgPlatform.XgLogger.info(function(){return p+" : load end"}),b})}).call(this);