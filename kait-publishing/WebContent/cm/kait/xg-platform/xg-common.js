(function(){"use strict";var a={}.hasOwnProperty;!function(a,b){return"function"==typeof define&&define.amd?define("XgCommon",[],b):a.XgCommon=b()}(window,function(){var b,c,d,e,f,g,h,i,j,k,l,m,n={},o="xg-common.js";if(n.getIEVersion=function(){var a,b,c=-1;return"Microsoft Internet Explorer"===navigator.appName&&(b=navigator.userAgent,a=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),null!==a.exec(b)&&(c=parseFloat(RegExp.$1))),c},h=n.getIEVersion(),n.isOlderBrowser=function(){return-1!==h&&10>h},n.isIEBrowser=function(){return-1!==h},n.isOlderBrowser)for(k=["assert","assert","cd","clear","count","countReset","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","select","table","time","timeEnd","timeStamp","timeline","timelineEnd","trace","warn"],i=k.length,b=window.console=window.console||{},l=function(){};i--;)j=k[i],b[j]||(b[j]=l);if(10!==h||ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(a,b){var c,d,e;return void 0===a&&(a=0),void 0===b&&(b=this.byteLength),a=Math.floor(a),b=Math.floor(b),0>a&&(a+=this.byteLength),0>b&&(b+=this.byteLength),a=Math.min(Math.max(0,a),this.byteLength),b=Math.min(Math.max(0,b),this.byteLength),0>=b-a?new ArrayBuffer(0):(c=new ArrayBuffer(b-a),d=new Uint8Array(c),e=new Uint8Array(this,a,b-a),d.set(e),c)}),window.XgPlatform||(window.XgPlatform={XgLogger:{TRACE_LEVEL:1,DEBUG_LEVEL:2,INFO_LEVEL:3,WARN_LEVEL:4,ERROR_LEVEL:5,level:4,trace:function(a){return this.level===this.TRACE_LEVEL?b.trace(a()):void 0},debug:function(a){return this.level<=this.DEBUG_LEVEL?b.debug(a()):void 0},info:function(a){return this.level<=this.INFO_LEVEL?b.info(a()):void 0},warn:function(a){return this.level<=this.WARN_LEVEL?b.warn(a()):void 0},error:function(a){return this.level<=this.ERROR_LEVEL?b.error(a()):void 0}},XgDataSet:{},XgPath:"./xg-platform",XgDataType:"JSON"}),XgPlatform.XgLogger.info(function(){return o+" : load start"}),n.Pool=function(a){var b=this;return this.taskQueue=[],this.workerQueue=[],this.addWorkerTask=function(a){var c;return b.workerQueue.length?(c=b.workerQueue.shift(),c.run(a)):b.taskQueue.push(a)},this.init=function(){var c,d=[];for(b.workerQueue=[],c=0;a>c;++c)d.push(b.workerQueue.push(new n.WorkerThread(b)));return d},this.freeWorkerThread=function(c){var d;return b.taskQueue.length?(d=b.taskQueue.shift(),c.run(d),b.taskQueue.length||b.workerQueue.length?void 0:b.init(a)):b.taskQueue.push(c)},this},n.WorkerThread=function(a){var b,c=this;return this.parentPool=a,this.workerTask={},this.run=function(a){var d;return c.workerTask=a,a.script?(d=new Worker(a.script),d.addEventListener("message",b,!1),d.onerror=function(a){return XgPlatform.XgLogger.error(function(){return["XgCommon.WorkerThread",a]}),c.parentPool.freeWorkerThread(c)},d.postMessage([a.startMessage,a.data])):void 0},b=function(a){return c.workerTask.callback(a),a.data.step&&"close"===a.data.step?c.parentPool.freeWorkerThread(c):void 0},this},n.WorkerTask=function(a,b,c,d){return this.script=a,this.callback=b,this.startMessage=c,this.data=d,this},n.getThreadPoolSize=function(){try{var a=localStorage.getItem("xg-pool-size");return null!==a&&void 0!==a&&a.length&&(a=parseInt(a)),a}catch(b){return 2}},n.setThreadPoolSize=function(a){try{return a=a||4,localStorage.setItem("xg-pool-size",a),this}catch(b){return this}},n.constant={COLUMN:{INDEX:0,NAME:1,TYPE:2,TYPE_OF_GAUCE:3,SIZE:4,CONSTRAINT:5},CONSTRAINT:{KEY:"key",NORMAL:"normal",NOTNULL:"notnull",SEQUENCE:"sequence"},CRUD:{CREATE:"C",READ:"R",UPDATE:"U",DELETE:"D"},STATUS:{UNKNOWN:0,NORMAL:1,INSERT:2,UPDATE:3,DELETE:4},DATATYPE_GAUCE:{string:1,"int":2,decimal:4,date:8,blob:9,url:10,"long":11,"char":12,bigint:13,datetime:16},DATATYPE:{int8:1,int16:2,int32:3,int64:4,uint8:5,uint16:6,uint32:7,uint64:8,string:9,"double":10,bit:11,bool:12,unknown:13,array:14,pvoid:18,variant:22},RANGE_OF_GAUCE:{INT:{MAX:2147483647,MIN:-2147483648},LONG:{MAX:0x8000000000000000,MIN:-0x8000000000000000},DECIMAL:{MAX:Number.MAX_VALUE,MIN:Number.MIN_VALUE},BIGINT:{MAX:Number.MAX_VALUE,MIN:Number.MIN_VALUE}},PACKET_SIZE:{PS:2,PD:15,PV:18,PT:2,PI:40,PC:1,PP:1,PR:40,PL:10},DATASET_SIZE:{DSNM:40,DSTP:4,DSCR:4,DSIU:4,DSIP:4,DSVM:4,DSVU:4,DSRP:4,DSRC:4,DSCC:4,DSCS:4},COLUMN_SIZE:{CNM:40,CVR:4,CVS:4,CTP:4,CPR:4,CSZ:4,CDS:4},ROW_SIZE:{RO:4,RS:4,RJ:4,RF:4},CONSTRAINT_NUM:{NORMAL:0,NOTNULL:1,KEY:3,SEQUENCE:7}},n.createUUID=function(){var a=arguments;return XgPlatform.XgLogger.debug(function(){return["XgCommon.createUUID",a]}),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;return c.toString(16)})},n.stringToXML=function(a){var b=void 0;if(window.DOMParser)b=function(a){return(new window.DOMParser).parseFromString(a,"text/xml")};else{if(!window.ActiveXObject)throw new n.Error("Can not find XML dom parser",o);b=function(a){var b=new window.ActiveXObject("Microsoft.XMLDOM");return b.async=!1,b.loadXML(a),b}}return b(a)},n.getKeyByValue=function(a,b){var c,d,e,f,g=void 0,h=arguments;if(XgPlatform.XgLogger.debug(function(){return["XgCommon.getKeyByValue",h]}),"object"!=typeof a)throw new n.Error("First argument must be object",o);for(e=Object.keys(a),c=0,f=e.length;f>c;c++)if(d=e[c],a[d]===b){g=d;break}return g},n.isValidDate=function(a){var b=new Date(a),c=arguments;return XgPlatform.XgLogger.debug(function(){return["XgCommon.isValidDate",c]}),Object.prototype.toString.call("[object Date]"===b)?!isNaN(b.getTime()):!1},n.getGauceDateStr=function(a){var b,c,d,e=arguments;return XgPlatform.XgLogger.debug(function(){return["XgCommon.getGauceDateStr",e]}),d=a.getFullYear().toString(),c=(a.getMonth()+1).toString(),b=a.getDate().toString(),10>c&&(c="0"+c),10>b&&(b="0"+b),d+c+b},n.getDateStrFromGauceDate=function(a){var b=a,c=arguments;return XgPlatform.XgLogger.debug(function(){return["XgCommon.getDateStrFromGauceDate",c]}),null===a||void 0===a?"":("string"!=typeof a||n.isValidDate(a)||8!==a.length||(a=a.toString(),b=a.substring(0,4)+"-"+a.substring(4,6)+"-"+a.substring(6,8)),b)},n.deleteProperties=function(a,b){var c,d,e,f=arguments;if(XgPlatform.XgLogger.debug(function(){return["XgCommon.deleteProperties",f]}),"string"==typeof b&&delete a.properties,b instanceof Array)for(c=0,d=b.length;d>c;c++)e=b[c],delete a[e];return this},n.getDataSet=function(a){var b=arguments;return XgPlatform.XgLogger.debug(function(){return["XgCommon.getDataSet",b]}),window.XgPlatform.XgDataSet[a]},n.setDataSet=function(a){var b=arguments;if(XgPlatform.XgLogger.debug(function(){return["XgCommon.setDataSet",b]}),window.XgPlatform.XgDataSet[a.getId()])throw XgPlatform.XgLogger.error(function(){return"XgCommon.setDataSet : ["+a.getId()+"] xgDataSet already registered in XgPlatform"}),new n.Error("["+a.getId()+"] xgDataSet already registered in XgPlatform",o);return window.XgPlatform.XgDataSet[a.getId()]=a,this},n.deepFreeze=function(b){var c,d;Object.freeze(b);for(c in b)a.call(b,c)&&(d=b[c],null!==d&&void 0!==d&&"object"==typeof d&&Object.isFrozen(d)!==!0&&n.deepFreeze(b[c]));return b},n.filterXSS=function(a){var b=a;return"string"==typeof a&&(b=a.replace(/</g,"&lt;").replace(/>/g,"&gt;")),b},n.Error=function(a,b,c){return Object.create||(this.prototype=Error.apply(null,arguments)),this.message="XgError : "+a,this.fileName=b,this.code=c,this},Object.create&&(n.Error.prototype=Object.create(Error),n.Error.prototype.constructor=n.Error),Object.freeze&&n.deepFreeze(n),window.XgPlatform.threadPool||(m=n.getThreadPoolSize(),m||(n.setThreadPoolSize(),m=n.getThreadPoolSize()),window.XgPlatform.threadPool=new n.Pool(m),window.XgPlatform.threadPool.init()),!DOMImplementation.prototype.createDocument){for(g=0,e=["MSXML6.DOMDocument","MSXML5.DOMDocument","MSXML4.DOMDocument","MSXML3.DOMDocument","MSXML2.DOMDocument.5.0","MSXML2.DOMDocument.4.0","MSXML2.DOMDocument.3.0","MSXML2.DOMDocument","MSXML.DomDocument","Microsoft.XmlDom"],f=e.length;f>g;){try{c=new ActiveXObject(e[g]),d=e[g];break}catch(p){}g++}DOMImplementation.prototype.createDocument=function(a,b,c){var e,f,g,h="";if(c)throw"This is not a complete shim for DOMImplementation.prototype.createDocument.";if(!d)throw"Could not create a DOM document object";return e=new ActiveXObject(d),b&&(f=b.indexOf(":"),f>-1?(g=b.slice(0,f),h=" xmlns:"+g+'="'+a+'"'):a&&(h=' xmlns="'+a+'"'),e.loadXML("<"+b+h+"/>")),e}}return XgPlatform.XgLogger.info(function(){return o+" : load end"}),n})}).call(this);