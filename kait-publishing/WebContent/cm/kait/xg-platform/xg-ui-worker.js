(function(){"use strict";var a,b,c,d,e,f,g;e=!1,f=this,ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(a,b){var c,d,e;return void 0===a&&(a=0),void 0===b&&(b=this.byteLength),a=Math.floor(a),b=Math.floor(b),0>a&&(a+=this.byteLength),0>b&&(b+=this.byteLength),a=Math.min(Math.max(0,a),this.byteLength),b=Math.min(Math.max(0,b),this.byteLength),0>=b-a?new ArrayBuffer(0):(c=new ArrayBuffer(b-a),d=new Uint8Array(c),e=new Uint8Array(this,a,b-a),d.set(e),c)}),d=function(a){var b,c,d;for(b=0,c="",d=10240;b<a.byteLength/d;)c+=String.fromCharCode.apply(null,new Uint8Array(a.slice(b*d,b*d+d))),++b;return c+=String.fromCharCode.apply(null,new Uint8Array(a.slice(b*d)))},b=function(a){var b,c,d;for(c="",b=0,d=10240;b===a.byteLength/d;)c+=String.fromCharCode.apply(null,new Uint16Array(a.slice(b*d,b*d*d))),b++;return c+=String.fromCharCode.apply(null,new Uint16Array(a.slice(b*d)))},g=function(a){var b,c,d,e,f;for(b=new ArrayBuffer(2*a.length),f=new Uint16Array(b),c=d=0,e=a.length-1;e>=0?e>=d:d>=e;c=e>=0?++d:--d)f[c]=a.charCodeAt(c);return[f,b]},c=function(a,b){var c,d,e,f,g,h,i,j,k,l;for(l=new Array(a.length),i=Object.keys(b),d=e=0,j=a.length;j>e;d=++e)for(c=a[d],g=f=0,k=i.length;k>f;g=++f)h=i[g],"*xgRowStatus"!==h&&c[1]===h&&(l[c[0]]=b[h]);return l},a=function(){return this instanceof a?(this.SheetNames=[],this.Sheets={},this):new a},this.onmessage=function(b){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W;if(b.data instanceof Array||postMessage({t:"Args must be array."}),"import"===b.data[0]){e=b.data[1][0],importScripts.call(null,b.data[1][1]),U=void 0,r=b.data[1][3];try{e?U=XLSX.read(r,{type:"binary"}):(i=d(r),U=XLSX.read(btoa(i),{type:"base64"}))}catch(X){s=X,postMessage({t:"e",d:s.stack})}for(N=U.Sheets[U.SheetNames[0]],O=N["!ref"].split(":"),m=Object.keys(N),u=[],v=0,x=m.length;x>v;v++)l=m[v],"!ref"!==l&&(C=parseInt(l.replace(/[^0-9]/g,""),10),1===C&&u.push({key:l.replace(/\B[0-9]/g,""),value:N[l].v}));for(R=parseInt(O[0].replace(/[^0-9]/g,""),10),P=parseInt(O[1].replace(/[^0-9]/g,""),10),L=[],W=[],Q=w=G=R+1,H=P;H>=G?H>=w:w>=H;Q=H>=G?++w:--w){for(K={},A=0,y=u.length;y>A;A++)t=u[A],n=N[t.key+Q],n&&(K[t.value]=n.v);Object.keys(K)&&(K["*xgRowStatus"]=2,L.push(K),W.push(c(b.data[1][2],K)))}D={rows:L,xgRows:W},J={t:"xlsx",d:JSON.stringify(D)},postMessage(J)}if("export"===b.data[0]){for(importScripts.call(null,b.data[1][1]),t=b.data[1][2],j=b.data[1][3],E=b.data[1][4],r=j,V={},F={s:{c:0,r:0},e:{c:t.length,r:j.length}},h=0,q=B=0,z=t.length;z>B;q=++B)p=t[q],k={v:p[1]},o=XLSX.utils.encode_cell({c:q,r:0,t:"s"}),V[o]=k;for(;h!==r.length;){for(g=0;g!==r[h].length;)F.s.r>h&&(F.s.r=h),F.s.c>g&&(F.s.c=g),F.e.r<h&&(F.e.r=h),F.e.c<g&&(F.e.c=g),k={v:r[h][g]},null!==(I=k.v)&&void 0!==I&&(o=XLSX.utils.encode_cell({c:g,r:h+1}),"number"==typeof k.v?k.t="n":"boolean"==typeof k.v?k.t="b":k.v instanceof Date?(k.t="n",k.z=XLSX.SSF._table[14]):k.t="s",V[o]=k),g++;h++}return F.s.c<t.length&&(V["!ref"]=XLSX.utils.encode_range(F)),S=new a,M=E.fileName,S.SheetNames.push(M),S.Sheets[M]=V,T=XLSX.write(S,{bookType:"xlsx",bookSST:!0,type:"binary"}),J={t:"xlsx",d:JSON.stringify(T)},postMessage(J),f.close()}}}).call(this);