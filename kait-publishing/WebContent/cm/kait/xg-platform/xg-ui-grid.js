(function(){"use strict";var a=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};!function(a,b){return"function"==typeof define&&define.amd?define("XgUIGrid",["jquery","XgCommon","XgUICommon"],b):a.XgUIGrid=b(a.jQuery,a.XgCommon,a.XgUICommon)}(window,function(b,c,d){function e(a,b){var c,d=a.data("xg-bind-data-table");return void 0!==b.selectedrowindex&&"number"==typeof b.selectedrowindex&&(c=a.jqxGrid("getrowid",b.selectedrowindex),(-1===c||null===c||void 0===c)&&(c=0),d)?d.parent.$eventEmitter.trigger("xg-bind-event",{uuid:a.data("xg-uuid"),eventName:"setRowPos",rowIdx:c,value:c,xgDataTableId:d.getId()}):void 0}function f(a,b,e){var f,g,h,i,j,k,l,m,n,o=[];if(o.push({datafield:"*xgRowStatus",type:"number",columntype:"textbox",groupable:!1,editable:!1,filterable:!1,text:"",width:30,cellsrenderer:function(b,d,e){var f,g,h,i;if("*xgRowStatus"===d){switch(i=a.jqxGrid("rowsheight"),g=a.css("font-size"),"string"==typeof i&&(i=parseInt(i,10)),"string"==typeof g&&(g=parseInt(g,10)),h=i/2-(g+3)/2,4>h&&(h=4),f="normal",e){case c.constant.STATUS.UNKNOWN:f="unknown";break;case c.constant.STATUS.NORMAL:f="normal";break;case c.constant.STATUS.INSERT:f="insert";break;case c.constant.STATUS.UPDATE:f="update";break;case c.constant.STATUS.DELETE:f="delete"}return"<div class='xg-grid-status-"+f+"' style='margin-top:"+h+"px; text-align: center;'></div>"}}}),e.showsequence&&(e.sequencedesc=e.sequencedesc||!1,e.sequencewidth=e.sequencewidth||30,e.sequencetext=e.sequencetext||"번호",o.push({datafield:"*xgSequence",columntype:"number",align:"center",groupable:!1,editable:!1,filterable:!1,text:e.sequencetext,width:e.sequencewidth,cellsrenderer:function(b,c,d){var f,g,h,i,j,k,l;return"*xgSequence"===c?(h=a.xgGrid("pagenum"),i=a.xgGrid("pagesize"),l=a.xgGrid("totalRecords"),j=a.jqxGrid("rowsheight"),f=a.css("font-size"),"string"==typeof j&&(j=parseInt(j,10)),"string"==typeof f&&(f=parseInt(f,10)),g=j/2-(f+3)/2,4>g&&(g=4),k=a.data("xg-option-virtualmode")?e.sequencedesc===!1?d+1+(h-1)*i:l-d-(h-1)*i:e.sequencedesc===!1?d+1:l-d,"<div style='text-align:center;margin-top:"+g+"px;'>"+k+"</div>"):void 0}})),e.columns)for(k=e.columns,g=0,h=k.length;h>g;++g){for(j=k[g],l=b.header,m=0,n=l.length;n>m;++m)if(f=l[m],j.datafield===f[c.constant.COLUMN.NAME]){j.xgSize=f[c.constant.COLUMN.SIZE],j.xgType=f[c.constant.COLUMN.TYPE_OF_GAUCE],j.xgConstraint=f[c.constant.COLUMN.CONSTRAINT],j.type=d.convertXgDataTypeToJSDataType(f[c.constant.COLUMN.TYPE_OF_GAUCE]),j.columntype||(j.columntype="textbox");break}o.push(j)}else for(l=b.header,g=0,h=l.length;h>g;++g)f=l[g],j={datafield:f[c.constant.COLUMN.NAME],text:f[c.constant.COLUMN.NAME],type:d.convertXgDataTypeToJSDataType(f[c.constant.COLUMN.TYPE_OF_GAUCE]),xgType:f[c.constant.COLUMN.TYPE_OF_GAUCE],xgConstraint:f[c.constant.COLUMN.CONSTRAINT],xgSize:f[c.constant.COLUMN.SIZE],width:100},i=f[c.constant.COLUMN.NAME],"number"===j.type&&(j.cellsalign="right"),o.push(j);return o}function g(a,b){for(var c=a.length,d=[];c--;)d.push(delete a[c][b]);return d}function h(a){var b="rowclick",c=a.jqxGrid("selectionmode");return"cell"===c&&(b="cellclick"),a.on(b,function(b){var c=a.jqxGrid("getrowid",b.args.rowindex),d=a.data("xg-bind-data-table");return null!==c&&void 0!==c?d.parent.$eventEmitter.trigger("xg-bind-event",{uuid:a.data("xg-uuid"),eventName:"setRowPos",rowIdx:c,value:c,xgDataTableId:d.getId()}):void 0})}function i(e,f,i){function j(a){g(a,"validation"),g(a,"cellclassname")}function k(b){var d,e;for(d=0,e=b.length;e>d;++d){var g=b[d];Z.getColumnIndex(g.datafield)<0||(b[d].validation||(b[d].validation=function(b,d){var e,h;if("normal"!==g.xgConstraint&&(e=[null,void 0],g.xgConstraint===c.constant.CONSTRAINT.KEY&&e.push(""),a.call(e,d)>=0))return{result:!1,message:f.locale.required};if("number"!==(h=g.type)&&"float"!==h||void 0===d||null===d){if("date"===g.type){if(isNaN(Date.parse(d)))return{result:!1,message:f.locale.requiredDate}}else if(d.toString().length>g.xgSize)return{result:!1,message:g.xgSize+f.locale.overflowMaxNumber}}else if(d=parseInt(d.toString(),10),"number"!=typeof d)return{result:!1,message:f.locale.requiredNumber};return!0}),b[d].cellclassname||(b[d].cellclassname=function(a,b,c){var d="",e=g.xgConstraint;return"key"!==e&&"sequence"!==e||null!==c&&void 0!==c&&""!==c?"notnull"!==e||null!==c&&void 0!==c||(d="cell-invalidate"):d="cell-invalidate",d}))}}var l,m,n,o,p,q,v,w,z,B,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W=e.data("xg-bind-option"),X={},Y=e.jqxGrid("selectionmode"),Z=e.data("xg-bind-data-table");if(b.extend(!0,X,W,f),e.data("xg-bind-option",X),e.data("xg-bind-data-table-id",Z.getId()),e.data("xg-uuid")||(d.removeEvents(e,["rowclick","cellclick","cellvaluechanged","xg-bind-event","pagechanged"]),e.data("inner-components",{}),e.on("xg-bind-event",function(a,b){var f,g,h,i,j,k,l,m,n,o,p,q;if(b.uuid===e.data("xg-uuid"))return!1;if(Z.getId()!==b.xgDataTableId)return!1;if("setValue"===b.eventName)if("column"===b.bind.type){for(i=!1,m=e.jqxGrid("columns").records,k=0,l=m.length;l>k;++k)if(f=m[k],f.displayfield===b.bind.column){i=!0;break}p=Z.getRowStatus(b.rowIdx),i&&p!==c.constant.STATUS.DELETE&&e.jqxGrid("setcellvaluebyid",b.rowIdx,b.bind.column,b.value),p!==c.constant.STATUS.INSERT&&p!==c.constant.STATUS.DELETE&&e.jqxGrid("setcellvaluebyid",b.rowIdx,"*xgRowStatus",c.constant.STATUS.UPDATE)}else"row"===b.bind.type&&console.warn("[ xgGrid setValue listner ] row type의 경우 향후 구현 예정");else if("xgDataTableInit"===b.eventName)e.jqxGrid("clearselection"),e.jqxGrid({source:d.createUIAdapter(Z,"xgGrid")});else if("addRow"===b.eventName)if(b.value instanceof Array){for(o=[],h=e.jqxGrid("getboundrows").length,g=h+b.value.length,j=h,l=g;l>=j;++j)o.push(j);e.jqxGrid("addrow",o,b.value)}else e.jqxGrid("addrow",null,b.value,b.rowIdx),n=Z.getRowCount()-1,e.jqxGrid("setcellvaluebyid",n,"*xgRowStatus",c.constant.STATUS.INSERT);else if("deleteRow"===b.eventName){for(e.jqxGrid("beginupdate",!0),q=b.value,k=0,l=q.length;l>k;++k)n=q[k],e.jqxGrid("setcellvaluebyid",n,"*xgRowStatus",c.constant.STATUS.DELETE);return e.jqxGrid("endupdate")}}),h(e),e.on("cellvaluechanged",function(a){var b,f,g,h,i;return-1===Z.getColumnIndex(a.args.datafield)?!0:(e.data("xg-grid-edit-status",!1),"*xgRowStatus"===a.args.datafield?!1:a.args.oldvalue&&a.args.newvalue&&a.args.oldvalue.toString()===a.args.newvalue.toString()?!1:(g=e.jqxGrid("getrowid",a.args.rowindex),h=Z.getRowStatus(g),h===c.constant.STATUS.DELETE?!1:(f=a.args.newvalue,i=f.value,f instanceof Object&&null!==i&&void 0!==i&&(f=i),b={bind:{type:"column",column:a.args.datafield}},d.setBindColInfo(Z,b),Z.parent.$eventEmitter.trigger("xg-bind-event",{uuid:e.data("xg-uuid"),eventName:"setValue",bind:b.bind,value:f,rowIdx:g,rowValue:Z.getRow(g),xgDataTableId:Z.getId()}),c.constant.STATUS.INSERT!==Z.getRowStatus(g)&&e.jqxGrid("setcellvaluebyid",g,"*xgRowStatus",c.constant.STATUS.UPDATE),!0)))}),e.on("pagechanged ",function(a){var b=a.args;return e.data("xg-option-pagenum",b.pagenum+1)}),d.setUUID(e),Z.parent.bindComponent(e,"jqxGrid")),M=d.getLocaleCode(),N=d.getLocalization(M),E={},!f)return e;if(i.columns||(i.columns=e.jqxGrid("columns").records),f.template)for(H=d.constant.GRID.TEMPLATE[f.template.toUpperCase()],R=0,S=H.length;S>R;++R)G=H[R],K=Object.keys(G)[0],T=f[K],(void 0===T||null===T)&&(f[K]=G[K]);if(e.jqxGrid("beginupdate",!0),E.handlekeyboardnavigation=function(a){var c,d,f,g,h,i,j,k,l,m,n,o,p=b(a.target.parentElement).attr("id"),q=e.attr("id");if("string"==typeof p&&p.replace(/wrapper/g,"")!==q)return!1;if(K=a.charCode?a.charCode:a.keyCode?a.keyCode:0,!e.data("xg-grid-edit-status")){if(f=!1,k=-1,Y.indexOf("cell")>-1?(l=e.jqxGrid("getselectedcell"),l&&(k=l.rowindex),f=!0):k=e.jqxGrid("getselectedrowindex"),38===K&&k>0)return e.jqxGrid("clearselection"),f?e.xgGrid("selectcell",k-1,l.datafield):e.xgGrid({selectedrowindex:k-1}),e.jqxGrid("pageable")&&(i=e.jqxGrid("getdatainformation").paginginformation,k===i.pagenum*i.pagesize&&e.jqxGrid("gotoprevpage")),!0;if(40===K&&k<e.jqxGrid("getboundrows").length-1)return e.jqxGrid("clearselection"),f?e.xgGrid("selectcell",k+1,l.datafield):e.xgGrid({selectedrowindex:k+1}),e.jqxGrid("pageable")&&(i=e.jqxGrid("getdatainformation").paginginformation,k+1===(i.pagenum+1)*i.pagesize&&e.jqxGrid("gotonextpage")),!0;if(46===K&&("INPUT"===(h=a.target.nodeName)||"TEXTAREA"===h))return n=b(a.target).data("xg-uuid"),o=b(a.target).val(),m=u(a.target),m.start===m.end&&(m.end+=1),d=o.substr(0,m.start),c=o.substr(m.end,o.length),j=d+c,b(a.target).val(j),b(a.target).setCursorPosition(m.start),n&&(g=e.data("xg-bind-data-table"),W=b(a.target).data("xg-bind-option"),"write"===W.mode&&(g.parent.$eventEmitter.trigger("xg-bind-event",{uuid:n,eventName:"setValue",rowIdx:g.getRowPos(),bind:{column:W.bind.column,columnIndex:W.bind.columnIndex,type:W.bind.type},value:j,xgDataTableId:g.getId()}),b(a.target).setCursorPosition(m.start))),!0;if(46===K&&e.jqxGrid("enablekeyboarddelete"))return A(e,f),!0}return!1},f.contextMenu){if(V=e.data("xg-uuid"),d.removeEvents(e,["contextmenu","rowclick","cellclick"]),x(e,"contextMenu"),x(e,"outerContextMenu"),e.on("contextmenu",function(){return!1}),l=b("<div></div>"),J="<ul>",f.contextMenu.rowControl&&(J+=d.constant.GRID.MARKUP.CONTEXT_MENU),f.contextMenu["export"]&&(J+=d.constant.GRID.MARKUP.EXPORT_MENU),J+="</ul>",l.html(J),m=l.find("li"),"en"!==M)for(P=0,Q=m.length;Q>P;++P)O=m[P],b(O).html(N[b(O).data("xg-bind-method")]);if(l.jqxMenu({width:230,height:26*m.length+4,autoOpenPopup:!1,mode:"popup"}),n=b("<div></div>"),n.html(d.constant.GRID.MARKUP.OUTER_CONTEXT_MENU),o=n.find("li"),"en"!==M)for(P=0,Q=o.length;Q>P;++P)O=o[P],b(O).html(N[b(O).data("xg-bind-method")]);n.jqxMenu({width:210,height:26*o.length+4,autoOpenPopup:!1,mode:"popup"}),b("body").append(l).append(n),C(e,"contextMenu",{method:"jqxMenu",target:l}),C(e,"outerContextMenu",{method:"jqxMenu",target:n}),v=function(){return l.jqxMenu("close"),n.jqxMenu("close")},h(e),q="rowclick",U="selectrow",Y.indexOf("cell")>-1&&(q="cellclick",U="selectcell"),e.on(q,function(a){var c,d;return v(),a.args.rightclick?(d=b(window).scrollTop(),c=b(window).scrollLeft(),l.jqxMenu("open",parseInt(a.args.originalEvent.clientX,10)+5+c,parseInt(a.args.originalEvent.clientY,10)+5+d),Y.indexOf("multiple")>-1&&e.jqxGrid("clearselection"),"selectcell"===U?e.jqxGrid(U,a.args.rowindex,a.args.datafield):"selectrow"===U&&e.jqxGrid(U,a.args.rowindex),!0):!1}),e.on("mousedown",function(a){var c,d,g,h=void 0;return v(),a||(a=window.event),a.which?h=3===a.which:a.button&&(h=2===a.button),h&&(c=e.jqxGrid("getboundrows"),1>c.length&&f.contextMenu.rowControl&&(g=b(window).scrollTop(),d=b(window).scrollLeft(),n.jqxMenu("open",parseInt(a.clientX,10)+5+d,parseInt(a.clientY,10)+5+g))),!0}),l.on("itemclick",function(a){var c,g,h=a.args,i=b("#"+h.id).data("xg-bind-method"),j=Y.indexOf("cell")>-1;return i.indexOf("insertRow")>-1&&(c=i.substring(9),i=i.substring(0,9),g=0,"After"===c&&(g=1),e.xgGrid("addrow",null,r(Z.header,Z.booleanColumn),e.xgGrid("getselectedrowindex")+g)),"addRow"===i?e.xgGrid("addrow",null,r(Z.header,Z.booleanColumn)):"addRowTop"===i?e.xgGrid("addrow",null,r(Z.header,Z.booleanColumn),"top"):"deleteRow"===i?A(e,j):"exportExcel"===i?e.xgGrid("exportdata","xls",d.getToday(),!0,null,!0,f.actionUrl||"/XG/ix-export.xex","UTF-8"):"exportJSON"===i&&e.xgGrid("exportdata","json",d.getToday(),!0,null,!0),!1}),n.on("itemclick",function(a){var c=b("#"+a.args.id).data("xg-bind-method");return"addRow"===c&&e.xgGrid("addrow",null,r(Z.header,Z.booleanColumn)),!1})}else d.removeEvents(e,["contextmenu","rowclick","cellclick","mousedown"]),x(e,"contextMenu"),x(e,"outerContextMenu"),h(e);if(f.locale=f.locale||d.getLocaleCode(),f.locale&&("string"==typeof f.locale&&(f.locale=d.getLocalization(f.locale)),e.jqxGrid("localizestrings",f.locale)),p=!1,i.columns?e.data("xg-columns-origin",i.columns):i.columns=e.data("xg-columns-origin"),f.cellEdit)for(p=!0,D=i.columns,z=0,B=D.length;B>z;++z)w=D[z],-1!==Z.getColumnIndex(w.datafield)&&(I=function(a,b){i.columns[b].cellbeginedit=function(b,d){var f,g=e.jqxGrid("getrowid",b),h=Z.getRowStatus(g);return e.data("xg-grid-edit-status",!0),"key"===(f=a.xgConstraint)||"sequence"===f?h===c.constant.STATUS.INSERT?!0:h===c.constant.STATUS.DELETE?(console.warn("Row already deleted."),!1):d===a.datafield?(console.warn("You can not editing Key or sequence columns."),!1):!0:h===c.constant.STATUS.DELETE?(console.warn("Row already deleted."),!1):!0},i.columns[b].cellendedit=function(){return e.data("xg-grid-edit-status",!1)}})(w,z);else p=!0,g(i.columns,"cellbeginedit");if((f.cellValidation===!1||f.cellValidation===!0)&&(p=!0),f.cellValidation===!1&&j(i.columns),f.cellValidation&&k(i.columns),f.columnFormat)for(p=!0,D=i.columns,z=0,B=D.length;B>z;++z)w=D[z],-1!==Z.getColumnIndex(w.datafield)&&(w.cellsformat||("date"===w.type?i.columns[z].cellsformat="yyyy-MM-dd":"datetime"===w.type?i.columns[z].cellsformat="yyyy-MM-dd HH:mm:ss":"number"===w.type?i.columns[z].cellsformat="n":"float"===w.type&&(i.columns[z].cellsformat="d2")));else p=!0,g(i.columns,"cellsformat");if(f.showRowStatus===!1?e.jqxGrid("hidecolumn","*xgRowStatus"):e.jqxGrid("showcolumn","*xgRowStatus"),f.useEditor)for(p=!0,D=i.columns,z=0,B=D.length;B>z;++z)w=D[z],F=w.datafield,"*xgRowStatus"!==F&&"*xgSequence"!==F&&-1!==Z.getColumnIndex(w.datafield)&&(I=function(a,b){var d=a.type;return"number"===d?i.columns[b].columntype="numberinput":("date"===d||"datetime"===d)&&(i.columns[b].columntype="datetimeinput"),i.columns[b].columntype?i.columns[b].initeditor=function(e,f,g){var h;switch(G=void 0,d){case"number":G="jqxNumberInput",h={decimal:0,max:c.constant.RANGE_OF_GAUCE[a.xgType.toUpperCase()].MAX,min:c.constant.RANGE_OF_GAUCE[a.xgType.toUpperCase()].MIN,digits:i.columns[b].xgSize,decimalDigits:0};break;case"float":G="jqxNumberInput",h={decimal:2,max:c.constant.RANGE_OF_GAUCE.DECIMAL.MAX,min:c.constant.RANGE_OF_GAUCE.DECIMAL.MIN,digits:i.columns[b].xgSize,decimalDigits:2};break;case"date":G="jqxDateTimeInput",h={formatString:N.patterns.d,dayNameFormat:"firstLetter"};break;case"datetime":G="jqxDateTimeInput",h={formatString:N.patterns.F,dayNameFormat:"firstLetter"}}if(G&&h)switch(g[G](h),d){case"number":case"float":return g[G]("val",f);case"date":case"datetime":if(!f)return f=c.getGauceDateStr(new Date)}}:void 0})(w,z);else p=!0,g(i.columns,"columntype"),g(i.columns,"initeditor");if(f.useEditor instanceof Object)for(p=!0,L=Object.keys(f.useEditor),D=i.columns,z=0,B=D.length;B>z;++z)w=D[z],F=w.datafield,"*xgRowStatus"!==F&&-1!==Z.getColumnIndex(F)&&(I=function(g,h){var j,k,l,m,n,o,p,q=g.datafield;if(a.call(L,q)<0)return!1;if(G=n=void 0,l=f.useEditor[g.datafield],p=l.columntype,"dropdownlist"!==p&&"checkbox"!==p&&"passwordinput"!==p&&"numberinput"!==p&&"datetimeinput"!==p)return!1;switch(l.source||(l.source=[]),l.columntype){case"dropdownlist":G="jqxDropDownList";break;case"checkbox":G="jqxCheckBox";break;case"passwordinput":G="jqxPasswordInput";break;case"numberinput":G="jqxNumberInput";break;case"datetimeinput":G="jqxDateTimeInput"}return o="object"==typeof l.source[0],delete i.columns[h].validation,m=l.columntype,i.columns[h].columntype=m,"passwordinput"===m&&(i.columns[h].columntype="custom"),j=function(a,b,c){return c?void a[b](c):a[b]()},(k=function(a){if("checkbox"===m)i.columns[h].cellbeginedit=function(a){var b=e.jqxGrid("getrowid",a),d=Z.getRowStatus(b);return e.data("xg-grid-edit-status",!1),d===c.constant.STATUS.DELETE?(console.warn("Row already deleted."),!1):(e.jqxGrid({selectedrowindex:a}),!0)},l.checkedAll&&(i.columns[h].rendered=function(c){var f=b(c),h={width:16,height:16,animationShowDelay:0,animationHideDelay:0,enableContainerClick:!0},j=f.last().text();return f.last().append('<span class="xg-checked-all">'+j+"</span>"),b(c).find("span:not(.xg-checked-all)").remove(),i.theme&&(h.theme=i.theme),f[a](h),f.css("width","100%"),d.removeEvents(f,["click","change"]),f.on("click",function(a){a.stopPropagation()}),f.on("change",function(a){var b,c,d,f=a.args.checked;for(e.jqxGrid("beginupdate"),c=0,d=e.jqxGrid("getrows").length;d>c;++c)b=e.jqxGrid("getrowboundindex",c),e.jqxGrid("setcellvalue",b,g.datafield,f);return e.jqxGrid("endupdate")})}),l.checkedAll===!1&&(i.columns[h].rendered=function(a){var c=b(b(a).find("span.xg-checked-all"));return c?c.remove():void 0});else if("datetimeinput"===m)i.columns[h].initeditor=function(b,d,e){var f=d;return f||(f=c.getGauceDateStr(new Date)),"string"==typeof f&&8===f.length&&(f=new Date(c.getDateStrFromGauceDate(d))),e[a]("setDate",f)},i.columns[h].cellvaluechanging=function(a,b,c,d,e){return e&&d!==e?e:d};else if("passwordinput"===m)i.columns[h].createeditor=function(c,d,e){var f=b('<input type="password" style="width: 100%; height: 100%;">');return e.append(f),l.option||(l.option={maxLength:g.xgSize}),j(f,a,l.option)},i.columns[h].initeditor=function(b,c,d){var e;return y(),e=d.find('input[type="password"]:first'),e[a]("val",c),e.focus()},i.columns[h].geteditorvalue=function(a,b,c){return c.find('input[type="password"]:first').val()},i.columns[h].cellsrenderer=function(a,b,c){var d=c.replace(/./gi,"●");return"<div style='margin-top:4px;margin-left:4px;'> "+d+" </div>"},i.columns[h].cellvaluechanging=function(a,b,c,d,h){return null===h||void 0===h||d===h?d:(f.cellValidation&&h.length>g.xgSize&&e.jqxGrid("showvalidationpopup",a,g.datafield,""+g.xgSize+f.locale.overflowMaxNumber),h)},i.columns[h].destroyeditor=function(a){return b(a).jqxPasswordInput("destroy")};else if("numberinput"===m)i.columns[h].initeditor=function(b,c,d){return j(d,a,l.option)};else if("dropdownlist"===m)return i.columns[h].initeditor=function(b,c,d){var e;return n={autoDropDownHeight:!0},l.source.length&&(n.source=l.source,l.source.length>6&&(n.autoDropDownHeight=!1,n.dropDownHeight=200)),o&&(n.valueMember="value",n.displayMember="text"),j(d,a,n),e=o?t(l.source,c,"value","index"):s(l.source,c),n.source||(e=t(d[a]("source").records,c,g.datafield,"index")),(null===e||void 0===e)&&(e=0),d[a]("selectIndex",e)},i.columns[h].cellsrenderer=function(a,b,c){var d,e;return e=o?c instanceof Object?c.text:t(l.source,c,"value","text"):c,(null===e||void 0===e)&&(e=c),d=i.columns[h].cellsalign,"<div style='margin-top:4px;margin-left:4px;text-align:"+d+";'> "+e+" </div>"},i.columns[h].cellvaluechanging=function(a,b,c,d,f){var h,i,j={};return o?(h=t(l.source,f,"text","value"),j=h):(h=f,j=h),null===h||void 0===h?d:d&&d.toString()===h.toString()?d:(i=e.jqxGrid("getrowid",a),e.jqxGrid("setcellvaluebyid",i,g.datafield,j),j)}})(G)})(w,z);return f.groupSubsum?(p=!0,E.groupsrenderer=function(a,b,c,d){var e,g,h,j,k,l,m,n,o,p,q,r,s,t={};for(L=Object.keys(f.groupSubsum),d.subItems.length&&L.length?(I=function(a,b){var c,d,e,g=[];for(d=0,e=a.length;e>d;++d)K=a[d],c=this.getcolumnaggregateddata(K,f.groupSubsum[K],!0,b.subItems),g.push(t[K]=c);return g},I.apply(this,[L,d])):(s=[],n=function(a,b){var c,d,e,f,g;if(a.subGroups.length){for(c=a.subGroups,f=[],d=0,e=c.length;e>d;++d)g=c[d],f.push(n(a.subGroups[d],b));return f}return b=a.subItems.map(function(a){return a})},n(d,s),I=function(a,b,c){var d,e,g,h=[];for(e=0,g=a.length;g>e;++e)K=a[e],d=this.getcolumnaggregateddata(K,f.groupSubsum[K],!0,c),h.push(t[K]=d);return h},I.apply(this,[L,d,s])),r="<div style='position: relative; margin: 4px; overflow: hidden;'>"+a+" [ ",p=0,q=L.length;q>p;++p)for(K=L[p],m=i.columns,k=0,l=m.length;l>k;++k)if(w=m[k],K===w.datafield){for(j=w.text,"*xgRowStatus"===w.datafield||w.text||(j=""+w.datafield),o=Object.keys(t[K]),g=0,h=o.length;h>g;++g)e=o[g],j+=" "+e+" : "+t[K][e],g+1!==o.length&&(j+=", ");r+=j}return r+=" ]</div>"}):(p=!0,delete E.groupsrenderer),p&&(E.columns=i.columns),e.jqxGrid(E),e.jqxGrid("refreshdata"),e.jqxGrid("endupdate"),e}function k(a){return function(){var c,d,e,f,g,h=a.data("xg-bind-data-table"),i=h.getId(),j=h.parent,k=a.jqxGrid("pagerheight"),l=a.data("xg-option-pagenum")||1,m=a.jqxGrid("pagesize"),n=a.jqxGrid("theme"),o=(k-17)/2,p=j.totalRecords[i]||0;return a.data("xg-option-totalrecords",p),g=0===Math.floor(p%m)?Math.floor(p/m):Math.floor(p/m)+1,c=b("<div style='width: 98%; height: 98%;'></div>"),c.css("margin-top",o),e=b("<div><div></div></div>"),e.find("div").addClass("jqx-icon-arrow-left"),e.jqxButton({theme:n}),f=b("<div><div></div></div>"),f.find("div").addClass("jqx-icon-arrow-right"),f.jqxButton({theme:n}),d=b("<div style='font-size: 11px; margin-right:10px; margin-left: 10px; font-weight: bold; float: right;'></div>"),d.text(l>g?g+" / "+g:l+" / "+g),e.css("float","right"),f.css("float","right"),f.appendTo(c),e.appendTo(c),d.appendTo(c),p>0&&(f.click(function(){return l!==g&&0!==p?(g>l&&(l+=1),v(a,j,i,l,m)):void 0}),e.click(function(){return 1!==l&&0!==p?(l>1&&(l-=1),v(a,j,i,l,m)):void 0})),c}}function l(a){return function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=a.data("xg-bind-data-table"),t=s.getId(),u=s.parent,w=a.jqxGrid("pagerheight"),x=a.data("xg-option-pagenum")||1,y=a.jqxGrid("pagesize"),z=a.jqxGrid("pagerbuttonscount"),A=a.jqxGrid("theme"),B=(w-17)/2,C=u.totalRecords[t]||0;for(a.data("xg-option-totalrecords",C),r=0===Math.floor(C%y)?Math.floor(C/y):Math.floor(C/y)+1,m=Math.floor((x-1)/z),q=Math.floor((r-1)/z),p=m*z+1,c=b("<div style='width: 98%; height: 98%; text-align: center;'></div>"),c.css("margin-top",B),d=b("<div type='button'><div></div></div>"),d.find("div").addClass("jqx-icon-arrow-first"),d.jqxButton({theme:A}),d.click(function(){return x=1,v(a,u,t,x,y)}),d.mouseenter(function(){return d.find("div").addClass("jqx-icon-arrow-first-hover")}),d.mouseleave(function(){return d.find("div").removeClass("jqx-icon-arrow-first-hover")}),d.mousedown(function(){return d.find("div").addClass("jqx-icon-arrow-first-selected")}),d.mouseup(function(){return d.find("div").removeClass("jqx-icon-arrow-first-selected")}),j=b("<div type='button'><div></div></div>"),j.find("div").addClass("jqx-icon-arrow-left"),j.jqxButton({theme:A}),j.mouseenter(function(){return j.find("div").addClass("jqx-icon-arrow-left-hover")}),j.mouseleave(function(){return j.find("div").removeClass("jqx-icon-arrow-left-hover")}),j.mousedown(function(){return j.find("div").addClass("jqx-icon-arrow-left-selected")}),j.mouseup(function(){return j.find("div").removeClass("jqx-icon-arrow-left-selected")}),l=b("<div class='jqx-number-block'></div>"),i=b("<a class='jqx-grid-pager-number'>...</a>"),i.css("cursor","pointer"),i.mouseenter(function(){return i.addClass("jqx-fill-state-hover")}),i.mouseleave(function(){return i.removeClass("jqx-fill-state-hover")}),n=b("<a class='jqx-grid-pager-number'>...</a>"),n.css("cursor","pointer"),n.mouseenter(function(){return n.addClass("jqx-fill-state-hover")}),n.mouseleave(function(){return n.removeClass("jqx-fill-state-hover")}),i.appendTo(l),e=0,f=z;f>e&&!(p+e>r);++e)x===p+e?k=b("<a class='jqx-grid-pager-number jqx-fill-state-pressed'>"+x+"</a>"):(k=b("<a class='jqx-grid-pager-number'>"+(p+e)+"</a>"),k.css("cursor","pointer"),function(c){k.click(function(){return 0!==C?(x=c,v(a,u,t,x,y)):void 0}),k.mouseenter(function(a){return b(a.target).addClass("jqx-fill-state-hover")}),k.mouseleave(function(a){return b(a.target).removeClass("jqx-fill-state-hover")})}(p+e)),k.appendTo(l);return n.appendTo(l),i.css("display",0===m?"none":"inline"),n.css("display",m===q?"none":"inline"),o=b("<div type='button'><div></div></div>"),o.find("div").addClass("jqx-icon-arrow-right"),o.jqxButton({theme:A}),o.mouseenter(function(){return o.find("div").addClass("jqx-icon-arrow-right-hover")}),o.mouseleave(function(){return o.find("div").removeClass("jqx-icon-arrow-right-hover")}),o.mousedown(function(){return o.find("div").addClass("jqx-icon-arrow-right-selected")}),o.mouseup(function(){return o.find("div").removeClass("jqx-icon-arrow-right-selected")}),h=b("<div type='button'><div></div></div>"),h.find("div").addClass("jqx-icon-arrow-last"),h.jqxButton({theme:A}),h.click(function(){return x=r,v(a,u,t,x,y)}),h.mouseenter(function(){return h.find("div").addClass("jqx-icon-arrow-last-hover")}),h.mouseleave(function(){return h.find("div").removeClass("jqx-icon-arrow-last-hover")}),h.mousedown(function(){return h.find("div").addClass("jqx-icon-arrow-last-selected")}),h.mouseup(function(){return h.find("div").removeClass("jqx-icon-arrow-last-selected")}),g=b("<div style='font-size: 11px;font-weight: bold; float: right;'></div>"),g.text(x>r?r+" / "+r:x+" / "+r),d.appendTo(c),j.appendTo(c),l.appendTo(c),o.appendTo(c),h.appendTo(c),C>0&&(o.click(function(){return x!==r&&0!==C?(r>x&&(x+=1),v(a,u,t,x,y)):void 0}),j.click(function(){return 1!==x&&0!==C?(x>1&&(x-=1),v(a,u,t,x,y)):void 0}),n.click(function(){return r>x&&(x=p+z),v(a,u,t,x,y)}),i.click(function(){return x>1&&(x=p-z),v(a,u,t,x,y)})),c}}function m(a){for(var b={},c=Object.keys(a),d={virtualmode:!0},e=0,f=c.length;f>e;e++){var g=c[e];D.hasOwnProperty(g)&&(d.hasOwnProperty(g)||(b[g]=a[g]))}return a.xgInitOption&&(a.xgInitOption.xgDataSet&&a.xgInitOption.xgDataTable||(!!a.xgInitOption.source&&(b.source=a.xgInitOption.source),!!a.xgInitOption.columns&&(b.columns=a.xgInitOption.columns))),b}var n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D={},E="xg-ui-grid.js";return XgPlatform.XgLogger.info(function(){return E+" : load start"}),function(){b.jqx._jqxGrid.prototype.defineInstance.apply(D)}(),p=function(a,b){var c,d,e,f=Object.keys(b),g=new Array(a.getColumnCount());for(c=0,d=f.length;d>c;++c)e=f[c],g[a.getColumnIndex(e)]=b[e];return g},q=function(a,b){var c,d,e,f=[];for(c=0,d=b.length;d>c;++c)e=b[j],f.push(p(a,e));return f},r=function(a,b){var d,e,f,g,h={};for(h["*xgRowStatus"]=c.constant.STATUS.INSERT,f=0,g=a.length;g>f;++f)d=a[f],e=null,b[d[c.constant.COLUMN.NAME]]&&(e=!1),h[d[c.constant.COLUMN.NAME]]=e;return h},t=function(a,b,c,d){var e,f,g,h=void 0;if(null===b||void 0===b)return h;for(b instanceof Object&&(b=b[c]),e=0,f=a.length;f>e;++e)if(g=a[e],g[c].toString()===b.toString()){"text"===d||"value"===d?h=g[d]:"index"===d&&(h=e);break}return h},s=function(a,b){var c,d,e,f=void 0;if(null===b||void 0===b)return 0;for(c=0,d=a.length;d>c;++c)if(e=a[c],e.toString()===b.toString()){f=c;break}return f},o=function(a,b,d){var e,f,g,h=a.data("xg-bind-data-table").header;for(f=0,g=h.length;g>f;++f)e=h[f],a.jqxGrid("setcolumnproperty",e[c.constant.COLUMN.NAME],b,d);return a},z=function(a,b,d,e){var f,g=void 0;if(d instanceof Array)for(g=q(b,d),f=d.length;f--;)d[f]["*xgRowStatus"]=c.constant.STATUS.INSERT;else g=p(b,d),d["*xgRowStatus"]=c.constant.STATUS.INSERT;return a.jqxGrid("addrow",null,d,e),b.parent.$eventEmitter.trigger("xg-bind-event",{uuid:a.data("xg-uuid"),eventName:"addRow",rowIdx:e,value:d,rowValue:g,xgDataTableId:b.getId()})},B=function(a,b,d){var e,f,g=a.getRowStatus(b);if(delete d.uid,g===c.constant.STATUS.UNKNOWN||g===c.constant.STATUS.DELETE)throw new c.Error("Can not update row. Row status in [ unkown, delete ]",E);for(f=p(a,d),e=f.length;e--;)a.setValue(b,colIdx,f[colIdx]);return g===c.constant.STATUS.INSERT&&a.setRowStatus(b,g),a.getRowStatus(b)},A=function(a,b){var c,d,e,f,g,h=[];if(b)for(d=a.jqxGrid("getselectedcells"),f=0,g=d.length;g>f;++f)c=d[f],h.push(c.rowindex);else h=a.jqxGrid("getselectedrowindexes");if(!h.length)return!1;for(e=[],f=h.length;f--;)e.push(a.jqxGrid("getrowid",h[f]));return a.xgGrid("removerow",e)},y=function(){return b(".jqx-grid-validation, .jqx-grid-validation-arrow-up, .jqx-grid-validation-arrow-down").remove()},x=function(a,b){var c=a.data("inner-components"),d=c[b];return d&&(d.target[d.method]("destroy"),delete c[b],a.data("inner-components",c)),d=null,a},w=function(a){for(var b=Object.keys(a.data("inner-components")),c=b.length;c--;)x(a,b[c]);return b=null,a},C=function(a,b,c){var d=a.data("inner-components");return c.target&&c.method&&(d[b]=c,a.data("inner-components",d)),a},u=function(a){var b,c,d,e={start:0,end:0};return"number"==typeof a.selectionStart&&"number"==typeof a.selectionEnd?(e.start=a.selectionStart,e.end=a.selectionEnd):document.selection&&(c=document.selection.createRange().getBookmark(),d=a.createTextRange(),b=d.duplicate(),d.moveToBookmark(c),b.setEndPoint("EndToStart",d),e.start=b.text.length,e.end=e.start+d.text.length),e},v=function(a,b,c,d,e){return a.jqxGrid("showloadelement"),a.data("xg-option-pagenum",d),b.getDataAdapter().setParams({START:(d-1)*e,PAGESIZE:e}),b.select(c)},b.fn.xgGrid=function(){function a(a){if(P.virtualmode){a.data("xg-option-virtualmode",!0);var b=a.data("xg-option-pagenum"),c=(P.theme||a.jqxGrid("theme"),P.pagesize||100);U&&U.getDataAdapter().setParams({START:(b-1)*c,PAGESIZE:c});var d;d="simple"===P.pagermode?l(a):k(a),Q.pageable=P.pageable||!0,Q.pagerrenderer=d}}var g,h,j,n,o,p,q,s,t,u,v,x,y,A,B,C,D,F,G,H,I,J,K,L,M,N=this.selector?this.selector:this,O=arguments;if(XgPlatform.XgLogger.debug(function(){return["XgUIGrid",N,O]}),b(N).attr("data-xg-grid",""),1===arguments.length&&"object"==typeof arguments[0]){var P=arguments[0],Q=m(P),R=P.blocksize?P.blocksize:5;b(N).data("xg-option-blocksize",R);var S=P.blockalign?P.blockalign:"left";b(N).data("xg-option-blockalign",S);var T=P.pagenum?P.pagenum:1;if(b(N).data("xg-option-pagenum",T),P.xgInitOption){var U,V=b(N).data("xg-init-option");if(V=b.extend(!0,V,P.xgInitOption),b(N).data("xg-init-option",V),"string"==typeof V.xgDataSet?U=c.getDataSet(V.xgDataSet):"object"==typeof V.xgDataSet&&(U=V.xgDataSet),"string"==typeof V.xgDataTable){if(!U)throw new c.Error("Require xgDataSet option property",E);M=U.getDataTable(V.xgDataTable)}else"object"==typeof V.xgDataTable&&(M=V.xgDataTable);if(b(N).data("xg-bind-data-table",M),!U||!M)return b(N).jqxGrid(Q);L=P.xgBindOption,o=f(b(N),M,V),M.uiAdapter=d.createUIAdapter(M,"xgGrid"),Q.source=M.uiAdapter,Q.columns=o,a(b(N)),g=b(N).jqxGrid(Q),i(g,L,Q)}else P.xgBindOption?(L=P.xgBindOption,g=b(N).jqxGrid(Q),i(g,L,Q)):(g=b(N).jqxGrid(Q),A=d.getLocaleCode(),B=d.getLocalization(A),g.jqxGrid("localizestrings",B));return e(b(N),Q),g}if(b(N).data("xg-bind-data-table")&&arguments.length>0)if(g=b(N),u=Array.prototype.slice.call(arguments,0,1)[0],D=Array.prototype.slice.call(arguments,1,arguments.length),n=g.data("xg-bind-data-table"),"exportdata"===u){var V=b(N).data("xg-init-option");if(V.showsequence)for(K=g.jqxGrid("source"),v=0,x=K.records.length;x>v;++v)K.records[v]["*xgSequence"]=V.sequencedesc?K.records.length-v:v+1}else{if("addrow"===u){if(p=g.jqxGrid("getselectedrowindex"),H=void 0,h=D[1],j=D[2],"number"==typeof j?H=j:("top"===j||"first"===j)&&(H=0),y=0,void 0===h||null===h)D[1]={};else if(void 0!==h&&null!==h&&"object"==typeof h)if(h instanceof Array){for(y=h.length,s=0,t=h.length;t>s;++s)q=h[s],Object.keys(q).length||(arguments[2][s]=r(n.header,n.booleanColumn));z(g,n,arguments[2],j)}else h instanceof Object&&(Object.keys(h).length||(arguments[2]=r(n.header,n.booleanColumn)),z(g,n,arguments[2],j),y=1);return void 0!==H&&null!==H&&p>=H?p+=y:(void 0===H||null===H)&&(p=0),-1!==g.jqxGrid("selectedrowindex")&&g.jqxGrid({selectedrowindex:p}),g}if("removerow"===u){for("number"==typeof D[0]&&(arguments[1]=[D[0]]),F=[],h=arguments[1],v=0,x=h.length;x>v;++v)H=h[v],G=g.jqxGrid("getrowid",H),"string"==typeof G&&(G=parseInt(G.toString(),10)),g.jqxGrid("getcellvaluebyid",G,"*xgRowStatus")===c.constant.STATUS.INSERT?g.xgGrid("deleterow",H):(g.jqxGrid("setcellvaluebyid",G,"*xgRowStatus",c.constant.STATUS.DELETE),F.push(G));return F.length>0&&n.parent.$eventEmitter.trigger("xg-bind-event",{uuid:g.data("xg-uuid"),eventName:"deleteRow",rowIdx:void 0,value:F,xgDataTableId:n.getId()}),g}if("deleterow"===u){for("number"==typeof D[0]&&(arguments[1]=[D[0]]),h=arguments[1],v=0,x=h.length;x>v;++v)H=h[v],G=g.jqxGrid("getrowid",H),null!==G&&("string"==typeof G&&(G=parseInt(G.toString(),10)),g.jqxGrid("deleterow",G),g.jqxGrid("setcellvaluebyid",G,"*xgRowStatus",c.constant.STATUS.DELETE),n.deleteRow(G));return g}if("destroy"===u)w(g);else if("setcolumnindex"===u){if("number"!=typeof arguments[2])throw new c.Error("Can not change column index. args[ 2 ] is not number.",E);arguments[2]=arguments[2]+1}else{if("xgSelect"===u&&n.parent)return n.parent.select([n.getId()],function(a,b,e){if(200!==e)throw new c.Error("XgUIGrid select sync fail",E);

return g.jqxGrid({source:d.createUIAdapter(n,"xgGrid")}),h=D[0],h&&"function"==typeof h?h(a,b,e):void 0}),g;if("xgUpdate"===u&&n.parent)return n.parent.update([n.getId()],D[0]),g;if("xgInitOption"===u)return g.data("xg-init-option");if("xgBindOption"===u)return g.data("xg-bind-option");if("blocksize"===u){if(1===arguments.length)return g.data("xg-option-blocksize");if(arguments.length>1)return h=arguments[1],J=typeof h,"string"===J?C=parseInt(h,10):"number"===J&&(C=h),g.data("xg-option-blocksize",C)}else if("pagenum"===u){if(1===arguments.length)return g.data("xg-option-pagenum");if(arguments.length>1)return h=arguments[1],J=typeof h,"string"===J?C=parseInt(h,10):"number"===J&&(C=h),I=g.jqxGrid("pagesize"),g.data("xg-option-virtualmode")&&n.parent.getDataAdapter().setParams({START:(C-1)*I,PAGESIZE:I}),g.data("xg-option-pagenum",C)}else{if("totalRecords"===u)return g.data("xg-option-virtualmode")?g.data("xg-option-totalrecords")||0:n.getRowCount();if("getDataSet"===u)return n.parent;if("getDataTable"===u)return n}}}return b.fn.jqxGrid.apply(this,arguments)},n={},n=function(){var a=Array.prototype.slice.call(arguments,0,1)[0],c=Array.prototype.slice.call(arguments,1,arguments.length)[0];return b(a).xgGrid(c)},b(document).ready(function(){for(var a,c=b("[data-xg-grid]"),d=c.length,e=[];d--;)a=b(c[d]),e.push(a.data("xg-option")?a.xgGrid(a.data("xg-option")):void 0);return e}),XgPlatform.XgLogger.info(function(){return E+" : load end"}),n})}).call(this);